(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[614],{776:function(i){"use strict";function earcut(i,m,p){p=p||2;var _,x,y,T,v,E,A,S=m&&m.length,I=S?m[0]*p:i.length,R=linkedList(i,0,I,p,!0),C=[];if(!R||R.next===R.prev)return C;if(S&&(R=eliminateHoles(i,m,R,p)),i.length>80*p){_=y=i[0],x=T=i[1];for(var P=p;P<I;P+=p)v=i[P],E=i[P+1],v<_&&(_=v),E<x&&(x=E),v>y&&(y=v),E>T&&(T=E);A=0!==(A=Math.max(y-_,T-x))?32767/A:0}return earcutLinked(R,C,p,_,x,A,0),C}function linkedList(i,m,p,_,x){var y,T;if(x===signedArea(i,m,p,_)>0)for(y=m;y<p;y+=_)T=insertNode(y,i[y],i[y+1],T);else for(y=p-_;y>=m;y-=_)T=insertNode(y,i[y],i[y+1],T);return T&&equals(T,T.next)&&(removeNode(T),T=T.next),T}function filterPoints(i,m){if(!i)return i;m||(m=i);var p,_=i;do if(p=!1,!_.steiner&&(equals(_,_.next)||0===area(_.prev,_,_.next))){if(removeNode(_),(_=m=_.prev)===_.next)break;p=!0}else _=_.next;while(p||_!==m);return m}function earcutLinked(i,m,p,_,x,y,T){if(i){!T&&y&&indexCurve(i,_,x,y);for(var v,E,A=i;i.prev!==i.next;){if(v=i.prev,E=i.next,y?isEarHashed(i,_,x,y):isEar(i)){m.push(v.i/p|0),m.push(i.i/p|0),m.push(E.i/p|0),removeNode(i),i=E.next,A=E.next;continue}if((i=E)===A){T?1===T?earcutLinked(i=cureLocalIntersections(filterPoints(i),m,p),m,p,_,x,y,2):2===T&&splitEarcut(i,m,p,_,x,y):earcutLinked(filterPoints(i),m,p,_,x,y,1);break}}}}function isEar(i){var m=i.prev,p=i.next;if(area(m,i,p)>=0)return!1;for(var _=m.x,x=i.x,y=p.x,T=m.y,v=i.y,E=p.y,A=_<x?_<y?_:y:x<y?x:y,S=T<v?T<E?T:E:v<E?v:E,I=_>x?_>y?_:y:x>y?x:y,R=T>v?T>E?T:E:v>E?v:E,C=p.next;C!==m;){if(C.x>=A&&C.x<=I&&C.y>=S&&C.y<=R&&pointInTriangle(_,T,x,v,y,E,C.x,C.y)&&area(C.prev,C,C.next)>=0)return!1;C=C.next}return!0}function isEarHashed(i,m,p,_){var x=i.prev,y=i.next;if(area(x,i,y)>=0)return!1;for(var T=x.x,v=i.x,E=y.x,A=x.y,S=i.y,I=y.y,R=T<v?T<E?T:E:v<E?v:E,C=A<S?A<I?A:I:S<I?S:I,P=T>v?T>E?T:E:v>E?v:E,k=A>S?A>I?A:I:S>I?S:I,B=zOrder(R,C,m,p,_),D=zOrder(P,k,m,p,_),F=i.prevZ,L=i.nextZ;F&&F.z>=B&&L&&L.z<=D;){if(F.x>=R&&F.x<=P&&F.y>=C&&F.y<=k&&F!==x&&F!==y&&pointInTriangle(T,A,v,S,E,I,F.x,F.y)&&area(F.prev,F,F.next)>=0||(F=F.prevZ,L.x>=R&&L.x<=P&&L.y>=C&&L.y<=k&&L!==x&&L!==y&&pointInTriangle(T,A,v,S,E,I,L.x,L.y)&&area(L.prev,L,L.next)>=0))return!1;L=L.nextZ}for(;F&&F.z>=B;){if(F.x>=R&&F.x<=P&&F.y>=C&&F.y<=k&&F!==x&&F!==y&&pointInTriangle(T,A,v,S,E,I,F.x,F.y)&&area(F.prev,F,F.next)>=0)return!1;F=F.prevZ}for(;L&&L.z<=D;){if(L.x>=R&&L.x<=P&&L.y>=C&&L.y<=k&&L!==x&&L!==y&&pointInTriangle(T,A,v,S,E,I,L.x,L.y)&&area(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function cureLocalIntersections(i,m,p){var _=i;do{var x=_.prev,y=_.next.next;!equals(x,y)&&intersects(x,_,_.next,y)&&locallyInside(x,y)&&locallyInside(y,x)&&(m.push(x.i/p|0),m.push(_.i/p|0),m.push(y.i/p|0),removeNode(_),removeNode(_.next),_=i=y),_=_.next}while(_!==i);return filterPoints(_)}function splitEarcut(i,m,p,_,x,y){var T=i;do{for(var v=T.next.next;v!==T.prev;){if(T.i!==v.i&&isValidDiagonal(T,v)){var E=splitPolygon(T,v);T=filterPoints(T,T.next),E=filterPoints(E,E.next),earcutLinked(T,m,p,_,x,y,0),earcutLinked(E,m,p,_,x,y,0);return}v=v.next}T=T.next}while(T!==i)}function eliminateHoles(i,m,p,_){var x,y,T,v,E,A=[];for(x=0,y=m.length;x<y;x++)T=m[x]*_,v=x<y-1?m[x+1]*_:i.length,(E=linkedList(i,T,v,_,!1))===E.next&&(E.steiner=!0),A.push(getLeftmost(E));for(A.sort(compareX),x=0;x<A.length;x++)p=eliminateHole(A[x],p);return p}function compareX(i,m){return i.x-m.x}function eliminateHole(i,m){var p=findHoleBridge(i,m);if(!p)return m;var _=splitPolygon(p,i);return filterPoints(_,_.next),filterPoints(p,p.next)}function findHoleBridge(i,m){var p,_=m,x=i.x,y=i.y,T=-1/0;do{if(y<=_.y&&y>=_.next.y&&_.next.y!==_.y){var v=_.x+(y-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(v<=x&&v>T&&(T=v,p=_.x<_.next.x?_:_.next,v===x))return p}_=_.next}while(_!==m);if(!p)return null;var E,A=p,S=p.x,I=p.y,R=1/0;_=p;do x>=_.x&&_.x>=S&&x!==_.x&&pointInTriangle(y<I?x:T,y,S,I,y<I?T:x,y,_.x,_.y)&&(E=Math.abs(y-_.y)/(x-_.x),locallyInside(_,i)&&(E<R||E===R&&(_.x>p.x||_.x===p.x&&sectorContainsSector(p,_)))&&(p=_,R=E)),_=_.next;while(_!==A);return p}function sectorContainsSector(i,m){return 0>area(i.prev,i,m.prev)&&0>area(m.next,i,i.next)}function indexCurve(i,m,p,_){var x=i;do 0===x.z&&(x.z=zOrder(x.x,x.y,m,p,_)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next;while(x!==i);x.prevZ.nextZ=null,x.prevZ=null,sortLinked(x)}function sortLinked(i){var m,p,_,x,y,T,v,E,A=1;do{for(p=i,i=null,y=null,T=0;p;){for(T++,_=p,v=0,m=0;m<A&&(v++,_=_.nextZ);m++);for(E=A;v>0||E>0&&_;)0!==v&&(0===E||!_||p.z<=_.z)?(x=p,p=p.nextZ,v--):(x=_,_=_.nextZ,E--),y?y.nextZ=x:i=x,x.prevZ=y,y=x;p=_}y.nextZ=null,A*=2}while(T>1);return i}function zOrder(i,m,p,_,x){return(i=((i=((i=((i=((i=(i-p)*x|0)|i<<8)&16711935)|i<<4)&252645135)|i<<2)&858993459)|i<<1)&1431655765)|(m=((m=((m=((m=((m=(m-_)*x|0)|m<<8)&16711935)|m<<4)&252645135)|m<<2)&858993459)|m<<1)&1431655765)<<1}function getLeftmost(i){var m=i,p=i;do(m.x<p.x||m.x===p.x&&m.y<p.y)&&(p=m),m=m.next;while(m!==i);return p}function pointInTriangle(i,m,p,_,x,y,T,v){return(x-T)*(m-v)>=(i-T)*(y-v)&&(i-T)*(_-v)>=(p-T)*(m-v)&&(p-T)*(y-v)>=(x-T)*(_-v)}function isValidDiagonal(i,m){return i.next.i!==m.i&&i.prev.i!==m.i&&!intersectsPolygon(i,m)&&(locallyInside(i,m)&&locallyInside(m,i)&&middleInside(i,m)&&(area(i.prev,i,m.prev)||area(i,m.prev,m))||equals(i,m)&&area(i.prev,i,i.next)>0&&area(m.prev,m,m.next)>0)}function area(i,m,p){return(m.y-i.y)*(p.x-m.x)-(m.x-i.x)*(p.y-m.y)}function equals(i,m){return i.x===m.x&&i.y===m.y}function intersects(i,m,p,_){var x=sign(area(i,m,p)),y=sign(area(i,m,_)),T=sign(area(p,_,i)),v=sign(area(p,_,m));return!!(x!==y&&T!==v||0===x&&onSegment(i,p,m)||0===y&&onSegment(i,_,m)||0===T&&onSegment(p,i,_)||0===v&&onSegment(p,m,_))}function onSegment(i,m,p){return m.x<=Math.max(i.x,p.x)&&m.x>=Math.min(i.x,p.x)&&m.y<=Math.max(i.y,p.y)&&m.y>=Math.min(i.y,p.y)}function sign(i){return i>0?1:i<0?-1:0}function intersectsPolygon(i,m){var p=i;do{if(p.i!==i.i&&p.next.i!==i.i&&p.i!==m.i&&p.next.i!==m.i&&intersects(p,p.next,i,m))return!0;p=p.next}while(p!==i);return!1}function locallyInside(i,m){return 0>area(i.prev,i,i.next)?area(i,m,i.next)>=0&&area(i,i.prev,m)>=0:0>area(i,m,i.prev)||0>area(i,i.next,m)}function middleInside(i,m){var p=i,_=!1,x=(i.x+m.x)/2,y=(i.y+m.y)/2;do p.y>y!=p.next.y>y&&p.next.y!==p.y&&x<(p.next.x-p.x)*(y-p.y)/(p.next.y-p.y)+p.x&&(_=!_),p=p.next;while(p!==i);return _}function splitPolygon(i,m){var p=new Node(i.i,i.x,i.y),_=new Node(m.i,m.x,m.y),x=i.next,y=m.prev;return i.next=m,m.prev=i,p.next=x,x.prev=p,_.next=p,p.prev=_,y.next=_,_.prev=y,_}function insertNode(i,m,p,_){var x=new Node(i,m,p);return _?(x.next=_.next,x.prev=_,_.next.prev=x,_.next=x):(x.prev=x,x.next=x),x}function removeNode(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Node(i,m,p){this.i=i,this.x=m,this.y=p,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(i,m,p,_){for(var x=0,y=m,T=p-_;y<p;y+=_)x+=(i[T]-i[y])*(i[y+1]+i[T+1]),T=y;return x}i.exports=earcut,i.exports.default=earcut,earcut.deviation=function(i,m,p,_){var x=m&&m.length,y=x?m[0]*p:i.length,T=Math.abs(signedArea(i,0,y,p));if(x)for(var v=0,E=m.length;v<E;v++){var A=m[v]*p,S=v<E-1?m[v+1]*p:i.length;T-=Math.abs(signedArea(i,A,S,p))}var I=0;for(v=0;v<_.length;v+=3){var R=_[v]*p,C=_[v+1]*p,P=_[v+2]*p;I+=Math.abs((i[R]-i[P])*(i[C+1]-i[R+1])-(i[R]-i[C])*(i[P+1]-i[R+1]))}return 0===T&&0===I?0:Math.abs((I-T)/T)},earcut.flatten=function(i){for(var m=i[0][0].length,p={vertices:[],holes:[],dimensions:m},_=0,x=0;x<i.length;x++){for(var y=0;y<i[x].length;y++)for(var T=0;T<m;T++)p.vertices.push(i[x][y][T]);x>0&&(_+=i[x-1].length,p.holes.push(_))}return p}},8729:function(i){"use strict";var m=Object.prototype.hasOwnProperty,p="~";function Events(){}function EE(i,m,p){this.fn=i,this.context=m,this.once=p||!1}function addListener(i,m,_,x,y){if("function"!=typeof _)throw TypeError("The listener must be a function");var T=new EE(_,x||i,y),v=p?p+m:m;return i._events[v]?i._events[v].fn?i._events[v]=[i._events[v],T]:i._events[v].push(T):(i._events[v]=T,i._eventsCount++),i}function clearEvent(i,m){0==--i._eventsCount?i._events=new Events:delete i._events[m]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),new Events().__proto__||(p=!1)),EventEmitter.prototype.eventNames=function(){var i,_,x=[];if(0===this._eventsCount)return x;for(_ in i=this._events)m.call(i,_)&&x.push(p?_.slice(1):_);return Object.getOwnPropertySymbols?x.concat(Object.getOwnPropertySymbols(i)):x},EventEmitter.prototype.listeners=function(i){var m=p?p+i:i,_=this._events[m];if(!_)return[];if(_.fn)return[_.fn];for(var x=0,y=_.length,T=Array(y);x<y;x++)T[x]=_[x].fn;return T},EventEmitter.prototype.listenerCount=function(i){var m=p?p+i:i,_=this._events[m];return _?_.fn?1:_.length:0},EventEmitter.prototype.emit=function(i,m,_,x,y,T){var v=p?p+i:i;if(!this._events[v])return!1;var E,A,S=this._events[v],I=arguments.length;if(S.fn){switch(S.once&&this.removeListener(i,S.fn,void 0,!0),I){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,m),!0;case 3:return S.fn.call(S.context,m,_),!0;case 4:return S.fn.call(S.context,m,_,x),!0;case 5:return S.fn.call(S.context,m,_,x,y),!0;case 6:return S.fn.call(S.context,m,_,x,y,T),!0}for(A=1,E=Array(I-1);A<I;A++)E[A-1]=arguments[A];S.fn.apply(S.context,E)}else{var R,C=S.length;for(A=0;A<C;A++)switch(S[A].once&&this.removeListener(i,S[A].fn,void 0,!0),I){case 1:S[A].fn.call(S[A].context);break;case 2:S[A].fn.call(S[A].context,m);break;case 3:S[A].fn.call(S[A].context,m,_);break;case 4:S[A].fn.call(S[A].context,m,_,x);break;default:if(!E)for(R=1,E=Array(I-1);R<I;R++)E[R-1]=arguments[R];S[A].fn.apply(S[A].context,E)}}return!0},EventEmitter.prototype.on=function(i,m,p){return addListener(this,i,m,p,!1)},EventEmitter.prototype.once=function(i,m,p){return addListener(this,i,m,p,!0)},EventEmitter.prototype.removeListener=function(i,m,_,x){var y=p?p+i:i;if(!this._events[y])return this;if(!m)return clearEvent(this,y),this;var T=this._events[y];if(T.fn)T.fn!==m||x&&!T.once||_&&T.context!==_||clearEvent(this,y);else{for(var v=0,E=[],A=T.length;v<A;v++)(T[v].fn!==m||x&&!T[v].once||_&&T[v].context!==_)&&E.push(T[v]);E.length?this._events[y]=1===E.length?E[0]:E:clearEvent(this,y)}return this},EventEmitter.prototype.removeAllListeners=function(i){var m;return i?(m=p?p+i:i,this._events[m]&&clearEvent(this,m)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=p,EventEmitter.EventEmitter=EventEmitter,i.exports=EventEmitter},3171:function(i,m,p){var _,x,y,T,v,E,A,S,I,R,C,P,k,B,D;(x=function(){this.init()}).prototype={init:function(){var i=this||y;return i._counter=1e3,i._html5AudioPool=[],i.html5PoolSize=10,i._codecs={},i._howls=[],i._muted=!1,i._volume=1,i._canPlayEvent="canplaythrough",i._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,i.masterGain=null,i.noAudio=!1,i.usingWebAudio=!0,i.autoSuspend=!0,i.ctx=null,i.autoUnlock=!0,i._setup(),i},volume:function(i){var m=this||y;if(i=parseFloat(i),m.ctx||C(),void 0!==i&&i>=0&&i<=1){if(m._volume=i,m._muted)return m;m.usingWebAudio&&m.masterGain.gain.setValueAtTime(i,y.ctx.currentTime);for(var p=0;p<m._howls.length;p++)if(!m._howls[p]._webAudio)for(var _=m._howls[p]._getSoundIds(),x=0;x<_.length;x++){var T=m._howls[p]._soundById(_[x]);T&&T._node&&(T._node.volume=T._volume*i)}return m}return m._volume},mute:function(i){var m=this||y;m.ctx||C(),m._muted=i,m.usingWebAudio&&m.masterGain.gain.setValueAtTime(i?0:m._volume,y.ctx.currentTime);for(var p=0;p<m._howls.length;p++)if(!m._howls[p]._webAudio)for(var _=m._howls[p]._getSoundIds(),x=0;x<_.length;x++){var T=m._howls[p]._soundById(_[x]);T&&T._node&&(T._node.muted=!!i||T._muted)}return m},stop:function(){for(var i=this||y,m=0;m<i._howls.length;m++)i._howls[m].stop();return i},unload:function(){for(var i=this||y,m=i._howls.length-1;m>=0;m--)i._howls[m].unload();return i.usingWebAudio&&i.ctx&&void 0!==i.ctx.close&&(i.ctx.close(),i.ctx=null,C()),i},codecs:function(i){return(this||y)._codecs[i.replace(/^x-/,"")]},_setup:function(){var i=this||y;if(i.state=i.ctx&&i.ctx.state||"suspended",i._autoSuspend(),!i.usingWebAudio){if("undefined"!=typeof Audio)try{var m=new Audio;void 0===m.oncanplaythrough&&(i._canPlayEvent="canplay")}catch(m){i.noAudio=!0}else i.noAudio=!0}try{var m=new Audio;m.muted&&(i.noAudio=!0)}catch(i){}return i.noAudio||i._setupCodecs(),i},_setupCodecs:function(){var i=this||y,m=null;try{m="undefined"!=typeof Audio?new Audio:null}catch(m){return i}if(!m||"function"!=typeof m.canPlayType)return i;var p=m.canPlayType("audio/mpeg;").replace(/^no$/,""),_=i._navigator?i._navigator.userAgent:"",x=_.match(/OPR\/(\d+)/g),T=x&&33>parseInt(x[0].split("/")[1],10),v=-1!==_.indexOf("Safari")&&-1===_.indexOf("Chrome"),E=_.match(/Version\/(.*?) /),A=v&&E&&15>parseInt(E[1],10);return i._codecs={mp3:!!(!T&&(p||m.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!p,opus:!!m.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!m.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!m.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(m.canPlayType('audio/wav; codecs="1"')||m.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!m.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!m.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(m.canPlayType("audio/x-m4a;")||m.canPlayType("audio/m4a;")||m.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(m.canPlayType("audio/x-m4b;")||m.canPlayType("audio/m4b;")||m.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(m.canPlayType("audio/x-mp4;")||m.canPlayType("audio/mp4;")||m.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!A&&m.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!A&&m.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!m.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(m.canPlayType("audio/x-flac;")||m.canPlayType("audio/flac;")).replace(/^no$/,"")},i},_unlockAudio:function(){var i=this||y;if(!i._audioUnlocked&&i.ctx){i._audioUnlocked=!1,i.autoUnlock=!1,i._mobileUnloaded||44100===i.ctx.sampleRate||(i._mobileUnloaded=!0,i.unload()),i._scratchBuffer=i.ctx.createBuffer(1,1,22050);var unlock=function(m){for(;i._html5AudioPool.length<i.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,i._releaseHtml5Audio(p)}catch(m){i.noAudio=!0;break}for(var _=0;_<i._howls.length;_++)if(!i._howls[_]._webAudio)for(var x=i._howls[_]._getSoundIds(),y=0;y<x.length;y++){var T=i._howls[_]._soundById(x[y]);T&&T._node&&!T._node._unlocked&&(T._node._unlocked=!0,T._node.load())}i._autoResume();var v=i.ctx.createBufferSource();v.buffer=i._scratchBuffer,v.connect(i.ctx.destination),void 0===v.start?v.noteOn(0):v.start(0),"function"==typeof i.ctx.resume&&i.ctx.resume(),v.onended=function(){v.disconnect(0),i._audioUnlocked=!0,document.removeEventListener("touchstart",unlock,!0),document.removeEventListener("touchend",unlock,!0),document.removeEventListener("click",unlock,!0),document.removeEventListener("keydown",unlock,!0);for(var m=0;m<i._howls.length;m++)i._howls[m]._emit("unlock")}};return document.addEventListener("touchstart",unlock,!0),document.addEventListener("touchend",unlock,!0),document.addEventListener("click",unlock,!0),document.addEventListener("keydown",unlock,!0),i}},_obtainHtml5Audio:function(){var i=this||y;if(i._html5AudioPool.length)return i._html5AudioPool.pop();var m=new Audio().play();return m&&"undefined"!=typeof Promise&&(m instanceof Promise||"function"==typeof m.then)&&m.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(i){var m=this||y;return i._unlocked&&m._html5AudioPool.push(i),m},_autoSuspend:function(){var i=this;if(i.autoSuspend&&i.ctx&&void 0!==i.ctx.suspend&&y.usingWebAudio){for(var m=0;m<i._howls.length;m++)if(i._howls[m]._webAudio){for(var p=0;p<i._howls[m]._sounds.length;p++)if(!i._howls[m]._sounds[p]._paused)return i}return i._suspendTimer&&clearTimeout(i._suspendTimer),i._suspendTimer=setTimeout(function(){if(i.autoSuspend){i._suspendTimer=null,i.state="suspending";var handleSuspension=function(){i.state="suspended",i._resumeAfterSuspend&&(delete i._resumeAfterSuspend,i._autoResume())};i.ctx.suspend().then(handleSuspension,handleSuspension)}},3e4),i}},_autoResume:function(){var i=this;if(i.ctx&&void 0!==i.ctx.resume&&y.usingWebAudio)return"running"===i.state&&"interrupted"!==i.ctx.state&&i._suspendTimer?(clearTimeout(i._suspendTimer),i._suspendTimer=null):"suspended"===i.state||"running"===i.state&&"interrupted"===i.ctx.state?(i.ctx.resume().then(function(){i.state="running";for(var m=0;m<i._howls.length;m++)i._howls[m]._emit("resume")}),i._suspendTimer&&(clearTimeout(i._suspendTimer),i._suspendTimer=null)):"suspending"===i.state&&(i._resumeAfterSuspend=!0),i}},y=new x,(T=function(i){if(!i.src||0===i.src.length){console.error("An array of source files must be passed with any new Howl.");return}this.init(i)}).prototype={init:function(i){var m=this;return y.ctx||C(),m._autoplay=i.autoplay||!1,m._format="string"!=typeof i.format?i.format:[i.format],m._html5=i.html5||!1,m._muted=i.mute||!1,m._loop=i.loop||!1,m._pool=i.pool||5,m._preload="boolean"!=typeof i.preload&&"metadata"!==i.preload||i.preload,m._rate=i.rate||1,m._sprite=i.sprite||{},m._src="string"!=typeof i.src?i.src:[i.src],m._volume=void 0!==i.volume?i.volume:1,m._xhr={method:i.xhr&&i.xhr.method?i.xhr.method:"GET",headers:i.xhr&&i.xhr.headers?i.xhr.headers:null,withCredentials:!!i.xhr&&!!i.xhr.withCredentials&&i.xhr.withCredentials},m._duration=0,m._state="unloaded",m._sounds=[],m._endTimers={},m._queue=[],m._playLock=!1,m._onend=i.onend?[{fn:i.onend}]:[],m._onfade=i.onfade?[{fn:i.onfade}]:[],m._onload=i.onload?[{fn:i.onload}]:[],m._onloaderror=i.onloaderror?[{fn:i.onloaderror}]:[],m._onplayerror=i.onplayerror?[{fn:i.onplayerror}]:[],m._onpause=i.onpause?[{fn:i.onpause}]:[],m._onplay=i.onplay?[{fn:i.onplay}]:[],m._onstop=i.onstop?[{fn:i.onstop}]:[],m._onmute=i.onmute?[{fn:i.onmute}]:[],m._onvolume=i.onvolume?[{fn:i.onvolume}]:[],m._onrate=i.onrate?[{fn:i.onrate}]:[],m._onseek=i.onseek?[{fn:i.onseek}]:[],m._onunlock=i.onunlock?[{fn:i.onunlock}]:[],m._onresume=[],m._webAudio=y.usingWebAudio&&!m._html5,void 0!==y.ctx&&y.ctx&&y.autoUnlock&&y._unlockAudio(),y._howls.push(m),m._autoplay&&m._queue.push({event:"play",action:function(){m.play()}}),m._preload&&"none"!==m._preload&&m.load(),m},load:function(){var i,m,p=null;if(y.noAudio){this._emit("loaderror",null,"No audio support.");return}"string"==typeof this._src&&(this._src=[this._src]);for(var _=0;_<this._src.length;_++){if(this._format&&this._format[_])i=this._format[_];else{if("string"!=typeof(m=this._src[_])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(i=/^data:audio\/([^;,]+);/i.exec(m))||(i=/\.([^.]+)$/.exec(m.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&y.codecs(i)){p=this._src[_];break}}if(!p){this._emit("loaderror",null,"No codec support for selected audio sources.");return}return this._src=p,this._state="loading","https:"===window.location.protocol&&"http:"===p.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new v(this),this._webAudio&&A(this),this},play:function(i,m){var p=this,_=null;if("number"==typeof i)_=i,i=null;else if("string"==typeof i&&"loaded"===p._state&&!p._sprite[i])return null;else if(void 0===i&&(i="__default",!p._playLock)){for(var x=0,T=0;T<p._sounds.length;T++)p._sounds[T]._paused&&!p._sounds[T]._ended&&(x++,_=p._sounds[T]._id);1===x?i=null:_=null}var v=_?p._soundById(_):p._inactiveSound();if(!v)return null;if(_&&!i&&(i=v._sprite||"__default"),"loaded"!==p._state){v._sprite=i,v._ended=!1;var E=v._id;return p._queue.push({event:"play",action:function(){p.play(E)}}),E}if(_&&!v._paused)return m||p._loadQueue("play"),v._id;p._webAudio&&y._autoResume();var A=Math.max(0,v._seek>0?v._seek:p._sprite[i][0]/1e3),S=Math.max(0,(p._sprite[i][0]+p._sprite[i][1])/1e3-A),I=1e3*S/Math.abs(v._rate),R=p._sprite[i][0]/1e3,C=(p._sprite[i][0]+p._sprite[i][1])/1e3;v._sprite=i,v._ended=!1;var setParams=function(){v._paused=!1,v._seek=A,v._start=R,v._stop=C,v._loop=!!(v._loop||p._sprite[i][2])};if(A>=C){p._ended(v);return}var P=v._node;if(p._webAudio){var playWebAudio=function(){p._playLock=!1,setParams(),p._refreshBuffer(v);var i=v._muted||p._muted?0:v._volume;P.gain.setValueAtTime(i,y.ctx.currentTime),v._playStart=y.ctx.currentTime,void 0===P.bufferSource.start?v._loop?P.bufferSource.noteGrainOn(0,A,86400):P.bufferSource.noteGrainOn(0,A,S):v._loop?P.bufferSource.start(0,A,86400):P.bufferSource.start(0,A,S),I!==1/0&&(p._endTimers[v._id]=setTimeout(p._ended.bind(p,v),I)),m||setTimeout(function(){p._emit("play",v._id),p._loadQueue()},0)};"running"===y.state&&"interrupted"!==y.ctx.state?playWebAudio():(p._playLock=!0,p.once("resume",playWebAudio),p._clearTimer(v._id))}else{var playHtml5=function(){P.currentTime=A,P.muted=v._muted||p._muted||y._muted||P.muted,P.volume=v._volume*y.volume(),P.playbackRate=v._rate;try{var _=P.play();if(_&&"undefined"!=typeof Promise&&(_ instanceof Promise||"function"==typeof _.then)?(p._playLock=!0,setParams(),_.then(function(){p._playLock=!1,P._unlocked=!0,m?p._loadQueue():p._emit("play",v._id)}).catch(function(){p._playLock=!1,p._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),v._ended=!0,v._paused=!0})):m||(p._playLock=!1,setParams(),p._emit("play",v._id)),P.playbackRate=v._rate,P.paused){p._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}"__default"!==i||v._loop?p._endTimers[v._id]=setTimeout(p._ended.bind(p,v),I):(p._endTimers[v._id]=function(){p._ended(v),P.removeEventListener("ended",p._endTimers[v._id],!1)},P.addEventListener("ended",p._endTimers[v._id],!1))}catch(i){p._emit("playerror",v._id,i)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===P.src&&(P.src=p._src,P.load());var k=window&&window.ejecta||!P.readyState&&y._navigator.isCocoonJS;if(P.readyState>=3||k)playHtml5();else{p._playLock=!0,p._state="loading";var listener=function(){p._state="loaded",playHtml5(),P.removeEventListener(y._canPlayEvent,listener,!1)};P.addEventListener(y._canPlayEvent,listener,!1),p._clearTimer(v._id)}}return v._id},pause:function(i){var m=this;if("loaded"!==m._state||m._playLock)return m._queue.push({event:"pause",action:function(){m.pause(i)}}),m;for(var p=m._getSoundIds(i),_=0;_<p.length;_++){m._clearTimer(p[_]);var x=m._soundById(p[_]);if(x&&!x._paused&&(x._seek=m.seek(p[_]),x._rateSeek=0,x._paused=!0,m._stopFade(p[_]),x._node)){if(m._webAudio){if(!x._node.bufferSource)continue;void 0===x._node.bufferSource.stop?x._node.bufferSource.noteOff(0):x._node.bufferSource.stop(0),m._cleanBuffer(x._node)}else isNaN(x._node.duration)&&x._node.duration!==1/0||x._node.pause()}arguments[1]||m._emit("pause",x?x._id:null)}return m},stop:function(i,m){var p=this;if("loaded"!==p._state||p._playLock)return p._queue.push({event:"stop",action:function(){p.stop(i)}}),p;for(var _=p._getSoundIds(i),x=0;x<_.length;x++){p._clearTimer(_[x]);var y=p._soundById(_[x]);y&&(y._seek=y._start||0,y._rateSeek=0,y._paused=!0,y._ended=!0,p._stopFade(_[x]),y._node&&(p._webAudio?y._node.bufferSource&&(void 0===y._node.bufferSource.stop?y._node.bufferSource.noteOff(0):y._node.bufferSource.stop(0),p._cleanBuffer(y._node)):isNaN(y._node.duration)&&y._node.duration!==1/0||(y._node.currentTime=y._start||0,y._node.pause(),y._node.duration===1/0&&p._clearSound(y._node))),m||p._emit("stop",y._id))}return p},mute:function(i,m){var p=this;if("loaded"!==p._state||p._playLock)return p._queue.push({event:"mute",action:function(){p.mute(i,m)}}),p;if(void 0===m){if("boolean"!=typeof i)return p._muted;p._muted=i}for(var _=p._getSoundIds(m),x=0;x<_.length;x++){var T=p._soundById(_[x]);T&&(T._muted=i,T._interval&&p._stopFade(T._id),p._webAudio&&T._node?T._node.gain.setValueAtTime(i?0:T._volume,y.ctx.currentTime):T._node&&(T._node.muted=!!y._muted||i),p._emit("mute",T._id))}return p},volume:function(){var i,m,p,_=this,x=arguments;if(0===x.length)return _._volume;if(1===x.length||2===x.length&&void 0===x[1]?_._getSoundIds().indexOf(x[0])>=0?m=parseInt(x[0],10):i=parseFloat(x[0]):x.length>=2&&(i=parseFloat(x[0]),m=parseInt(x[1],10)),void 0===i||!(i>=0)||!(i<=1))return(p=m?_._soundById(m):_._sounds[0])?p._volume:0;if("loaded"!==_._state||_._playLock)return _._queue.push({event:"volume",action:function(){_.volume.apply(_,x)}}),_;void 0===m&&(_._volume=i),m=_._getSoundIds(m);for(var T=0;T<m.length;T++)(p=_._soundById(m[T]))&&(p._volume=i,x[2]||_._stopFade(m[T]),_._webAudio&&p._node&&!p._muted?p._node.gain.setValueAtTime(i,y.ctx.currentTime):p._node&&!p._muted&&(p._node.volume=i*y.volume()),_._emit("volume",p._id));return _},fade:function(i,m,p,_){var x=this;if("loaded"!==x._state||x._playLock)return x._queue.push({event:"fade",action:function(){x.fade(i,m,p,_)}}),x;i=Math.min(Math.max(0,parseFloat(i)),1),m=Math.min(Math.max(0,parseFloat(m)),1),p=parseFloat(p),x.volume(i,_);for(var T=x._getSoundIds(_),v=0;v<T.length;v++){var E=x._soundById(T[v]);if(E){if(_||x._stopFade(T[v]),x._webAudio&&!E._muted){var A=y.ctx.currentTime,S=A+p/1e3;E._volume=i,E._node.gain.setValueAtTime(i,A),E._node.gain.linearRampToValueAtTime(m,S)}x._startFadeInterval(E,i,m,p,T[v],void 0===_)}}return x},_startFadeInterval:function(i,m,p,_,x,y){var T=this,v=m,E=p-m,A=Math.abs(E/.01),S=Date.now();i._fadeTo=p,i._interval=setInterval(function(){var x=(Date.now()-S)/_;S=Date.now(),v+=E*x,v=Math.round(100*v)/100,v=E<0?Math.max(p,v):Math.min(p,v),T._webAudio?i._volume=v:T.volume(v,i._id,!0),y&&(T._volume=v),(p<m&&v<=p||p>m&&v>=p)&&(clearInterval(i._interval),i._interval=null,i._fadeTo=null,T.volume(p,i._id),T._emit("fade",i._id))},Math.max(4,A>0?_/A:_))},_stopFade:function(i){var m=this._soundById(i);return m&&m._interval&&(this._webAudio&&m._node.gain.cancelScheduledValues(y.ctx.currentTime),clearInterval(m._interval),m._interval=null,this.volume(m._fadeTo,i),m._fadeTo=null,this._emit("fade",i)),this},loop:function(){var i,m,p,_=arguments;if(0===_.length)return this._loop;if(1===_.length){if("boolean"!=typeof _[0])return!!(p=this._soundById(parseInt(_[0],10)))&&p._loop;i=_[0],this._loop=i}else 2===_.length&&(i=_[0],m=parseInt(_[1],10));for(var x=this._getSoundIds(m),y=0;y<x.length;y++)(p=this._soundById(x[y]))&&(p._loop=i,this._webAudio&&p._node&&p._node.bufferSource&&(p._node.bufferSource.loop=i,i&&(p._node.bufferSource.loopStart=p._start||0,p._node.bufferSource.loopEnd=p._stop,this.playing(x[y])&&(this.pause(x[y],!0),this.play(x[y],!0)))));return this},rate:function(){var i,m,p,_=this,x=arguments;if(0===x.length?m=_._sounds[0]._id:1===x.length?_._getSoundIds().indexOf(x[0])>=0?m=parseInt(x[0],10):i=parseFloat(x[0]):2===x.length&&(i=parseFloat(x[0]),m=parseInt(x[1],10)),"number"!=typeof i)return(p=_._soundById(m))?p._rate:_._rate;if("loaded"!==_._state||_._playLock)return _._queue.push({event:"rate",action:function(){_.rate.apply(_,x)}}),_;void 0===m&&(_._rate=i),m=_._getSoundIds(m);for(var T=0;T<m.length;T++)if(p=_._soundById(m[T])){_.playing(m[T])&&(p._rateSeek=_.seek(m[T]),p._playStart=_._webAudio?y.ctx.currentTime:p._playStart),p._rate=i,_._webAudio&&p._node&&p._node.bufferSource?p._node.bufferSource.playbackRate.setValueAtTime(i,y.ctx.currentTime):p._node&&(p._node.playbackRate=i);var v=_.seek(m[T]),E=1e3*((_._sprite[p._sprite][0]+_._sprite[p._sprite][1])/1e3-v)/Math.abs(p._rate);(_._endTimers[m[T]]||!p._paused)&&(_._clearTimer(m[T]),_._endTimers[m[T]]=setTimeout(_._ended.bind(_,p),E)),_._emit("rate",p._id)}return _},seek:function(){var i,m,p=this,_=arguments;if(0===_.length?p._sounds.length&&(m=p._sounds[0]._id):1===_.length?p._getSoundIds().indexOf(_[0])>=0?m=parseInt(_[0],10):p._sounds.length&&(m=p._sounds[0]._id,i=parseFloat(_[0])):2===_.length&&(i=parseFloat(_[0]),m=parseInt(_[1],10)),void 0===m)return 0;if("number"==typeof i&&("loaded"!==p._state||p._playLock))return p._queue.push({event:"seek",action:function(){p.seek.apply(p,_)}}),p;var x=p._soundById(m);if(x){if("number"==typeof i&&i>=0){var T=p.playing(m);T&&p.pause(m,!0),x._seek=i,x._ended=!1,p._clearTimer(m),p._webAudio||!x._node||isNaN(x._node.duration)||(x._node.currentTime=i);var seekAndEmit=function(){T&&p.play(m,!0),p._emit("seek",m)};if(T&&!p._webAudio){var emitSeek=function(){p._playLock?setTimeout(emitSeek,0):seekAndEmit()};setTimeout(emitSeek,0)}else seekAndEmit()}else{if(!p._webAudio)return x._node.currentTime;var v=p.playing(m)?y.ctx.currentTime-x._playStart:0,E=x._rateSeek?x._rateSeek-x._seek:0;return x._seek+(E+v*Math.abs(x._rate))}}return p},playing:function(i){if("number"==typeof i){var m=this._soundById(i);return!!m&&!m._paused}for(var p=0;p<this._sounds.length;p++)if(!this._sounds[p]._paused)return!0;return!1},duration:function(i){var m=this._duration,p=this._soundById(i);return p&&(m=this._sprite[p._sprite][1]/1e3),m},state:function(){return this._state},unload:function(){for(var i=this,m=i._sounds,p=0;p<m.length;p++)m[p]._paused||i.stop(m[p]._id),i._webAudio||(i._clearSound(m[p]._node),m[p]._node.removeEventListener("error",m[p]._errorFn,!1),m[p]._node.removeEventListener(y._canPlayEvent,m[p]._loadFn,!1),m[p]._node.removeEventListener("ended",m[p]._endFn,!1),y._releaseHtml5Audio(m[p]._node)),delete m[p]._node,i._clearTimer(m[p]._id);var _=y._howls.indexOf(i);_>=0&&y._howls.splice(_,1);var x=!0;for(p=0;p<y._howls.length;p++)if(y._howls[p]._src===i._src||i._src.indexOf(y._howls[p]._src)>=0){x=!1;break}return E&&x&&delete E[i._src],y.noAudio=!1,i._state="unloaded",i._sounds=[],i=null,null},on:function(i,m,p,_){var x=this["_on"+i];return"function"==typeof m&&x.push(_?{id:p,fn:m,once:_}:{id:p,fn:m}),this},off:function(i,m,p){var _=this["_on"+i],x=0;if("number"==typeof m&&(p=m,m=null),m||p)for(x=0;x<_.length;x++){var y=p===_[x].id;if(m===_[x].fn&&y||!m&&y){_.splice(x,1);break}}else if(i)this["_on"+i]=[];else{var T=Object.keys(this);for(x=0;x<T.length;x++)0===T[x].indexOf("_on")&&Array.isArray(this[T[x]])&&(this[T[x]]=[])}return this},once:function(i,m,p){return this.on(i,m,p,1),this},_emit:function(i,m,p){for(var _=this["_on"+i],x=_.length-1;x>=0;x--)(!_[x].id||_[x].id===m||"load"===i)&&(setTimeout((function(i){i.call(this,m,p)}).bind(this,_[x].fn),0),_[x].once&&this.off(i,_[x].fn,_[x].id));return this._loadQueue(i),this},_loadQueue:function(i){if(this._queue.length>0){var m=this._queue[0];m.event===i&&(this._queue.shift(),this._loadQueue()),i||m.action()}return this},_ended:function(i){var m=i._sprite;if(!this._webAudio&&i._node&&!i._node.paused&&!i._node.ended&&i._node.currentTime<i._stop)return setTimeout(this._ended.bind(this,i),100),this;var p=!!(i._loop||this._sprite[m][2]);if(this._emit("end",i._id),!this._webAudio&&p&&this.stop(i._id,!0).play(i._id),this._webAudio&&p){this._emit("play",i._id),i._seek=i._start||0,i._rateSeek=0,i._playStart=y.ctx.currentTime;var _=(i._stop-i._start)*1e3/Math.abs(i._rate);this._endTimers[i._id]=setTimeout(this._ended.bind(this,i),_)}return this._webAudio&&!p&&(i._paused=!0,i._ended=!0,i._seek=i._start||0,i._rateSeek=0,this._clearTimer(i._id),this._cleanBuffer(i._node),y._autoSuspend()),this._webAudio||p||this.stop(i._id,!0),this},_clearTimer:function(i){if(this._endTimers[i]){if("function"!=typeof this._endTimers[i])clearTimeout(this._endTimers[i]);else{var m=this._soundById(i);m&&m._node&&m._node.removeEventListener("ended",this._endTimers[i],!1)}delete this._endTimers[i]}return this},_soundById:function(i){for(var m=0;m<this._sounds.length;m++)if(i===this._sounds[m]._id)return this._sounds[m];return null},_inactiveSound:function(){this._drain();for(var i=0;i<this._sounds.length;i++)if(this._sounds[i]._ended)return this._sounds[i].reset();return new v(this)},_drain:function(){var i=this._pool,m=0,p=0;if(!(this._sounds.length<i)){for(p=0;p<this._sounds.length;p++)this._sounds[p]._ended&&m++;for(p=this._sounds.length-1;p>=0;p--){if(m<=i)return;this._sounds[p]._ended&&(this._webAudio&&this._sounds[p]._node&&this._sounds[p]._node.disconnect(0),this._sounds.splice(p,1),m--)}}},_getSoundIds:function(i){if(void 0!==i)return[i];for(var m=[],p=0;p<this._sounds.length;p++)m.push(this._sounds[p]._id);return m},_refreshBuffer:function(i){return i._node.bufferSource=y.ctx.createBufferSource(),i._node.bufferSource.buffer=E[this._src],i._panner?i._node.bufferSource.connect(i._panner):i._node.bufferSource.connect(i._node),i._node.bufferSource.loop=i._loop,i._loop&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop||0),i._node.bufferSource.playbackRate.setValueAtTime(i._rate,y.ctx.currentTime),this},_cleanBuffer:function(i){var m=y._navigator&&y._navigator.vendor.indexOf("Apple")>=0;if(!i.bufferSource)return this;if(y._scratchBuffer&&i.bufferSource&&(i.bufferSource.onended=null,i.bufferSource.disconnect(0),m))try{i.bufferSource.buffer=y._scratchBuffer}catch(i){}return i.bufferSource=null,this},_clearSound:function(i){/MSIE |Trident\//.test(y._navigator&&y._navigator.userAgent)||(i.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}},(v=function(i){this._parent=i,this.init()}).prototype={init:function(){var i=this._parent;return this._muted=i._muted,this._loop=i._loop,this._volume=i._volume,this._rate=i._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++y._counter,i._sounds.push(this),this.create(),this},create:function(){var i=this._parent,m=y._muted||this._muted||this._parent._muted?0:this._volume;return i._webAudio?(this._node=void 0===y.ctx.createGain?y.ctx.createGainNode():y.ctx.createGain(),this._node.gain.setValueAtTime(m,y.ctx.currentTime),this._node.paused=!0,this._node.connect(y.masterGain)):y.noAudio||(this._node=y._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(y._canPlayEvent,this._loadFn,!1),this._endFn=this._endListener.bind(this),this._node.addEventListener("ended",this._endFn,!1),this._node.src=i._src,this._node.preload=!0===i._preload?"auto":i._preload,this._node.volume=m*y.volume(),this._node.load()),this},reset:function(){var i=this._parent;return this._muted=i._muted,this._loop=i._loop,this._volume=i._volume,this._rate=i._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++y._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var i=this._parent;i._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(i._sprite).length&&(i._sprite={__default:[0,1e3*i._duration]}),"loaded"!==i._state&&(i._state="loaded",i._emit("load"),i._loadQueue()),this._node.removeEventListener(y._canPlayEvent,this._loadFn,!1)},_endListener:function(){var i=this._parent;i._duration===1/0&&(i._duration=Math.ceil(10*this._node.duration)/10,i._sprite.__default[1]===1/0&&(i._sprite.__default[1]=1e3*i._duration),i._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}},E={},A=function(i){var m=i._src;if(E[m]){i._duration=E[m].duration,R(i);return}if(/^data:[^;]+;base64,/.test(m)){for(var p=atob(m.split(",")[1]),_=new Uint8Array(p.length),x=0;x<p.length;++x)_[x]=p.charCodeAt(x);I(_.buffer,i)}else{var y=new XMLHttpRequest;y.open(i._xhr.method,m,!0),y.withCredentials=i._xhr.withCredentials,y.responseType="arraybuffer",i._xhr.headers&&Object.keys(i._xhr.headers).forEach(function(m){y.setRequestHeader(m,i._xhr.headers[m])}),y.onload=function(){var m=(y.status+"")[0];if("0"!==m&&"2"!==m&&"3"!==m){i._emit("loaderror",null,"Failed loading audio file with status: "+y.status+".");return}I(y.response,i)},y.onerror=function(){i._webAudio&&(i._html5=!0,i._webAudio=!1,i._sounds=[],delete E[m],i.load())},S(y)}},S=function(i){try{i.send()}catch(m){i.onerror()}},I=function(i,m){var error=function(){m._emit("loaderror",null,"Decoding audio data failed.")},success=function(i){i&&m._sounds.length>0?(E[m._src]=i,R(m,i)):error()};"undefined"!=typeof Promise&&1===y.ctx.decodeAudioData.length?y.ctx.decodeAudioData(i).then(success).catch(error):y.ctx.decodeAudioData(i,success,error)},R=function(i,m){m&&!i._duration&&(i._duration=m.duration),0===Object.keys(i._sprite).length&&(i._sprite={__default:[0,1e3*i._duration]}),"loaded"!==i._state&&(i._state="loaded",i._emit("load"),i._loadQueue())},C=function(){if(y.usingWebAudio){try{"undefined"!=typeof AudioContext?y.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?y.ctx=new webkitAudioContext:y.usingWebAudio=!1}catch(i){y.usingWebAudio=!1}y.ctx||(y.usingWebAudio=!1);var i=/iP(hone|od|ad)/.test(y._navigator&&y._navigator.platform),m=y._navigator&&y._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),p=m?parseInt(m[1],10):null;if(i&&p&&p<9){var _=/safari/.test(y._navigator&&y._navigator.userAgent.toLowerCase());y._navigator&&!_&&(y.usingWebAudio=!1)}y.usingWebAudio&&(y.masterGain=void 0===y.ctx.createGain?y.ctx.createGainNode():y.ctx.createGain(),y.masterGain.gain.setValueAtTime(y._muted?0:y._volume,y.ctx.currentTime),y.masterGain.connect(y.ctx.destination)),y._setup()}},void 0!==(_=(function(){return{Howler:y,Howl:T}}).apply(m,[]))&&(i.exports=_),m.Howler=y,m.Howl=T,void 0!==p.g?(p.g.HowlerGlobal=x,p.g.Howler=y,p.g.Howl=T,p.g.Sound=v):"undefined"!=typeof window&&(window.HowlerGlobal=x,window.Howler=y,window.Howl=T,window.Sound=v),HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(i){if(!this.ctx||!this.ctx.listener)return this;for(var m=this._howls.length-1;m>=0;m--)this._howls[m].stereo(i);return this},HowlerGlobal.prototype.pos=function(i,m,p){return this.ctx&&this.ctx.listener?(m="number"!=typeof m?this._pos[1]:m,p="number"!=typeof p?this._pos[2]:p,"number"!=typeof i)?this._pos:(this._pos=[i,m,p],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this):this},HowlerGlobal.prototype.orientation=function(i,m,p,_,x,y){if(!this.ctx||!this.ctx.listener)return this;var T=this._orientation;return(m="number"!=typeof m?T[1]:m,p="number"!=typeof p?T[2]:p,_="number"!=typeof _?T[3]:_,x="number"!=typeof x?T[4]:x,y="number"!=typeof y?T[5]:y,"number"!=typeof i)?T:(this._orientation=[i,m,p,_,x,y],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(i,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(m,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(p,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(_,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(x,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(y,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(i,m,p,_,x,y),this)},Howl.prototype.init=(P=Howl.prototype.init,function(i){return this._orientation=i.orientation||[1,0,0],this._stereo=i.stereo||null,this._pos=i.pos||null,this._pannerAttr={coneInnerAngle:void 0!==i.coneInnerAngle?i.coneInnerAngle:360,coneOuterAngle:void 0!==i.coneOuterAngle?i.coneOuterAngle:360,coneOuterGain:void 0!==i.coneOuterGain?i.coneOuterGain:0,distanceModel:void 0!==i.distanceModel?i.distanceModel:"inverse",maxDistance:void 0!==i.maxDistance?i.maxDistance:1e4,panningModel:void 0!==i.panningModel?i.panningModel:"HRTF",refDistance:void 0!==i.refDistance?i.refDistance:1,rolloffFactor:void 0!==i.rolloffFactor?i.rolloffFactor:1},this._onstereo=i.onstereo?[{fn:i.onstereo}]:[],this._onpos=i.onpos?[{fn:i.onpos}]:[],this._onorientation=i.onorientation?[{fn:i.onorientation}]:[],P.call(this,i)}),Howl.prototype.stereo=function(i,m){var p=this;if(!p._webAudio)return p;if("loaded"!==p._state)return p._queue.push({event:"stereo",action:function(){p.stereo(i,m)}}),p;var _=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===m){if("number"!=typeof i)return p._stereo;p._stereo=i,p._pos=[i,0,0]}for(var x=p._getSoundIds(m),y=0;y<x.length;y++){var T=p._soundById(x[y]);if(T){if("number"!=typeof i)return T._stereo;T._stereo=i,T._pos=[i,0,0],T._node&&(T._pannerAttr.panningModel="equalpower",T._panner&&T._panner.pan||D(T,_),"spatial"===_?void 0!==T._panner.positionX?(T._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),T._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),T._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):T._panner.setPosition(i,0,0):T._panner.pan.setValueAtTime(i,Howler.ctx.currentTime)),p._emit("stereo",T._id)}}return p},Howl.prototype.pos=function(i,m,p,_){var x=this;if(!x._webAudio)return x;if("loaded"!==x._state)return x._queue.push({event:"pos",action:function(){x.pos(i,m,p,_)}}),x;if(m="number"!=typeof m?0:m,p="number"!=typeof p?-.5:p,void 0===_){if("number"!=typeof i)return x._pos;x._pos=[i,m,p]}for(var y=x._getSoundIds(_),T=0;T<y.length;T++){var v=x._soundById(y[T]);if(v){if("number"!=typeof i)return v._pos;v._pos=[i,m,p],v._node&&((!v._panner||v._panner.pan)&&D(v,"spatial"),void 0!==v._panner.positionX?(v._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),v._panner.positionY.setValueAtTime(m,Howler.ctx.currentTime),v._panner.positionZ.setValueAtTime(p,Howler.ctx.currentTime)):v._panner.setPosition(i,m,p)),x._emit("pos",v._id)}}return x},Howl.prototype.orientation=function(i,m,p,_){var x=this;if(!x._webAudio)return x;if("loaded"!==x._state)return x._queue.push({event:"orientation",action:function(){x.orientation(i,m,p,_)}}),x;if(m="number"!=typeof m?x._orientation[1]:m,p="number"!=typeof p?x._orientation[2]:p,void 0===_){if("number"!=typeof i)return x._orientation;x._orientation=[i,m,p]}for(var y=x._getSoundIds(_),T=0;T<y.length;T++){var v=x._soundById(y[T]);if(v){if("number"!=typeof i)return v._orientation;v._orientation=[i,m,p],v._node&&(v._panner||(v._pos||(v._pos=x._pos||[0,0,-.5]),D(v,"spatial")),void 0!==v._panner.orientationX?(v._panner.orientationX.setValueAtTime(i,Howler.ctx.currentTime),v._panner.orientationY.setValueAtTime(m,Howler.ctx.currentTime),v._panner.orientationZ.setValueAtTime(p,Howler.ctx.currentTime)):v._panner.setOrientation(i,m,p)),x._emit("orientation",v._id)}}return x},Howl.prototype.pannerAttr=function(){var i,m,p,_=arguments;if(!this._webAudio)return this;if(0===_.length)return this._pannerAttr;if(1===_.length){if("object"!=typeof _[0])return(p=this._soundById(parseInt(_[0],10)))?p._pannerAttr:this._pannerAttr;i=_[0],void 0===m&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),this._pannerAttr={coneInnerAngle:void 0!==i.pannerAttr.coneInnerAngle?i.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:void 0!==i.pannerAttr.coneOuterAngle?i.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:void 0!==i.pannerAttr.coneOuterGain?i.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:void 0!==i.pannerAttr.distanceModel?i.pannerAttr.distanceModel:this._distanceModel,maxDistance:void 0!==i.pannerAttr.maxDistance?i.pannerAttr.maxDistance:this._maxDistance,refDistance:void 0!==i.pannerAttr.refDistance?i.pannerAttr.refDistance:this._refDistance,rolloffFactor:void 0!==i.pannerAttr.rolloffFactor?i.pannerAttr.rolloffFactor:this._rolloffFactor,panningModel:void 0!==i.pannerAttr.panningModel?i.pannerAttr.panningModel:this._panningModel})}else 2===_.length&&(i=_[0],m=parseInt(_[1],10));for(var x=this._getSoundIds(m),y=0;y<x.length;y++)if(p=this._soundById(x[y])){var T=p._pannerAttr;T={coneInnerAngle:void 0!==i.coneInnerAngle?i.coneInnerAngle:T.coneInnerAngle,coneOuterAngle:void 0!==i.coneOuterAngle?i.coneOuterAngle:T.coneOuterAngle,coneOuterGain:void 0!==i.coneOuterGain?i.coneOuterGain:T.coneOuterGain,distanceModel:void 0!==i.distanceModel?i.distanceModel:T.distanceModel,maxDistance:void 0!==i.maxDistance?i.maxDistance:T.maxDistance,refDistance:void 0!==i.refDistance?i.refDistance:T.refDistance,rolloffFactor:void 0!==i.rolloffFactor?i.rolloffFactor:T.rolloffFactor,panningModel:void 0!==i.panningModel?i.panningModel:T.panningModel};var v=p._panner;v||(p._pos||(p._pos=this._pos||[0,0,-.5]),D(p,"spatial"),v=p._panner),v.coneInnerAngle=T.coneInnerAngle,v.coneOuterAngle=T.coneOuterAngle,v.coneOuterGain=T.coneOuterGain,v.distanceModel=T.distanceModel,v.maxDistance=T.maxDistance,v.refDistance=T.refDistance,v.rolloffFactor=T.rolloffFactor,v.panningModel=T.panningModel}return this},Sound.prototype.init=(k=Sound.prototype.init,function(){var i=this._parent;this._orientation=i._orientation,this._stereo=i._stereo,this._pos=i._pos,this._pannerAttr=i._pannerAttr,k.call(this),this._stereo?i.stereo(this._stereo):this._pos&&i.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}),Sound.prototype.reset=(B=Sound.prototype.reset,function(){var i=this._parent;return this._orientation=i._orientation,this._stereo=i._stereo,this._pos=i._pos,this._pannerAttr=i._pannerAttr,this._stereo?i.stereo(this._stereo):this._pos?i.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,i._refreshBuffer(this)),B.call(this)}),D=function(i,m){"spatial"===(m=m||"spatial")?(i._panner=Howler.ctx.createPanner(),i._panner.coneInnerAngle=i._pannerAttr.coneInnerAngle,i._panner.coneOuterAngle=i._pannerAttr.coneOuterAngle,i._panner.coneOuterGain=i._pannerAttr.coneOuterGain,i._panner.distanceModel=i._pannerAttr.distanceModel,i._panner.maxDistance=i._pannerAttr.maxDistance,i._panner.refDistance=i._pannerAttr.refDistance,i._panner.rolloffFactor=i._pannerAttr.rolloffFactor,i._panner.panningModel=i._pannerAttr.panningModel,void 0!==i._panner.positionX?(i._panner.positionX.setValueAtTime(i._pos[0],Howler.ctx.currentTime),i._panner.positionY.setValueAtTime(i._pos[1],Howler.ctx.currentTime),i._panner.positionZ.setValueAtTime(i._pos[2],Howler.ctx.currentTime)):i._panner.setPosition(i._pos[0],i._pos[1],i._pos[2]),void 0!==i._panner.orientationX?(i._panner.orientationX.setValueAtTime(i._orientation[0],Howler.ctx.currentTime),i._panner.orientationY.setValueAtTime(i._orientation[1],Howler.ctx.currentTime),i._panner.orientationZ.setValueAtTime(i._orientation[2],Howler.ctx.currentTime)):i._panner.setOrientation(i._orientation[0],i._orientation[1],i._orientation[2])):(i._panner=Howler.ctx.createStereoPanner(),i._panner.pan.setValueAtTime(i._stereo,Howler.ctx.currentTime)),i._panner.connect(i._node),i._paused||i._parent.pause(i._id,!0).play(i._id,!0)}},692:function(i,m,p){!function(){var m={452:function(i){"use strict";i.exports=p(9875)}},_={};function __nccwpck_require__(i){var p=_[i];if(void 0!==p)return p.exports;var x=_[i]={exports:{}},y=!0;try{m[i](x,x.exports,__nccwpck_require__),y=!1}finally{y&&delete _[i]}return x.exports}__nccwpck_require__.ab="//";var x={};!function(){var i,m=(i=__nccwpck_require__(452))&&"object"==typeof i&&"default"in i?i.default:i,p=/https?|ftp|gopher|file/;function r(i){"string"==typeof i&&(i=d(i));var _,x,y,T,v,E,A,S,I,R=(x=(_=i).auth,y=_.hostname,T=_.protocol||"",v=_.pathname||"",E=_.hash||"",A=_.query||"",S=!1,x=x?encodeURIComponent(x).replace(/%3A/i,":")+"@":"",_.host?S=x+_.host:y&&(S=x+(~y.indexOf(":")?"["+y+"]":y),_.port&&(S+=":"+_.port)),A&&"object"==typeof A&&(A=m.encode(A)),I=_.search||A&&"?"+A||"",T&&":"!==T.substr(-1)&&(T+=":"),_.slashes||(!T||p.test(T))&&!1!==S?(S="//"+(S||""),v&&"/"!==v[0]&&(v="/"+v)):S||(S=""),E&&"#"!==E[0]&&(E="#"+E),I&&"?"!==I[0]&&(I="?"+I),{protocol:T,host:S,pathname:v=v.replace(/[?#]/g,encodeURIComponent),search:I=I.replace("#","%23"),hash:E});return""+R.protocol+R.host+R.pathname+R.search+R.hash}var _="http://",y=_+"w.w",T=/^([a-z0-9.+-]*:\/\/\/)([a-z0-9.+-]:\/*)?/i,v=/https?|ftp|gopher|file/;function h(i,m){var p="string"==typeof i?d(i):i;i="object"==typeof i?r(i):i;var x=d(m),E="";p.protocol&&!p.slashes&&(E=p.protocol,i=i.replace(p.protocol,""),E+="/"===m[0]||"/"===i[0]?"/":""),E&&x.protocol&&(E="",x.slashes||(E=x.protocol,m=m.replace(x.protocol,"")));var A=i.match(T);A&&!x.protocol&&(i=i.substr((E=A[1]+(A[2]||"")).length),/^\/\/[^/]/.test(m)&&(E=E.slice(0,-1)));var S=new URL(i,y+"/"),I=new URL(m,S).toString().replace(y,""),R=x.protocol||p.protocol;return R+=p.slashes||x.slashes?"//":"",!E&&R?I=I.replace(_,R):E&&(I=I.replace(_,"")),v.test(I)||~m.indexOf(".")||"/"===i.slice(-1)||"/"===m.slice(-1)||"/"!==I.slice(-1)||(I=I.slice(0,-1)),E&&(I=E+("/"===I[0]?I.substr(1):I)),I}function l(){}l.prototype.parse=d,l.prototype.format=r,l.prototype.resolve=h,l.prototype.resolveObject=h;var E=/^https?|ftp|gopher|file/,A=/^(.*?)([#?].*)/,S=/^([a-z0-9.+-]*:)(\/{0,3})(.*)/i,I=/^([a-z0-9.+-]*:)?\/\/\/*/i,R=/^([a-z0-9.+-]*:)(\/{0,2})\[(.*)\]$/i;function d(i,p,_){if(void 0===p&&(p=!1),void 0===_&&(_=!1),i&&"object"==typeof i&&i instanceof l)return i;var x=(i=i.trim()).match(A);i=x?x[1].replace(/\\/g,"/")+x[2]:i.replace(/\\/g,"/"),R.test(i)&&"/"!==i.slice(-1)&&(i+="/");var T=!/(^javascript)/.test(i)&&i.match(S),v=I.test(i),C="";T&&(E.test(T[1])||(C=T[1].toLowerCase(),i=""+T[2]+T[3]),T[2]||(v=!1,E.test(T[1])?(C=T[1],i=""+T[3]):i="//"+T[3]),3!==T[2].length&&1!==T[2].length||(C=T[1],i="/"+T[3]));var P,k=(x?x[1]:i).match(/^https?:\/\/[^/]+(:[0-9]+)(?=\/|$)/),B=k&&k[1],D=new l,F="",L="";try{P=new URL(i)}catch(m){F=m,C||_||!/^\/\//.test(i)||/^\/\/.+[@.]/.test(i)||(L="/",i=i.substr(1));try{P=new URL(i,y)}catch(i){return D.protocol=C,D.href=C,D}}D.slashes=v&&!L,D.host="w.w"===P.host?"":P.host,D.hostname="w.w"===P.hostname?"":P.hostname.replace(/(\[|\])/g,""),D.protocol=F?C||null:P.protocol,D.search=P.search.replace(/\\/g,"%5C"),D.hash=P.hash.replace(/\\/g,"%5C");var O=i.split("#");!D.search&&~O[0].indexOf("?")&&(D.search="?"),D.hash||""!==O[1]||(D.hash="#"),D.query=p?m.decode(P.search.substr(1)):D.search.substr(1),D.pathname=L+(T?P.pathname.replace(/['^|`]/g,function(i){return"%"+i.charCodeAt().toString(16).toUpperCase()}).replace(/((?:%[0-9A-F]{2})+)/g,function(i,m){try{return decodeURIComponent(m).split("").map(function(i){var m=i.charCodeAt();return m>256||/^[a-z0-9]$/i.test(i)?i:"%"+m.toString(16).toUpperCase()}).join("")}catch(i){return m}}):P.pathname),"about:"===D.protocol&&"blank"===D.pathname&&(D.protocol="",D.pathname=""),F&&"/"!==i[0]&&(D.pathname=D.pathname.substr(1)),C&&!E.test(C)&&"/"!==i.slice(-1)&&"/"===D.pathname&&(D.pathname=""),D.path=D.pathname+D.search,D.auth=[P.username,P.password].map(decodeURIComponent).filter(Boolean).join(":"),D.port=P.port,B&&!D.host.endsWith(B)&&(D.host+=B,D.port=B.slice(1)),D.href=L?""+D.pathname+D.search+D.hash:r(D);var V=/^(file)/.test(D.href)?["host","hostname"]:[];return Object.keys(D).forEach(function(i){~V.indexOf(i)||(D[i]=D[i]||null)}),D}x.parse=d,x.format=r,x.resolve=h,x.resolveObject=function(i,m){return d(h(i,m))},x.Url=l}(),i.exports=x}()},9875:function(i){!function(){"use strict";var m={815:function(i){function hasOwnProperty(i,m){return Object.prototype.hasOwnProperty.call(i,m)}i.exports=function(i,p,_,x){p=p||"&",_=_||"=";var y={};if("string"!=typeof i||0===i.length)return y;var T=/\+/g;i=i.split(p);var v=1e3;x&&"number"==typeof x.maxKeys&&(v=x.maxKeys);var E=i.length;v>0&&E>v&&(E=v);for(var A=0;A<E;++A){var S,I,R,C,P=i[A].replace(T,"%20"),k=P.indexOf(_);k>=0?(S=P.substr(0,k),I=P.substr(k+1)):(S=P,I=""),R=decodeURIComponent(S),C=decodeURIComponent(I),hasOwnProperty(y,R)?m(y[R])?y[R].push(C):y[R]=[y[R],C]:y[R]=C}return y};var m=Array.isArray||function(i){return"[object Array]"===Object.prototype.toString.call(i)}},577:function(i){var stringifyPrimitive=function(i){switch(typeof i){case"string":return i;case"boolean":return i?"true":"false";case"number":return isFinite(i)?i:"";default:return""}};i.exports=function(i,_,x,y){return(_=_||"&",x=x||"=",null===i&&(i=void 0),"object"==typeof i)?map(p(i),function(p){var y=encodeURIComponent(stringifyPrimitive(p))+x;return m(i[p])?map(i[p],function(i){return y+encodeURIComponent(stringifyPrimitive(i))}).join(_):y+encodeURIComponent(stringifyPrimitive(i[p]))}).join(_):y?encodeURIComponent(stringifyPrimitive(y))+x+encodeURIComponent(stringifyPrimitive(i)):""};var m=Array.isArray||function(i){return"[object Array]"===Object.prototype.toString.call(i)};function map(i,m){if(i.map)return i.map(m);for(var p=[],_=0;_<i.length;_++)p.push(m(i[_],_));return p}var p=Object.keys||function(i){var m=[];for(var p in i)Object.prototype.hasOwnProperty.call(i,p)&&m.push(p);return m}}},p={};function __nccwpck_require__(i){var _=p[i];if(void 0!==_)return _.exports;var x=p[i]={exports:{}},y=!0;try{m[i](x,x.exports,__nccwpck_require__),y=!1}finally{y&&delete p[i]}return x.exports}__nccwpck_require__.ab="//";var _={};_.decode=_.parse=__nccwpck_require__(815),_.encode=_.stringify=__nccwpck_require__(577),i.exports=_}()},622:function(i,m,p){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _=p(2265),x=Symbol.for("react.element"),y=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),T=_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,v={key:!0,ref:!0,__self:!0,__source:!0};function q(i,m,p){var _,E={},A=null,S=null;for(_ in void 0!==p&&(A=""+p),void 0!==m.key&&(A=""+m.key),void 0!==m.ref&&(S=m.ref),m)y.call(m,_)&&!v.hasOwnProperty(_)&&(E[_]=m[_]);if(i&&i.defaultProps)for(_ in m=i.defaultProps)void 0===E[_]&&(E[_]=m[_]);return{$$typeof:x,type:i,key:A,ref:S,props:E,_owner:T.current}}m.jsx=q,m.jsxs=q},7437:function(i,m,p){"use strict";i.exports=p(622)},2857:function(i,m,p){"use strict";let _;p.d(m,{de:function(){return Z},Q2:function(){return E},gN:function(){return checkExtension},uz:function(){return copySearchParams},cU:function(){return createTexture}});var x,y=p(6392);let T={loader:y.nw.LoadParser,resolver:y.nw.ResolveParser,cache:y.nw.CacheParser,detection:y.nw.DetectionParser};y.Rw.handle(y.nw.Asset,i=>{let m=i.ref;Object.entries(T).filter(([i])=>!!m[i]).forEach(([i,p])=>y.Rw.add(Object.assign(m[i],{extension:m[i].extension??p})))},i=>{let m=i.ref;Object.keys(T).filter(i=>!!m[i]).forEach(i=>y.Rw.remove(m[i]))});let BackgroundLoader=class BackgroundLoader{constructor(i,m=!1){this._loader=i,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=m}add(i){i.forEach(i=>{this._assetList.push(i)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let i=[],m=Math.min(this._assetList.length,this._maxConcurrent);for(let p=0;p<m;p++)i.push(this._assetList.pop());await this._loader.load(i),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(i){this._isActive!==i&&(this._isActive=i,i&&!this._isLoading&&this._next())}};function checkExtension(i,m){let p=i.split("?")[0],_=y.P6.path.extname(p).toLowerCase();return Array.isArray(m)?m.includes(_):_===m}let convertToList=(i,m,p=!1)=>(Array.isArray(i)||(i=[i]),m?i.map(i=>"string"==typeof i||p?m(i):i):i);let CacheClass=class CacheClass{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(i){return this._cache.has(i)}get(i){let m=this._cache.get(i);return m||console.warn(`[Assets] Asset id ${i} was not found in the Cache`),m}set(i,m){let p;let _=convertToList(i);for(let i=0;i<this.parsers.length;i++){let x=this.parsers[i];if(x.test(m)){p=x.getCacheableAssets(_,m);break}}p||(p={},_.forEach(i=>{p[i]=m}));let x=Object.keys(p),T={cacheKeys:x,keys:_};_.forEach(i=>{this._cacheMap.set(i,T)}),x.forEach(i=>{this._cache.has(i)&&this._cache.get(i)!==m&&console.warn("[Cache] already has key:",i),this._cache.set(i,p[i])}),m instanceof y.xE&&_.forEach(i=>{m.baseTexture!==y.xE.EMPTY.baseTexture&&y.VL.addToCache(m.baseTexture,i),y.xE.addToCache(m,i)})}remove(i){if(!this._cacheMap.has(i)){console.warn(`[Assets] Asset id ${i} was not found in the Cache`);return}let m=this._cacheMap.get(i);m.cacheKeys.forEach(i=>{this._cache.delete(i)}),m.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}};let v=new CacheClass,isSingleItem=i=>!Array.isArray(i);let Loader=class Loader{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(i,m,p)=>(this._parsersValidated=!1,i[m]=p,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(i,m){let p={promise:null,parser:null};return p.promise=(async()=>{let _=null,x=null;if(m.loadParser&&((x=this._parserHash[m.loadParser])||console.warn(`[Assets] specified load parser "${m.loadParser}" not found while loading ${i}`)),!x){for(let p=0;p<this.parsers.length;p++){let _=this.parsers[p];if(_.load&&_.test?.(i,m,this)){x=_;break}}if(!x)return console.warn(`[Assets] ${i} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}_=await x.load(i,m,this),p.parser=x;for(let i=0;i<this.parsers.length;i++){let x=this.parsers[i];x.parse&&x.parse&&await x.testParse?.(_,m,this)&&(_=await x.parse(_,m,this)||_,p.parser=x)}return _})(),p}async load(i,m){this._parsersValidated||this._validateParsers();let p=0,_={},x=isSingleItem(i),T=convertToList(i,i=>({alias:[i],src:i})),v=T.length,E=T.map(async i=>{let x=y.P6.path.toAbsolute(i.src);if(!_[i.src])try{this.promiseCache[x]||(this.promiseCache[x]=this._getLoadPromiseAndParser(x,i)),_[i.src]=await this.promiseCache[x].promise,m&&m(++p/v)}catch(m){throw delete this.promiseCache[x],delete _[i.src],Error(`[Loader.load] Failed to load ${x}.
${m}`)}});return await Promise.all(E),x?_[T[0].src]:_}async unload(i){let m=convertToList(i,i=>({alias:[i],src:i})).map(async i=>{let m=y.P6.path.toAbsolute(i.src),p=this.promiseCache[m];if(p){let _=await p.promise;delete this.promiseCache[m],p.parser?.unload?.(_,i,this)}});await Promise.all(m)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(i=>i.name).reduce((i,m)=>(i[m.name]&&console.warn(`[Assets] loadParser name conflict "${m.name}"`),{...i,[m.name]:m}),{})}};var E=((x=E||{})[x.Low=0]="Low",x[x.Normal=1]="Normal",x[x.High=2]="High",x);function checkDataUrl(i,m){if(Array.isArray(m)){for(let p of m)if(i.startsWith(`data:${p}`))return!0;return!1}return i.startsWith(`data:${m}`)}let A={extension:{type:y.nw.LoadParser,priority:E.Low},name:"loadJson",test:i=>checkDataUrl(i,"application/json")||checkExtension(i,".json"),load:async i=>await (await y.Xd.ADAPTER.fetch(i)).json()};y.Rw.add(A);let S={name:"loadTxt",extension:{type:y.nw.LoadParser,priority:E.Low},test:i=>checkDataUrl(i,"text/plain")||checkExtension(i,".txt"),load:async i=>await (await y.Xd.ADAPTER.fetch(i)).text()};y.Rw.add(S);let I=["normal","bold","100","200","300","400","500","600","700","800","900"],R=[".ttf",".otf",".woff",".woff2"],C=["font/ttf","font/otf","font/woff","font/woff2"],P=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function getFontFamilyName(i){let m=y.P6.path.extname(i),p=y.P6.path.basename(i,m).replace(/(-|_)/g," ").toLowerCase().split(" ").map(i=>i.charAt(0).toUpperCase()+i.slice(1)),_=p.length>0;for(let i of p)if(!i.match(P)){_=!1;break}let x=p.join(" ");return _||(x=`"${x.replace(/[\\"]/g,"\\$&")}"`),x}let k=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function encodeURIWhenNeeded(i){return k.test(i)?i:encodeURI(i)}let B={extension:{type:y.nw.LoadParser,priority:E.Low},name:"loadWebFont",test:i=>checkDataUrl(i,C)||checkExtension(i,R),async load(i,m){let p=y.Xd.ADAPTER.getFontFaceSet();if(p){let _=[],x=m.data?.family??getFontFamilyName(i),y=m.data?.weights?.filter(i=>I.includes(i))??["normal"],T=m.data??{};for(let m=0;m<y.length;m++){let v=y[m],E=new FontFace(x,`url(${encodeURIWhenNeeded(i)})`,{...T,weight:v});await E.load(),p.add(E),_.push(E)}return 1===_.length?_[0]:_}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(i){(Array.isArray(i)?i:[i]).forEach(i=>y.Xd.ADAPTER.getFontFaceSet().delete(i))}};y.Rw.add(B);let D=0,F,L={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},O={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let WorkerManagerClass=class WorkerManagerClass{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise(i=>{let m=URL.createObjectURL(new Blob([L.code],{type:"application/javascript"})),p=new Worker(m);p.addEventListener("message",_=>{p.terminate(),URL.revokeObjectURL(m),i(_.data)})})),this._isImageBitmapSupported}loadImageBitmap(i){return this._run("loadImageBitmap",[i])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){void 0===F&&(F=navigator.hardwareConcurrency||4);let i=this.workerPool.pop();return!i&&this._createdWorkers<F&&(_||(_=URL.createObjectURL(new Blob([O.code],{type:"application/javascript"}))),this._createdWorkers++,(i=new Worker(_)).addEventListener("message",i=>{this.complete(i.data),this.returnWorker(i.target),this.next()})),i}returnWorker(i){this.workerPool.push(i)}complete(i){void 0!==i.error?this.resolveHash[i.uuid].reject(i.error):this.resolveHash[i.uuid].resolve(i.data),this.resolveHash[i.uuid]=null}async _run(i,m){await this._initWorkers();let p=new Promise((p,_)=>{this.queue.push({id:i,arguments:m,resolve:p,reject:_})});return this.next(),p}next(){if(!this.queue.length)return;let i=this.getWorker();if(!i)return;let m=this.queue.pop(),p=m.id;this.resolveHash[D]={resolve:m.resolve,reject:m.reject},i.postMessage({data:m.arguments,uuid:D++,id:p})}};let V=new WorkerManagerClass;function createTexture(i,m,p){i.resource.internal=!0;let _=new y.xE(i),unload=()=>{delete m.promiseCache[p],v.has(p)&&v.remove(p)};return _.baseTexture.once("destroyed",()=>{p in m.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),unload())}),_.once("destroyed",()=>{i.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),unload())}),_}let U=[".jpeg",".jpg",".png",".webp",".avif"],X=["image/jpeg","image/png","image/webp","image/avif"];async function loadImageBitmap(i){let m=await y.Xd.ADAPTER.fetch(i);if(!m.ok)throw Error(`[loadImageBitmap] Failed to fetch ${i}: ${m.status} ${m.statusText}`);let p=await m.blob();return await createImageBitmap(p)}let Y={name:"loadTextures",extension:{type:y.nw.LoadParser,priority:E.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:i=>checkDataUrl(i,X)||checkExtension(i,U),async load(i,m,p){let _;let x=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;_=x?this.config.preferWorkers&&await V.isImageBitmapSupported()?await V.loadImageBitmap(i):await loadImageBitmap(i):await new Promise((m,p)=>{let _=new Image;_.crossOrigin=this.config.crossOrigin,_.src=i,_.complete?m(_):(_.onload=()=>m(_),_.onerror=i=>p(i))});let T={...m.data};T.resolution??(T.resolution=y.P6.getResolutionOfUrl(i)),x&&T.resourceOptions?.ownsImageBitmap===void 0&&(T.resourceOptions={...T.resourceOptions},T.resourceOptions.ownsImageBitmap=!0);let v=new y.VL(_,T);return v.resource.src=i,createTexture(v,p,i)},unload(i){i.destroy(!0)}};y.Rw.add(Y);let G={extension:{type:y.nw.LoadParser,priority:E.High},name:"loadSVG",test:i=>checkDataUrl(i,"image/svg+xml")||checkExtension(i,".svg"),testParse:async i=>y.pX.test(i),async parse(i,m,p){let _=new y.pX(i,m?.data?.resourceOptions);await _.load();let x=new y.VL(_,{resolution:y.P6.getResolutionOfUrl(i),...m?.data});return x.resource.src=m.src,createTexture(x,p,m.src)},load:async(i,m)=>(await y.Xd.ADAPTER.fetch(i)).text(),unload:Y.unload};y.Rw.add(G);let W=[".mp4",".m4v",".webm",".ogv"],z=["video/mp4","video/webm","video/ogg"],j={name:"loadVideo",extension:{type:y.nw.LoadParser,priority:E.High},config:{defaultAutoPlay:!0},test:i=>checkDataUrl(i,z)||checkExtension(i,W),async load(i,m,p){let _;let x=await (await y.Xd.ADAPTER.fetch(i)).blob(),T=URL.createObjectURL(x);try{let x={autoPlay:this.config.defaultAutoPlay,...m?.data?.resourceOptions},v=new y.eH(T,x);await v.load();let E=new y.VL(v,{alphaMode:await y.P6.detectVideoAlphaMode(),resolution:y.P6.getResolutionOfUrl(i),...m?.data});E.resource.src=i,(_=createTexture(E,p,i)).baseTexture.once("destroyed",()=>{URL.revokeObjectURL(T)})}catch(i){throw URL.revokeObjectURL(T),i}return _},unload(i){i.destroy(!0)}};function processX(i,m,p,_,x){let y=m[p];for(let T=0;T<y.length;T++){let v=y[T];p<m.length-1?processX(i.replace(_[p],v),m,p+1,_,x):x.push(i.replace(_[p],v))}}function createStringVariations(i){let m=i.match(/\{(.*?)\}/g),p=[];if(m){let _=[];m.forEach(i=>{let m=i.substring(1,i.length-1).split(",");_.push(m)}),processX(i,_,0,m,p)}else p.push(i);return p}y.Rw.add(j);let Resolver=class Resolver{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(i,m)=>`${i}${this._bundleIdConnector}${m}`,extractAssetIdFromBundle:(i,m)=>m.replace(`${i}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(i){if(this._bundleIdConnector=i.connector??this._bundleIdConnector,this._createBundleAssetId=i.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=i.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...i){i.forEach(i=>{this._preferredOrder.push(i),i.priority||(i.priority=Object.keys(i.params))}),this._resolverHash={}}set basePath(i){this._basePath=i}get basePath(){return this._basePath}set rootPath(i){this._rootPath=i}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(i){"string"==typeof i?this._defaultSearchParams=i:this._defaultSearchParams=Object.keys(i).map(m=>`${encodeURIComponent(m)}=${encodeURIComponent(i[m])}`).join("&")}getAlias(i){let{alias:m,name:p,src:_,srcs:x}=i;return convertToList(m||p||_||x,i=>"string"==typeof i?i:Array.isArray(i)?i.map(i=>i?.src??i?.srcs??i):i?.src||i?.srcs?i.src??i.srcs:i,!0)}addManifest(i){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=i,i.bundles.forEach(i=>{this.addBundle(i.name,i.assets)})}addBundle(i,m){let p=[];Array.isArray(m)?m.forEach(m=>{let _;let x=m.src??m.srcs,y=m.alias??m.name;if("string"==typeof y){let m=this._createBundleAssetId(i,y);p.push(m),_=[y,m]}else{let m=y.map(m=>this._createBundleAssetId(i,m));p.push(...m),_=[...y,...m]}this.add({...m,alias:_,src:x})}):Object.keys(m).forEach(_=>{let x=[_,this._createBundleAssetId(i,_)];if("string"==typeof m[_])this.add({alias:x,src:m[_]});else if(Array.isArray(m[_]))this.add({alias:x,src:m[_]});else{let i=m[_],p=i.src??i.srcs;this.add({...i,alias:x,src:Array.isArray(p)?p:[p]})}p.push(...x)}),this._bundles[i]=p}add(i,m,p,_,x){let T;let v=[];"string"==typeof i||Array.isArray(i)&&"string"==typeof i[0]?(y.P6.deprecation("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),v.push({alias:i,src:m,data:p,format:_,loadParser:x})):Array.isArray(i)?v.push(...i):v.push(i),T=i=>{this.hasKey(i)&&console.warn(`[Resolver] already has key: ${i} overwriting`)},convertToList(v).forEach(i=>{let{src:m,srcs:p}=i,{data:_,format:x,loadParser:y}=i,v=convertToList(m||p).map(i=>"string"==typeof i?createStringVariations(i):Array.isArray(i)?i:[i]),E=this.getAlias(i);Array.isArray(E)?E.forEach(T):T(E);let A=[];v.forEach(i=>{i.forEach(i=>{let m={};if("object"!=typeof i){m.src=i;for(let p=0;p<this._parsers.length;p++){let _=this._parsers[p];if(_.test(i)){m=_.parse(i);break}}}else _=i.data??_,x=i.format??x,y=i.loadParser??y,m={...m,...i};if(!E)throw Error(`[Resolver] alias is undefined for this asset: ${m.src}`);m=this.buildResolvedAsset(m,{aliases:E,data:_,format:x,loadParser:y}),A.push(m)})}),E.forEach(i=>{this._assetMap[i]=A})})}resolveBundle(i){let m=isSingleItem(i);i=convertToList(i);let p={};return i.forEach(i=>{let m=this._bundles[i];if(m){let _=this.resolve(m),x={};for(let m in _){let p=_[m];x[this._extractAssetIdFromBundle(i,m)]=p}p[i]=x}}),m?p[i[0]]:p}resolveUrl(i){let m=this.resolve(i);if("string"!=typeof i){let i={};for(let p in m)i[p]=m[p].src;return i}return m.src}resolve(i){let m=isSingleItem(i);i=convertToList(i);let p={};return i.forEach(i=>{if(!this._resolverHash[i]){if(this._assetMap[i]){let m=this._assetMap[i],p=m[0],_=this._getPreferredOrder(m);_?.priority.forEach(i=>{_.params[i].forEach(p=>{let _=m.filter(m=>!!m[i]&&m[i]===p);_.length&&(m=_)})}),this._resolverHash[i]=m[0]??p}else this._resolverHash[i]=this.buildResolvedAsset({alias:[i],src:i},{})}p[i]=this._resolverHash[i]}),m?p[i[0]]:p}hasKey(i){return!!this._assetMap[i]}hasBundle(i){return!!this._bundles[i]}_getPreferredOrder(i){for(let m=0;m<i.length;m++){let m=i[0],p=this._preferredOrder.find(i=>i.params.format.includes(m.format));if(p)return p}return this._preferredOrder[0]}_appendDefaultSearchParams(i){if(!this._defaultSearchParams)return i;let m=/\?/.test(i)?"&":"?";return`${i}${m}${this._defaultSearchParams}`}buildResolvedAsset(i,m){let{aliases:p,data:_,loadParser:x,format:T}=m;return(this._basePath||this._rootPath)&&(i.src=y.P6.path.toAbsolute(i.src,this._basePath,this._rootPath)),i.alias=p??i.alias??[i.src],i.src=this._appendDefaultSearchParams(i.src),i.data={..._||{},...i.data},i.loadParser=x??i.loadParser,i.format=T??y.P6.path.extname(i.src).slice(1),i.srcs=i.src,i.name=i.alias,i}};let AssetsClass=class AssetsClass{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Resolver,this.loader=new Loader,this.cache=v,this._backgroundLoader=new BackgroundLoader(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(i={}){if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,i.defaultSearchParams&&this.resolver.setDefaultSearchParams(i.defaultSearchParams),i.basePath&&(this.resolver.basePath=i.basePath),i.bundleIdentifier&&this.resolver.setBundleIdentifier(i.bundleIdentifier),i.manifest){let m=i.manifest;"string"==typeof m&&(m=await this.load(m)),this.resolver.addManifest(m)}let m=i.texturePreference?.resolution??1,p=await this._detectFormats({preferredFormats:i.texturePreference?.format,skipDetections:i.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:p,resolution:"number"==typeof m?[m]:m}}),i.preferences&&this.setPreferences(i.preferences)}add(i,m,p,_,x){this.resolver.add(i,m,p,_,x)}async load(i,m){this._initialized||await this.init();let p=isSingleItem(i),_=convertToList(i).map(i=>{if("string"!=typeof i){let m=this.resolver.getAlias(i);return m.some(i=>!this.resolver.hasKey(i))&&this.add(i),Array.isArray(m)?m[0]:m}return this.resolver.hasKey(i)||this.add({alias:i,src:i}),i}),x=this.resolver.resolve(_),y=await this._mapLoadToResolve(x,m);return p?y[_[0]]:y}addBundle(i,m){this.resolver.addBundle(i,m)}async loadBundle(i,m){this._initialized||await this.init();let p=!1;"string"==typeof i&&(p=!0,i=[i]);let _=this.resolver.resolveBundle(i),x={},y=Object.keys(_),T=0,v=0,_onProgress=()=>{m?.(++T/v)},E=y.map(i=>{let m=_[i];return v+=Object.keys(m).length,this._mapLoadToResolve(m,_onProgress).then(m=>{x[i]=m})});return await Promise.all(E),p?x[i[0]]:x}async backgroundLoad(i){this._initialized||await this.init(),"string"==typeof i&&(i=[i]);let m=this.resolver.resolve(i);this._backgroundLoader.add(Object.values(m))}async backgroundLoadBundle(i){this._initialized||await this.init(),"string"==typeof i&&(i=[i]);let m=this.resolver.resolveBundle(i);Object.values(m).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(i){if("string"==typeof i)return v.get(i);let m={};for(let p=0;p<i.length;p++)m[p]=v.get(i[p]);return m}async _mapLoadToResolve(i,m){let p=Object.values(i),_=Object.keys(i);this._backgroundLoader.active=!1;let x=await this.loader.load(p,m);this._backgroundLoader.active=!0;let y={};return p.forEach((i,m)=>{let p=x[i.src],T=[i.src];i.alias&&T.push(...i.alias),y[_[m]]=p,v.set(T,p)}),y}async unload(i){this._initialized||await this.init();let m=convertToList(i).map(i=>"string"!=typeof i?i.src:i),p=this.resolver.resolve(m);await this._unloadFromResolved(p)}async unloadBundle(i){this._initialized||await this.init(),i=convertToList(i);let m=this.resolver.resolveBundle(i),p=Object.keys(m).map(i=>this._unloadFromResolved(m[i]));await Promise.all(p)}async _unloadFromResolved(i){let m=Object.values(i);m.forEach(i=>{v.remove(i.src)}),await this.loader.unload(m)}async _detectFormats(i){let m=[];for(let p of(i.preferredFormats&&(m=Array.isArray(i.preferredFormats)?i.preferredFormats:[i.preferredFormats]),i.detections))i.skipDetections||await p.test()?m=await p.add(m):i.skipDetections||(m=await p.remove(m));return m=m.filter((i,p)=>m.indexOf(i)===p)}get detections(){return this._detections}get preferWorkers(){return Y.config.preferWorkers}set preferWorkers(i){y.P6.deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:i})}setPreferences(i){this.loader.parsers.forEach(m=>{m.config&&Object.keys(m.config).filter(m=>m in i).forEach(p=>{m.config[p]=i[p]})})}};let Z=new AssetsClass;y.Rw.handleByList(y.nw.LoadParser,Z.loader.parsers).handleByList(y.nw.ResolveParser,Z.resolver.parsers).handleByList(y.nw.CacheParser,Z.cache.parsers).handleByList(y.nw.DetectionParser,Z.detections);let K={extension:y.nw.CacheParser,test:i=>Array.isArray(i)&&i.every(i=>i instanceof y.xE),getCacheableAssets:(i,m)=>{let p={};return i.forEach(i=>{m.forEach((m,_)=>{p[i+(0===_?"":_+1)]=m})}),p}};async function testImageFormat(i){if("Image"in globalThis)return new Promise(m=>{let p=new Image;p.onload=()=>{m(!0)},p.onerror=()=>{m(!1)},p.src=i});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{let m=await (await fetch(i)).blob();await createImageBitmap(m)}catch{return!1}return!0}return!1}y.Rw.add(K);let J={extension:{type:y.nw.DetectionParser,priority:1},test:async()=>testImageFormat("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async i=>[...i,"avif"],remove:async i=>i.filter(i=>"avif"!==i)};y.Rw.add(J);let Q={extension:{type:y.nw.DetectionParser,priority:0},test:async()=>testImageFormat("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async i=>[...i,"webp"],remove:async i=>i.filter(i=>"webp"!==i)};y.Rw.add(Q);let tt=["png","jpg","jpeg"],te={extension:{type:y.nw.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...tt],remove:async i=>i.filter(i=>!tt.includes(i))};y.Rw.add(te);let tr="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function testVideoFormat(i){return!tr&&""!==document.createElement("video").canPlayType(i)}let ti={extension:{type:y.nw.DetectionParser,priority:0},test:async()=>testVideoFormat("video/webm"),add:async i=>[...i,"webm"],remove:async i=>i.filter(i=>"webm"!==i)};y.Rw.add(ti);let ts={extension:{type:y.nw.DetectionParser,priority:0},test:async()=>testVideoFormat("video/mp4"),add:async i=>[...i,"mp4","m4v"],remove:async i=>i.filter(i=>"mp4"!==i&&"m4v"!==i)};y.Rw.add(ts);let tn={extension:{type:y.nw.DetectionParser,priority:0},test:async()=>testVideoFormat("video/ogg"),add:async i=>[...i,"ogv"],remove:async i=>i.filter(i=>"ogv"!==i)};y.Rw.add(tn);let ta={extension:y.nw.ResolveParser,test:Y.test,parse:i=>({resolution:parseFloat(y.Xd.RETINA_PREFIX.exec(i)?.[1]??"1"),format:y.P6.path.extname(i).slice(1),src:i})};y.Rw.add(ta);let copySearchParams=(i,m)=>{let p=m.split("?")[1];return p&&(i+=`?${p}`),i}},6392:function(i,m,p){"use strict";let _,x,y,T;p.d(m,{iw:function(){return tu},T$:function(){return te},VL:function(){return es},a$:function(){return BatchDrawCall},JZ:function(){return BatchGeometry},Ie:function(){return BatchTextureArray},lW:function(){return Buffer},qm:function(){return BufferResource},yl:function(){return td},Cd:function(){return Circle},Il:function(){return tJ},ZX:function(){return ec},lg:function(){return tr},Pj:function(){return Ellipse},nw:function(){return t9},I2:function(){return ti},wn:function(){return e$},wG:function(){return Geometry},A7:function(){return tf},KI:function(){return th},y3:function(){return Matrix},bO:function(){return ObjectRenderer},AB:function(){return ObservablePoint},_b:function(){return eu},E9:function(){return Point},mg:function(){return Polygon},$r:function(){return eO},ud:function(){return QuadUv},jl:function(){return ed},Ae:function(){return Rectangle},TI:function(){return RenderTexture},c9:function(){return RoundedRectangle},aH:function(){return to},HS:function(){return em},pX:function(){return rg},ex:function(){return Shader},ZM:function(){return State},vK:function(){return tn},xE:function(){return Texture},UX:function(){return TextureMatrix},vB:function(){return ro},wx:function(){return eA},uF:function(){return rn},oo:function(){return UniformGroup},eH:function(){return rx},Rv:function(){return ViewableBuffer},Nt:function(){return tl},e6:function(){return autoDetectRenderer},Y9:function(){return rc},kP:function(){return rd},Rw:function(){return t7},Xd:function(){return tx},P6:function(){return K}});var v,E,A,S,I,R,C,P,k,B,D,F,L,O,V,U,X,Y,G,W,z,j,Z,K={};p.r(K),p.d(K,{BaseTextureCache:function(){return t8},BoundingBox:function(){return t4},CanvasRenderTarget:function(){return CanvasRenderTarget},DATA_URI:function(){return t0},EventEmitter:function(){return tN},ProgramCache:function(){return t6},TextureCache:function(){return t5},clearTextureCache:function(){return clearTextureCache},correctBlendMode:function(){return correctBlendMode},createIndicesForQuads:function(){return createIndicesForQuads},decomposeDataUri:function(){return decomposeDataUri},deprecation:function(){return deprecation},destroyTextureCache:function(){return destroyTextureCache},detectVideoAlphaMode:function(){return detectVideoAlphaMode},determineCrossOrigin:function(){return determineCrossOrigin},earcut:function(){return tL},getBufferType:function(){return getBufferType},getCanvasBoundingBox:function(){return getCanvasBoundingBox},getResolutionOfUrl:function(){return getResolutionOfUrl},hex2rgb:function(){return hex2rgb},hex2string:function(){return hex2string},interleaveTypedArrays:function(){return interleaveTypedArrays},isMobile:function(){return tF},isPow2:function(){return isPow2},isWebGLSupported:function(){return isWebGLSupported},log2:function(){return log2},nextPow2:function(){return nextPow2},path:function(){return tX},premultiplyBlendMode:function(){return tQ},premultiplyRgba:function(){return premultiplyRgba},premultiplyTint:function(){return premultiplyTint},premultiplyTintToRgba:function(){return premultiplyTintToRgba},removeItems:function(){return removeItems},rgb2hex:function(){return rgb2hex},sayHello:function(){return sayHello},sign:function(){return sign},skipHello:function(){return skipHello},string2hex:function(){return string2hex},trimCanvas:function(){return trimCanvas},uid:function(){return uid},url:function(){return tU}});var J=((v=J||{})[v.WEBGL_LEGACY=0]="WEBGL_LEGACY",v[v.WEBGL=1]="WEBGL",v[v.WEBGL2=2]="WEBGL2",v),Q=((E=Q||{})[E.UNKNOWN=0]="UNKNOWN",E[E.WEBGL=1]="WEBGL",E[E.CANVAS=2]="CANVAS",E),tt=((A=tt||{})[A.COLOR=16384]="COLOR",A[A.DEPTH=256]="DEPTH",A[A.STENCIL=1024]="STENCIL",A),te=((S=te||{})[S.NORMAL=0]="NORMAL",S[S.ADD=1]="ADD",S[S.MULTIPLY=2]="MULTIPLY",S[S.SCREEN=3]="SCREEN",S[S.OVERLAY=4]="OVERLAY",S[S.DARKEN=5]="DARKEN",S[S.LIGHTEN=6]="LIGHTEN",S[S.COLOR_DODGE=7]="COLOR_DODGE",S[S.COLOR_BURN=8]="COLOR_BURN",S[S.HARD_LIGHT=9]="HARD_LIGHT",S[S.SOFT_LIGHT=10]="SOFT_LIGHT",S[S.DIFFERENCE=11]="DIFFERENCE",S[S.EXCLUSION=12]="EXCLUSION",S[S.HUE=13]="HUE",S[S.SATURATION=14]="SATURATION",S[S.COLOR=15]="COLOR",S[S.LUMINOSITY=16]="LUMINOSITY",S[S.NORMAL_NPM=17]="NORMAL_NPM",S[S.ADD_NPM=18]="ADD_NPM",S[S.SCREEN_NPM=19]="SCREEN_NPM",S[S.NONE=20]="NONE",S[S.SRC_OVER=0]="SRC_OVER",S[S.SRC_IN=21]="SRC_IN",S[S.SRC_OUT=22]="SRC_OUT",S[S.SRC_ATOP=23]="SRC_ATOP",S[S.DST_OVER=24]="DST_OVER",S[S.DST_IN=25]="DST_IN",S[S.DST_OUT=26]="DST_OUT",S[S.DST_ATOP=27]="DST_ATOP",S[S.ERASE=26]="ERASE",S[S.SUBTRACT=28]="SUBTRACT",S[S.XOR=29]="XOR",S),tr=((I=tr||{})[I.POINTS=0]="POINTS",I[I.LINES=1]="LINES",I[I.LINE_LOOP=2]="LINE_LOOP",I[I.LINE_STRIP=3]="LINE_STRIP",I[I.TRIANGLES=4]="TRIANGLES",I[I.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",I[I.TRIANGLE_FAN=6]="TRIANGLE_FAN",I),ti=((R=ti||{})[R.RGBA=6408]="RGBA",R[R.RGB=6407]="RGB",R[R.RG=33319]="RG",R[R.RED=6403]="RED",R[R.RGBA_INTEGER=36249]="RGBA_INTEGER",R[R.RGB_INTEGER=36248]="RGB_INTEGER",R[R.RG_INTEGER=33320]="RG_INTEGER",R[R.RED_INTEGER=36244]="RED_INTEGER",R[R.ALPHA=6406]="ALPHA",R[R.LUMINANCE=6409]="LUMINANCE",R[R.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",R[R.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",R[R.DEPTH_STENCIL=34041]="DEPTH_STENCIL",R),ts=((C=ts||{})[C.TEXTURE_2D=3553]="TEXTURE_2D",C[C.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",C[C.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",C[C.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",C[C.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",C[C.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",C[C.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",C[C.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",C[C.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",C),tn=((P=tn||{})[P.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",P[P.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",P[P.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",P[P.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",P[P.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",P[P.UNSIGNED_INT=5125]="UNSIGNED_INT",P[P.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",P[P.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",P[P.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",P[P.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",P[P.BYTE=5120]="BYTE",P[P.SHORT=5122]="SHORT",P[P.INT=5124]="INT",P[P.FLOAT=5126]="FLOAT",P[P.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",P[P.HALF_FLOAT=36193]="HALF_FLOAT",P),ta=((k=ta||{})[k.FLOAT=0]="FLOAT",k[k.INT=1]="INT",k[k.UINT=2]="UINT",k),to=((B=to||{})[B.NEAREST=0]="NEAREST",B[B.LINEAR=1]="LINEAR",B),tl=((D=tl||{})[D.CLAMP=33071]="CLAMP",D[D.REPEAT=10497]="REPEAT",D[D.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",D),th=((F=th||{})[F.OFF=0]="OFF",F[F.POW2=1]="POW2",F[F.ON=2]="ON",F[F.ON_MANUAL=3]="ON_MANUAL",F),tu=((L=tu||{})[L.NPM=0]="NPM",L[L.UNPACK=1]="UNPACK",L[L.PMA=2]="PMA",L[L.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",L[L.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",L[L.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",L),td=((O=td||{})[O.NO=0]="NO",O[O.YES=1]="YES",O[O.AUTO=2]="AUTO",O[O.BLEND=0]="BLEND",O[O.CLEAR=1]="CLEAR",O[O.BLIT=2]="BLIT",O),tc=((V=tc||{})[V.AUTO=0]="AUTO",V[V.MANUAL=1]="MANUAL",V),tm=((U=tm||{}).LOW="lowp",U.MEDIUM="mediump",U.HIGH="highp",U),tf=((X=tf||{})[X.NONE=0]="NONE",X[X.SCISSOR=1]="SCISSOR",X[X.STENCIL=2]="STENCIL",X[X.SPRITE=3]="SPRITE",X[X.COLOR=4]="COLOR",X),tp=((Y=tp||{})[Y.RED=1]="RED",Y[Y.GREEN=2]="GREEN",Y[Y.BLUE=4]="BLUE",Y[Y.ALPHA=8]="ALPHA",Y),tg=((G=tg||{})[G.NONE=0]="NONE",G[G.LOW=2]="LOW",G[G.MEDIUM=4]="MEDIUM",G[G.HIGH=8]="HIGH",G),t_=((W=t_||{})[W.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",W[W.ARRAY_BUFFER=34962]="ARRAY_BUFFER",W[W.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",W);let tx={ADAPTER:{createCanvas:(i,m)=>{let p=document.createElement("canvas");return p.width=i,p.height=m,p},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,m)=>fetch(i,m),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")},RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var ty=/iPhone/i,tb=/iPod/i,tT=/iPad/i,tv=/\biOS-universal(?:.+)Mac\b/i,tE=/\bAndroid(?:.+)Mobile\b/i,tA=/Android/i,tS=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,tw=/Silk/i,tI=/Windows Phone/i,tR=/\bWindows(?:.+)ARM\b/i,tM=/BlackBerry/i,tC=/BB10/i,tP=/Opera Mini/i,tk=/\b(CriOS|Chrome)(?:.+)Mobile/i,tB=/Mobile(?:.+)Firefox\b/i,isAppleTabletOnIos13=function(i){return void 0!==i&&"MacIntel"===i.platform&&"number"==typeof i.maxTouchPoints&&i.maxTouchPoints>1&&"undefined"==typeof MSStream};function createMatch(i){return function(m){return m.test(i)}}function isMobile(i){var m={userAgent:"",platform:"",maxTouchPoints:0};i||"undefined"==typeof navigator?"string"==typeof i?m.userAgent=i:i&&i.userAgent&&(m={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0}):m={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var p=m.userAgent,_=p.split("[FBAN");void 0!==_[1]&&(p=_[0]),void 0!==(_=p.split("Twitter"))[1]&&(p=_[0]);var x=createMatch(p),y={apple:{phone:x(ty)&&!x(tI),ipod:x(tb),tablet:!x(ty)&&(x(tT)||isAppleTabletOnIos13(m))&&!x(tI),universal:x(tv),device:(x(ty)||x(tb)||x(tT)||x(tv)||isAppleTabletOnIos13(m))&&!x(tI)},amazon:{phone:x(tS),tablet:!x(tS)&&x(tw),device:x(tS)||x(tw)},android:{phone:!x(tI)&&x(tS)||!x(tI)&&x(tE),tablet:!x(tI)&&!x(tS)&&!x(tE)&&(x(tw)||x(tA)),device:!x(tI)&&(x(tS)||x(tw)||x(tE)||x(tA))||x(/\bokhttp\b/i)},windows:{phone:x(tI),tablet:x(tR),device:x(tI)||x(tR)},other:{blackberry:x(tM),blackberry10:x(tC),opera:x(tP),firefox:x(tB),chrome:x(tk),device:x(tM)||x(tC)||x(tP)||x(tB)||x(tk)},any:!1,phone:!1,tablet:!1};return y.any=y.apple.device||y.android.device||y.windows.device||y.other.device,y.phone=y.apple.phone||y.android.phone||y.windows.phone,y.tablet=y.apple.tablet||y.android.tablet||y.windows.tablet,y}let tD=isMobile.default??isMobile,tF=tD(globalThis.navigator);tx.RETINA_PREFIX=/@([0-9\.]+)x/,tx.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var tN=p(8729),tL=p(776),tO=p(692);let tV={};function deprecation(i,m,p=3){if(tV[m])return;let _=Error().stack;typeof _>"u"?console.warn("PixiJS Deprecation Warning: ",`${m}
Deprecated since v${i}`):(_=_.split(`
`).splice(p).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${m}
Deprecated since v${i}`),console.warn(_),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${m}
Deprecated since v${i}`),console.warn(_))),tV[m]=!0}let tU={get parse(){return deprecation("7.3.0","utils.url.parse is deprecated, use native URL API instead."),tO.parse},get format(){return deprecation("7.3.0","utils.url.format is deprecated, use native URL API instead."),tO.format},get resolve(){return deprecation("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),tO.resolve}};function assertPath(i){if("string"!=typeof i)throw TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function removeUrlParams(i){return i.split("?")[0].split("#")[0]}function escapeRegExp(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function replaceAll(i,m,p){return i.replace(RegExp(escapeRegExp(m),"g"),p)}function normalizeStringPosix(i,m){let p="",_=0,x=-1,y=0,T=-1;for(let v=0;v<=i.length;++v){if(v<i.length)T=i.charCodeAt(v);else{if(47===T)break;T=47}if(47===T){if(!(x===v-1||1===y)){if(x!==v-1&&2===y){if(p.length<2||2!==_||46!==p.charCodeAt(p.length-1)||46!==p.charCodeAt(p.length-2)){if(p.length>2){let i=p.lastIndexOf("/");if(i!==p.length-1){-1===i?(p="",_=0):_=(p=p.slice(0,i)).length-1-p.lastIndexOf("/"),x=v,y=0;continue}}else if(2===p.length||1===p.length){p="",_=0,x=v,y=0;continue}}m&&(p.length>0?p+="/..":p="..",_=2)}else p.length>0?p+=`/${i.slice(x+1,v)}`:p=i.slice(x+1,v),_=v-x-1}x=v,y=0}else 46===T&&-1!==y?++y:y=-1}return p}let tX={toPosix:i=>replaceAll(i,"\\","/"),isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl:i=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i),isBlobUrl:i=>i.startsWith("blob:"),hasProtocol(i){return/^[^/:]+:/.test(this.toPosix(i))},getProtocol(i){assertPath(i),i=this.toPosix(i);let m=/^file:\/\/\//.exec(i);if(m)return m[0];let p=/^[^/:]+:\/{0,2}/.exec(i);return p?p[0]:""},toAbsolute(i,m,p){if(assertPath(i),this.isDataUrl(i)||this.isBlobUrl(i))return i;let _=removeUrlParams(this.toPosix(m??tx.ADAPTER.getBaseUrl())),x=removeUrlParams(this.toPosix(p??this.rootname(_)));return(i=this.toPosix(i)).startsWith("/")?tX.join(x,i.slice(1)):this.isAbsolute(i)?i:this.join(_,i)},normalize(i){if(assertPath(i),0===i.length)return".";if(this.isDataUrl(i)||this.isBlobUrl(i))return i;i=this.toPosix(i);let m="",p=i.startsWith("/");this.hasProtocol(i)&&(m=this.rootname(i),i=i.slice(m.length));let _=i.endsWith("/");return(i=normalizeStringPosix(i,!1)).length>0&&_&&(i+="/"),p?`/${i}`:m+i},isAbsolute(i){return assertPath(i),i=this.toPosix(i),!!this.hasProtocol(i)||i.startsWith("/")},join(...i){let m;if(0===i.length)return".";for(let p=0;p<i.length;++p){let _=i[p];if(assertPath(_),_.length>0){if(void 0===m)m=_;else{let x=i[p-1]??"";this.extname(x)?m+=`/../${_}`:m+=`/${_}`}}}return void 0===m?".":this.normalize(m)},dirname(i){if(assertPath(i),0===i.length)return".";let m=(i=this.toPosix(i)).charCodeAt(0),p=47===m,_=-1,x=!0,y=this.getProtocol(i),T=i;i=i.slice(y.length);for(let p=i.length-1;p>=1;--p)if(47===(m=i.charCodeAt(p))){if(!x){_=p;break}}else x=!1;return -1===_?p?"/":this.isUrl(T)?y+i:y:p&&1===_?"//":y+i.slice(0,_)},rootname(i){assertPath(i);let m="";if(m=(i=this.toPosix(i)).startsWith("/")?"/":this.getProtocol(i),this.isUrl(i)){let p=i.indexOf("/",m.length);(m=-1!==p?i.slice(0,p):i).endsWith("/")||(m+="/")}return m},basename(i,m){assertPath(i),m&&assertPath(m),i=removeUrlParams(this.toPosix(i));let p=0,_=-1,x=!0,y;if(void 0!==m&&m.length>0&&m.length<=i.length){if(m.length===i.length&&m===i)return"";let T=m.length-1,v=-1;for(y=i.length-1;y>=0;--y){let E=i.charCodeAt(y);if(47===E){if(!x){p=y+1;break}}else -1===v&&(x=!1,v=y+1),T>=0&&(E===m.charCodeAt(T)?-1==--T&&(_=y):(T=-1,_=v))}return p===_?_=v:-1===_&&(_=i.length),i.slice(p,_)}for(y=i.length-1;y>=0;--y)if(47===i.charCodeAt(y)){if(!x){p=y+1;break}}else -1===_&&(x=!1,_=y+1);return -1===_?"":i.slice(p,_)},extname(i){assertPath(i),i=removeUrlParams(this.toPosix(i));let m=-1,p=0,_=-1,x=!0,y=0;for(let T=i.length-1;T>=0;--T){let v=i.charCodeAt(T);if(47===v){if(!x){p=T+1;break}continue}-1===_&&(x=!1,_=T+1),46===v?-1===m?m=T:1!==y&&(y=1):-1!==m&&(y=-1)}return -1===m||-1===_||0===y||1===y&&m===_-1&&m===p+1?"":i.slice(m,_)},parse(i){let m;assertPath(i);let p={root:"",dir:"",base:"",ext:"",name:""};if(0===i.length)return p;let _=(i=removeUrlParams(this.toPosix(i))).charCodeAt(0),x=this.isAbsolute(i);p.root=this.rootname(i),m=x||this.hasProtocol(i)?1:0;let y=-1,T=0,v=-1,E=!0,A=i.length-1,S=0;for(;A>=m;--A){if(47===(_=i.charCodeAt(A))){if(!E){T=A+1;break}continue}-1===v&&(E=!1,v=A+1),46===_?-1===y?y=A:1!==S&&(S=1):-1!==y&&(S=-1)}return -1===y||-1===v||0===S||1===S&&y===v-1&&y===T+1?-1!==v&&(0===T&&x?p.base=p.name=i.slice(1,v):p.base=p.name=i.slice(T,v)):(0===T&&x?(p.name=i.slice(1,y),p.base=i.slice(1,v)):(p.name=i.slice(T,y),p.base=i.slice(T,v)),p.ext=i.slice(y,v)),p.dir=this.dirname(i),p},sep:"/",delimiter:":"};async function detectVideoAlphaMode(){return _??(_=(async()=>{let i=document.createElement("canvas").getContext("webgl");if(!i)return tu.UNPACK;let m=await new Promise(i=>{let m=document.createElement("video");m.onloadeddata=()=>i(m),m.onerror=()=>i(null),m.autoplay=!1,m.crossOrigin="anonymous",m.preload="auto",m.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",m.load()});if(!m)return tu.UNPACK;let p=i.createTexture();i.bindTexture(i.TEXTURE_2D,p);let _=i.createFramebuffer();i.bindFramebuffer(i.FRAMEBUFFER,_),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,p,0),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,m);let x=new Uint8Array(4);return i.readPixels(0,0,1,1,i.RGBA,i.UNSIGNED_BYTE,x),i.deleteFramebuffer(_),i.deleteTexture(p),i.getExtension("WEBGL_lose_context")?.loseContext(),x[0]<=x[3]?tu.PMA:tu.UNPACK})()),_}function skipHello(){deprecation("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function sayHello(){deprecation("7.0.0",'sayHello is deprecated, please use Renderer\'s "hello" option')}function isWebGLSupported(){return typeof x>"u"&&(x=function(){let i={stencil:!0,failIfMajorPerformanceCaveat:tx.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!tx.ADAPTER.getWebGLRenderingContext())return!1;let m=tx.ADAPTER.createCanvas(),p=m.getContext("webgl",i)||m.getContext("experimental-webgl",i),_=!!p?.getContextAttributes()?.stencil;if(p){let i=p.getExtension("WEBGL_lose_context");i&&i.loseContext()}return p=null,_}catch{return!1}}()),x}var tY={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(i){return"string"==typeof i?i.length>0:"number"==typeof i},n=function(i,m,p){return void 0===m&&(m=0),void 0===p&&(p=Math.pow(10,m)),Math.round(p*i)/p+0},e=function(i,m,p){return void 0===m&&(m=0),void 0===p&&(p=1),i>p?p:i>m?i:m},u=function(i){return(i=isFinite(i)?i%360:0)>0?i:i+360},a=function(i){return{r:e(i.r,0,255),g:e(i.g,0,255),b:e(i.b,0,255),a:e(i.a)}},o=function(i){return{r:n(i.r),g:n(i.g),b:n(i.b),a:n(i.a,3)}},tG=/^#([0-9a-f]{3,8})$/i,s=function(i){var m=i.toString(16);return m.length<2?"0"+m:m},h=function(i){var m=i.r,p=i.g,_=i.b,x=i.a,y=Math.max(m,p,_),T=y-Math.min(m,p,_),v=T?y===m?(p-_)/T:y===p?2+(_-m)/T:4+(m-p)/T:0;return{h:60*(v<0?v+6:v),s:y?T/y*100:0,v:y/255*100,a:x}},b=function(i){var m=i.h,p=i.s,_=i.v,x=i.a;m=m/360*6,p/=100,_/=100;var y=Math.floor(m),T=_*(1-p),v=_*(1-(m-y)*p),E=_*(1-(1-m+y)*p),A=y%6;return{r:255*[_,v,T,T,E,_][A],g:255*[E,_,_,v,T,T][A],b:255*[T,T,E,_,_,v][A],a:x}},g=function(i){return{h:u(i.h),s:e(i.s,0,100),l:e(i.l,0,100),a:e(i.a)}},d=function(i){return{h:n(i.h),s:n(i.s),l:n(i.l),a:n(i.a,3)}},f=function(i){var m,p;return b((m=i.s,{h:i.h,s:(m*=((p=i.l)<50?p:100-p)/100)>0?2*m/(p+m)*100:0,v:p+m,a:i.a}))},c=function(i){var m,p,_,x;return{h:(m=h(i)).h,s:(x=(200-(p=m.s))*(_=m.v)/100)>0&&x<200?p*_/100/(x<=100?x:200-x)*100:0,l:x/2,a:m.a}},tH=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,tW=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,t$=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,tz=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,tj={string:[[function(i){var m=tG.exec(i);return m?(i=m[1]).length<=4?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:4===i.length?n(parseInt(i[3]+i[3],16)/255,2):1}:6===i.length||8===i.length?{r:parseInt(i.substr(0,2),16),g:parseInt(i.substr(2,2),16),b:parseInt(i.substr(4,2),16),a:8===i.length?n(parseInt(i.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(i){var m=t$.exec(i)||tz.exec(i);return m?m[2]!==m[4]||m[4]!==m[6]?null:a({r:Number(m[1])/(m[2]?100/255:1),g:Number(m[3])/(m[4]?100/255:1),b:Number(m[5])/(m[6]?100/255:1),a:void 0===m[7]?1:Number(m[7])/(m[8]?100:1)}):null},"rgb"],[function(i){var m,p,_=tH.exec(i)||tW.exec(i);return _?f(g({h:(m=_[1],void 0===(p=_[2])&&(p="deg"),Number(m)*(tY[p]||1)),s:Number(_[3]),l:Number(_[4]),a:void 0===_[5]?1:Number(_[5])/(_[6]?100:1)})):null},"hsl"]],object:[[function(i){var m=i.r,p=i.g,_=i.b,x=i.a;return t(m)&&t(p)&&t(_)?a({r:Number(m),g:Number(p),b:Number(_),a:Number(void 0===x?1:x)}):null},"rgb"],[function(i){var m=i.h,p=i.s,_=i.l,x=i.a;return t(m)&&t(p)&&t(_)?f(g({h:Number(m),s:Number(p),l:Number(_),a:Number(void 0===x?1:x)})):null},"hsl"],[function(i){var m,p=i.h,_=i.s,x=i.v,y=i.a;return t(p)&&t(_)&&t(x)?b({h:u((m={h:Number(p),s:Number(_),v:Number(x),a:Number(void 0===y?1:y)}).h),s:e(m.s,0,100),v:e(m.v,0,100),a:e(m.a)}):null},"hsv"]]},N=function(i,m){for(var p=0;p<m.length;p++){var _=m[p][0](i);if(_)return[_,m[p][1]]}return[null,void 0]},M=function(i,m){var p=c(i);return{h:p.h,s:e(p.s+100*m,0,100),l:p.l,a:p.a}},H=function(i){return(299*i.r+587*i.g+114*i.b)/1e3/255},$=function(i,m){var p=c(i);return{h:p.h,s:p.s,l:e(p.l+100*m,0,100),a:p.a}},tq=function(){function r(i){this.parsed=("string"==typeof i?N(i.trim(),tj.string):"object"==typeof i&&null!==i?N(i,tj.object):[null,void 0])[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return null!==this.parsed},r.prototype.brightness=function(){return n(H(this.rgba),2)},r.prototype.isDark=function(){return .5>H(this.rgba)},r.prototype.isLight=function(){return H(this.rgba)>=.5},r.prototype.toHex=function(){var i,m,p,_,x,y;return m=(i=o(this.rgba)).r,p=i.g,_=i.b,y=(x=i.a)<1?s(n(255*x)):"","#"+s(m)+s(p)+s(_)+y},r.prototype.toRgb=function(){return o(this.rgba)},r.prototype.toRgbString=function(){var i,m,p,_,x;return m=(i=o(this.rgba)).r,p=i.g,_=i.b,(x=i.a)<1?"rgba("+m+", "+p+", "+_+", "+x+")":"rgb("+m+", "+p+", "+_+")"},r.prototype.toHsl=function(){return d(c(this.rgba))},r.prototype.toHslString=function(){var i,m,p,_,x;return m=(i=d(c(this.rgba))).h,p=i.s,_=i.l,(x=i.a)<1?"hsla("+m+", "+p+"%, "+_+"%, "+x+")":"hsl("+m+", "+p+"%, "+_+"%)"},r.prototype.toHsv=function(){var i;return{h:n((i=h(this.rgba)).h),s:n(i.s),v:n(i.v),a:n(i.a,3)}},r.prototype.invert=function(){var i;return w({r:255-(i=this.rgba).r,g:255-i.g,b:255-i.b,a:i.a})},r.prototype.saturate=function(i){return void 0===i&&(i=.1),w(M(this.rgba,i))},r.prototype.desaturate=function(i){return void 0===i&&(i=.1),w(M(this.rgba,-i))},r.prototype.grayscale=function(){return w(M(this.rgba,-1))},r.prototype.lighten=function(i){return void 0===i&&(i=.1),w($(this.rgba,i))},r.prototype.darken=function(i){return void 0===i&&(i=.1),w($(this.rgba,-i))},r.prototype.rotate=function(i){return void 0===i&&(i=15),this.hue(this.hue()+i)},r.prototype.alpha=function(i){var m;return"number"==typeof i?w({r:(m=this.rgba).r,g:m.g,b:m.b,a:i}):n(this.rgba.a,3)},r.prototype.hue=function(i){var m=c(this.rgba);return"number"==typeof i?w({h:i,s:m.s,l:m.l,a:m.a}):n(m.h)},r.prototype.isEqual=function(i){return this.toHex()===w(i).toHex()},r}(),w=function(i){return i instanceof tq?i:new tq(i)},tZ=[];!function(i){i.forEach(function(i){0>tZ.indexOf(i)&&(i(tq,tj),tZ.push(i))})}([function(i,m){var p={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},_={};for(var x in p)_[p[x]]=x;var y={};i.prototype.toName=function(m){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var x,T=_[this.toHex()];if(T)return T;if(null==m?void 0:m.closest){var v=this.toRgb(),E=1/0,A="black";if(!y.length)for(var S in p)y[S]=new i(p[S]).toRgb();for(var I in p){var R=(x=y[I],Math.pow(v.r-x.r,2)+Math.pow(v.g-x.g,2)+Math.pow(v.b-x.b,2));R<E&&(E=R,A=I)}return A}},m.string.push([function(m){var _=m.toLowerCase(),x="transparent"===_?"#0000":p[_];return x?new i(x).toRgb():null},"name"])}]);let tK=class _Color2{constructor(i=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=i}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(i){return this.value=i,this}set value(i){if(i instanceof _Color2)this._value=this.cloneSource(i._value),this._int=i._int,this._components.set(i._components);else{if(null===i)throw Error("Cannot set PIXI.Color#value to null");null!==this._value&&this.isSourceEqual(this._value,i)||(this.normalize(i),this._value=this.cloneSource(i))}}get value(){return this._value}cloneSource(i){return"string"==typeof i||"number"==typeof i||i instanceof Number||null===i?i:Array.isArray(i)||ArrayBuffer.isView(i)?i.slice(0):"object"==typeof i&&null!==i?{...i}:i}isSourceEqual(i,m){let p=typeof i;if(p!==typeof m)return!1;if("number"===p||"string"===p||i instanceof Number)return i===m;if(Array.isArray(i)&&Array.isArray(m)||ArrayBuffer.isView(i)&&ArrayBuffer.isView(m))return i.length===m.length&&i.every((i,p)=>i===m[p]);if(null!==i&&null!==m){let p=Object.keys(i),_=Object.keys(m);return p.length===_.length&&p.every(p=>i[p]===m[p])}return i===m}toRgba(){let[i,m,p,_]=this._components;return{r:i,g:m,b:p,a:_}}toRgb(){let[i,m,p]=this._components;return{r:i,g:m,b:p}}toRgbaString(){let[i,m,p]=this.toUint8RgbArray();return`rgba(${i},${m},${p},${this.alpha})`}toUint8RgbArray(i){let[m,p,_]=this._components;return(i=i??[])[0]=Math.round(255*m),i[1]=Math.round(255*p),i[2]=Math.round(255*_),i}toRgbArray(i){i=i??[];let[m,p,_]=this._components;return i[0]=m,i[1]=p,i[2]=_,i}toNumber(){return this._int}toLittleEndianNumber(){let i=this._int;return(i>>16)+(65280&i)+((255&i)<<16)}multiply(i){let[m,p,_,x]=_Color2.temp.setValue(i)._components;return this._components[0]*=m,this._components[1]*=p,this._components[2]*=_,this._components[3]*=x,this.refreshInt(),this._value=null,this}premultiply(i,m=!0){return m&&(this._components[0]*=i,this._components[1]*=i,this._components[2]*=i),this._components[3]=i,this.refreshInt(),this._value=null,this}toPremultiplied(i,m=!0){if(1===i)return -16777216+this._int;if(0===i)return m?0:this._int;let p=this._int>>16&255,_=this._int>>8&255,x=255&this._int;return m&&(p=p*i+.5|0,_=_*i+.5|0,x=x*i+.5|0),(255*i<<24)+(p<<16)+(_<<8)+x}toHex(){let i=this._int.toString(16);return`#${"000000".substring(0,6-i.length)+i}`}toHexa(){let i=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-i.length)+i}setAlpha(i){return this._components[3]=this._clamp(i),this}round(i){let[m,p,_]=this._components;return this._components[0]=Math.round(m*i)/i,this._components[1]=Math.round(p*i)/i,this._components[2]=Math.round(_*i)/i,this.refreshInt(),this._value=null,this}toArray(i){i=i??[];let[m,p,_,x]=this._components;return i[0]=m,i[1]=p,i[2]=_,i[3]=x,i}normalize(i){let m,p,_,x;if(("number"==typeof i||i instanceof Number)&&i>=0&&i<=16777215){let y=i;m=(y>>16&255)/255,p=(y>>8&255)/255,_=(255&y)/255,x=1}else if((Array.isArray(i)||i instanceof Float32Array)&&i.length>=3&&i.length<=4)i=this._clamp(i),[m,p,_,x=1]=i;else if((i instanceof Uint8Array||i instanceof Uint8ClampedArray)&&i.length>=3&&i.length<=4)i=this._clamp(i,0,255),[m,p,_,x=255]=i,m/=255,p/=255,_/=255,x/=255;else if("string"==typeof i||"object"==typeof i){if("string"==typeof i){let m=_Color2.HEX_PATTERN.exec(i);m&&(i=`#${m[2]}`)}let y=w(i);y.isValid()&&({r:m,g:p,b:_,a:x}=y.rgba,m/=255,p/=255,_/=255)}if(void 0!==m)this._components[0]=m,this._components[1]=p,this._components[2]=_,this._components[3]=x,this.refreshInt();else throw Error(`Unable to convert color ${i}`)}refreshInt(){this._clamp(this._components);let[i,m,p]=this._components;this._int=(255*i<<16)+(255*m<<8)+(255*p|0)}_clamp(i,m=0,p=1){return"number"==typeof i?Math.min(Math.max(i,m),p):(i.forEach((_,x)=>{i[x]=Math.min(Math.max(_,m),p)}),i)}};tK.shared=new tK,tK.temp=new tK,tK.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let tJ=tK;function hex2rgb(i,m=[]){return deprecation("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),tJ.shared.setValue(i).toRgbArray(m)}function hex2string(i){return deprecation("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),tJ.shared.setValue(i).toHex()}function string2hex(i){return deprecation("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),tJ.shared.setValue(i).toNumber()}function rgb2hex(i){return deprecation("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),tJ.shared.setValue(i).toNumber()}function mapPremultipliedBlendModes(){let i=[],m=[];for(let p=0;p<32;p++)i[p]=p,m[p]=p;i[te.NORMAL_NPM]=te.NORMAL,i[te.ADD_NPM]=te.ADD,i[te.SCREEN_NPM]=te.SCREEN,m[te.NORMAL]=te.NORMAL_NPM,m[te.ADD]=te.ADD_NPM,m[te.SCREEN]=te.SCREEN_NPM;let p=[];return p.push(m),p.push(i),p}let tQ=mapPremultipliedBlendModes();function correctBlendMode(i,m){return tQ[m?1:0][i]}function premultiplyRgba(i,m,p,_=!0){return deprecation("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),tJ.shared.setValue(i).premultiply(m,_).toArray(p??new Float32Array(4))}function premultiplyTint(i,m){return deprecation("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),tJ.shared.setValue(i).toPremultiplied(m)}function premultiplyTintToRgba(i,m,p,_=!0){return deprecation("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),tJ.shared.setValue(i).premultiply(m,_).toArray(p??new Float32Array(4))}let t0=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function createIndicesForQuads(i,m=null){let p=6*i;if((m=m||new Uint16Array(p)).length!==p)throw Error(`Out buffer length is incorrect, got ${m.length} and expected ${p}`);for(let i=0,_=0;i<p;i+=6,_+=4)m[i+0]=_+0,m[i+1]=_+1,m[i+2]=_+2,m[i+3]=_+0,m[i+4]=_+2,m[i+5]=_+3;return m}function getBufferType(i){if(4===i.BYTES_PER_ELEMENT)return i instanceof Float32Array?"Float32Array":i instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===i.BYTES_PER_ELEMENT){if(i instanceof Uint16Array)return"Uint16Array"}else if(1===i.BYTES_PER_ELEMENT&&i instanceof Uint8Array)return"Uint8Array";return null}let t1={Float32Array,Uint32Array,Int32Array,Uint8Array};function interleaveTypedArrays(i,m){let p=0,_=0,x={};for(let x=0;x<i.length;x++)_+=m[x],p+=i[x].length;let y=new ArrayBuffer(4*p),T=null,v=0;for(let p=0;p<i.length;p++){let E=m[p],A=i[p],S=getBufferType(A);x[S]||(x[S]=new t1[S](y)),T=x[S];for(let i=0;i<A.length;i++){let m=(i/E|0)*_+v,p=i%E;T[m+p]=A[i]}v+=E}return new Float32Array(y)}function nextPow2(i){return i+=0===i?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,(i|=i>>>16)+1}function isPow2(i){return!(i&i-1)&&!!i}function log2(i){let m=(i>65535?1:0)<<4,p=((i>>>=m)>255?1:0)<<3;return i>>>=p,m|=p,p=(i>15?1:0)<<2,i>>>=p,m|=p,p=(i>3?1:0)<<1,i>>>=p,(m|=p)|i>>1}function removeItems(i,m,p){let _;let x=i.length;if(m>=x||0===p)return;p=m+p>x?x-m:p;let y=x-p;for(_=m;_<y;++_)i[_]=i[_+p];i.length=y}function sign(i){return 0===i?0:i<0?-1:1}let t2=0;function uid(){return++t2}let t3=class{constructor(i,m,p,_){this.left=i,this.top=m,this.right=p,this.bottom=_}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};t3.EMPTY=new t3(0,0,0,0);let t4=t3,t6={},t5=Object.create(null),t8=Object.create(null);function destroyTextureCache(){let i;for(i in t5)t5[i].destroy();for(i in t8)t8[i].destroy()}function clearTextureCache(){let i;for(i in t5)delete t5[i];for(i in t8)delete t8[i]}let CanvasRenderTarget=class CanvasRenderTarget{constructor(i,m,p){this._canvas=tx.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=p||tx.RESOLUTION,this.resize(i,m)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(i,m){this._checkDestroyed(),this._canvas.width=Math.round(i*this.resolution),this._canvas.height=Math.round(m*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(i){this._checkDestroyed(),this._canvas.width=Math.round(i)}get height(){return this._checkDestroyed(),this._canvas.height}set height(i){this._checkDestroyed(),this._canvas.height=Math.round(i)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(null===this._canvas)throw TypeError("The CanvasRenderTarget has already been destroyed")}};function checkRow(i,m,p){for(let _=0,x=4*p*m;_<m;++_,x+=4)if(0!==i[x+3])return!1;return!0}function checkColumn(i,m,p,_,x){let y=4*m;for(let m=_,T=_*y+4*p;m<=x;++m,T+=y)if(0!==i[T+3])return!1;return!0}function getCanvasBoundingBox(i){let{width:m,height:p}=i,_=i.getContext("2d",{willReadFrequently:!0});if(null===_)throw TypeError("Failed to get canvas 2D context");let x=_.getImageData(0,0,m,p).data,y=0,T=0,v=m-1,E=p-1;for(;T<p&&checkRow(x,m,T);)++T;if(T===p)return t4.EMPTY;for(;checkRow(x,m,E);)--E;for(;checkColumn(x,m,y,T,E);)++y;for(;checkColumn(x,m,v,T,E);)--v;return new t4(y,T,++v,++E)}function trimCanvas(i){let m=getCanvasBoundingBox(i),{width:p,height:_}=m,x=null;if(!m.isEmpty()){let y=i.getContext("2d");if(null===y)throw TypeError("Failed to get canvas 2D context");x=y.getImageData(m.left,m.top,p,_)}return{width:p,height:_,data:x}}function decomposeDataUri(i){let m=t0.exec(i);if(m)return{mediaType:m[1]?m[1].toLowerCase():void 0,subType:m[2]?m[2].toLowerCase():void 0,charset:m[3]?m[3].toLowerCase():void 0,encoding:m[4]?m[4].toLowerCase():void 0,data:m[5]}}function determineCrossOrigin(i,m=globalThis.location){if(i.startsWith("data:"))return"";m=m||globalThis.location;let p=new URL(i,document.baseURI);return p.hostname!==m.hostname||p.port!==m.port||p.protocol!==m.protocol?"anonymous":""}function getResolutionOfUrl(i,m=1){let p=tx.RETINA_PREFIX?.exec(i);return p?parseFloat(p[1]):m}var t9=((z=t9||{}).Renderer="renderer",z.Application="application",z.RendererSystem="renderer-webgl-system",z.RendererPlugin="renderer-webgl-plugin",z.CanvasRendererSystem="renderer-canvas-system",z.CanvasRendererPlugin="renderer-canvas-plugin",z.Asset="asset",z.LoadParser="load-parser",z.ResolveParser="resolve-parser",z.CacheParser="cache-parser",z.DetectionParser="detection-parser",z);let normalizeExtension=i=>{if("function"==typeof i||"object"==typeof i&&i.extension){if(!i.extension)throw Error("Extension class must have an extension object");i={..."object"!=typeof i.extension?{type:i.extension}:i.extension,ref:i}}if("object"==typeof i)i={...i};else throw Error("Invalid extension type");return"string"==typeof i.type&&(i.type=[i.type]),i},normalizePriority=(i,m)=>normalizeExtension(i).priority??m,t7={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(normalizeExtension).forEach(i=>{i.type.forEach(m=>this._removeHandlers[m]?.(i))}),this},add(...i){return i.map(normalizeExtension).forEach(i=>{i.type.forEach(m=>{let p=this._addHandlers,_=this._queue;p[m]?p[m](i):(_[m]=_[m]||[],_[m].push(i))})}),this},handle(i,m,p){let _=this._addHandlers,x=this._removeHandlers;if(_[i]||x[i])throw Error(`Extension type ${i} already has a handler`);_[i]=m,x[i]=p;let y=this._queue;return y[i]&&(y[i].forEach(i=>m(i)),delete y[i]),this},handleByMap(i,m){return this.handle(i,i=>{m[i.name]=i.ref},i=>{delete m[i.name]})},handleByList(i,m,p=-1){return this.handle(i,i=>{m.includes(i.ref)||(m.push(i.ref),m.sort((i,m)=>normalizePriority(m,p)-normalizePriority(i,p)))},i=>{let p=m.indexOf(i.ref);-1!==p&&m.splice(p,1)})}};let ViewableBuffer=class ViewableBuffer{constructor(i){"number"==typeof i?this.rawBinaryData=new ArrayBuffer(i):i instanceof Uint8Array?this.rawBinaryData=i.buffer:this.rawBinaryData=i,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(i){return this[`${i}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(i){switch(i){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw Error(`${i} isn't a valid view type`)}}};let et=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function generateIfTestSrc(i){let m="";for(let p=0;p<i;++p)p>0&&(m+=`
else `),p<i-1&&(m+=`if(test == ${p}.0){}`);return m}function checkMaxIfStatementsInShader(i,m){if(0===i)throw Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let p=m.createShader(m.FRAGMENT_SHADER);for(;;){let _=et.replace(/%forloop%/gi,generateIfTestSrc(i));if(m.shaderSource(p,_),m.compileShader(p),m.getShaderParameter(p,m.COMPILE_STATUS))break;i=i/2|0}return i}let State=class State{constructor(){this.data=0,this.blendMode=te.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(i){!!(1&this.data)!==i&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(i){!!(2&this.data)!==i&&(this.data^=2)}get culling(){return!!(4&this.data)}set culling(i){!!(4&this.data)!==i&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(i){!!(8&this.data)!==i&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(i){!!(32&this.data)!==i&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(i){!!(16&this.data)!==i&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(i){this.blend=i!==te.NONE,this._blendMode=i}get polygonOffset(){return this._polygonOffset}set polygonOffset(i){this.offsets=!!i,this._polygonOffset=i}static for2d(){let i=new State;return i.depthTest=!1,i.blend=!0,i}};State.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};let ee=[];function autoDetectResource(i,m){if(!i)return null;let p="";if("string"==typeof i){let m=/\.(\w{3,4})(?:$|\?|#)/i.exec(i);m&&(p=m[1].toLowerCase())}for(let _=ee.length-1;_>=0;--_){let x=ee[_];if(x.test&&x.test(i,p))return new x(i,m)}throw Error("Unrecognized source type to auto-detect Resource")}let Runner_Runner=class Runner_Runner{constructor(i){this.items=[],this._name=i,this._aliasCount=0}emit(i,m,p,_,x,y,T,v){if(arguments.length>8)throw Error("max arguments reached");let{name:E,items:A}=this;this._aliasCount++;for(let S=0,I=A.length;S<I;S++)A[S][E](i,m,p,_,x,y,T,v);return A===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(i){return i[this._name]&&(this.ensureNonAliasedItems(),this.remove(i),this.items.push(i)),this}remove(i){let m=this.items.indexOf(i);return -1!==m&&(this.ensureNonAliasedItems(),this.items.splice(m,1)),this}contains(i){return this.items.includes(i)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return 0===this.items.length}get name(){return this._name}};Object.defineProperties(Runner_Runner.prototype,{dispatch:{value:Runner_Runner.prototype.emit},run:{value:Runner_Runner.prototype.emit}});let Resource=class Resource{constructor(i=0,m=0){this._width=i,this._height=m,this.destroyed=!1,this.internal=!1,this.onResize=new Runner_Runner("setRealSize"),this.onUpdate=new Runner_Runner("update"),this.onError=new Runner_Runner("onError")}bind(i){this.onResize.add(i),this.onUpdate.add(i),this.onError.add(i),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(i){this.onResize.remove(i),this.onUpdate.remove(i),this.onError.remove(i)}resize(i,m){(i!==this._width||m!==this._height)&&(this._width=i,this._height=m,this.onResize.emit(i,m))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(i,m,p){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(i,m){return!1}};let BufferResource=class BufferResource extends Resource{constructor(i,m){let{width:p,height:_}=m||{};if(!p||!_)throw Error("BufferResource width or height invalid");super(p,_),this.data=i,this.unpackAlignment=m.unpackAlignment??4}upload(i,m,p){let _=i.gl;_.pixelStorei(_.UNPACK_ALIGNMENT,this.unpackAlignment),_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m.alphaMode===tu.UNPACK);let x=m.realWidth,y=m.realHeight;return p.width===x&&p.height===y?_.texSubImage2D(m.target,0,0,0,x,y,m.format,p.type,this.data):(p.width=x,p.height=y,_.texImage2D(m.target,0,p.internalFormat,x,y,0,m.format,p.type,this.data)),!0}dispose(){this.data=null}static test(i){return null===i||i instanceof Int8Array||i instanceof Uint8Array||i instanceof Uint8ClampedArray||i instanceof Int16Array||i instanceof Uint16Array||i instanceof Int32Array||i instanceof Uint32Array||i instanceof Float32Array}};let er={scaleMode:to.NEAREST,alphaMode:tu.NPM},ei=class _BaseTexture2 extends tN{constructor(i=null,m=null){super(),m=Object.assign({},_BaseTexture2.defaultOptions,m);let{alphaMode:p,mipmap:_,anisotropicLevel:x,scaleMode:y,width:T,height:v,wrapMode:E,format:A,type:S,target:I,resolution:R,resourceOptions:C}=m;!i||i instanceof Resource||((i=autoDetectResource(i,C)).internal=!0),this.resolution=R||tx.RESOLUTION,this.width=Math.round((T||0)*this.resolution)/this.resolution,this.height=Math.round((v||0)*this.resolution)/this.resolution,this._mipmap=_,this.anisotropicLevel=x,this._wrapMode=E,this._scaleMode=y,this.format=A,this.type=S,this.target=I,this.alphaMode=p,this.uid=uid(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=T>0&&v>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(i)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(i){this._mipmap!==i&&(this._mipmap=i,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(i){this._scaleMode!==i&&(this._scaleMode=i,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(i){this._wrapMode!==i&&(this._wrapMode=i,this.dirtyStyleId++)}setStyle(i,m){let p;return void 0!==i&&i!==this.scaleMode&&(this.scaleMode=i,p=!0),void 0!==m&&m!==this.mipmap&&(this.mipmap=m,p=!0),p&&this.dirtyStyleId++,this}setSize(i,m,p){return p=p||this.resolution,this.setRealSize(i*p,m*p,p)}setRealSize(i,m,p){return this.resolution=p||this.resolution,this.width=Math.round(i)/this.resolution,this.height=Math.round(m)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=isPow2(this.realWidth)&&isPow2(this.realHeight)}setResolution(i){let m=this.resolution;return m===i||(this.resolution=i,this.valid&&(this.width=Math.round(this.width*m)/i,this.height=Math.round(this.height*m)/i,this.emit("update",this)),this._refreshPOT()),this}setResource(i){if(this.resource===i)return this;if(this.resource)throw Error("Resource can be set only once");return i.bind(this),this.resource=i,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(i){this.emit("error",this,i)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete t8[this.cacheId],delete t5[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),_BaseTexture2.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(i,m,p=tx.STRICT_TEXTURE_CACHE){let _="string"==typeof i,x=null;if(_)x=i;else{if(!i._pixiId){let p=m?.pixiIdPrefix||"pixiid";i._pixiId=`${p}_${uid()}`}x=i._pixiId}let y=t8[x];if(_&&p&&!y)throw Error(`The cacheId "${x}" does not exist in BaseTextureCache.`);return y||((y=new _BaseTexture2(i,m)).cacheId=x,_BaseTexture2.addToCache(y,x)),y}static fromBuffer(i,m,p,_){let x,y;i=i||new Float32Array(m*p*4);let T=new BufferResource(i,{width:m,height:p,..._?.resourceOptions});return i instanceof Float32Array?(x=ti.RGBA,y=tn.FLOAT):i instanceof Int32Array?(x=ti.RGBA_INTEGER,y=tn.INT):i instanceof Uint32Array?(x=ti.RGBA_INTEGER,y=tn.UNSIGNED_INT):i instanceof Int16Array?(x=ti.RGBA_INTEGER,y=tn.SHORT):i instanceof Uint16Array?(x=ti.RGBA_INTEGER,y=tn.UNSIGNED_SHORT):i instanceof Int8Array?(x=ti.RGBA,y=tn.BYTE):(x=ti.RGBA,y=tn.UNSIGNED_BYTE),T.internal=!0,new _BaseTexture2(T,Object.assign({},er,{type:y,format:x},_))}static addToCache(i,m){m&&(i.textureCacheIds.includes(m)||i.textureCacheIds.push(m),t8[m]&&t8[m]!==i&&console.warn(`BaseTexture added to the cache with an id [${m}] that already had an entry`),t8[m]=i)}static removeFromCache(i){if("string"==typeof i){let m=t8[i];if(m){let p=m.textureCacheIds.indexOf(i);return p>-1&&m.textureCacheIds.splice(p,1),delete t8[i],m}}else if(i?.textureCacheIds){for(let m=0;m<i.textureCacheIds.length;++m)delete t8[i.textureCacheIds[m]];return i.textureCacheIds.length=0,i}return null}};ei.defaultOptions={mipmap:th.POW2,anisotropicLevel:0,scaleMode:to.LINEAR,wrapMode:tl.CLAMP,alphaMode:tu.UNPACK,target:ts.TEXTURE_2D,format:ti.RGBA,type:tn.UNSIGNED_BYTE},ei._globalBatch=0;let es=ei;let BatchDrawCall=class BatchDrawCall{constructor(){this.texArray=null,this.blend=0,this.type=tr.TRIANGLES,this.start=0,this.size=0,this.data=null}};let en=0;let Buffer=class Buffer{constructor(i,m=!0,p=!1){this.data=i||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=p,this.static=m,this.id=en++,this.disposeRunner=new Runner_Runner("disposeBuffer")}update(i){i instanceof Array&&(i=new Float32Array(i)),this.data=i||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(i){this.type=i?t_.ELEMENT_ARRAY_BUFFER:t_.ARRAY_BUFFER}get index(){return this.type===t_.ELEMENT_ARRAY_BUFFER}static from(i){return i instanceof Array&&(i=new Float32Array(i)),new Buffer(i)}};let Attribute=class Attribute{constructor(i,m=0,p=!1,_=tn.FLOAT,x,y,T,v=1){this.buffer=i,this.size=m,this.normalized=p,this.type=_,this.stride=x,this.start=y,this.instance=T,this.divisor=v}destroy(){this.buffer=null}static from(i,m,p,_,x){return new Attribute(i,m,p,_,x)}};let ea={Float32Array,Uint32Array,Int32Array,Uint8Array};function interleaveTypedArrays_interleaveTypedArrays(i,m){let p=0,_=0,x={};for(let x=0;x<i.length;x++)_+=m[x],p+=i[x].length;let y=new ArrayBuffer(4*p),T=null,v=0;for(let p=0;p<i.length;p++){let E=m[p],A=i[p],S=getBufferType(A);x[S]||(x[S]=new ea[S](y)),T=x[S];for(let i=0;i<A.length;i++){let m=(i/E|0)*_+v,p=i%E;T[m+p]=A[i]}v+=E}return new Float32Array(y)}let eo={5126:4,5123:2,5121:1},el=0,eh={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};let Geometry=class Geometry{constructor(i=[],m={}){this.buffers=i,this.indexBuffer=null,this.attributes=m,this.glVertexArrayObjects={},this.id=el++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Runner_Runner("disposeGeometry"),this.refCount=0}addAttribute(i,m,p=0,_=!1,x,y,T,v=!1){if(!m)throw Error("You must pass a buffer when creating an attribute");m instanceof Buffer||(m instanceof Array&&(m=new Float32Array(m)),m=new Buffer(m));let E=i.split("|");if(E.length>1){for(let i=0;i<E.length;i++)this.addAttribute(E[i],m,p,_,x);return this}let A=this.buffers.indexOf(m);return -1===A&&(this.buffers.push(m),A=this.buffers.length-1),this.attributes[i]=new Attribute(A,p,_,x,y,T,v),this.instanced=this.instanced||v,this}getAttribute(i){return this.attributes[i]}getBuffer(i){return this.buffers[this.getAttribute(i).buffer]}addIndex(i){return i instanceof Buffer||(i instanceof Array&&(i=new Uint16Array(i)),i=new Buffer(i)),i.type=t_.ELEMENT_ARRAY_BUFFER,this.indexBuffer=i,this.buffers.includes(i)||this.buffers.push(i),this}getIndex(){return this.indexBuffer}interleave(){let i;if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;let m=[],p=[],_=new Buffer;for(i in this.attributes){let _=this.attributes[i],x=this.buffers[_.buffer];m.push(x.data),p.push(_.size*eo[_.type]/4),_.buffer=0}for(_.data=interleaveTypedArrays_interleaveTypedArrays(m,p),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[_],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let i in this.attributes){let m=this.attributes[i];return this.buffers[m.buffer].data.length/(m.stride/4||m.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){let i=new Geometry;for(let m=0;m<this.buffers.length;m++)i.buffers[m]=new Buffer(this.buffers[m].data.slice(0));for(let m in this.attributes){let p=this.attributes[m];i.attributes[m]=new Attribute(p.buffer,p.size,p.normalized,p.type,p.stride,p.start,p.instance)}return this.indexBuffer&&(i.indexBuffer=i.buffers[this.buffers.indexOf(this.indexBuffer)],i.indexBuffer.type=t_.ELEMENT_ARRAY_BUFFER),i}static merge(i){let m;let p=new Geometry,_=[],x=[],y=[];for(let p=0;p<i.length;p++){m=i[p];for(let i=0;i<m.buffers.length;i++)x[i]=x[i]||0,x[i]+=m.buffers[i].data.length,y[i]=0}for(let i=0;i<m.buffers.length;i++)_[i]=new eh[getBufferType(m.buffers[i].data)](x[i]),p.buffers[i]=new Buffer(_[i]);for(let p=0;p<i.length;p++){m=i[p];for(let i=0;i<m.buffers.length;i++)_[i].set(m.buffers[i].data,y[i]),y[i]+=m.buffers[i].data.length}if(p.attributes=m.attributes,m.indexBuffer){p.indexBuffer=p.buffers[m.buffers.indexOf(m.indexBuffer)],p.indexBuffer.type=t_.ELEMENT_ARRAY_BUFFER;let _=0,x=0,y=0,T=0;for(let i=0;i<m.buffers.length;i++)if(m.buffers[i]!==m.indexBuffer){T=i;break}for(let i in m.attributes){let p=m.attributes[i];(0|p.buffer)===T&&(x+=p.size*eo[p.type]/4)}for(let m=0;m<i.length;m++){let v=i[m].indexBuffer.data;for(let i=0;i<v.length;i++)p.indexBuffer.data[i+y]+=_;_+=i[m].buffers[T].data.length/x,y+=v.length}}return p}};let BatchGeometry=class BatchGeometry extends Geometry{constructor(i=!1){super(),this._buffer=new Buffer(null,i,!1),this._indexBuffer=new Buffer(null,i,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,tn.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,tn.FLOAT).addAttribute("aColor",this._buffer,4,!0,tn.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,tn.FLOAT).addIndex(this._indexBuffer)}};let eu=2*Math.PI,ed=180/Math.PI,ec=Math.PI/180;var em=((j=em||{})[j.POLY=0]="POLY",j[j.RECT=1]="RECT",j[j.CIRC=2]="CIRC",j[j.ELIP=3]="ELIP",j[j.RREC=4]="RREC",j);let Point=class Point{constructor(i=0,m=0){this.x=0,this.y=0,this.x=i,this.y=m}clone(){return new Point(this.x,this.y)}copyFrom(i){return this.set(i.x,i.y),this}copyTo(i){return i.set(this.x,this.y),i}equals(i){return i.x===this.x&&i.y===this.y}set(i=0,m=i){return this.x=i,this.y=m,this}};Point.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};let ef=[new Point,new Point,new Point,new Point];let Rectangle=class Rectangle{constructor(i=0,m=0,p=0,_=0){this.x=Number(i),this.y=Number(m),this.width=Number(p),this.height=Number(_),this.type=em.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Rectangle(0,0,0,0)}clone(){return new Rectangle(this.x,this.y,this.width,this.height)}copyFrom(i){return this.x=i.x,this.y=i.y,this.width=i.width,this.height=i.height,this}copyTo(i){return i.x=this.x,i.y=this.y,i.width=this.width,i.height=this.height,i}contains(i,m){return!(this.width<=0)&&!(this.height<=0)&&i>=this.x&&i<this.x+this.width&&m>=this.y&&m<this.y+this.height}intersects(i,m){if(!m){let m=this.x<i.x?i.x:this.x;if((this.right>i.right?i.right:this.right)<=m)return!1;let p=this.y<i.y?i.y:this.y;return(this.bottom>i.bottom?i.bottom:this.bottom)>p}let p=this.left,_=this.right,x=this.top,y=this.bottom;if(_<=p||y<=x)return!1;let T=ef[0].set(i.left,i.top),v=ef[1].set(i.left,i.bottom),E=ef[2].set(i.right,i.top),A=ef[3].set(i.right,i.bottom);if(E.x<=T.x||v.y<=T.y)return!1;let S=Math.sign(m.a*m.d-m.b*m.c);if(0===S||(m.apply(T,T),m.apply(v,v),m.apply(E,E),m.apply(A,A),Math.max(T.x,v.x,E.x,A.x)<=p||Math.min(T.x,v.x,E.x,A.x)>=_||Math.max(T.y,v.y,E.y,A.y)<=x||Math.min(T.y,v.y,E.y,A.y)>=y))return!1;let I=S*(v.y-T.y),R=S*(T.x-v.x),C=I*p+R*x,P=I*_+R*x,k=I*p+R*y,B=I*_+R*y;if(Math.max(C,P,k,B)<=I*T.x+R*T.y||Math.min(C,P,k,B)>=I*A.x+R*A.y)return!1;let D=S*(T.y-E.y),F=S*(E.x-T.x),L=D*p+F*x,O=D*_+F*x,V=D*p+F*y,U=D*_+F*y;return!(Math.max(L,O,V,U)<=D*T.x+F*T.y||Math.min(L,O,V,U)>=D*A.x+F*A.y)}pad(i=0,m=i){return this.x-=i,this.y-=m,this.width+=2*i,this.height+=2*m,this}fit(i){let m=Math.max(this.x,i.x),p=Math.min(this.x+this.width,i.x+i.width),_=Math.max(this.y,i.y),x=Math.min(this.y+this.height,i.y+i.height);return this.x=m,this.width=Math.max(p-m,0),this.y=_,this.height=Math.max(x-_,0),this}ceil(i=1,m=.001){let p=Math.ceil((this.x+this.width-m)*i)/i,_=Math.ceil((this.y+this.height-m)*i)/i;return this.x=Math.floor((this.x+m)*i)/i,this.y=Math.floor((this.y+m)*i)/i,this.width=p-this.x,this.height=_-this.y,this}enlarge(i){let m=Math.min(this.x,i.x),p=Math.max(this.x+this.width,i.x+i.width),_=Math.min(this.y,i.y),x=Math.max(this.y+this.height,i.y+i.height);return this.x=m,this.width=p-m,this.y=_,this.height=x-_,this}};Rectangle.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};let Circle=class Circle{constructor(i=0,m=0,p=0){this.x=i,this.y=m,this.radius=p,this.type=em.CIRC}clone(){return new Circle(this.x,this.y,this.radius)}contains(i,m){if(this.radius<=0)return!1;let p=this.radius*this.radius,_=this.x-i,x=this.y-m;return _*=_,x*=x,_+x<=p}getBounds(){return new Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}};Circle.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};let Ellipse=class Ellipse{constructor(i=0,m=0,p=0,_=0){this.x=i,this.y=m,this.width=p,this.height=_,this.type=em.ELIP}clone(){return new Ellipse(this.x,this.y,this.width,this.height)}contains(i,m){if(this.width<=0||this.height<=0)return!1;let p=(i-this.x)/this.width,_=(m-this.y)/this.height;return p*=p,_*=_,p+_<=1}getBounds(){return new Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)}};Ellipse.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};let Polygon=class Polygon{constructor(...i){let m=Array.isArray(i[0])?i[0]:i;if("number"!=typeof m[0]){let i=[];for(let p=0,_=m.length;p<_;p++)i.push(m[p].x,m[p].y);m=i}this.points=m,this.type=em.POLY,this.closeStroke=!0}clone(){let i=this.points.slice(),m=new Polygon(i);return m.closeStroke=this.closeStroke,m}contains(i,m){let p=!1,_=this.points.length/2;for(let x=0,y=_-1;x<_;y=x++){let _=this.points[2*x],T=this.points[2*x+1],v=this.points[2*y],E=this.points[2*y+1];T>m!=E>m&&i<(v-_)*((m-T)/(E-T))+_&&(p=!p)}return p}};Polygon.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((i,m)=>`${i}, ${m}`,"")}]`};let RoundedRectangle=class RoundedRectangle{constructor(i=0,m=0,p=0,_=0,x=20){this.x=i,this.y=m,this.width=p,this.height=_,this.radius=x,this.type=em.RREC}clone(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)}contains(i,m){if(this.width<=0||this.height<=0)return!1;if(i>=this.x&&i<=this.x+this.width&&m>=this.y&&m<=this.y+this.height){let p=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(m>=this.y+p&&m<=this.y+this.height-p||i>=this.x+p&&i<=this.x+this.width-p)return!0;let _=i-(this.x+p),x=m-(this.y+p),y=p*p;if(_*_+x*x<=y||(_=i-(this.x+this.width-p))*_+x*x<=y||_*_+(x=m-(this.y+this.height-p))*x<=y||(_=i-(this.x+p))*_+x*x<=y)return!0}return!1}};RoundedRectangle.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};let Matrix=class Matrix{constructor(i=1,m=0,p=0,_=1,x=0,y=0){this.array=null,this.a=i,this.b=m,this.c=p,this.d=_,this.tx=x,this.ty=y}fromArray(i){this.a=i[0],this.b=i[1],this.c=i[3],this.d=i[4],this.tx=i[2],this.ty=i[5]}set(i,m,p,_,x,y){return this.a=i,this.b=m,this.c=p,this.d=_,this.tx=x,this.ty=y,this}toArray(i,m){this.array||(this.array=new Float32Array(9));let p=m||this.array;return i?(p[0]=this.a,p[1]=this.b,p[2]=0,p[3]=this.c,p[4]=this.d,p[5]=0,p[6]=this.tx,p[7]=this.ty):(p[0]=this.a,p[1]=this.c,p[2]=this.tx,p[3]=this.b,p[4]=this.d,p[5]=this.ty,p[6]=0,p[7]=0),p[8]=1,p}apply(i,m){m=m||new Point;let p=i.x,_=i.y;return m.x=this.a*p+this.c*_+this.tx,m.y=this.b*p+this.d*_+this.ty,m}applyInverse(i,m){m=m||new Point;let p=1/(this.a*this.d+-(this.c*this.b)),_=i.x,x=i.y;return m.x=this.d*p*_+-this.c*p*x+(this.ty*this.c-this.tx*this.d)*p,m.y=this.a*p*x+-this.b*p*_+(-this.ty*this.a+this.tx*this.b)*p,m}translate(i,m){return this.tx+=i,this.ty+=m,this}scale(i,m){return this.a*=i,this.d*=m,this.c*=i,this.b*=m,this.tx*=i,this.ty*=m,this}rotate(i){let m=Math.cos(i),p=Math.sin(i),_=this.a,x=this.c,y=this.tx;return this.a=_*m-this.b*p,this.b=_*p+this.b*m,this.c=x*m-this.d*p,this.d=x*p+this.d*m,this.tx=y*m-this.ty*p,this.ty=y*p+this.ty*m,this}append(i){let m=this.a,p=this.b,_=this.c,x=this.d;return this.a=i.a*m+i.b*_,this.b=i.a*p+i.b*x,this.c=i.c*m+i.d*_,this.d=i.c*p+i.d*x,this.tx=i.tx*m+i.ty*_+this.tx,this.ty=i.tx*p+i.ty*x+this.ty,this}setTransform(i,m,p,_,x,y,T,v,E){return this.a=Math.cos(T+E)*x,this.b=Math.sin(T+E)*x,this.c=-Math.sin(T-v)*y,this.d=Math.cos(T-v)*y,this.tx=i-(p*this.a+_*this.c),this.ty=m-(p*this.b+_*this.d),this}prepend(i){let m=this.tx;if(1!==i.a||0!==i.b||0!==i.c||1!==i.d){let m=this.a,p=this.c;this.a=m*i.a+this.b*i.c,this.b=m*i.b+this.b*i.d,this.c=p*i.a+this.d*i.c,this.d=p*i.b+this.d*i.d}return this.tx=m*i.a+this.ty*i.c+i.tx,this.ty=m*i.b+this.ty*i.d+i.ty,this}decompose(i){let m=this.a,p=this.b,_=this.c,x=this.d,y=i.pivot,T=-Math.atan2(-_,x),v=Math.atan2(p,m),E=Math.abs(T+v);return E<1e-5||1e-5>Math.abs(eu-E)?(i.rotation=v,i.skew.x=i.skew.y=0):(i.rotation=0,i.skew.x=T,i.skew.y=v),i.scale.x=Math.sqrt(m*m+p*p),i.scale.y=Math.sqrt(_*_+x*x),i.position.x=this.tx+(y.x*m+y.y*_),i.position.y=this.ty+(y.x*p+y.y*x),i}invert(){let i=this.a,m=this.b,p=this.c,_=this.d,x=this.tx,y=i*_-m*p;return this.a=_/y,this.b=-m/y,this.c=-p/y,this.d=i/y,this.tx=(p*this.ty-_*x)/y,this.ty=-(i*this.ty-m*x)/y,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let i=new Matrix;return i.a=this.a,i.b=this.b,i.c=this.c,i.d=this.d,i.tx=this.tx,i.ty=this.ty,i}copyTo(i){return i.a=this.a,i.b=this.b,i.c=this.c,i.d=this.d,i.tx=this.tx,i.ty=this.ty,i}copyFrom(i){return this.a=i.a,this.b=i.b,this.c=i.c,this.d=i.d,this.tx=i.tx,this.ty=i.ty,this}static get IDENTITY(){return new Matrix}static get TEMP_MATRIX(){return new Matrix}};Matrix.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};let ep=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],eg=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],e_=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ex=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ey=[],eb=[],eT=Math.sign;!function(){for(let i=0;i<16;i++){let m=[];ey.push(m);for(let p=0;p<16;p++){let _=eT(ep[i]*ep[p]+e_[i]*eg[p]),x=eT(eg[i]*ep[p]+ex[i]*eg[p]),y=eT(ep[i]*e_[p]+e_[i]*ex[p]),T=eT(eg[i]*e_[p]+ex[i]*ex[p]);for(let i=0;i<16;i++)if(ep[i]===_&&eg[i]===x&&e_[i]===y&&ex[i]===T){m.push(i);break}}}for(let i=0;i<16;i++){let m=new Matrix;m.set(ep[i],eg[i],e_[i],ex[i],0,0),eb.push(m)}}();let ev={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>ep[i],uY:i=>eg[i],vX:i=>e_[i],vY:i=>ex[i],inv:i=>8&i?15&i:7&-i,add:(i,m)=>ey[i][m],sub:(i,m)=>ey[i][ev.inv(m)],rotate180:i=>4^i,isVertical:i=>(3&i)==2,byDirection:(i,m)=>2*Math.abs(i)<=Math.abs(m)?m>=0?ev.S:ev.N:2*Math.abs(m)<=Math.abs(i)?i>0?ev.E:ev.W:m>0?i>0?ev.SE:ev.SW:i>0?ev.NE:ev.NW,matrixAppendRotationInv:(i,m,p=0,_=0)=>{let x=eb[ev.inv(m)];x.tx=p,x.ty=_,i.append(x)}};let ObservablePoint=class ObservablePoint{constructor(i,m,p=0,_=0){this._x=p,this._y=_,this.cb=i,this.scope=m}clone(i=this.cb,m=this.scope){return new ObservablePoint(i,m,this._x,this._y)}set(i=0,m=i){return(this._x!==i||this._y!==m)&&(this._x=i,this._y=m,this.cb.call(this.scope)),this}copyFrom(i){return(this._x!==i.x||this._y!==i.y)&&(this._x=i.x,this._y=i.y,this.cb.call(this.scope)),this}copyTo(i){return i.set(this._x,this._y),i}equals(i){return i.x===this._x&&i.y===this._y}get x(){return this._x}set x(i){this._x!==i&&(this._x=i,this.cb.call(this.scope))}get y(){return this._y}set y(i){this._y!==i&&(this._y=i,this.cb.call(this.scope))}};ObservablePoint.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};let eE=class{constructor(){this.worldTransform=new Matrix,this.localTransform=new Matrix,this.position=new ObservablePoint(this.onChange,this,0,0),this.scale=new ObservablePoint(this.onChange,this,1,1),this.pivot=new ObservablePoint(this.onChange,this,0,0),this.skew=new ObservablePoint(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){let i=this.localTransform;this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(i){let m=this.localTransform;if(this._localID!==this._currentLocalID&&(m.a=this._cx*this.scale.x,m.b=this._sx*this.scale.x,m.c=this._cy*this.scale.y,m.d=this._sy*this.scale.y,m.tx=this.position.x-(this.pivot.x*m.a+this.pivot.y*m.c),m.ty=this.position.y-(this.pivot.x*m.b+this.pivot.y*m.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==i._worldID){let p=i.worldTransform,_=this.worldTransform;_.a=m.a*p.a+m.b*p.c,_.b=m.a*p.b+m.b*p.d,_.c=m.c*p.a+m.d*p.c,_.d=m.c*p.b+m.d*p.d,_.tx=m.tx*p.a+m.ty*p.c+p.tx,_.ty=m.tx*p.b+m.ty*p.d+p.ty,this._parentID=i._worldID,this._worldID++}}setFromMatrix(i){i.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(i){this._rotation!==i&&(this._rotation=i,this.updateSkew())}};eE.IDENTITY=new eE;let eA=eE;eA.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var eS=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,ew=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;let eI=[{test:i=>"float"===i.type&&1===i.size&&!i.isArray,code:i=>`
            if(uv["${i}"] !== ud["${i}"].value)
            {
                ud["${i}"].value = uv["${i}"]
                gl.uniform1f(ud["${i}"].location, uv["${i}"])
            }
            `},{test:(i,m)=>("sampler2D"===i.type||"samplerCube"===i.type||"sampler2DArray"===i.type)&&1===i.size&&!i.isArray&&(null==m||void 0!==m.castToBaseTexture),code:i=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${i}"], t);

            if(ud["${i}"].value !== t)
            {
                ud["${i}"].value = t;
                gl.uniform1i(ud["${i}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(i,m)=>"mat3"===i.type&&1===i.size&&!i.isArray&&void 0!==m.a,code:i=>`
            gl.uniformMatrix3fv(ud["${i}"].location, false, uv["${i}"].toArray(true));
            `,codeUbo:i=>`
                var ${i}_matrix = uv.${i}.toArray(true);

                data[offset] = ${i}_matrix[0];
                data[offset+1] = ${i}_matrix[1];
                data[offset+2] = ${i}_matrix[2];
        
                data[offset + 4] = ${i}_matrix[3];
                data[offset + 5] = ${i}_matrix[4];
                data[offset + 6] = ${i}_matrix[5];
        
                data[offset + 8] = ${i}_matrix[6];
                data[offset + 9] = ${i}_matrix[7];
                data[offset + 10] = ${i}_matrix[8];
            `},{test:(i,m)=>"vec2"===i.type&&1===i.size&&!i.isArray&&void 0!==m.x,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${i}"].location, v.x, v.y);
                }`,codeUbo:i=>`
                v = uv.${i};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:i=>"vec2"===i.type&&1===i.size&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${i}"].location, v[0], v[1]);
                }
            `},{test:(i,m)=>"vec4"===i.type&&1===i.size&&!i.isArray&&void 0!==m.width,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${i}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(i,m)=>"vec4"===i.type&&1===i.size&&!i.isArray&&void 0!==m.red,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${i}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(i,m)=>"vec3"===i.type&&1===i.size&&!i.isArray&&void 0!==m.red,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${i}"].location, v.red, v.green, v.blue)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:i=>"vec4"===i.type&&1===i.size&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${i}"].location, v[0], v[1], v[2], v[3])
                }`}],eR={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},eM={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function generateUniformsSync(i,m){let p=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let _ in i.uniforms){let x=m[_];if(!x){i.uniforms[_]?.group===!0&&(i.uniforms[_].ubo?p.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${_}, '${_}');
                    `):p.push(`
                        renderer.shader.syncUniformGroup(uv.${_}, syncData);
                    `));continue}let y=i.uniforms[_],T=!1;for(let i=0;i<eI.length;i++)if(eI[i].test(x,y)){p.push(eI[i].code(_,y)),T=!0;break}if(!T){let i=(1!==x.size||x.isArray?eM:eR)[x.type].replace("location",`ud["${_}"].location`);p.push(`
            cu = ud["${_}"];
            cv = cu.value;
            v = uv["${_}"];
            ${i};`)}}return Function("ud","uv","renderer","syncData",p.join(`
`))}let eC={},eP=eC;function getTestContext(){if(eP===eC||eP?.isContextLost()){let i;let m=tx.ADAPTER.createCanvas();tx.PREFER_ENV>=J.WEBGL2&&(i=m.getContext("webgl2",{})),i||((i=m.getContext("webgl",{})||m.getContext("experimental-webgl",{}))?i.getExtension("WEBGL_draw_buffers"):i=null),eP=i}return eP}function getMaxFragmentPrecision(){if(!y){y=tm.MEDIUM;let i=getTestContext();if(i&&i.getShaderPrecisionFormat){let m=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);m&&(y=m.precision?tm.HIGH:tm.MEDIUM)}}return y}let ek={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},eB=null,eD={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType(i,m){if(!eB){let m=Object.keys(eD);eB={};for(let p=0;p<m.length;++p){let _=m[p];eB[i[_]]=eD[_]}}return eB[m]}function setPrecision(i,m,p){if("precision"!==i.substring(0,9)){let _=m;return m===tm.HIGH&&p!==tm.HIGH&&(_=tm.MEDIUM),`precision ${_} float;
${i}`}return p!==tm.HIGH&&"precision highp"===i.substring(0,15)?i.replace("precision highp","precision mediump"):i}let eF=0,eN={},eL=class _Program2{constructor(i,m,p="pixi-shader",_={}){this.extra={},this.id=eF++,this.vertexSrc=i||_Program2.defaultVertexSrc,this.fragmentSrc=m||_Program2.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=_,"#version"!==this.vertexSrc.substring(0,8)&&(eN[p=p.replace(/\s+/g,"-")]?(eN[p]++,p+=`-${eN[p]}`):eN[p]=1,this.vertexSrc=`#define SHADER_NAME ${p}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${p}
${this.fragmentSrc}`,this.vertexSrc=setPrecision(this.vertexSrc,_Program2.defaultVertexPrecision,tm.HIGH),this.fragmentSrc=setPrecision(this.fragmentSrc,_Program2.defaultFragmentPrecision,getMaxFragmentPrecision())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return ew}static get defaultFragmentSrc(){return eS}static from(i,m,p){let _=i+m,x=t6[_];return x||(t6[_]=x=new _Program2(i,m,p)),x}};eL.defaultVertexPrecision=tm.HIGH,eL.defaultFragmentPrecision=tF.apple.device?tm.HIGH:tm.MEDIUM;let eO=eL,eV=0;let UniformGroup=class UniformGroup{constructor(i,m,p){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=eV++,this.static=!!m,this.ubo=!!p,i instanceof Buffer?(this.buffer=i,this.buffer.type=t_.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=i,this.ubo&&(this.buffer=new Buffer(new Float32Array(1)),this.buffer.type=t_.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(i,m,p){if(this.ubo)throw Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[i]=new UniformGroup(m,p)}static from(i,m,p){return new UniformGroup(i,m,p)}static uboFrom(i,m){return new UniformGroup(i,m??!0,!0)}};let Shader=class Shader{constructor(i,m){this.uniformBindCount=0,this.program=i,m?m instanceof UniformGroup?this.uniformGroup=m:this.uniformGroup=new UniformGroup(m):this.uniformGroup=new UniformGroup({}),this.disposeRunner=new Runner_Runner("disposeShader")}checkUniformExists(i,m){if(m.uniforms[i])return!0;for(let p in m.uniforms){let _=m.uniforms[p];if(!0===_.group&&this.checkUniformExists(i,_))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(i,m,p){let _=eO.from(i,m);return new Shader(_,p)}};let BatchShaderGenerator=class BatchShaderGenerator{constructor(i,m){if(this.vertexSrc=i,this.fragTemplate=m,this.programCache={},this.defaultGroupCache={},!m.includes("%count%"))throw Error('Fragment template must contain "%count%".');if(!m.includes("%forloop%"))throw Error('Fragment template must contain "%forloop%".')}generateShader(i){if(!this.programCache[i]){let m=new Int32Array(i);for(let p=0;p<i;p++)m[p]=p;this.defaultGroupCache[i]=UniformGroup.from({uSamplers:m},!0);let p=this.fragTemplate;p=(p=p.replace(/%count%/gi,`${i}`)).replace(/%forloop%/gi,this.generateSampleSrc(i)),this.programCache[i]=new eO(this.vertexSrc,p)}let m={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:this.defaultGroupCache[i]};return new Shader(this.programCache[i],m)}generateSampleSrc(i){let m="";m+=`

`;for(let p=0;p<i;p++)p>0&&(m+=`
else `),p<i-1&&(m+=`if(vTextureId < ${p}.5)`),m+=`
{
	color = texture2D(uSamplers[${p}], vTextureCoord);
}`;return m+`

`}};let BatchTextureArray=class BatchTextureArray{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let i=0;i<this.count;i++)this.elements[i]=null;this.count=0}};function canUploadSameBuffer(){return!tF.apple.device}function maxRecommendedTextures(i){let m=!0,p=tx.ADAPTER.getNavigator();if(tF.tablet||tF.phone){if(tF.apple.device){let i=p.userAgent.match(/OS (\d+)_(\d+)?/);i&&11>parseInt(i[1],10)&&(m=!1)}if(tF.android.device){let i=p.userAgent.match(/Android\s([0-9.]*)/);i&&7>parseInt(i[1],10)&&(m=!1)}}return m?i:4}let ObjectRenderer=class ObjectRenderer{constructor(i){this.renderer=i}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(i){}};var eU=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,eX=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;let eY=class _BatchRenderer2 extends ObjectRenderer{constructor(i){super(i),this.setShaderGenerator(),this.geometryClass=BatchGeometry,this.vertexSize=6,this.state=State.for2d(),this.size=4*_BatchRenderer2.defaultBatchSize,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),i.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??maxRecommendedTextures(32),this._defaultMaxTextures}static set defaultMaxTextures(i){this._defaultMaxTextures=i}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??canUploadSameBuffer(),this._canUploadSameBuffer}static set canUploadSameBuffer(i){this._canUploadSameBuffer=i}get MAX_TEXTURES(){return deprecation("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return eX}static get defaultFragmentTemplate(){return eU}setShaderGenerator({vertex:i=_BatchRenderer2.defaultVertexSrc,fragment:m=_BatchRenderer2.defaultFragmentTemplate}={}){this.shaderGenerator=new BatchShaderGenerator(i,m)}contextChange(){let i=this.renderer.gl;tx.PREFER_ENV===J.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),_BatchRenderer2.defaultMaxTextures),this.maxTextures=checkMaxIfStatementsInShader(this.maxTextures,i)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){let{_drawCallPool:i,_textureArrayPool:m}=_BatchRenderer2,p=this.size/4,_=Math.floor(p/this.maxTextures)+1;for(;i.length<p;)i.push(new BatchDrawCall);for(;m.length<_;)m.push(new BatchTextureArray);for(let i=0;i<this.maxTextures;i++)this._tempBoundTextures[i]=null}onPrerender(){this._flushId=0}render(i){i._texture.valid&&(this._vertexCount+i.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=i.vertexData.length/2,this._indexCount+=i.indices.length,this._bufferedTextures[this._bufferSize]=i._texture.baseTexture,this._bufferedElements[this._bufferSize++]=i)}buildTexturesAndDrawCalls(){let{_bufferedTextures:i,maxTextures:m}=this,p=_BatchRenderer2._textureArrayPool,_=this.renderer.batch,x=this._tempBoundTextures,y=this.renderer.textureGC.count,T=++es._globalBatch,v=0,E=p[0],A=0;_.copyBoundTextures(x,m);for(let S=0;S<this._bufferSize;++S){let I=i[S];i[S]=null,I._batchEnabled!==T&&(E.count>=m&&(_.boundArray(E,x,T,m),this.buildDrawCalls(E,A,S),A=S,E=p[++v],++T),I._batchEnabled=T,I.touched=y,E.elements[E.count++]=I)}E.count>0&&(_.boundArray(E,x,T,m),this.buildDrawCalls(E,A,this._bufferSize),++v,++T);for(let i=0;i<x.length;i++)x[i]=null;es._globalBatch=T}buildDrawCalls(i,m,p){let{_bufferedElements:_,_attributeBuffer:x,_indexBuffer:y,vertexSize:T}=this,v=_BatchRenderer2._drawCallPool,E=this._dcIndex,A=this._aIndex,S=this._iIndex,I=v[E];I.start=this._iIndex,I.texArray=i;for(let R=m;R<p;++R){let p=_[R],C=p._texture.baseTexture,P=tQ[C.alphaMode?1:0][p.blendMode];_[R]=null,m<R&&I.blend!==P&&(I.size=S-I.start,m=R,(I=v[++E]).texArray=i,I.start=S),this.packInterleavedGeometry(p,x,y,A,S),A+=p.vertexData.length/2*T,S+=p.indices.length,I.blend=P}m<p&&(I.size=S-I.start,++E),this._dcIndex=E,this._aIndex=A,this._iIndex=S}bindAndClearTexArray(i){let m=this.renderer.texture;for(let p=0;p<i.count;p++)m.bind(i.elements[p],i.ids[p]),i.elements[p]=null;i.count=0}updateGeometry(){let{_packedGeometries:i,_attributeBuffer:m,_indexBuffer:p}=this;_BatchRenderer2.canUploadSameBuffer?(i[this._flushId]._buffer.update(m.rawBinaryData),i[this._flushId]._indexBuffer.update(p),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,i[this._flushId]=new this.geometryClass),i[this._flushId]._buffer.update(m.rawBinaryData),i[this._flushId]._indexBuffer.update(p),this.renderer.geometry.bind(i[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){let i=this._dcIndex,{gl:m,state:p}=this.renderer,_=_BatchRenderer2._drawCallPool,x=null;for(let y=0;y<i;y++){let{texArray:i,type:T,size:v,start:E,blend:A}=_[y];x!==i&&(x=i,this.bindAndClearTexArray(i)),this.state.blendMode=A,p.set(this.state),m.drawElements(T,v,m.UNSIGNED_SHORT,2*E)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),_BatchRenderer2.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]&&this._packedGeometries[i].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(i){let m=nextPow2(Math.ceil(i/8)),p=log2(m),_=8*m;this._aBuffers.length<=p&&(this._iBuffers.length=p+1);let x=this._aBuffers[_];return x||(this._aBuffers[_]=x=new ViewableBuffer(_*this.vertexSize*4)),x}getIndexBuffer(i){let m=nextPow2(Math.ceil(i/12)),p=log2(m),_=12*m;this._iBuffers.length<=p&&(this._iBuffers.length=p+1);let x=this._iBuffers[p];return x||(this._iBuffers[p]=x=new Uint16Array(_)),x}packInterleavedGeometry(i,m,p,_,x){let{uint32View:y,float32View:T}=m,v=_/this.vertexSize,E=i.uvs,A=i.indices,S=i.vertexData,I=i._texture.baseTexture._batchLocation,R=Math.min(i.worldAlpha,1),C=tJ.shared.setValue(i._tintRGB).toPremultiplied(R,i._texture.baseTexture.alphaMode>0);for(let i=0;i<S.length;i+=2)T[_++]=S[i],T[_++]=S[i+1],T[_++]=E[i],T[_++]=E[i+1],y[_++]=C,T[_++]=I;for(let i=0;i<A.length;i++)p[x++]=v+A[i]}};eY.defaultBatchSize=4096,eY.extension={name:"batch",type:t9.RendererPlugin},eY._drawCallPool=[],eY._textureArrayPool=[],t7.add(eY);var eG=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,eH=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;let eW=class _Filter2 extends Shader{constructor(i,m,p){let _=eO.from(i||_Filter2.defaultVertexSrc,m||_Filter2.defaultFragmentSrc);super(_,p),this.padding=0,this.resolution=_Filter2.defaultResolution,this.multisample=_Filter2.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new State}apply(i,m,p,_,x){i.applyFilter(this,m,p,_)}get blendMode(){return this.state.blendMode}set blendMode(i){this.state.blendMode=i}get resolution(){return this._resolution}set resolution(i){this._resolution=i}static get defaultVertexSrc(){return eH}static get defaultFragmentSrc(){return eG}};eW.defaultResolution=1,eW.defaultMultisample=tg.NONE;let e$=eW;let BackgroundSystem=class BackgroundSystem{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new tJ(0),this.alpha=1}init(i){this.clearBeforeRender=i.clearBeforeRender;let{backgroundColor:m,background:p,backgroundAlpha:_}=i,x=p??m;void 0!==x&&(this.color=x),this.alpha=_}get color(){return this._backgroundColor.value}set color(i){this._backgroundColor.setValue(i)}get alpha(){return this._backgroundColor.alpha}set alpha(i){this._backgroundColor.setAlpha(i)}get backgroundColor(){return this._backgroundColor}destroy(){}};BackgroundSystem.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},BackgroundSystem.extension={type:[t9.RendererSystem,t9.CanvasRendererSystem],name:"background"},t7.add(BackgroundSystem);let BatchSystem=class BatchSystem{constructor(i){this.renderer=i,this.emptyRenderer=new ObjectRenderer(i),this.currentRenderer=this.emptyRenderer}setObjectRenderer(i){this.currentRenderer!==i&&(this.currentRenderer.stop(),this.currentRenderer=i,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(i,m){let{boundTextures:p}=this.renderer.texture;for(let _=m-1;_>=0;--_)i[_]=p[_]||null,i[_]&&(i[_]._batchLocation=_)}boundArray(i,m,p,_){let{elements:x,ids:y,count:T}=i,v=0;for(let i=0;i<T;i++){let T=x[i],E=T._batchLocation;if(E>=0&&E<_&&m[E]===T){y[i]=E;continue}for(;v<_;){let _=m[v];if(_&&_._batchEnabled===p&&_._batchLocation===v){v++;continue}y[i]=v,T._batchLocation=v,m[v]=T;break}}}destroy(){this.renderer=null}};BatchSystem.extension={type:t9.RendererSystem,name:"batch"},t7.add(BatchSystem);let ez=0;let ContextSystem=class ContextSystem{constructor(i){this.renderer=i,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(i){this.gl=i,this.renderer.gl=i,this.renderer.CONTEXT_UID=ez++}init(i){if(i.context)this.initFromContext(i.context);else{let m=this.renderer.background.alpha<1,p=i.premultipliedAlpha;this.preserveDrawingBuffer=i.preserveDrawingBuffer,this.useContextAlpha=i.useContextAlpha,this.powerPreference=i.powerPreference,this.initFromOptions({alpha:m,premultipliedAlpha:p,antialias:i.antialias,stencil:!0,preserveDrawingBuffer:i.preserveDrawingBuffer,powerPreference:i.powerPreference})}}initFromContext(i){this.gl=i,this.validateContext(i),this.renderer.gl=i,this.renderer.CONTEXT_UID=ez++,this.renderer.runners.contextChange.emit(i);let m=this.renderer.view;void 0!==m.addEventListener&&(m.addEventListener("webglcontextlost",this.handleContextLost,!1),m.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(i){let m=this.createContext(this.renderer.view,i);this.initFromContext(m)}createContext(i,m){let p;if(tx.PREFER_ENV>=J.WEBGL2&&(p=i.getContext("webgl2",m)),p)this.webGLVersion=2;else if(this.webGLVersion=1,!(p=i.getContext("webgl",m)||i.getContext("experimental-webgl",m)))throw Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=p,this.getExtensions(),this.gl}getExtensions(){let{gl:i}=this,m={loseContext:i.getExtension("WEBGL_lose_context"),anisotropicFiltering:i.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:i.getExtension("OES_texture_float_linear"),s3tc:i.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:i.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:i.getExtension("WEBGL_compressed_texture_etc"),etc1:i.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:i.getExtension("WEBGL_compressed_texture_atc"),astc:i.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,m,{drawBuffers:i.getExtension("WEBGL_draw_buffers"),depthTexture:i.getExtension("WEBGL_depth_texture"),vertexArrayObject:i.getExtension("OES_vertex_array_object")||i.getExtension("MOZ_OES_vertex_array_object")||i.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:i.getExtension("OES_element_index_uint"),floatTexture:i.getExtension("OES_texture_float"),floatTextureLinear:i.getExtension("OES_texture_float_linear"),textureHalfFloat:i.getExtension("OES_texture_half_float"),textureHalfFloatLinear:i.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,m,{colorBufferFloat:i.getExtension("EXT_color_buffer_float")})}handleContextLost(i){i.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){let i=this.renderer.view;this.renderer=null,void 0!==i.removeEventListener&&(i.removeEventListener("webglcontextlost",this.handleContextLost),i.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(i){let m=i.getContextAttributes(),p="WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext;p&&(this.webGLVersion=2),m&&!m.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");let _=p||!!i.getExtension("OES_element_index_uint");this.supports.uint32Indices=_,_||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}};ContextSystem.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},ContextSystem.extension={type:t9.RendererSystem,name:"context"},t7.add(ContextSystem);let Framebuffer=class Framebuffer{constructor(i,m){if(this.width=Math.round(i),this.height=Math.round(m),!this.width||!this.height)throw Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Runner_Runner("disposeFramebuffer"),this.multisample=tg.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(i=0,m){return this.colorTextures[i]=m||new es(null,{scaleMode:to.NEAREST,resolution:1,mipmap:th.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(i){return this.depthTexture=i||new es(null,{scaleMode:to.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:th.OFF,format:ti.DEPTH_COMPONENT,type:tn.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(i,m){if(i=Math.round(i),m=Math.round(m),!i||!m)throw Error("Framebuffer width and height must not be zero");if(!(i===this.width&&m===this.height)){this.width=i,this.height=m,this.dirtyId++,this.dirtySize++;for(let p=0;p<this.colorTextures.length;p++){let _=this.colorTextures[p],x=_.resolution;_.setSize(i/x,m/x)}if(this.depthTexture){let p=this.depthTexture.resolution;this.depthTexture.setSize(i/p,m/p)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}};let BaseRenderTexture=class BaseRenderTexture extends es{constructor(i={}){if("number"==typeof i){let m=arguments[0],p=arguments[1],_=arguments[2],x=arguments[3];i={width:m,height:p,scaleMode:_,resolution:x}}i.width=i.width??100,i.height=i.height??100,i.multisample??(i.multisample=tg.NONE),super(null,i),this.mipmap=th.OFF,this.valid=!0,this._clear=new tJ([0,0,0,0]),this.framebuffer=new Framebuffer(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=i.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(i){this._clear.setValue(i)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(i){this.framebuffer.multisample=i}resize(i,m){this.framebuffer.resize(i*this.resolution,m*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}};let BaseImageResource=class BaseImageResource extends Resource{constructor(i){let m=i.naturalWidth||i.videoWidth||i.width,p=i.naturalHeight||i.videoHeight||i.height;super(m,p),this.source=i,this.noSubImage=!1}static crossOrigin(i,m,p){void 0!==p||m.startsWith("data:")?!1!==p&&(i.crossOrigin="string"==typeof p?p:"anonymous"):i.crossOrigin=determineCrossOrigin(m)}upload(i,m,p,_){let x=i.gl,y=m.realWidth,T=m.realHeight;if(_=_||this.source,"u">typeof HTMLImageElement&&_ instanceof HTMLImageElement){if(!_.complete||0===_.naturalWidth)return!1}else if("u">typeof HTMLVideoElement&&_ instanceof HTMLVideoElement&&_.readyState<=1)return!1;return x.pixelStorei(x.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m.alphaMode===tu.UNPACK),this.noSubImage||m.target!==x.TEXTURE_2D||p.width!==y||p.height!==T?(p.width=y,p.height=T,x.texImage2D(m.target,0,p.internalFormat,m.format,p.type,_)):x.texSubImage2D(x.TEXTURE_2D,0,0,0,m.format,p.type,_),!0}update(){if(this.destroyed)return;let i=this.source,m=i.naturalWidth||i.videoWidth||i.width,p=i.naturalHeight||i.videoHeight||i.height;this.resize(m,p),super.update()}dispose(){this.source=null}};let ImageResource=class ImageResource extends BaseImageResource{constructor(i,m){if(m=m||{},"string"==typeof i){let p=new Image;BaseImageResource.crossOrigin(p,i,m.crossorigin),p.src=i,i=p}super(i),!i.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=i.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(m.createBitmap??tx.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof m.alphaMode?m.alphaMode:null,this.bitmap=null,this._load=null,!1!==m.autoLoad&&this.load()}load(i){return this._load||(void 0!==i&&(this.createBitmap=i),this._load=new Promise((i,m)=>{let p=this.source;this.url=p.src;let completed=()=>{this.destroyed||(p.onload=null,p.onerror=null,this.update(),this._load=null,this.createBitmap?i(this.process()):i(this))};p.complete&&p.src?completed():(p.onload=completed,p.onerror=i=>{m(i),this.onError.emit(i)})})),this._load}process(){let i=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);let m=globalThis.createImageBitmap,p=!i.crossOrigin||"anonymous"===i.crossOrigin;return this._process=fetch(i.src,{mode:p?"cors":"no-cors"}).then(i=>i.blob()).then(p=>m(p,0,0,i.width,i.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===tu.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(i,m,p){if("number"==typeof this.alphaMode&&(m.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(i,m,p);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(i,m,p,this.bitmap),!this.preserveBitmap){let i=!0,_=m._glTextures;for(let x in _){let y=_[x];if(y!==p&&y.dirtyId!==m.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(i){return"u">typeof HTMLImageElement&&("string"==typeof i||i instanceof HTMLImageElement)}};let TextureUvs=class TextureUvs{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(i,m,p){let _=m.width,x=m.height;if(p){let m=i.width/2/_,y=i.height/2/x,T=i.x/_+m,v=i.y/x+y;p=ev.add(p,ev.NW),this.x0=T+m*ev.uX(p),this.y0=v+y*ev.uY(p),p=ev.add(p,2),this.x1=T+m*ev.uX(p),this.y1=v+y*ev.uY(p),p=ev.add(p,2),this.x2=T+m*ev.uX(p),this.y2=v+y*ev.uY(p),p=ev.add(p,2),this.x3=T+m*ev.uX(p),this.y3=v+y*ev.uY(p)}else this.x0=i.x/_,this.y0=i.y/x,this.x1=(i.x+i.width)/_,this.y1=i.y/x,this.x2=(i.x+i.width)/_,this.y2=(i.y+i.height)/x,this.x3=i.x/_,this.y3=(i.y+i.height)/x;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}};TextureUvs.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};let ej=new TextureUvs;function removeAllHandlers(i){i.destroy=function(){},i.on=function(){},i.once=function(){},i.emit=function(){}}let Texture=class Texture extends tN{constructor(i,m,p,_,x,y,T){if(super(),this.noFrame=!1,m||(this.noFrame=!0,m=new Rectangle(0,0,1,1)),i instanceof Texture&&(i=i.baseTexture),this.baseTexture=i,this._frame=m,this.trim=_,this.valid=!1,this.destroyed=!1,this._uvs=ej,this.uvMatrix=null,this.orig=p||m,this._rotate=Number(x||0),!0===x)this._rotate=2;else if(this._rotate%2!=0)throw Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=y?new Point(y.x,y.y):new Point(0,0),this.defaultBorders=T,this._updateID=0,this.textureCacheIds=[],i.valid?this.noFrame?i.valid&&this.onBaseTextureUpdated(i):this.frame=m:i.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&i.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(i){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=i.width,this._frame.height=i.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(i){if(this.baseTexture){if(i){let{resource:i}=this.baseTexture;i?.url&&t5[i.url]&&Texture.removeFromCache(i.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Texture.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){let i=this._frame.clone(),m=this._frame===this.orig?i:this.orig.clone(),p=new Texture(this.baseTexture,!this.noFrame&&i,m,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(p._frame=i),p}updateUvs(){this._uvs===ej&&(this._uvs=new TextureUvs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(i,m={},p=tx.STRICT_TEXTURE_CACHE){let _="string"==typeof i,x=null;if(_)x=i;else if(i instanceof es){if(!i.cacheId){let p=m?.pixiIdPrefix||"pixiid";i.cacheId=`${p}-${uid()}`,es.addToCache(i,i.cacheId)}x=i.cacheId}else{if(!i._pixiId){let p=m?.pixiIdPrefix||"pixiid";i._pixiId=`${p}_${uid()}`}x=i._pixiId}let y=t5[x];if(_&&p&&!y)throw Error(`The cacheId "${x}" does not exist in TextureCache.`);return y||i instanceof es?!y&&i instanceof es&&(y=new Texture(i),Texture.addToCache(y,x)):(m.resolution||(m.resolution=getResolutionOfUrl(i)),(y=new Texture(new es(i,m))).baseTexture.cacheId=x,es.addToCache(y.baseTexture,x),Texture.addToCache(y,x)),y}static fromURL(i,m){let p=Object.assign({autoLoad:!1},m?.resourceOptions),_=Texture.from(i,Object.assign({resourceOptions:p},m),!1),x=_.baseTexture.resource;return _.baseTexture.valid?Promise.resolve(_):x.load().then(()=>Promise.resolve(_))}static fromBuffer(i,m,p,_){return new Texture(es.fromBuffer(i,m,p,_))}static fromLoader(i,m,p,_){let x=new es(i,Object.assign({scaleMode:es.defaultOptions.scaleMode,resolution:getResolutionOfUrl(m)},_)),{resource:y}=x;y instanceof ImageResource&&(y.url=m);let T=new Texture(x);return p||(p=m),es.addToCache(T.baseTexture,p),Texture.addToCache(T,p),p!==m&&(es.addToCache(T.baseTexture,m),Texture.addToCache(T,m)),T.baseTexture.valid?Promise.resolve(T):new Promise(i=>{T.baseTexture.once("loaded",()=>i(T))})}static addToCache(i,m){m&&(i.textureCacheIds.includes(m)||i.textureCacheIds.push(m),t5[m]&&t5[m]!==i&&console.warn(`Texture added to the cache with an id [${m}] that already had an entry`),t5[m]=i)}static removeFromCache(i){if("string"==typeof i){let m=t5[i];if(m){let p=m.textureCacheIds.indexOf(i);return p>-1&&m.textureCacheIds.splice(p,1),delete t5[i],m}}else if(i?.textureCacheIds){for(let m=0;m<i.textureCacheIds.length;++m)t5[i.textureCacheIds[m]]===i&&delete t5[i.textureCacheIds[m]];return i.textureCacheIds.length=0,i}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(i){this._frame=i,this.noFrame=!1;let{x:m,y:p,width:_,height:x}=i,y=m+_>this.baseTexture.width,T=p+x>this.baseTexture.height;if(y||T){let i=`X: ${m} + ${_} = ${m+_} > ${this.baseTexture.width}`,v=`Y: ${p} + ${x} = ${p+x} > ${this.baseTexture.height}`;throw Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${i} ${y&&T?"and":"or"} ${v}`)}this.valid=_&&x&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=i),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(i){this._rotate=i,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Texture._EMPTY||(Texture._EMPTY=new Texture(new es),removeAllHandlers(Texture._EMPTY),removeAllHandlers(Texture._EMPTY.baseTexture)),Texture._EMPTY}static get WHITE(){if(!Texture._WHITE){let i=tx.ADAPTER.createCanvas(16,16),m=i.getContext("2d");i.width=16,i.height=16,m.fillStyle="white",m.fillRect(0,0,16,16),Texture._WHITE=new Texture(es.from(i)),removeAllHandlers(Texture._WHITE),removeAllHandlers(Texture._WHITE.baseTexture)}return Texture._WHITE}};let RenderTexture=class RenderTexture extends Texture{constructor(i,m){super(i,m),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(i){this.framebuffer.multisample=i}resize(i,m,p=!0){let _=this.baseTexture.resolution,x=Math.round(i*_)/_,y=Math.round(m*_)/_;this.valid=x>0&&y>0,this._frame.width=this.orig.width=x,this._frame.height=this.orig.height=y,p&&this.baseTexture.resize(x,y),this.updateUvs()}setResolution(i){let{baseTexture:m}=this;m.resolution!==i&&(m.setResolution(i),this.resize(m.width,m.height,!1))}static create(i){return new RenderTexture(new BaseRenderTexture(i))}};let RenderTexturePool=class RenderTexturePool{constructor(i){this.texturePool={},this.textureOptions=i||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(i,m,p=tg.NONE){let _=new BaseRenderTexture(Object.assign({width:i,height:m,resolution:1,multisample:p},this.textureOptions));return new RenderTexture(_)}getOptimalTexture(i,m,p=1,_=tg.NONE){let x;i=Math.max(Math.ceil(i*p-1e-6),1),m=Math.max(Math.ceil(m*p-1e-6),1),this.enableFullScreen&&i===this._pixelsWidth&&m===this._pixelsHeight?x=_>1?-_:-1:(i=nextPow2(i),m=nextPow2(m),x=((65535&i)<<16|65535&m)>>>0,_>1&&(x+=4294967296*_)),this.texturePool[x]||(this.texturePool[x]=[]);let y=this.texturePool[x].pop();return y||(y=this.createTexture(i,m,_)),y.filterPoolKey=x,y.setResolution(p),y}getFilterTexture(i,m,p){let _=this.getOptimalTexture(i.width,i.height,m||i.resolution,p||tg.NONE);return _.filterFrame=i.filterFrame,_}returnTexture(i){let m=i.filterPoolKey;i.filterFrame=null,this.texturePool[m].push(i)}returnFilterTexture(i){this.returnTexture(i)}clear(i){if(i=!1!==i)for(let i in this.texturePool){let m=this.texturePool[i];if(m)for(let i=0;i<m.length;i++)m[i].destroy(!0)}this.texturePool={}}setScreenSize(i){if(!(i.width===this._pixelsWidth&&i.height===this._pixelsHeight)){for(let m in this.enableFullScreen=i.width>0&&i.height>0,this.texturePool){if(!(0>Number(m)))continue;let i=this.texturePool[m];if(i)for(let m=0;m<i.length;m++)i[m].destroy(!0);this.texturePool[m]=[]}this._pixelsWidth=i.width,this._pixelsHeight=i.height}}};RenderTexturePool.SCREEN_KEY=-1;let Quad=class Quad extends Geometry{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}};let QuadUv=class QuadUv extends Geometry{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Buffer(this.vertices),this.uvBuffer=new Buffer(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(i,m){let p=0,_=0;return this.uvs[0]=p,this.uvs[1]=_,this.uvs[2]=p+m.width/i.width,this.uvs[3]=_,this.uvs[4]=p+m.width/i.width,this.uvs[5]=_+m.height/i.height,this.uvs[6]=p,this.uvs[7]=_+m.height/i.height,p=m.x,_=m.y,this.vertices[0]=p,this.vertices[1]=_,this.vertices[2]=p+m.width,this.vertices[3]=_,this.vertices[4]=p+m.width,this.vertices[5]=_+m.height,this.vertices[6]=p,this.vertices[7]=_+m.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}};let FilterState=class FilterState{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=tg.NONE,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.bindingSourceFrame=new Rectangle,this.bindingDestinationFrame=new Rectangle,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}};let eq=[new Point,new Point,new Point,new Point],eZ=new Matrix;let FilterSystem=class FilterSystem{constructor(i){this.renderer=i,this.defaultFilterStack=[{}],this.texturePool=new RenderTexturePool,this.statePool=[],this.quad=new Quad,this.quadUv=new QuadUv,this.tempRect=new Rectangle,this.activeState={},this.globalUniforms=new UniformGroup({outputFrame:new Rectangle,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(i,m){let p,_;let x=this.renderer,y=this.defaultFilterStack,T=this.statePool.pop()||new FilterState,v=x.renderTexture;if(v.current){let i=v.current;p=i.resolution,_=i.multisample}else p=x.resolution,_=x.multisample;let E=m[0].resolution||p,A=m[0].multisample??_,S=m[0].padding,I=m[0].autoFit,R=m[0].legacy??!0;for(let i=1;i<m.length;i++){let x=m[i];E=Math.min(E,x.resolution||p),A=Math.min(A,x.multisample??_),S=this.useMaxPadding?Math.max(S,x.padding):S+x.padding,I=I&&x.autoFit,R=R||(x.legacy??!0)}1===y.length&&(this.defaultFilterStack[0].renderTexture=v.current),y.push(T),T.resolution=E,T.multisample=A,T.legacy=R,T.target=i,T.sourceFrame.copyFrom(i.filterArea||i.getBounds(!0)),T.sourceFrame.pad(S);let C=this.tempRect.copyFrom(v.sourceFrame);x.projection.transform&&this.transformAABB(eZ.copyFrom(x.projection.transform).invert(),C),I?(T.sourceFrame.fit(C),(T.sourceFrame.width<=0||T.sourceFrame.height<=0)&&(T.sourceFrame.width=0,T.sourceFrame.height=0)):T.sourceFrame.intersects(C)||(T.sourceFrame.width=0,T.sourceFrame.height=0),this.roundFrame(T.sourceFrame,v.current?v.current.resolution:x.resolution,v.sourceFrame,v.destinationFrame,x.projection.transform),T.renderTexture=this.getOptimalFilterTexture(T.sourceFrame.width,T.sourceFrame.height,E,A),T.filters=m,T.destinationFrame.width=T.renderTexture.width,T.destinationFrame.height=T.renderTexture.height;let P=this.tempRect;P.x=0,P.y=0,P.width=T.sourceFrame.width,P.height=T.sourceFrame.height,T.renderTexture.filterFrame=T.sourceFrame,T.bindingSourceFrame.copyFrom(v.sourceFrame),T.bindingDestinationFrame.copyFrom(v.destinationFrame),T.transform=x.projection.transform,x.projection.transform=null,v.bind(T.renderTexture,T.sourceFrame,P),x.framebuffer.clear(0,0,0,0)}pop(){let i=this.defaultFilterStack,m=i.pop(),p=m.filters;this.activeState=m;let _=this.globalUniforms.uniforms;_.outputFrame=m.sourceFrame,_.resolution=m.resolution;let x=_.inputSize,y=_.inputPixel,T=_.inputClamp;if(x[0]=m.destinationFrame.width,x[1]=m.destinationFrame.height,x[2]=1/x[0],x[3]=1/x[1],y[0]=Math.round(x[0]*m.resolution),y[1]=Math.round(x[1]*m.resolution),y[2]=1/y[0],y[3]=1/y[1],T[0]=.5*y[2],T[1]=.5*y[3],T[2]=m.sourceFrame.width*x[2]-.5*y[2],T[3]=m.sourceFrame.height*x[3]-.5*y[3],m.legacy){let i=_.filterArea;i[0]=m.destinationFrame.width,i[1]=m.destinationFrame.height,i[2]=m.sourceFrame.x,i[3]=m.sourceFrame.y,_.filterClamp=_.inputClamp}this.globalUniforms.update();let v=i[i.length-1];if(this.renderer.framebuffer.blit(),1===p.length)p[0].apply(this,m.renderTexture,v.renderTexture,td.BLEND,m),this.returnFilterTexture(m.renderTexture);else{let i=m.renderTexture,_=this.getOptimalFilterTexture(i.width,i.height,m.resolution);_.filterFrame=i.filterFrame;let x=0;for(x=0;x<p.length-1;++x){1===x&&m.multisample>1&&((_=this.getOptimalFilterTexture(i.width,i.height,m.resolution)).filterFrame=i.filterFrame),p[x].apply(this,i,_,td.CLEAR,m);let y=i;i=_,_=y}p[x].apply(this,i,v.renderTexture,td.BLEND,m),x>1&&m.multisample>1&&this.returnFilterTexture(m.renderTexture),this.returnFilterTexture(i),this.returnFilterTexture(_)}m.clear(),this.statePool.push(m)}bindAndClear(i,m=td.CLEAR){let{renderTexture:p,state:_}=this.renderer;if(i===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,i?.filterFrame){let m=this.tempRect;m.x=0,m.y=0,m.width=i.filterFrame.width,m.height=i.filterFrame.height,p.bind(i,i.filterFrame,m)}else i!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?p.bind(i):this.renderer.renderTexture.bind(i,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);let x=1&_.stateId||this.forceClear;(m===td.CLEAR||m===td.BLIT&&x)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(i,m,p,_){let x=this.renderer;x.state.set(i.state),this.bindAndClear(p,_),i.uniforms.uSampler=m,i.uniforms.filterGlobals=this.globalUniforms,x.shader.bind(i),i.legacy=!!i.program.attributeData.aTextureCoord,i.legacy?(this.quadUv.map(m._frame,m.filterFrame),x.geometry.bind(this.quadUv),x.geometry.draw(tr.TRIANGLES)):(x.geometry.bind(this.quad),x.geometry.draw(tr.TRIANGLE_STRIP))}calculateSpriteMatrix(i,m){let{sourceFrame:p,destinationFrame:_}=this.activeState,{orig:x}=m._texture,y=i.set(_.width,0,0,_.height,p.x,p.y),T=m.worldTransform.copyTo(Matrix.TEMP_MATRIX);return T.invert(),y.prepend(T),y.scale(1/x.width,1/x.height),y.translate(m.anchor.x,m.anchor.y),y}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(i,m,p=1,_=tg.NONE){return this.texturePool.getOptimalTexture(i,m,p,_)}getFilterTexture(i,m,p){if("number"==typeof i){let p=i;i=m,m=p}i=i||this.activeState.renderTexture;let _=this.texturePool.getOptimalTexture(i.width,i.height,m||i.resolution,p||tg.NONE);return _.filterFrame=i.filterFrame,_}returnFilterTexture(i){this.texturePool.returnTexture(i)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(i,m){let p=eq[0],_=eq[1],x=eq[2],y=eq[3];p.set(m.left,m.top),_.set(m.left,m.bottom),x.set(m.right,m.top),y.set(m.right,m.bottom),i.apply(p,p),i.apply(_,_),i.apply(x,x),i.apply(y,y);let T=Math.min(p.x,_.x,x.x,y.x),v=Math.min(p.y,_.y,x.y,y.y),E=Math.max(p.x,_.x,x.x,y.x),A=Math.max(p.y,_.y,x.y,y.y);m.x=T,m.y=v,m.width=E-T,m.height=A-v}roundFrame(i,m,p,_,x){if(!(i.width<=0||i.height<=0||p.width<=0||p.height<=0)){if(x){let{a:i,b:m,c:p,d:_}=x;if((Math.abs(m)>1e-4||Math.abs(p)>1e-4)&&(Math.abs(i)>1e-4||Math.abs(_)>1e-4))return}(x=x?eZ.copyFrom(x):eZ.identity()).translate(-p.x,-p.y).scale(_.width/p.width,_.height/p.height).translate(_.x,_.y),this.transformAABB(x,i),i.ceil(m),this.transformAABB(x.invert(),i)}}};FilterSystem.extension={type:t9.RendererSystem,name:"filter"},t7.add(FilterSystem);let GLFramebuffer=class GLFramebuffer{constructor(i){this.framebuffer=i,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=tg.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}};let eK=new Rectangle;let FramebufferSystem=class FramebufferSystem{constructor(i){this.renderer=i,this.managedFramebuffers=[],this.unknownFramebuffer=new Framebuffer(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);let i=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Rectangle,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){let m=this.renderer.context.extensions.drawBuffers,p=this.renderer.context.extensions.depthTexture;tx.PREFER_ENV===J.WEBGL_LEGACY&&(m=null,p=null),m?i.drawBuffers=i=>m.drawBuffersWEBGL(i):(this.hasMRT=!1,i.drawBuffers=()=>{}),p||(this.writeDepthTexture=!1)}else this.msaaSamples=i.getInternalformatParameter(i.RENDERBUFFER,i.RGBA8,i.SAMPLES)}bind(i,m,p=0){let{gl:_}=this;if(i){let x=i.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(i);this.current!==i&&(this.current=i,_.bindFramebuffer(_.FRAMEBUFFER,x.framebuffer)),x.mipLevel!==p&&(i.dirtyId++,i.dirtyFormat++,x.mipLevel=p),x.dirtyId!==i.dirtyId&&(x.dirtyId=i.dirtyId,x.dirtyFormat!==i.dirtyFormat?(x.dirtyFormat=i.dirtyFormat,x.dirtySize=i.dirtySize,this.updateFramebuffer(i,p)):x.dirtySize!==i.dirtySize&&(x.dirtySize=i.dirtySize,this.resizeFramebuffer(i)));for(let m=0;m<i.colorTextures.length;m++){let p=i.colorTextures[m];this.renderer.texture.unbind(p.parentTextureArray||p)}if(i.depthTexture&&this.renderer.texture.unbind(i.depthTexture),m){let i=m.width>>p,_=m.height>>p,x=i/m.width;this.setViewport(m.x*x,m.y*x,i,_)}else{let m=i.width>>p,_=i.height>>p;this.setViewport(0,0,m,_)}}else this.current&&(this.current=null,_.bindFramebuffer(_.FRAMEBUFFER,null)),m?this.setViewport(m.x,m.y,m.width,m.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(i,m,p,_){let x=this.viewport;i=Math.round(i),m=Math.round(m),p=Math.round(p),_=Math.round(_),(x.width!==p||x.height!==_||x.x!==i||x.y!==m)&&(x.x=i,x.y=m,x.width=p,x.height=_,this.gl.viewport(i,m,p,_))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(i,m,p,_,x=tt.COLOR|tt.DEPTH){let{gl:y}=this;y.clearColor(i,m,p,_),y.clear(x)}initFramebuffer(i){let{gl:m}=this,p=new GLFramebuffer(m.createFramebuffer());return p.multisample=this.detectSamples(i.multisample),i.glFramebuffers[this.CONTEXT_UID]=p,this.managedFramebuffers.push(i),i.disposeRunner.add(this),p}resizeFramebuffer(i){let{gl:m}=this,p=i.glFramebuffers[this.CONTEXT_UID];if(p.stencil){let _;m.bindRenderbuffer(m.RENDERBUFFER,p.stencil),_=1===this.renderer.context.webGLVersion?m.DEPTH_STENCIL:i.depth&&i.stencil?m.DEPTH24_STENCIL8:i.depth?m.DEPTH_COMPONENT24:m.STENCIL_INDEX8,p.msaaBuffer?m.renderbufferStorageMultisample(m.RENDERBUFFER,p.multisample,_,i.width,i.height):m.renderbufferStorage(m.RENDERBUFFER,_,i.width,i.height)}let _=i.colorTextures,x=_.length;m.drawBuffers||(x=Math.min(x,1));for(let y=0;y<x;y++){let x=_[y],T=x.parentTextureArray||x;this.renderer.texture.bind(T,0),0===y&&p.msaaBuffer&&(m.bindRenderbuffer(m.RENDERBUFFER,p.msaaBuffer),m.renderbufferStorageMultisample(m.RENDERBUFFER,p.multisample,T._glTextures[this.CONTEXT_UID].internalFormat,i.width,i.height))}i.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(i.depthTexture,0)}updateFramebuffer(i,m){let{gl:p}=this,_=i.glFramebuffers[this.CONTEXT_UID],x=i.colorTextures,y=x.length;p.drawBuffers||(y=Math.min(y,1)),_.multisample>1&&this.canMultisampleFramebuffer(i)?_.msaaBuffer=_.msaaBuffer||p.createRenderbuffer():_.msaaBuffer&&(p.deleteRenderbuffer(_.msaaBuffer),_.msaaBuffer=null,_.blitFramebuffer&&(_.blitFramebuffer.dispose(),_.blitFramebuffer=null));let T=[];for(let v=0;v<y;v++){let y=x[v],E=y.parentTextureArray||y;this.renderer.texture.bind(E,0),0===v&&_.msaaBuffer?(p.bindRenderbuffer(p.RENDERBUFFER,_.msaaBuffer),p.renderbufferStorageMultisample(p.RENDERBUFFER,_.multisample,E._glTextures[this.CONTEXT_UID].internalFormat,i.width,i.height),p.framebufferRenderbuffer(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.RENDERBUFFER,_.msaaBuffer)):(p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0+v,y.target,E._glTextures[this.CONTEXT_UID].texture,m),T.push(p.COLOR_ATTACHMENT0+v))}if(T.length>1&&p.drawBuffers(T),i.depthTexture&&this.writeDepthTexture){let _=i.depthTexture;this.renderer.texture.bind(_,0),p.framebufferTexture2D(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.TEXTURE_2D,_._glTextures[this.CONTEXT_UID].texture,m)}if((i.stencil||i.depth)&&!(i.depthTexture&&this.writeDepthTexture)){let m,x;_.stencil=_.stencil||p.createRenderbuffer(),1===this.renderer.context.webGLVersion?(m=p.DEPTH_STENCIL_ATTACHMENT,x=p.DEPTH_STENCIL):i.depth&&i.stencil?(m=p.DEPTH_STENCIL_ATTACHMENT,x=p.DEPTH24_STENCIL8):i.depth?(m=p.DEPTH_ATTACHMENT,x=p.DEPTH_COMPONENT24):(m=p.STENCIL_ATTACHMENT,x=p.STENCIL_INDEX8),p.bindRenderbuffer(p.RENDERBUFFER,_.stencil),_.msaaBuffer?p.renderbufferStorageMultisample(p.RENDERBUFFER,_.multisample,x,i.width,i.height):p.renderbufferStorage(p.RENDERBUFFER,x,i.width,i.height),p.framebufferRenderbuffer(p.FRAMEBUFFER,m,p.RENDERBUFFER,_.stencil)}else _.stencil&&(p.deleteRenderbuffer(_.stencil),_.stencil=null)}canMultisampleFramebuffer(i){return 1!==this.renderer.context.webGLVersion&&i.colorTextures.length<=1&&!i.depthTexture}detectSamples(i){let{msaaSamples:m}=this,p=tg.NONE;if(i<=1||null===m)return p;for(let _=0;_<m.length;_++)if(m[_]<=i){p=m[_];break}return 1===p&&(p=tg.NONE),p}blit(i,m,p){let{current:_,renderer:x,gl:y,CONTEXT_UID:T}=this;if(2!==x.context.webGLVersion||!_)return;let v=_.glFramebuffers[T];if(!v)return;if(!i){if(!v.msaaBuffer)return;let m=_.colorTextures[0];if(!m)return;v.blitFramebuffer||(v.blitFramebuffer=new Framebuffer(_.width,_.height),v.blitFramebuffer.addColorTexture(0,m)),(i=v.blitFramebuffer).colorTextures[0]!==m&&(i.colorTextures[0]=m,i.dirtyId++,i.dirtyFormat++),(i.width!==_.width||i.height!==_.height)&&(i.width=_.width,i.height=_.height,i.dirtyId++,i.dirtySize++)}m||((m=eK).width=_.width,m.height=_.height),p||(p=m);let E=m.width===p.width&&m.height===p.height;this.bind(i),y.bindFramebuffer(y.READ_FRAMEBUFFER,v.framebuffer),y.blitFramebuffer(m.left,m.top,m.right,m.bottom,p.left,p.top,p.right,p.bottom,y.COLOR_BUFFER_BIT,E?y.NEAREST:y.LINEAR),y.bindFramebuffer(y.READ_FRAMEBUFFER,i.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(i,m){let p=i.glFramebuffers[this.CONTEXT_UID],_=this.gl;if(!p)return;delete i.glFramebuffers[this.CONTEXT_UID];let x=this.managedFramebuffers.indexOf(i);x>=0&&this.managedFramebuffers.splice(x,1),i.disposeRunner.remove(this),m||(_.deleteFramebuffer(p.framebuffer),p.msaaBuffer&&_.deleteRenderbuffer(p.msaaBuffer),p.stencil&&_.deleteRenderbuffer(p.stencil)),p.blitFramebuffer&&this.disposeFramebuffer(p.blitFramebuffer,m)}disposeAll(i){let m=this.managedFramebuffers;this.managedFramebuffers=[];for(let p=0;p<m.length;p++)this.disposeFramebuffer(m[p],i)}forceStencil(){let i,m;let p=this.current;if(!p)return;let _=p.glFramebuffers[this.CONTEXT_UID];if(!_||_.stencil&&p.stencil)return;p.stencil=!0;let x=p.width,y=p.height,T=this.gl,v=_.stencil=T.createRenderbuffer();T.bindRenderbuffer(T.RENDERBUFFER,v),1===this.renderer.context.webGLVersion?(i=T.DEPTH_STENCIL_ATTACHMENT,m=T.DEPTH_STENCIL):p.depth?(i=T.DEPTH_STENCIL_ATTACHMENT,m=T.DEPTH24_STENCIL8):(i=T.STENCIL_ATTACHMENT,m=T.STENCIL_INDEX8),_.msaaBuffer?T.renderbufferStorageMultisample(T.RENDERBUFFER,_.multisample,m,x,y):T.renderbufferStorage(T.RENDERBUFFER,m,x,y),T.framebufferRenderbuffer(T.FRAMEBUFFER,i,T.RENDERBUFFER,v)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Rectangle}destroy(){this.renderer=null}};FramebufferSystem.extension={type:t9.RendererSystem,name:"framebuffer"},t7.add(FramebufferSystem);let eJ={5126:4,5123:2,5121:1};let GeometrySystem=class GeometrySystem{constructor(i){this.renderer=i,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);let i=this.gl=this.renderer.gl,m=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==m.webGLVersion){let m=this.renderer.context.extensions.vertexArrayObject;tx.PREFER_ENV===J.WEBGL_LEGACY&&(m=null),m?(i.createVertexArray=()=>m.createVertexArrayOES(),i.bindVertexArray=i=>m.bindVertexArrayOES(i),i.deleteVertexArray=i=>m.deleteVertexArrayOES(i)):(this.hasVao=!1,i.createVertexArray=()=>null,i.bindVertexArray=()=>null,i.deleteVertexArray=()=>null)}if(2!==m.webGLVersion){let m=i.getExtension("ANGLE_instanced_arrays");m?(i.vertexAttribDivisor=(i,p)=>m.vertexAttribDivisorANGLE(i,p),i.drawElementsInstanced=(i,p,_,x,y)=>m.drawElementsInstancedANGLE(i,p,_,x,y),i.drawArraysInstanced=(i,p,_,x)=>m.drawArraysInstancedANGLE(i,p,_,x)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===m.webGLVersion||!!m.extensions.uint32ElementIndex}bind(i,m){m=m||this.renderer.shader.shader;let{gl:p}=this,_=i.glVertexArrayObjects[this.CONTEXT_UID],x=!1;_||(this.managedGeometries[i.id]=i,i.disposeRunner.add(this),i.glVertexArrayObjects[this.CONTEXT_UID]=_={},x=!0);let y=_[m.program.id]||this.initGeometryVao(i,m,x);this._activeGeometry=i,this._activeVao!==y&&(this._activeVao=y,this.hasVao?p.bindVertexArray(y):this.activateVao(i,m.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){let i=this._activeGeometry,m=this.renderer.buffer;for(let p=0;p<i.buffers.length;p++){let _=i.buffers[p];m.update(_)}}checkCompatibility(i,m){let p=i.attributes,_=m.attributeData;for(let i in _)if(!p[i])throw Error(`shader and geometry incompatible, geometry missing the "${i}" attribute`)}getSignature(i,m){let p=i.attributes,_=m.attributeData,x=["g",i.id];for(let i in p)_[i]&&x.push(i,_[i].location);return x.join("-")}initGeometryVao(i,m,p=!0){let _=this.gl,x=this.CONTEXT_UID,y=this.renderer.buffer,T=m.program;T.glPrograms[x]||this.renderer.shader.generateProgram(m),this.checkCompatibility(i,T);let v=this.getSignature(i,T),E=i.glVertexArrayObjects[this.CONTEXT_UID],A=E[v];if(A)return E[T.id]=A,A;let S=i.buffers,I=i.attributes,R={},C={};for(let i in S)R[i]=0,C[i]=0;for(let i in I)!I[i].size&&T.attributeData[i]?I[i].size=T.attributeData[i].size:I[i].size||console.warn(`PIXI Geometry attribute '${i}' size cannot be determined (likely the bound shader does not have the attribute)`),R[I[i].buffer]+=I[i].size*eJ[I[i].type];for(let i in I){let m=I[i],p=m.size;void 0===m.stride&&(R[m.buffer]===p*eJ[m.type]?m.stride=0:m.stride=R[m.buffer]),void 0===m.start&&(m.start=C[m.buffer],C[m.buffer]+=p*eJ[m.type])}A=_.createVertexArray(),_.bindVertexArray(A);for(let i=0;i<S.length;i++){let m=S[i];y.bind(m),p&&m._glBuffers[x].refCount++}return this.activateVao(i,T),E[T.id]=A,E[v]=A,_.bindVertexArray(null),y.unbind(t_.ARRAY_BUFFER),A}disposeGeometry(i,m){if(!this.managedGeometries[i.id])return;delete this.managedGeometries[i.id];let p=i.glVertexArrayObjects[this.CONTEXT_UID],_=this.gl,x=i.buffers,y=this.renderer?.buffer;if(i.disposeRunner.remove(this),p){if(y)for(let i=0;i<x.length;i++){let p=x[i]._glBuffers[this.CONTEXT_UID];p&&(p.refCount--,0!==p.refCount||m||y.dispose(x[i],m))}if(!m){for(let i in p)if("g"===i[0]){let m=p[i];this._activeVao===m&&this.unbind(),_.deleteVertexArray(m)}}delete i.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(i){let m=Object.keys(this.managedGeometries);for(let p=0;p<m.length;p++)this.disposeGeometry(this.managedGeometries[m[p]],i)}activateVao(i,m){let p=this.gl,_=this.CONTEXT_UID,x=this.renderer.buffer,y=i.buffers,T=i.attributes;i.indexBuffer&&x.bind(i.indexBuffer);let v=null;for(let i in T){let E=T[i],A=y[E.buffer],S=A._glBuffers[_];if(m.attributeData[i]){v!==S&&(x.bind(A),v=S);let _=m.attributeData[i].location;if(p.enableVertexAttribArray(_),p.vertexAttribPointer(_,E.size,E.type||p.FLOAT,E.normalized,E.stride,E.start),E.instance){if(this.hasInstance)p.vertexAttribDivisor(_,E.divisor);else throw Error("geometry error, GPU Instancing is not supported on this device")}}}}draw(i,m,p,_){let{gl:x}=this,y=this._activeGeometry;if(y.indexBuffer){let T=y.indexBuffer.data.BYTES_PER_ELEMENT,v=2===T?x.UNSIGNED_SHORT:x.UNSIGNED_INT;2===T||4===T&&this.canUseUInt32ElementIndex?y.instanced?x.drawElementsInstanced(i,m||y.indexBuffer.data.length,v,(p||0)*T,_||1):x.drawElements(i,m||y.indexBuffer.data.length,v,(p||0)*T):console.warn("unsupported index buffer type: uint32")}else y.instanced?x.drawArraysInstanced(i,p,m||y.getSize(),_||1):x.drawArrays(i,p,m||y.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}};GeometrySystem.extension={type:t9.RendererSystem,name:"geometry"},t7.add(GeometrySystem);let eQ=new Matrix;let TextureMatrix=class TextureMatrix{constructor(i,m){this._texture=i,this.mapCoord=new Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof m>"u"?.5:m,this.isSimple=!1}get texture(){return this._texture}set texture(i){this._texture=i,this._textureID=-1}multiplyUvs(i,m){void 0===m&&(m=i);let p=this.mapCoord;for(let _=0;_<i.length;_+=2){let x=i[_],y=i[_+1];m[_]=x*p.a+y*p.c+p.tx,m[_+1]=x*p.b+y*p.d+p.ty}return m}update(i){let m=this._texture;if(!m||!m.valid||!i&&this._textureID===m._updateID)return!1;this._textureID=m._updateID,this._updateID++;let p=m._uvs;this.mapCoord.set(p.x1-p.x0,p.y1-p.y0,p.x3-p.x0,p.y3-p.y0,p.x0,p.y0);let _=m.orig,x=m.trim;x&&(eQ.set(_.width/x.width,0,0,_.height/x.height,-x.x/x.width,-x.y/x.height),this.mapCoord.append(eQ));let y=m.baseTexture,T=this.uClampFrame,v=this.clampMargin/y.resolution,E=this.clampOffset;return T[0]=(m._frame.x+v+E)/y.width,T[1]=(m._frame.y+v+E)/y.height,T[2]=(m._frame.x+m._frame.width-v+E)/y.width,T[3]=(m._frame.y+m._frame.height-v+E)/y.height,this.uClampOffset[0]=E/y.realWidth,this.uClampOffset[1]=E/y.realHeight,this.isSimple=m._frame.width===y.width&&m._frame.height===y.height&&0===m.rotate,!0}};var e0=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,e1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;let SpriteMaskFilter=class SpriteMaskFilter extends e${constructor(i,m,p){let _=null;"string"!=typeof i&&void 0===m&&void 0===p&&(_=i,i=void 0,m=void 0,p=void 0),super(i||e1,m||e0,p),this.maskSprite=_,this.maskMatrix=new Matrix}get maskSprite(){return this._maskSprite}set maskSprite(i){this._maskSprite=i,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(i,m,p,_){let x=this._maskSprite,y=x._texture;y.valid&&(y.uvMatrix||(y.uvMatrix=new TextureMatrix(y,0)),y.uvMatrix.update(),this.uniforms.npmAlpha=y.baseTexture.alphaMode?0:1,this.uniforms.mask=y,this.uniforms.otherMatrix=i.calculateSpriteMatrix(this.maskMatrix,x).prepend(y.uvMatrix.mapCoord),this.uniforms.alpha=x.worldAlpha,this.uniforms.maskClamp=y.uvMatrix.uClampFrame,i.applyFilter(this,m,p,_))}};let MaskData=class MaskData{constructor(i=null){this.type=tf.NONE,this.autoDetect=!0,this.maskObject=i||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=e$.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(i){i?this._filters?this._filters[0]=i:this._filters=[i]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=tf.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(i){i?(this._stencilCounter=i._stencilCounter,this._scissorCounter=i._scissorCounter,this._scissorRect=i._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}};let MaskSystem=class MaskSystem{constructor(i){this.renderer=i,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(i){this.maskStack=i,this.renderer.scissor.setMaskStack(i),this.renderer.stencil.setMaskStack(i)}push(i,m){let p=m;if(!p.isMaskData){let i=this.maskDataPool.pop()||new MaskData;i.pooled=!0,i.maskObject=m,p=i}let _=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(p.copyCountersOrReset(_),p._colorMask=_?_._colorMask:15,p.autoDetect&&this.detect(p),p._target=i,p.type!==tf.SPRITE&&this.maskStack.push(p),p.enabled)switch(p.type){case tf.SCISSOR:this.renderer.scissor.push(p);break;case tf.STENCIL:this.renderer.stencil.push(p);break;case tf.SPRITE:p.copyCountersOrReset(null),this.pushSpriteMask(p);break;case tf.COLOR:this.pushColorMask(p)}p.type===tf.SPRITE&&this.maskStack.push(p)}pop(i){let m=this.maskStack.pop();if(!(!m||m._target!==i)){if(m.enabled)switch(m.type){case tf.SCISSOR:this.renderer.scissor.pop(m);break;case tf.STENCIL:this.renderer.stencil.pop(m.maskObject);break;case tf.SPRITE:this.popSpriteMask(m);break;case tf.COLOR:this.popColorMask(m)}if(m.reset(),m.pooled&&this.maskDataPool.push(m),0!==this.maskStack.length){let i=this.maskStack[this.maskStack.length-1];i.type===tf.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(i){let m=i.maskObject;m?m.isSprite?i.type=tf.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(i)?i.type=tf.SCISSOR:i.type=tf.STENCIL:i.type=tf.COLOR}pushSpriteMask(i){let{maskObject:m}=i,p=i._target,_=i._filters;_||(_=this.alphaMaskPool[this.alphaMaskIndex])||(_=this.alphaMaskPool[this.alphaMaskIndex]=[new SpriteMaskFilter]),_[0].resolution=i.resolution,_[0].multisample=i.multisample,_[0].maskSprite=m;let x=p.filterArea;p.filterArea=m.getBounds(!0),this.renderer.filter.push(p,_),p.filterArea=x,i._filters||this.alphaMaskIndex++}popSpriteMask(i){this.renderer.filter.pop(),i._filters?i._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(i){let m=i._colorMask,p=i._colorMask=m&i.colorMask;p!==m&&this.renderer.gl.colorMask((1&p)!=0,(2&p)!=0,(4&p)!=0,(8&p)!=0)}popColorMask(i){let m=i._colorMask,p=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;p!==m&&this.renderer.gl.colorMask((1&p)!=0,(2&p)!=0,(4&p)!=0,(8&p)!=0)}destroy(){this.renderer=null}};MaskSystem.extension={type:t9.RendererSystem,name:"mask"},t7.add(MaskSystem);let AbstractMaskSystem=class AbstractMaskSystem{constructor(i){this.renderer=i,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(i){let{gl:m}=this.renderer,p=this.getStackLength();this.maskStack=i;let _=this.getStackLength();_!==p&&(0===_?m.disable(this.glConst):(m.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}};let e2=new Matrix,e3=[],e4=class _ScissorSystem2 extends AbstractMaskSystem{constructor(i){super(i),this.glConst=tx.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){let i=this.maskStack[this.maskStack.length-1];return i?i._scissorCounter:0}calcScissorRect(i){if(i._scissorRectLocal)return;let m=i._scissorRect,{maskObject:p}=i,{renderer:_}=this,x=_.renderTexture,y=p.getBounds(!0,e3.pop()??new Rectangle);this.roundFrameToPixels(y,x.current?x.current.resolution:_.resolution,x.sourceFrame,x.destinationFrame,_.projection.transform),m&&y.fit(m),i._scissorRectLocal=y}static isMatrixRotated(i){if(!i)return!1;let{a:m,b:p,c:_,d:x}=i;return(Math.abs(p)>1e-4||Math.abs(_)>1e-4)&&(Math.abs(m)>1e-4||Math.abs(x)>1e-4)}testScissor(i){let{maskObject:m}=i;if(!m.isFastRect||!m.isFastRect()||_ScissorSystem2.isMatrixRotated(m.worldTransform)||_ScissorSystem2.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(i);let p=i._scissorRectLocal;return p.width>0&&p.height>0}roundFrameToPixels(i,m,p,_,x){_ScissorSystem2.isMatrixRotated(x)||((x=x?e2.copyFrom(x):e2.identity()).translate(-p.x,-p.y).scale(_.width/p.width,_.height/p.height).translate(_.x,_.y),this.renderer.filter.transformAABB(x,i),i.fit(_),i.x=Math.round(i.x*m),i.y=Math.round(i.y*m),i.width=Math.round(i.width*m),i.height=Math.round(i.height*m))}push(i){i._scissorRectLocal||this.calcScissorRect(i);let{gl:m}=this.renderer;i._scissorRect||m.enable(m.SCISSOR_TEST),i._scissorCounter++,i._scissorRect=i._scissorRectLocal,this._useCurrent()}pop(i){let{gl:m}=this.renderer;i&&e3.push(i._scissorRectLocal),this.getStackLength()>0?this._useCurrent():m.disable(m.SCISSOR_TEST)}_useCurrent(){let i;let m=this.maskStack[this.maskStack.length-1]._scissorRect;i=this.renderer.renderTexture.current?m.y:this.renderer.height-m.height-m.y,this.renderer.gl.scissor(m.x,i,m.width,m.height)}};e4.extension={type:t9.RendererSystem,name:"scissor"},t7.add(e4);let StencilSystem=class StencilSystem extends AbstractMaskSystem{constructor(i){super(i),this.glConst=tx.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){let i=this.maskStack[this.maskStack.length-1];return i?i._stencilCounter:0}push(i){let m=i.maskObject,{gl:p}=this.renderer,_=i._stencilCounter;0===_&&(this.renderer.framebuffer.forceStencil(),p.clearStencil(0),p.clear(p.STENCIL_BUFFER_BIT),p.enable(p.STENCIL_TEST)),i._stencilCounter++;let x=i._colorMask;0!==x&&(i._colorMask=0,p.colorMask(!1,!1,!1,!1)),p.stencilFunc(p.EQUAL,_,4294967295),p.stencilOp(p.KEEP,p.KEEP,p.INCR),m.renderable=!0,m.render(this.renderer),this.renderer.batch.flush(),m.renderable=!1,0!==x&&(i._colorMask=x,p.colorMask((1&x)!=0,(2&x)!=0,(4&x)!=0,(8&x)!=0)),this._useCurrent()}pop(i){let m=this.renderer.gl;if(0===this.getStackLength())m.disable(m.STENCIL_TEST);else{let p=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,_=p?p._colorMask:15;0!==_&&(p._colorMask=0,m.colorMask(!1,!1,!1,!1)),m.stencilOp(m.KEEP,m.KEEP,m.DECR),i.renderable=!0,i.render(this.renderer),this.renderer.batch.flush(),i.renderable=!1,0!==_&&(p._colorMask=_,m.colorMask((1&_)!=0,(2&_)!=0,(4&_)!=0,(8&_)!=0)),this._useCurrent()}}_useCurrent(){let i=this.renderer.gl;i.stencilFunc(i.EQUAL,this.getStackLength(),4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}};StencilSystem.extension={type:t9.RendererSystem,name:"stencil"},t7.add(StencilSystem);let PluginSystem=class PluginSystem{constructor(i){this.renderer=i,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get:()=>(deprecation("7.0.0","renderer.plugins.extract has moved to renderer.extract"),i.extract)},prepare:{enumerable:!1,get:()=>(deprecation("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),i.prepare)},interaction:{enumerable:!1,get:()=>(deprecation("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),i.events)}})}init(){let i=this.rendererPlugins;for(let m in i)this.plugins[m]=new i[m](this.renderer)}destroy(){for(let i in this.plugins)this.plugins[i].destroy(),this.plugins[i]=null}};PluginSystem.extension={type:[t9.RendererSystem,t9.CanvasRendererSystem],name:"_plugin"},t7.add(PluginSystem);let ProjectionSystem=class ProjectionSystem{constructor(i){this.renderer=i,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Matrix,this.transform=null}update(i,m,p,_){this.destinationFrame=i||this.destinationFrame||this.defaultFrame,this.sourceFrame=m||this.sourceFrame||i,this.calculateProjection(this.destinationFrame,this.sourceFrame,p,_),this.transform&&this.projectionMatrix.append(this.transform);let x=this.renderer;x.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,x.globalUniforms.update(),x.shader.shader&&x.shader.syncUniformGroup(x.shader.shader.uniforms.globals)}calculateProjection(i,m,p,_){let x=this.projectionMatrix,y=_?-1:1;x.identity(),x.a=1/m.width*2,x.d=y*(1/m.height*2),x.tx=-1-m.x*x.a,x.ty=-y-m.y*x.d}setTransform(i){}destroy(){this.renderer=null}};ProjectionSystem.extension={type:t9.RendererSystem,name:"projection"},t7.add(ProjectionSystem);let e6=new eA,e5=new Rectangle;let GenerateTextureSystem=class GenerateTextureSystem{constructor(i){this.renderer=i,this._tempMatrix=new Matrix}generateTexture(i,m){let{region:p,..._}=m||{},x=p?.copyTo(e5)||i.getLocalBounds(e5,!0),y=_.resolution||this.renderer.resolution;x.width=Math.max(x.width,1/y),x.height=Math.max(x.height,1/y),_.width=x.width,_.height=x.height,_.resolution=y,_.multisample??(_.multisample=this.renderer.multisample);let T=RenderTexture.create(_);this._tempMatrix.tx=-x.x,this._tempMatrix.ty=-x.y;let v=i.transform;return i.transform=e6,this.renderer.render(i,{renderTexture:T,transform:this._tempMatrix,skipUpdateTransform:!!i.parent,blit:!0}),i.transform=v,T}destroy(){}};GenerateTextureSystem.extension={type:[t9.RendererSystem,t9.CanvasRendererSystem],name:"textureGenerator"},t7.add(GenerateTextureSystem);let e8=new Rectangle,e9=new Rectangle;let RenderTextureSystem=class RenderTextureSystem{constructor(i){this.renderer=i,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.viewportFrame=new Rectangle}contextChange(){let i=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(i&&i.alpha&&i.premultipliedAlpha)}bind(i=null,m,p){let _,x,y;let T=this.renderer;this.current=i,i?(y=(_=i.baseTexture).resolution,m||(e8.width=i.frame.width,e8.height=i.frame.height,m=e8),p||(e9.x=i.frame.x,e9.y=i.frame.y,e9.width=m.width,e9.height=m.height,p=e9),x=_.framebuffer):(y=T.resolution,m||(e8.width=T._view.screen.width,e8.height=T._view.screen.height,m=e8),p||((p=e8).width=m.width,p.height=m.height));let v=this.viewportFrame;v.x=p.x*y,v.y=p.y*y,v.width=p.width*y,v.height=p.height*y,i||(v.y=T.view.height-(v.y+v.height)),v.ceil(),this.renderer.framebuffer.bind(x,v),this.renderer.projection.update(p,m,y,!x),i?this.renderer.mask.setMaskStack(_.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(m),this.destinationFrame.copyFrom(p)}clear(i,m){let p=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,_=tJ.shared.setValue(i||p);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&_.premultiply(_.alpha);let x=this.destinationFrame,y=this.current?this.current.baseTexture:this.renderer._view.screen,T=x.width!==y.width||x.height!==y.height;if(T){let{x:i,y:m,width:p,height:_}=this.viewportFrame;i=Math.round(i),m=Math.round(m),p=Math.round(p),_=Math.round(_),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(i,m,p,_)}this.renderer.framebuffer.clear(_.red,_.green,_.blue,_.alpha,m),T&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}};RenderTextureSystem.extension={type:t9.RendererSystem,name:"renderTexture"},t7.add(RenderTextureSystem);let GLProgram=class GLProgram{constructor(i,m){this.program=i,this.uniformData=m,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}};function compileShader(i,m,p){let _=i.createShader(m);return i.shaderSource(_,p),i.compileShader(_),_}function booleanArray(i){let m=Array(i);for(let i=0;i<m.length;i++)m[i]=!1;return m}function defaultValue(i,m){switch(i){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*m);case"vec3":return new Float32Array(3*m);case"vec4":return new Float32Array(4*m);case"ivec2":return new Int32Array(2*m);case"ivec3":return new Int32Array(3*m);case"ivec4":return new Int32Array(4*m);case"uvec2":return new Uint32Array(2*m);case"uvec3":return new Uint32Array(3*m);case"uvec4":return new Uint32Array(4*m);case"bool":return!1;case"bvec2":return booleanArray(2*m);case"bvec3":return booleanArray(3*m);case"bvec4":return booleanArray(4*m);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function getAttributeData(i,m){let p={},_=m.getProgramParameter(i,m.ACTIVE_ATTRIBUTES);for(let x=0;x<_;x++){let _=m.getActiveAttrib(i,x);if(_.name.startsWith("gl_"))continue;let y=mapType(m,_.type),T={type:y,name:_.name,size:ek[y],location:m.getAttribLocation(i,_.name)};p[_.name]=T}return p}function getUniformData(i,m){let p={},_=m.getProgramParameter(i,m.ACTIVE_UNIFORMS);for(let x=0;x<_;x++){let _=m.getActiveUniform(i,x),y=_.name.replace(/\[.*?\]$/,""),T=!!_.name.match(/\[.*?\]$/),v=mapType(m,_.type);p[y]={name:y,index:x,type:v,size:_.size,isArray:T,value:defaultValue(v,_.size)}}return p}function logPrettyShaderError(i,m){let p=i.getShaderSource(m).split(`
`).map((i,m)=>`${m}: ${i}`),_=i.getShaderInfoLog(m),x=_.split(`
`),y={},T=x.map(i=>parseFloat(i.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(i=>!!i&&!y[i]&&(y[i]=!0,!0)),v=[""];T.forEach(i=>{p[i-1]=`%c${p[i-1]}%c`,v.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});let E=p.join(`
`);v[0]=E,console.error(_),console.groupCollapsed("click to view full shader code"),console.warn(...v),console.groupEnd()}function logProgramError(i,m,p,_){i.getProgramParameter(m,i.LINK_STATUS)||(i.getShaderParameter(p,i.COMPILE_STATUS)||logPrettyShaderError(i,p),i.getShaderParameter(_,i.COMPILE_STATUS)||logPrettyShaderError(i,_),console.error("PixiJS Error: Could not initialize shader."),""!==i.getProgramInfoLog(m)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",i.getProgramInfoLog(m)))}function generateProgram(i,m){let p=compileShader(i,i.VERTEX_SHADER,m.vertexSrc),_=compileShader(i,i.FRAGMENT_SHADER,m.fragmentSrc),x=i.createProgram();i.attachShader(x,p),i.attachShader(x,_);let y=m.extra?.transformFeedbackVaryings;if(y&&("function"!=typeof i.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):i.transformFeedbackVaryings(x,y.names,"separate"===y.bufferMode?i.SEPARATE_ATTRIBS:i.INTERLEAVED_ATTRIBS)),i.linkProgram(x),i.getProgramParameter(x,i.LINK_STATUS)||logProgramError(i,x,p,_),m.attributeData=getAttributeData(x,i),m.uniformData=getUniformData(x,i),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(m.vertexSrc)){let p=Object.keys(m.attributeData);p.sort((i,m)=>i>m?1:-1);for(let _=0;_<p.length;_++)m.attributeData[p[_]].location=_,i.bindAttribLocation(x,_,p[_]);i.linkProgram(x)}i.deleteShader(p),i.deleteShader(_);let T={};for(let p in m.uniformData){let _=m.uniformData[p];T[p]={location:i.getUniformLocation(x,p),value:defaultValue(_.type,_.size)}}return new GLProgram(x,T)}function uboUpdate(i,m,p,_,x){p.buffer.update(x)}let e7={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},rt={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function createUBOElements(i){let m=i.map(i=>({data:i,offset:0,dataLen:0,dirty:0})),p=0,_=0,x=0;for(let i=0;i<m.length;i++){let y=m[i];if(p=rt[y.data.type],y.data.size>1&&(p=Math.max(p,16)*y.data.size),y.dataLen=p,_%p!=0&&_<16){let i=_%p%16;_+=i,x+=i}_+p>16?(x=16*Math.ceil(x/16),y.offset=x,x+=p,_=p):(y.offset=x,_+=p,x+=p)}return{uboElements:m,size:x=16*Math.ceil(x/16)}}function getUBOData(i,m){let p=[];for(let _ in i)m[_]&&p.push(m[_]);return p.sort((i,m)=>i.index-m.index),p}function generateUniformBufferSync(i,m){if(!i.autoManage)return{size:0,syncFunc:uboUpdate};let p=getUBOData(i.uniforms,m),{uboElements:_,size:x}=createUBOElements(p),y=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let m=0;m<_.length;m++){let p=_[m],x=i.uniforms[p.data.name],T=p.data.name,v=!1;for(let i=0;i<eI.length;i++){let m=eI[i];if(m.codeUbo&&m.test(p.data,x)){y.push(`offset = ${p.offset/4};`,eI[i].codeUbo(p.data.name,x)),v=!0;break}}if(!v){if(p.data.size>1){let i=ek[p.data.type],m=Math.max(rt[p.data.type]/16,1),_=i/m,x=(4-_%4)%4;y.push(`
                cv = ud.${T}.value;
                v = uv.${T};
                offset = ${p.offset/4};

                t = 0;

                for(var i=0; i < ${p.data.size*m}; i++)
                {
                    for(var j = 0; j < ${_}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${x};
                }

                `)}else{let i=e7[p.data.type];y.push(`
                cv = ud.${T}.value;
                v = uv.${T};
                offset = ${p.offset/4};
                ${i};
                `)}}}return y.push(`
       renderer.buffer.update(buffer);
    `),{size:x,syncFunc:Function("ud","uv","renderer","syncData","buffer",y.join(`
`))}}function unsafeEvalSupported(){if("boolean"==typeof T)return T;try{T=!0===Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")}catch{T=!1}return T}let re=0,rr={textureCount:0,uboCount:0};let ShaderSystem=class ShaderSystem{constructor(i){this.destroyed=!1,this.renderer=i,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=re++}systemCheck(){if(!unsafeEvalSupported())throw Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(i){this.gl=i,this.reset()}bind(i,m){i.disposeRunner.add(this),i.uniforms.globals=this.renderer.globalUniforms;let p=i.program,_=p.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(i);return this.shader=i,this.program!==p&&(this.program=p,this.gl.useProgram(_.program)),m||(rr.textureCount=0,rr.uboCount=0,this.syncUniformGroup(i.uniformGroup,rr)),_}setUniforms(i){let m=this.shader.program,p=m.glPrograms[this.renderer.CONTEXT_UID];m.syncUniforms(p.uniformData,i,this.renderer)}syncUniformGroup(i,m){let p=this.getGlProgram();i.static&&i.dirtyId===p.uniformDirtyGroups[i.id]||(p.uniformDirtyGroups[i.id]=i.dirtyId,this.syncUniforms(i,p,m))}syncUniforms(i,m,p){(i.syncUniforms[this.shader.program.id]||this.createSyncGroups(i))(m.uniformData,i.uniforms,this.renderer,p)}createSyncGroups(i){let m=this.getSignature(i,this.shader.program.uniformData,"u");return this.cache[m]||(this.cache[m]=generateUniformsSync(i,this.shader.program.uniformData)),i.syncUniforms[this.shader.program.id]=this.cache[m],i.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(i,m){let p=this.getGlProgram();if(!i.static||0!==i.dirtyId||!p.uniformGroups[i.id]){i.dirtyId=0;let _=p.uniformGroups[i.id]||this.createSyncBufferGroup(i,p,m);i.buffer.update(),_(p.uniformData,i.uniforms,this.renderer,rr,i.buffer)}this.renderer.buffer.bindBufferBase(i.buffer,p.uniformBufferBindings[m])}createSyncBufferGroup(i,m,p){let{gl:_}=this.renderer;this.renderer.buffer.bind(i.buffer);let x=this.gl.getUniformBlockIndex(m.program,p);m.uniformBufferBindings[p]=this.shader.uniformBindCount,_.uniformBlockBinding(m.program,x,this.shader.uniformBindCount),this.shader.uniformBindCount++;let y=this.getSignature(i,this.shader.program.uniformData,"ubo"),T=this._uboCache[y];if(T||(T=this._uboCache[y]=generateUniformBufferSync(i,this.shader.program.uniformData)),i.autoManage){let m=new Float32Array(T.size/4);i.buffer.update(m)}return m.uniformGroups[i.id]=T.syncFunc,m.uniformGroups[i.id]}getSignature(i,m,p){let _=i.uniforms,x=[`${p}-`];for(let i in _)x.push(i),m[i]&&x.push(m[i].type);return x.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(i){let m=this.gl,p=i.program,_=generateProgram(m,p);return p.glPrograms[this.renderer.CONTEXT_UID]=_,_}reset(){this.program=null,this.shader=null}disposeShader(i){this.shader===i&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}};ShaderSystem.extension={type:t9.RendererSystem,name:"shader"},t7.add(ShaderSystem);let StartupSystem=class StartupSystem{constructor(i){this.renderer=i}run(i){let{renderer:m}=this;m.runners.init.emit(m.options),i.hello&&console.log(`PixiJS 7.3.2 - ${m.rendererLogId} - https://pixijs.com`),m.resize(m.screen.width,m.screen.height)}destroy(){}};function mapWebGLBlendModesToPixi(i,m=[]){return m[te.NORMAL]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.ADD]=[i.ONE,i.ONE],m[te.MULTIPLY]=[i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.SCREEN]=[i.ONE,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.OVERLAY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.DARKEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.LIGHTEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.COLOR_DODGE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.COLOR_BURN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.HARD_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.SOFT_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.DIFFERENCE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.EXCLUSION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.HUE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.SATURATION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.COLOR]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.LUMINOSITY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.NONE]=[0,0],m[te.NORMAL_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.ADD_NPM]=[i.SRC_ALPHA,i.ONE,i.ONE,i.ONE],m[te.SCREEN_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],m[te.SRC_IN]=[i.DST_ALPHA,i.ZERO],m[te.SRC_OUT]=[i.ONE_MINUS_DST_ALPHA,i.ZERO],m[te.SRC_ATOP]=[i.DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],m[te.DST_OVER]=[i.ONE_MINUS_DST_ALPHA,i.ONE],m[te.DST_IN]=[i.ZERO,i.SRC_ALPHA],m[te.DST_OUT]=[i.ZERO,i.ONE_MINUS_SRC_ALPHA],m[te.DST_ATOP]=[i.ONE_MINUS_DST_ALPHA,i.SRC_ALPHA],m[te.XOR]=[i.ONE_MINUS_DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],m[te.SUBTRACT]=[i.ONE,i.ONE,i.ONE,i.ONE,i.FUNC_REVERSE_SUBTRACT,i.FUNC_ADD],m}StartupSystem.defaultOptions={hello:!1},StartupSystem.extension={type:[t9.RendererSystem,t9.CanvasRendererSystem],name:"startup"},t7.add(StartupSystem);let ri=class _StateSystem2{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=te.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new State,this.defaultState.blend=!0}contextChange(i){this.gl=i,this.blendModes=mapWebGLBlendModesToPixi(i),this.set(this.defaultState),this.reset()}set(i){if(i=i||this.defaultState,this.stateId!==i.data){let m=this.stateId^i.data,p=0;for(;m;)1&m&&this.map[p].call(this,!!(i.data&1<<p)),m>>=1,p++;this.stateId=i.data}for(let m=0;m<this.checks.length;m++)this.checks[m](this,i)}forceState(i){i=i||this.defaultState;for(let m=0;m<this.map.length;m++)this.map[m].call(this,!!(i.data&1<<m));for(let m=0;m<this.checks.length;m++)this.checks[m](this,i);this.stateId=i.data}setBlend(i){this.updateCheck(_StateSystem2.checkBlendMode,i),this.gl[i?"enable":"disable"](this.gl.BLEND)}setOffset(i){this.updateCheck(_StateSystem2.checkPolygonOffset,i),this.gl[i?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(i){this.gl[i?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(i){this.gl.depthMask(i)}setCullFace(i){this.gl[i?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(i){this.gl.frontFace(this.gl[i?"CW":"CCW"])}setBlendMode(i){if(i===this.blendMode)return;this.blendMode=i;let m=this.blendModes[i],p=this.gl;2===m.length?p.blendFunc(m[0],m[1]):p.blendFuncSeparate(m[0],m[1],m[2],m[3]),6===m.length?(this._blendEq=!0,p.blendEquationSeparate(m[4],m[5])):this._blendEq&&(this._blendEq=!1,p.blendEquationSeparate(p.FUNC_ADD,p.FUNC_ADD))}setPolygonOffset(i,m){this.gl.polygonOffset(i,m)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(i,m){let p=this.checks.indexOf(i);m&&-1===p?this.checks.push(i):m||-1===p||this.checks.splice(p,1)}static checkBlendMode(i,m){i.setBlendMode(m.blendMode)}static checkPolygonOffset(i,m){i.setPolygonOffset(1,m.polygonOffset)}destroy(){this.gl=null}};ri.extension={type:t9.RendererSystem,name:"state"},t7.add(ri);let SystemManager=class SystemManager extends tN{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(i){this.addRunners(...i.runners);let m=(i.priority??[]).filter(m=>i.systems[m]),p=[...m,...Object.keys(i.systems).filter(i=>!m.includes(i))];for(let m of p)this.addSystem(i.systems[m],m)}addRunners(...i){i.forEach(i=>{this.runners[i]=new Runner_Runner(i)})}addSystem(i,m){let p=new i(this);if(this[m])throw Error(`Whoops! The name "${m}" is already in use`);for(let i in this[m]=p,this._systemsHash[m]=p,this.runners)this.runners[i].add(p);return this}emitWithCustomOptions(i,m){let p=Object.keys(this._systemsHash);i.items.forEach(_=>{let x=p.find(i=>this._systemsHash[i]===_);_[i.name](m[x])})}destroy(){Object.values(this.runners).forEach(i=>{i.destroy()}),this._systemsHash={}}};let rs=class _TextureGCSystem2{constructor(i){this.renderer=i,this.count=0,this.checkCount=0,this.maxIdle=_TextureGCSystem2.defaultMaxIdle,this.checkCountMax=_TextureGCSystem2.defaultCheckCountMax,this.mode=_TextureGCSystem2.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==tc.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let i=this.renderer.texture,m=i.managedTextures,p=!1;for(let _=0;_<m.length;_++){let x=m[_];x.resource&&this.count-x.touched>this.maxIdle&&(i.destroyTexture(x,!0),m[_]=null,p=!0)}if(p){let i=0;for(let p=0;p<m.length;p++)null!==m[p]&&(m[i++]=m[p]);m.length=i}}unload(i){let m=this.renderer.texture,p=i._texture;p&&!p.framebuffer&&m.destroyTexture(p);for(let m=i.children.length-1;m>=0;m--)this.unload(i.children[m])}destroy(){this.renderer=null}};rs.defaultMode=tc.AUTO,rs.defaultMaxIdle=3600,rs.defaultCheckCountMax=600,rs.extension={type:t9.RendererSystem,name:"textureGC"},t7.add(rs);let GLTexture=class GLTexture{constructor(i){this.texture=i,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=tn.UNSIGNED_BYTE,this.internalFormat=ti.RGBA,this.samplerType=0}};function mapInternalFormatToSamplerType(i){return"WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext?{[i.RGB]:ta.FLOAT,[i.RGBA]:ta.FLOAT,[i.ALPHA]:ta.FLOAT,[i.LUMINANCE]:ta.FLOAT,[i.LUMINANCE_ALPHA]:ta.FLOAT,[i.R8]:ta.FLOAT,[i.R8_SNORM]:ta.FLOAT,[i.RG8]:ta.FLOAT,[i.RG8_SNORM]:ta.FLOAT,[i.RGB8]:ta.FLOAT,[i.RGB8_SNORM]:ta.FLOAT,[i.RGB565]:ta.FLOAT,[i.RGBA4]:ta.FLOAT,[i.RGB5_A1]:ta.FLOAT,[i.RGBA8]:ta.FLOAT,[i.RGBA8_SNORM]:ta.FLOAT,[i.RGB10_A2]:ta.FLOAT,[i.RGB10_A2UI]:ta.FLOAT,[i.SRGB8]:ta.FLOAT,[i.SRGB8_ALPHA8]:ta.FLOAT,[i.R16F]:ta.FLOAT,[i.RG16F]:ta.FLOAT,[i.RGB16F]:ta.FLOAT,[i.RGBA16F]:ta.FLOAT,[i.R32F]:ta.FLOAT,[i.RG32F]:ta.FLOAT,[i.RGB32F]:ta.FLOAT,[i.RGBA32F]:ta.FLOAT,[i.R11F_G11F_B10F]:ta.FLOAT,[i.RGB9_E5]:ta.FLOAT,[i.R8I]:ta.INT,[i.R8UI]:ta.UINT,[i.R16I]:ta.INT,[i.R16UI]:ta.UINT,[i.R32I]:ta.INT,[i.R32UI]:ta.UINT,[i.RG8I]:ta.INT,[i.RG8UI]:ta.UINT,[i.RG16I]:ta.INT,[i.RG16UI]:ta.UINT,[i.RG32I]:ta.INT,[i.RG32UI]:ta.UINT,[i.RGB8I]:ta.INT,[i.RGB8UI]:ta.UINT,[i.RGB16I]:ta.INT,[i.RGB16UI]:ta.UINT,[i.RGB32I]:ta.INT,[i.RGB32UI]:ta.UINT,[i.RGBA8I]:ta.INT,[i.RGBA8UI]:ta.UINT,[i.RGBA16I]:ta.INT,[i.RGBA16UI]:ta.UINT,[i.RGBA32I]:ta.INT,[i.RGBA32UI]:ta.UINT,[i.DEPTH_COMPONENT16]:ta.FLOAT,[i.DEPTH_COMPONENT24]:ta.FLOAT,[i.DEPTH_COMPONENT32F]:ta.FLOAT,[i.DEPTH_STENCIL]:ta.FLOAT,[i.DEPTH24_STENCIL8]:ta.FLOAT,[i.DEPTH32F_STENCIL8]:ta.FLOAT}:{[i.RGB]:ta.FLOAT,[i.RGBA]:ta.FLOAT,[i.ALPHA]:ta.FLOAT,[i.LUMINANCE]:ta.FLOAT,[i.LUMINANCE_ALPHA]:ta.FLOAT,[i.DEPTH_STENCIL]:ta.FLOAT}}function mapTypeAndFormatToInternalFormat(i){return"WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext?{[tn.UNSIGNED_BYTE]:{[ti.RGBA]:i.RGBA8,[ti.RGB]:i.RGB8,[ti.RG]:i.RG8,[ti.RED]:i.R8,[ti.RGBA_INTEGER]:i.RGBA8UI,[ti.RGB_INTEGER]:i.RGB8UI,[ti.RG_INTEGER]:i.RG8UI,[ti.RED_INTEGER]:i.R8UI,[ti.ALPHA]:i.ALPHA,[ti.LUMINANCE]:i.LUMINANCE,[ti.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[tn.BYTE]:{[ti.RGBA]:i.RGBA8_SNORM,[ti.RGB]:i.RGB8_SNORM,[ti.RG]:i.RG8_SNORM,[ti.RED]:i.R8_SNORM,[ti.RGBA_INTEGER]:i.RGBA8I,[ti.RGB_INTEGER]:i.RGB8I,[ti.RG_INTEGER]:i.RG8I,[ti.RED_INTEGER]:i.R8I},[tn.UNSIGNED_SHORT]:{[ti.RGBA_INTEGER]:i.RGBA16UI,[ti.RGB_INTEGER]:i.RGB16UI,[ti.RG_INTEGER]:i.RG16UI,[ti.RED_INTEGER]:i.R16UI,[ti.DEPTH_COMPONENT]:i.DEPTH_COMPONENT16},[tn.SHORT]:{[ti.RGBA_INTEGER]:i.RGBA16I,[ti.RGB_INTEGER]:i.RGB16I,[ti.RG_INTEGER]:i.RG16I,[ti.RED_INTEGER]:i.R16I},[tn.UNSIGNED_INT]:{[ti.RGBA_INTEGER]:i.RGBA32UI,[ti.RGB_INTEGER]:i.RGB32UI,[ti.RG_INTEGER]:i.RG32UI,[ti.RED_INTEGER]:i.R32UI,[ti.DEPTH_COMPONENT]:i.DEPTH_COMPONENT24},[tn.INT]:{[ti.RGBA_INTEGER]:i.RGBA32I,[ti.RGB_INTEGER]:i.RGB32I,[ti.RG_INTEGER]:i.RG32I,[ti.RED_INTEGER]:i.R32I},[tn.FLOAT]:{[ti.RGBA]:i.RGBA32F,[ti.RGB]:i.RGB32F,[ti.RG]:i.RG32F,[ti.RED]:i.R32F,[ti.DEPTH_COMPONENT]:i.DEPTH_COMPONENT32F},[tn.HALF_FLOAT]:{[ti.RGBA]:i.RGBA16F,[ti.RGB]:i.RGB16F,[ti.RG]:i.RG16F,[ti.RED]:i.R16F},[tn.UNSIGNED_SHORT_5_6_5]:{[ti.RGB]:i.RGB565},[tn.UNSIGNED_SHORT_4_4_4_4]:{[ti.RGBA]:i.RGBA4},[tn.UNSIGNED_SHORT_5_5_5_1]:{[ti.RGBA]:i.RGB5_A1},[tn.UNSIGNED_INT_2_10_10_10_REV]:{[ti.RGBA]:i.RGB10_A2,[ti.RGBA_INTEGER]:i.RGB10_A2UI},[tn.UNSIGNED_INT_10F_11F_11F_REV]:{[ti.RGB]:i.R11F_G11F_B10F},[tn.UNSIGNED_INT_5_9_9_9_REV]:{[ti.RGB]:i.RGB9_E5},[tn.UNSIGNED_INT_24_8]:{[ti.DEPTH_STENCIL]:i.DEPTH24_STENCIL8},[tn.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[ti.DEPTH_STENCIL]:i.DEPTH32F_STENCIL8}}:{[tn.UNSIGNED_BYTE]:{[ti.RGBA]:i.RGBA,[ti.RGB]:i.RGB,[ti.ALPHA]:i.ALPHA,[ti.LUMINANCE]:i.LUMINANCE,[ti.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[tn.UNSIGNED_SHORT_5_6_5]:{[ti.RGB]:i.RGB},[tn.UNSIGNED_SHORT_4_4_4_4]:{[ti.RGBA]:i.RGBA},[tn.UNSIGNED_SHORT_5_5_5_1]:{[ti.RGBA]:i.RGBA}}}let TextureSystem=class TextureSystem{constructor(i){this.renderer=i,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new es,this.hasIntegerTextures=!1}contextChange(){let i=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=mapTypeAndFormatToInternalFormat(i),this.samplerTypes=mapInternalFormatToSamplerType(i);let m=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=m;for(let i=0;i<m;i++)this.boundTextures[i]=null;this.emptyTextures={};let p=new GLTexture(i.createTexture());i.bindTexture(i.TEXTURE_2D,p.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[i.TEXTURE_2D]=p,this.emptyTextures[i.TEXTURE_CUBE_MAP]=new GLTexture(i.createTexture()),i.bindTexture(i.TEXTURE_CUBE_MAP,this.emptyTextures[i.TEXTURE_CUBE_MAP].texture);for(let m=0;m<6;m++)i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,null);i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MIN_FILTER,i.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(i,m=0){let{gl:p}=this;if(i=i?.castToBaseTexture(),i?.valid&&!i.parentTextureArray){i.touched=this.renderer.textureGC.count;let _=i._glTextures[this.CONTEXT_UID]||this.initTexture(i);this.boundTextures[m]!==i&&(this.currentLocation!==m&&(this.currentLocation=m,p.activeTexture(p.TEXTURE0+m)),p.bindTexture(i.target,_.texture)),_.dirtyId!==i.dirtyId?(this.currentLocation!==m&&(this.currentLocation=m,p.activeTexture(p.TEXTURE0+m)),this.updateTexture(i)):_.dirtyStyleId!==i.dirtyStyleId&&this.updateTextureStyle(i),this.boundTextures[m]=i}else this.currentLocation!==m&&(this.currentLocation=m,p.activeTexture(p.TEXTURE0+m)),p.bindTexture(p.TEXTURE_2D,this.emptyTextures[p.TEXTURE_2D].texture),this.boundTextures[m]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let i=0;i<this.boundTextures.length;i++)this.boundTextures[i]=this.unknownTexture}unbind(i){let{gl:m,boundTextures:p}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<p.length;i++)p[i]===this.unknownTexture&&this.bind(null,i)}for(let _=0;_<p.length;_++)p[_]===i&&(this.currentLocation!==_&&(m.activeTexture(m.TEXTURE0+_),this.currentLocation=_),m.bindTexture(i.target,this.emptyTextures[i.target].texture),p[_]=null)}ensureSamplerType(i){let{boundTextures:m,hasIntegerTextures:p,CONTEXT_UID:_}=this;if(p)for(let p=i-1;p>=0;--p){let i=m[p];i&&i._glTextures[_].samplerType!==ta.FLOAT&&this.renderer.texture.unbind(i)}}initTexture(i){let m=new GLTexture(this.gl.createTexture());return m.dirtyId=-1,i._glTextures[this.CONTEXT_UID]=m,this.managedTextures.push(i),i.on("dispose",this.destroyTexture,this),m}initTextureType(i,m){m.internalFormat=this.internalFormats[i.type]?.[i.format]??i.format,m.samplerType=this.samplerTypes[m.internalFormat]??ta.FLOAT,2===this.webGLVersion&&i.type===tn.HALF_FLOAT?m.type=this.gl.HALF_FLOAT:m.type=i.type}updateTexture(i){let m=i._glTextures[this.CONTEXT_UID];if(!m)return;let p=this.renderer;if(this.initTextureType(i,m),i.resource?.upload(p,i,m))m.samplerType!==ta.FLOAT&&(this.hasIntegerTextures=!0);else{let _=i.realWidth,x=i.realHeight,y=p.gl;(m.width!==_||m.height!==x||m.dirtyId<0)&&(m.width=_,m.height=x,y.texImage2D(i.target,0,m.internalFormat,_,x,0,i.format,m.type,null))}i.dirtyStyleId!==m.dirtyStyleId&&this.updateTextureStyle(i),m.dirtyId=i.dirtyId}destroyTexture(i,m){let{gl:p}=this;if((i=i.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(i),p.deleteTexture(i._glTextures[this.CONTEXT_UID].texture),i.off("dispose",this.destroyTexture,this),delete i._glTextures[this.CONTEXT_UID],!m)){let m=this.managedTextures.indexOf(i);-1!==m&&removeItems(this.managedTextures,m,1)}}updateTextureStyle(i){let m=i._glTextures[this.CONTEXT_UID];m&&(i.mipmap!==th.POW2&&2===this.webGLVersion||i.isPowerOfTwo?m.mipmap=i.mipmap>=1:m.mipmap=!1,2===this.webGLVersion||i.isPowerOfTwo?m.wrapMode=i.wrapMode:m.wrapMode=tl.CLAMP,i.resource?.style(this.renderer,i,m)||this.setStyle(i,m),m.dirtyStyleId=i.dirtyStyleId)}setStyle(i,m){let p=this.gl;if(m.mipmap&&i.mipmap!==th.ON_MANUAL&&p.generateMipmap(i.target),p.texParameteri(i.target,p.TEXTURE_WRAP_S,m.wrapMode),p.texParameteri(i.target,p.TEXTURE_WRAP_T,m.wrapMode),m.mipmap){p.texParameteri(i.target,p.TEXTURE_MIN_FILTER,i.scaleMode===to.LINEAR?p.LINEAR_MIPMAP_LINEAR:p.NEAREST_MIPMAP_NEAREST);let m=this.renderer.context.extensions.anisotropicFiltering;if(m&&i.anisotropicLevel>0&&i.scaleMode===to.LINEAR){let _=Math.min(i.anisotropicLevel,p.getParameter(m.MAX_TEXTURE_MAX_ANISOTROPY_EXT));p.texParameterf(i.target,m.TEXTURE_MAX_ANISOTROPY_EXT,_)}}else p.texParameteri(i.target,p.TEXTURE_MIN_FILTER,i.scaleMode===to.LINEAR?p.LINEAR:p.NEAREST);p.texParameteri(i.target,p.TEXTURE_MAG_FILTER,i.scaleMode===to.LINEAR?p.LINEAR:p.NEAREST)}destroy(){this.renderer=null}};TextureSystem.extension={type:t9.RendererSystem,name:"texture"},t7.add(TextureSystem);let TransformFeedbackSystem=class TransformFeedbackSystem{constructor(i){this.renderer=i}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(i){let{gl:m,CONTEXT_UID:p}=this,_=i._glTransformFeedbacks[p]||this.createGLTransformFeedback(i);m.bindTransformFeedback(m.TRANSFORM_FEEDBACK,_)}unbind(){let{gl:i}=this;i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(i,m){let{gl:p,renderer:_}=this;m&&_.shader.bind(m),p.beginTransformFeedback(i)}endTransformFeedback(){let{gl:i}=this;i.endTransformFeedback()}createGLTransformFeedback(i){let{gl:m,renderer:p,CONTEXT_UID:_}=this,x=m.createTransformFeedback();i._glTransformFeedbacks[_]=x,m.bindTransformFeedback(m.TRANSFORM_FEEDBACK,x);for(let x=0;x<i.buffers.length;x++){let y=i.buffers[x];y&&(p.buffer.update(y),y._glBuffers[_].refCount++,m.bindBufferBase(m.TRANSFORM_FEEDBACK_BUFFER,x,y._glBuffers[_].buffer||null))}return m.bindTransformFeedback(m.TRANSFORM_FEEDBACK,null),i.disposeRunner.add(this),x}disposeTransformFeedback(i,m){let p=i._glTransformFeedbacks[this.CONTEXT_UID],_=this.gl;i.disposeRunner.remove(this);let x=this.renderer.buffer;if(x)for(let p=0;p<i.buffers.length;p++){let _=i.buffers[p];if(!_)continue;let y=_._glBuffers[this.CONTEXT_UID];y&&(y.refCount--,0!==y.refCount||m||x.dispose(_,m))}p&&(m||_.deleteTransformFeedback(p),delete i._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}};TransformFeedbackSystem.extension={type:t9.RendererSystem,name:"transformFeedback"},t7.add(TransformFeedbackSystem);let ViewSystem=class ViewSystem{constructor(i){this.renderer=i}init(i){this.screen=new Rectangle(0,0,i.width,i.height),this.element=i.view||tx.ADAPTER.createCanvas(),this.resolution=i.resolution||tx.RESOLUTION,this.autoDensity=!!i.autoDensity}resizeView(i,m){this.element.width=Math.round(i*this.resolution),this.element.height=Math.round(m*this.resolution);let p=this.element.width/this.resolution,_=this.element.height/this.resolution;this.screen.width=p,this.screen.height=_,this.autoDensity&&(this.element.style.width=`${p}px`,this.element.style.height=`${_}px`),this.renderer.emit("resize",p,_),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(i){i&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}};ViewSystem.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},ViewSystem.extension={type:[t9.RendererSystem,t9.CanvasRendererSystem],name:"_view"},t7.add(ViewSystem),tx.PREFER_ENV=J.WEBGL2,tx.STRICT_TEXTURE_CACHE=!1,tx.RENDER_OPTIONS={...ContextSystem.defaultOptions,...BackgroundSystem.defaultOptions,...ViewSystem.defaultOptions,...StartupSystem.defaultOptions},Object.defineProperties(tx,{WRAP_MODE:{get:()=>es.defaultOptions.wrapMode,set(i){deprecation("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),es.defaultOptions.wrapMode=i}},SCALE_MODE:{get:()=>es.defaultOptions.scaleMode,set(i){deprecation("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),es.defaultOptions.scaleMode=i}},MIPMAP_TEXTURES:{get:()=>es.defaultOptions.mipmap,set(i){deprecation("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),es.defaultOptions.mipmap=i}},ANISOTROPIC_LEVEL:{get:()=>es.defaultOptions.anisotropicLevel,set(i){deprecation("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),es.defaultOptions.anisotropicLevel=i}},FILTER_RESOLUTION:{get:()=>(deprecation("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),e$.defaultResolution),set(i){e$.defaultResolution=i}},FILTER_MULTISAMPLE:{get:()=>(deprecation("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),e$.defaultMultisample),set(i){e$.defaultMultisample=i}},SPRITE_MAX_TEXTURES:{get:()=>eY.defaultMaxTextures,set(i){deprecation("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),eY.defaultMaxTextures=i}},SPRITE_BATCH_SIZE:{get:()=>eY.defaultBatchSize,set(i){deprecation("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),eY.defaultBatchSize=i}},CAN_UPLOAD_SAME_BUFFER:{get:()=>eY.canUploadSameBuffer,set(i){deprecation("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),eY.canUploadSameBuffer=i}},GC_MODE:{get:()=>rs.defaultMode,set(i){deprecation("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),rs.defaultMode=i}},GC_MAX_IDLE:{get:()=>rs.defaultMaxIdle,set(i){deprecation("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),rs.defaultMaxIdle=i}},GC_MAX_CHECK_COUNT:{get:()=>rs.defaultCheckCountMax,set(i){deprecation("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),rs.defaultCheckCountMax=i}},PRECISION_VERTEX:{get:()=>eO.defaultVertexPrecision,set(i){deprecation("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),eO.defaultVertexPrecision=i}},PRECISION_FRAGMENT:{get:()=>eO.defaultFragmentPrecision,set(i){deprecation("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),eO.defaultFragmentPrecision=i}}});var rn=((Z=rn||{})[Z.INTERACTION=50]="INTERACTION",Z[Z.HIGH=25]="HIGH",Z[Z.NORMAL=0]="NORMAL",Z[Z.LOW=-25]="LOW",Z[Z.UTILITY=-50]="UTILITY",Z);let TickerListener=class TickerListener{constructor(i,m=null,p=0,_=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=i,this.context=m,this.priority=p,this.once=_}match(i,m=null){return this.fn===i&&this.context===m}emit(i){this.fn&&(this.context?this.fn.call(this.context,i):this.fn(i));let m=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),m}connect(i){this.previous=i,i.next&&(i.next.previous=this),this.next=i.next,i.next=this}destroy(i=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let m=this.next;return this.next=i?null:m,this.previous=null,m}};let ra=class _Ticker2{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener(null,null,1/0),this.deltaMS=1/_Ticker2.targetFPMS,this.elapsedMS=1/_Ticker2.targetFPMS,this._tick=i=>{this._requestId=null,this.started&&(this.update(i),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(i,m,p=rn.NORMAL){return this._addListener(new TickerListener(i,m,p))}addOnce(i,m,p=rn.NORMAL){return this._addListener(new TickerListener(i,m,p,!0))}_addListener(i){let m=this._head.next,p=this._head;if(m){for(;m;){if(i.priority>m.priority){i.connect(p);break}p=m,m=m.next}i.previous||i.connect(p)}else i.connect(p);return this._startIfPossible(),this}remove(i,m){let p=this._head.next;for(;p;)p=p.match(i,m)?p.destroy():p.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let i=0,m=this._head;for(;m=m.next;)i++;return i}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let i=this._head.next;for(;i;)i=i.destroy(!0);this._head.destroy(),this._head=null}}update(i=performance.now()){let m;if(i>this.lastTime){if((m=this.elapsedMS=i-this.lastTime)>this._maxElapsedMS&&(m=this._maxElapsedMS),m*=this.speed,this._minElapsedMS){let m=i-this._lastFrame|0;if(m<this._minElapsedMS)return;this._lastFrame=i-m%this._minElapsedMS}this.deltaMS=m,this.deltaTime=this.deltaMS*_Ticker2.targetFPMS;let p=this._head,_=p.next;for(;_;)_=_.emit(this.deltaTime);p.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=i}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(i){let m=Math.min(this.maxFPS,i),p=Math.min(Math.max(0,m)/1e3,_Ticker2.targetFPMS);this._maxElapsedMS=1/p}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(i){if(0===i)this._minElapsedMS=0;else{let m=Math.max(this.minFPS,i);this._minElapsedMS=1/(m/1e3)}}static get shared(){if(!_Ticker2._shared){let i=_Ticker2._shared=new _Ticker2;i.autoStart=!0,i._protected=!0}return _Ticker2._shared}static get system(){if(!_Ticker2._system){let i=_Ticker2._system=new _Ticker2;i.autoStart=!0,i._protected=!0}return _Ticker2._system}};ra.targetFPMS=.06;let ro=ra;Object.defineProperties(tx,{TARGET_FPMS:{get:()=>ro.targetFPMS,set(i){deprecation("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ro.targetFPMS=i}}});let TickerPlugin=class TickerPlugin{static init(i){i=Object.assign({autoStart:!0,sharedTicker:!1},i),Object.defineProperty(this,"ticker",{set(i){this._ticker&&this._ticker.remove(this.render,this),this._ticker=i,i&&i.add(this.render,this,rn.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=i.sharedTicker?ro.shared:new ro,i.autoStart&&this.start()}static destroy(){if(this._ticker){let i=this._ticker;this.ticker=null,i.destroy()}}};TickerPlugin.extension=t9.Application,t7.add(TickerPlugin);let rl=[];function autoDetectRenderer(i){for(let m of rl)if(m.test(i))return new m(i);throw Error("Unable to auto-detect a suitable renderer.")}t7.handleByList(t9.Renderer,rl);var rh=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ru=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;let rd=rh,rc=ru;let MultisampleSystem=class MultisampleSystem{constructor(i){this.renderer=i}contextChange(i){let m;if(1===this.renderer.context.webGLVersion){let p=i.getParameter(i.FRAMEBUFFER_BINDING);i.bindFramebuffer(i.FRAMEBUFFER,null),m=i.getParameter(i.SAMPLES),i.bindFramebuffer(i.FRAMEBUFFER,p)}else{let p=i.getParameter(i.DRAW_FRAMEBUFFER_BINDING);i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),m=i.getParameter(i.SAMPLES),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,p)}m>=tg.HIGH?this.multisample=tg.HIGH:m>=tg.MEDIUM?this.multisample=tg.MEDIUM:m>=tg.LOW?this.multisample=tg.LOW:this.multisample=tg.NONE}destroy(){}};MultisampleSystem.extension={type:t9.RendererSystem,name:"_multisample"},t7.add(MultisampleSystem);let GLBuffer=class GLBuffer{constructor(i){this.buffer=i||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}};let BufferSystem=class BufferSystem{constructor(i){this.renderer=i,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(i){let{gl:m,CONTEXT_UID:p}=this,_=i._glBuffers[p]||this.createGLBuffer(i);m.bindBuffer(i.type,_.buffer)}unbind(i){let{gl:m}=this;m.bindBuffer(i,null)}bindBufferBase(i,m){let{gl:p,CONTEXT_UID:_}=this;if(this.boundBufferBases[m]!==i){let x=i._glBuffers[_]||this.createGLBuffer(i);this.boundBufferBases[m]=i,p.bindBufferBase(p.UNIFORM_BUFFER,m,x.buffer)}}bindBufferRange(i,m,p){let{gl:_,CONTEXT_UID:x}=this;p=p||0;let y=i._glBuffers[x]||this.createGLBuffer(i);_.bindBufferRange(_.UNIFORM_BUFFER,m||0,y.buffer,256*p,256)}update(i){let{gl:m,CONTEXT_UID:p}=this,_=i._glBuffers[p]||this.createGLBuffer(i);if(i._updateID!==_.updateID){if(_.updateID=i._updateID,m.bindBuffer(i.type,_.buffer),_.byteLength>=i.data.byteLength)m.bufferSubData(i.type,0,i.data);else{let p=i.static?m.STATIC_DRAW:m.DYNAMIC_DRAW;_.byteLength=i.data.byteLength,m.bufferData(i.type,i.data,p)}}}dispose(i,m){if(!this.managedBuffers[i.id])return;delete this.managedBuffers[i.id];let p=i._glBuffers[this.CONTEXT_UID],_=this.gl;i.disposeRunner.remove(this),p&&(m||_.deleteBuffer(p.buffer),delete i._glBuffers[this.CONTEXT_UID])}disposeAll(i){let m=Object.keys(this.managedBuffers);for(let p=0;p<m.length;p++)this.dispose(this.managedBuffers[m[p]],i)}createGLBuffer(i){let{CONTEXT_UID:m,gl:p}=this;return i._glBuffers[m]=new GLBuffer(p.createBuffer()),this.managedBuffers[i.id]=i,i.disposeRunner.add(this),i._glBuffers[m]}};BufferSystem.extension={type:t9.RendererSystem,name:"buffer"},t7.add(BufferSystem);let ObjectRendererSystem=class ObjectRendererSystem{constructor(i){this.renderer=i}render(i,m){let p,_,x,y;let T=this.renderer;if(m&&(p=m.renderTexture,_=m.clear,x=m.transform,y=m.skipUpdateTransform),this.renderingToScreen=!p,T.runners.prerender.emit(),T.emit("prerender"),T.projection.transform=x,!T.context.isLost){if(p||(this.lastObjectRendered=i),!y){let m=i.enableTempParent();i.updateTransform(),i.disableTempParent(m)}T.renderTexture.bind(p),T.batch.currentRenderer.start(),(_??T.background.clearBeforeRender)&&T.renderTexture.clear(),i.render(T),T.batch.currentRenderer.flush(),p&&(m.blit&&T.framebuffer.blit(),p.baseTexture.update()),T.runners.postrender.emit(),T.projection.transform=null,T.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}};ObjectRendererSystem.extension={type:t9.RendererSystem,name:"objectRenderer"},t7.add(ObjectRendererSystem);let rm=class _Renderer2 extends SystemManager{constructor(i){super(),this.type=Q.WEBGL,i=Object.assign({},tx.RENDER_OPTIONS,i),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new UniformGroup({projectionMatrix:new Matrix},!0);let m={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:_Renderer2.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(m),"useContextAlpha"in i&&(deprecation("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),i.premultipliedAlpha=i.useContextAlpha&&"notMultiplied"!==i.useContextAlpha,i.backgroundAlpha=!1===i.useContextAlpha?1:i.backgroundAlpha),this._plugin.rendererPlugins=_Renderer2.__plugins,this.options=i,this.startup.run(this.options)}static test(i){return!i?.forceCanvas&&isWebGLSupported()}render(i,m){this.objectRenderer.render(i,m)}resize(i,m){this._view.resizeView(i,m)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(i=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:i}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(i){this._view.resolution=i,this.runners.resolutionChange.emit(i)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return deprecation("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return deprecation("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return deprecation("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(i){deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=i}get backgroundAlpha(){return deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(i){deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=i}get powerPreference(){return deprecation("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(i,m){return this.textureGenerator.generateTexture(i,m)}};rm.extension={type:t9.Renderer,priority:1},rm.__plugins={},rm.__systems={},t7.handleByMap(t9.RendererPlugin,rm.__plugins),t7.handleByMap(t9.RendererSystem,rm.__systems),t7.add(rm);let AbstractMultiResource=class AbstractMultiResource extends Resource{constructor(i,m){let{width:p,height:_}=m||{};super(p,_),this.items=[],this.itemDirtyIds=[];for(let m=0;m<i;m++){let i=new es;this.items.push(i),this.itemDirtyIds.push(-2)}this.length=i,this._load=null,this.baseTexture=null}initFromArray(i,m){for(let p=0;p<this.length;p++)i[p]&&(i[p].castToBaseTexture?this.addBaseTextureAt(i[p].castToBaseTexture(),p):i[p]instanceof Resource?this.addResourceAt(i[p],p):this.addResourceAt(autoDetectResource(i[p],m),p))}dispose(){for(let i=0,m=this.length;i<m;i++)this.items[i].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(i,m){if(!this.items[m])throw Error(`Index ${m} is out of bounds`);return i.valid&&!this.valid&&this.resize(i.width,i.height),this.items[m].setResource(i),this}bind(i){if(null!==this.baseTexture)throw Error("Only one base texture per TextureArray is allowed");super.bind(i);for(let m=0;m<this.length;m++)this.items[m].parentTextureArray=i,this.items[m].on("update",i.update,i)}unbind(i){super.unbind(i);for(let m=0;m<this.length;m++)this.items[m].parentTextureArray=null,this.items[m].off("update",i.update,i)}load(){if(this._load)return this._load;let i=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(i).then(()=>{let{realWidth:i,realHeight:m}=this.items[0];return this.resize(i,m),this.update(),Promise.resolve(this)}),this._load}};let ArrayResource=class ArrayResource extends AbstractMultiResource{constructor(i,m){let p,_;let{width:x,height:y}=m||{};Array.isArray(i)?(p=i,_=i.length):_=i,super(_,{width:x,height:y}),p&&this.initFromArray(p,m)}addBaseTextureAt(i,m){if(i.resource)this.addResourceAt(i.resource,m);else throw Error("ArrayResource does not support RenderTexture");return this}bind(i){super.bind(i),i.target=ts.TEXTURE_2D_ARRAY}upload(i,m,p){let{length:_,itemDirtyIds:x,items:y}=this,{gl:T}=i;p.dirtyId<0&&T.texImage3D(T.TEXTURE_2D_ARRAY,0,p.internalFormat,this._width,this._height,_,0,m.format,p.type,null);for(let i=0;i<_;i++){let _=y[i];x[i]<_.dirtyId&&(x[i]=_.dirtyId,_.valid&&T.texSubImage3D(T.TEXTURE_2D_ARRAY,0,0,0,i,_.resource.width,_.resource.height,1,m.format,p.type,_.resource.source))}return!0}};let CanvasResource=class CanvasResource extends BaseImageResource{constructor(i){super(i)}static test(i){let{OffscreenCanvas:m}=globalThis;return!!m&&i instanceof m||globalThis.HTMLCanvasElement&&i instanceof HTMLCanvasElement}};let rf=class _CubeResource2 extends AbstractMultiResource{constructor(i,m){let{width:p,height:_,autoLoad:x,linkBaseTexture:y}=m||{};if(i&&i.length!==_CubeResource2.SIDES)throw Error(`Invalid length. Got ${i.length}, expected 6`);super(6,{width:p,height:_});for(let i=0;i<_CubeResource2.SIDES;i++)this.items[i].target=ts.TEXTURE_CUBE_MAP_POSITIVE_X+i;this.linkBaseTexture=!1!==y,i&&this.initFromArray(i,m),!1!==x&&this.load()}bind(i){super.bind(i),i.target=ts.TEXTURE_CUBE_MAP}addBaseTextureAt(i,m,p){if(void 0===p&&(p=this.linkBaseTexture),!this.items[m])throw Error(`Index ${m} is out of bounds`);if(!this.linkBaseTexture||i.parentTextureArray||Object.keys(i._glTextures).length>0){if(i.resource)this.addResourceAt(i.resource,m);else throw Error("CubeResource does not support copying of renderTexture.")}else i.target=ts.TEXTURE_CUBE_MAP_POSITIVE_X+m,i.parentTextureArray=this.baseTexture,this.items[m]=i;return i.valid&&!this.valid&&this.resize(i.realWidth,i.realHeight),this.items[m]=i,this}upload(i,m,p){let _=this.itemDirtyIds;for(let x=0;x<_CubeResource2.SIDES;x++){let y=this.items[x];(_[x]<y.dirtyId||p.dirtyId<m.dirtyId)&&(y.valid&&y.resource?(y.resource.upload(i,y,p),_[x]=y.dirtyId):_[x]<-1&&(i.gl.texImage2D(y.target,0,p.internalFormat,m.realWidth,m.realHeight,0,m.format,p.type,null),_[x]=-1))}return!0}static test(i){return Array.isArray(i)&&i.length===_CubeResource2.SIDES}};rf.SIDES=6;let ImageBitmapResource=class ImageBitmapResource extends BaseImageResource{constructor(i,m){let p,_,x;m=m||{},"string"==typeof i?(p=ImageBitmapResource.EMPTY,_=i,x=!0):(p=i,_=null,x=!1),super(p),this.url=_,this.crossOrigin=m.crossOrigin??!0,this.alphaMode="number"==typeof m.alphaMode?m.alphaMode:null,this.ownsImageBitmap=m.ownsImageBitmap??x,this._load=null,!1!==m.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise(async(i,m)=>{if(null===this.url){i(this);return}try{let m=await tx.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;let p=await m.blob();if(this.destroyed)return;let _=await createImageBitmap(p,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===tu.UNPACK?"premultiply":"none"});if(this.destroyed){_.close();return}this.source=_,this.update(),i(this)}catch(i){if(this.destroyed)return;m(i),this.onError.emit(i)}})),this._load}upload(i,m,p){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(m.alphaMode=this.alphaMode),super.upload(i,m,p)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(i){return!!globalThis.createImageBitmap&&"u">typeof ImageBitmap&&("string"==typeof i||i instanceof ImageBitmap)}static get EMPTY(){return ImageBitmapResource._EMPTY=ImageBitmapResource._EMPTY??tx.ADAPTER.createCanvas(0,0),ImageBitmapResource._EMPTY}};let rp=class _SVGResource2 extends BaseImageResource{constructor(i,m){m=m||{},super(tx.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=i,this.scale=m.scale||1,this._overrideWidth=m.width,this._overrideHeight=m.height,this._resolve=null,this._crossorigin=m.crossorigin,this._load=null,!1!==m.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise(i=>{if(this._resolve=()=>{this.update(),i(this)},_SVGResource2.SVG_XML.test(this.svg.trim())){if(!btoa)throw Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()})),this._load}_loadSvg(){let i=new Image;BaseImageResource.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onerror=m=>{this._resolve&&(i.onerror=null,this.onError.emit(m))},i.onload=()=>{if(!this._resolve)return;let m=i.width,p=i.height;if(!m||!p)throw Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let _=m*this.scale,x=p*this.scale;(this._overrideWidth||this._overrideHeight)&&(_=this._overrideWidth||this._overrideHeight/p*m,x=this._overrideHeight||this._overrideWidth/m*p),_=Math.round(_),x=Math.round(x);let y=this.source;y.width=_,y.height=x,y._pixiId=`canvas_${uid()}`,y.getContext("2d").drawImage(i,0,0,m,p,0,0,_,x),this._resolve(),this._resolve=null}}static getSize(i){let m=_SVGResource2.SVG_SIZE.exec(i),p={};return m&&(p[m[1]]=Math.round(parseFloat(m[3])),p[m[5]]=Math.round(parseFloat(m[7]))),p}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(i,m){return"svg"===m||"string"==typeof i&&i.startsWith("data:image/svg+xml")||"string"==typeof i&&_SVGResource2.SVG_XML.test(i)}};rp.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,rp.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let rg=rp,r_=class _VideoResource2 extends BaseImageResource{constructor(i,m){if(m=m||{},!(i instanceof HTMLVideoElement)){let p=document.createElement("video");!1!==m.autoLoad&&p.setAttribute("preload","auto"),!1!==m.playsinline&&(p.setAttribute("webkit-playsinline",""),p.setAttribute("playsinline","")),!0===m.muted&&(p.setAttribute("muted",""),p.muted=!0),!0===m.loop&&p.setAttribute("loop",""),!1!==m.autoPlay&&p.setAttribute("autoplay",""),"string"==typeof i&&(i=[i]);let _=i[0].src||i[0];BaseImageResource.crossOrigin(p,_,m.crossorigin);for(let m=0;m<i.length;++m){let _=document.createElement("source"),{src:x,mime:y}=i[m];if((x=x||i[m]).startsWith("data:"))y=x.slice(5,x.indexOf(";"));else if(!x.startsWith("blob:")){let i=x.split("?").shift().toLowerCase(),m=i.slice(i.lastIndexOf(".")+1);y=y||_VideoResource2.MIME_TYPES[m]||`video/${m}`}_.src=x,y&&(_.type=y),p.appendChild(_)}i=p}super(i),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=m.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==m.autoPlay,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==m.autoLoad&&this.load()}update(i=0){if(!this.destroyed){if(this._updateFPS){let i=ro.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-i)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;let i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart),i.addEventListener("pause",this._onPlayStop),i.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise((m,p)=>{this.valid?m(this):(this._resolve=m,this._reject=p,i.load())}),this._load}_onError(i){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(i),this._reject&&(this._reject(i),this._reject=null,this._resolve=null)}_isSourcePlaying(){let i=this.source;return!i.paused&&!i.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){let i=this.source;i.removeEventListener("canplay",this._onCanPlay),i.removeEventListener("canplaythrough",this._onCanPlay);let m=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!m&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&i.play()}dispose(){this._configureAutoUpdate();let i=this.source;i&&(i.removeEventListener("play",this._onPlayStart),i.removeEventListener("pause",this._onPlayStop),i.removeEventListener("seeked",this._onSeeked),i.removeEventListener("canplay",this._onCanPlay),i.removeEventListener("canplaythrough",this._onCanPlay),i.removeEventListener("error",this._onError,!0),i.pause(),i.src="",i.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(i){i!==this._autoUpdate&&(this._autoUpdate=i,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(i){i!==this._updateFPS&&(this._updateFPS=i,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ro.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ro.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ro.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(i,m){return globalThis.HTMLVideoElement&&i instanceof HTMLVideoElement||_VideoResource2.TYPES.includes(m)}};r_.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],r_.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let rx=r_;ee.push(ImageBitmapResource,ImageResource,CanvasResource,rx,rg,BufferResource,rf,ArrayResource)},607:function(i,m,p){"use strict";p.d(m,{YZ:function(){return Bounds},W2:function(){return T},s$:function(){return DisplayObject}});var _=p(6392);let Bounds=class Bounds{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(i){return this.minX>this.maxX||this.minY>this.maxY?_.Ae.EMPTY:((i=i||new _.Ae(0,0,1,1)).x=this.minX,i.y=this.minY,i.width=this.maxX-this.minX,i.height=this.maxY-this.minY,i)}addPoint(i){this.minX=Math.min(this.minX,i.x),this.maxX=Math.max(this.maxX,i.x),this.minY=Math.min(this.minY,i.y),this.maxY=Math.max(this.maxY,i.y)}addPointMatrix(i,m){let{a:p,b:_,c:x,d:y,tx:T,ty:v}=i,E=p*m.x+x*m.y+T,A=_*m.x+y*m.y+v;this.minX=Math.min(this.minX,E),this.maxX=Math.max(this.maxX,E),this.minY=Math.min(this.minY,A),this.maxY=Math.max(this.maxY,A)}addQuad(i){let m=this.minX,p=this.minY,_=this.maxX,x=this.maxY,y=i[0],T=i[1];m=y<m?y:m,p=T<p?T:p,_=y>_?y:_,x=T>x?T:x,y=i[2],T=i[3],m=y<m?y:m,p=T<p?T:p,_=y>_?y:_,x=T>x?T:x,y=i[4],T=i[5],m=y<m?y:m,p=T<p?T:p,_=y>_?y:_,x=T>x?T:x,y=i[6],T=i[7],m=y<m?y:m,p=T<p?T:p,_=y>_?y:_,x=T>x?T:x,this.minX=m,this.minY=p,this.maxX=_,this.maxY=x}addFrame(i,m,p,_,x){this.addFrameMatrix(i.worldTransform,m,p,_,x)}addFrameMatrix(i,m,p,_,x){let y=i.a,T=i.b,v=i.c,E=i.d,A=i.tx,S=i.ty,I=this.minX,R=this.minY,C=this.maxX,P=this.maxY,k=y*m+v*p+A,B=T*m+E*p+S;I=k<I?k:I,R=B<R?B:R,C=k>C?k:C,P=B>P?B:P,k=y*_+v*p+A,B=T*_+E*p+S,I=k<I?k:I,R=B<R?B:R,C=k>C?k:C,P=B>P?B:P,k=y*m+v*x+A,B=T*m+E*x+S,I=k<I?k:I,R=B<R?B:R,C=k>C?k:C,P=B>P?B:P,k=y*_+v*x+A,B=T*_+E*x+S,I=k<I?k:I,R=B<R?B:R,C=k>C?k:C,P=B>P?B:P,this.minX=I,this.minY=R,this.maxX=C,this.maxY=P}addVertexData(i,m,p){let _=this.minX,x=this.minY,y=this.maxX,T=this.maxY;for(let v=m;v<p;v+=2){let m=i[v],p=i[v+1];_=m<_?m:_,x=p<x?p:x,y=m>y?m:y,T=p>T?p:T}this.minX=_,this.minY=x,this.maxX=y,this.maxY=T}addVertices(i,m,p,_){this.addVerticesMatrix(i.worldTransform,m,p,_)}addVerticesMatrix(i,m,p,_,x=0,y=x){let T=i.a,v=i.b,E=i.c,A=i.d,S=i.tx,I=i.ty,R=this.minX,C=this.minY,P=this.maxX,k=this.maxY;for(let i=p;i<_;i+=2){let p=m[i],_=m[i+1],B=T*p+E*_+S,D=A*_+v*p+I;R=Math.min(R,B-x),P=Math.max(P,B+x),C=Math.min(C,D-y),k=Math.max(k,D+y)}this.minX=R,this.minY=C,this.maxX=P,this.maxY=k}addBounds(i){let m=this.minX,p=this.minY,_=this.maxX,x=this.maxY;this.minX=i.minX<m?i.minX:m,this.minY=i.minY<p?i.minY:p,this.maxX=i.maxX>_?i.maxX:_,this.maxY=i.maxY>x?i.maxY:x}addBoundsMask(i,m){let p=i.minX>m.minX?i.minX:m.minX,_=i.minY>m.minY?i.minY:m.minY,x=i.maxX<m.maxX?i.maxX:m.maxX,y=i.maxY<m.maxY?i.maxY:m.maxY;if(p<=x&&_<=y){let i=this.minX,m=this.minY,T=this.maxX,v=this.maxY;this.minX=p<i?p:i,this.minY=_<m?_:m,this.maxX=x>T?x:T,this.maxY=y>v?y:v}}addBoundsMatrix(i,m){this.addFrameMatrix(m,i.minX,i.minY,i.maxX,i.maxY)}addBoundsArea(i,m){let p=i.minX>m.x?i.minX:m.x,_=i.minY>m.y?i.minY:m.y,x=i.maxX<m.x+m.width?i.maxX:m.x+m.width,y=i.maxY<m.y+m.height?i.maxY:m.y+m.height;if(p<=x&&_<=y){let i=this.minX,m=this.minY,T=this.maxX,v=this.maxY;this.minX=p<i?p:i,this.minY=_<m?_:m,this.maxX=x>T?x:T,this.maxY=y>v?y:v}}pad(i=0,m=i){this.isEmpty()||(this.minX-=i,this.maxX+=i,this.minY-=m,this.maxY+=m)}addFramePad(i,m,p,_,x,y){i-=x,m-=y,p+=x,_+=y,this.minX=this.minX<i?this.minX:i,this.maxX=this.maxX>p?this.maxX:p,this.minY=this.minY<m?this.minY:m,this.maxY=this.maxY>_?this.maxY:_}};let DisplayObject=class DisplayObject extends _.P6.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new _.wx,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Bounds,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(i){let m=Object.keys(i);for(let p=0;p<m.length;++p){let _=m[p];Object.defineProperty(DisplayObject.prototype,_,Object.getOwnPropertyDescriptor(i,_))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(i,m){return i||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),m||(this._boundsRect||(this._boundsRect=new _.Ae),m=this._boundsRect),this._bounds.getRectangle(m)}getLocalBounds(i){i||(this._localBoundsRect||(this._localBoundsRect=new _.Ae),i=this._localBoundsRect),this._localBounds||(this._localBounds=new Bounds);let m=this.transform,p=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=p?.worldAlpha??1,this.transform=this._tempDisplayObjectParent.transform;let x=this._bounds,y=this._boundsID;this._bounds=this._localBounds;let T=this.getBounds(!1,i);return this.parent=p,this.transform=m,this._bounds=x,this._bounds.updateID+=this._boundsID-y,T}toGlobal(i,m,p=!1){return p||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(i,m)}toLocal(i,m,p,_){return m&&(i=m.toGlobal(i,p,_)),_||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(i,p)}setParent(i){if(!i||!i.addChild)throw Error("setParent: Argument must be a Container");return i.addChild(this),i}removeFromParent(){this.parent?.removeChild(this)}setTransform(i=0,m=0,p=1,_=1,x=0,y=0,T=0,v=0,E=0){return this.position.x=i,this.position.y=m,this.scale.x=p||1,this.scale.y=_||1,this.rotation=x,this.skew.x=y,this.skew.y=T,this.pivot.x=v,this.pivot.y=E,this}destroy(i){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new TemporaryDisplayObject),this.tempDisplayObjectParent}enableTempParent(){let i=this.parent;return this.parent=this._tempDisplayObjectParent,i}disableTempParent(i){this.parent=i}get x(){return this.position.x}set x(i){this.transform.position.x=i}get y(){return this.position.y}set y(i){this.transform.position.y=i}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(i){this.transform.position.copyFrom(i)}get scale(){return this.transform.scale}set scale(i){this.transform.scale.copyFrom(i)}get pivot(){return this.transform.pivot}set pivot(i){this.transform.pivot.copyFrom(i)}get skew(){return this.transform.skew}set skew(i){this.transform.skew.copyFrom(i)}get rotation(){return this.transform.rotation}set rotation(i){this.transform.rotation=i}get angle(){return this.transform.rotation*_.jl}set angle(i){this.transform.rotation=i*_.ZX}get zIndex(){return this._zIndex}set zIndex(i){this._zIndex=i,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let i=this;do{if(!i.visible)return!1;i=i.parent}while(i);return!0}get mask(){return this._mask}set mask(i){if(this._mask!==i){if(this._mask){let i=this._mask.isMaskData?this._mask.maskObject:this._mask;i&&(i._maskRefCount--,0===i._maskRefCount&&(i.renderable=!0,i.isMask=!1))}if(this._mask=i,this._mask){let i=this._mask.isMaskData?this._mask.maskObject:this._mask;i&&(0===i._maskRefCount&&(i.renderable=!1,i.isMask=!0),i._maskRefCount++)}}}};let TemporaryDisplayObject=class TemporaryDisplayObject extends DisplayObject{constructor(){super(...arguments),this.sortDirty=null}};DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform;let x=new _.y3;function sortChildren(i,m){return i.zIndex===m.zIndex?i._lastSortedIndex-m._lastSortedIndex:i.zIndex-m.zIndex}let y=class _Container2 extends DisplayObject{constructor(){super(),this.children=[],this.sortableChildren=_Container2.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(i){}addChild(...i){if(i.length>1)for(let m=0;m<i.length;m++)this.addChild(i[m]);else{let m=i[0];m.parent&&m.parent.removeChild(m),m.parent=this,this.sortDirty=!0,m.transform._parentID=-1,this.children.push(m),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",m,this,this.children.length-1),m.emit("added",this)}return i[0]}addChildAt(i,m){if(m<0||m>this.children.length)throw Error(`${i}addChildAt: The index ${m} supplied is out of bounds ${this.children.length}`);return i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.splice(m,0,i),this._boundsID++,this.onChildrenChange(m),i.emit("added",this),this.emit("childAdded",i,this,m),i}swapChildren(i,m){if(i===m)return;let p=this.getChildIndex(i),_=this.getChildIndex(m);this.children[p]=m,this.children[_]=i,this.onChildrenChange(p<_?p:_)}getChildIndex(i){let m=this.children.indexOf(i);if(-1===m)throw Error("The supplied DisplayObject must be a child of the caller");return m}setChildIndex(i,m){if(m<0||m>=this.children.length)throw Error(`The index ${m} supplied is out of bounds ${this.children.length}`);let p=this.getChildIndex(i);_.P6.removeItems(this.children,p,1),this.children.splice(m,0,i),this.onChildrenChange(m)}getChildAt(i){if(i<0||i>=this.children.length)throw Error(`getChildAt: Index (${i}) does not exist.`);return this.children[i]}removeChild(...i){if(i.length>1)for(let m=0;m<i.length;m++)this.removeChild(i[m]);else{let m=i[0],p=this.children.indexOf(m);if(-1===p)return null;m.parent=null,m.transform._parentID=-1,_.P6.removeItems(this.children,p,1),this._boundsID++,this.onChildrenChange(p),m.emit("removed",this),this.emit("childRemoved",m,this,p)}return i[0]}removeChildAt(i){let m=this.getChildAt(i);return m.parent=null,m.transform._parentID=-1,_.P6.removeItems(this.children,i,1),this._boundsID++,this.onChildrenChange(i),m.emit("removed",this),this.emit("childRemoved",m,this,i),m}removeChildren(i=0,m=this.children.length){let p;let _=m-i;if(_>0&&_<=m){p=this.children.splice(i,_);for(let i=0;i<p.length;++i)p[i].parent=null,p[i].transform&&(p[i].transform._parentID=-1);this._boundsID++,this.onChildrenChange(i);for(let i=0;i<p.length;++i)p[i].emit("removed",this),this.emit("childRemoved",p[i],this,i);return p}if(0===_&&0===this.children.length)return[];throw RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let i=!1;for(let m=0,p=this.children.length;m<p;++m){let p=this.children[m];p._lastSortedIndex=m,i||0===p.zIndex||(i=!0)}i&&this.children.length>1&&this.children.sort(sortChildren),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let i=0,m=this.children.length;i<m;++i){let m=this.children[i];m.visible&&m.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let i=0;i<this.children.length;i++){let m=this.children[i];if(!(!m.visible||!m.renderable)){if(m.calculateBounds(),m._mask){let i=m._mask.isMaskData?m._mask.maskObject:m._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(m._bounds,i._bounds)):this._bounds.addBounds(m._bounds)}else m.filterArea?this._bounds.addBoundsArea(m._bounds,m.filterArea):this._bounds.addBounds(m._bounds)}}this._bounds.updateID=this._boundsID}getLocalBounds(i,m=!1){let p=super.getLocalBounds(i);if(!m)for(let i=0,m=this.children.length;i<m;++i){let m=this.children[i];m.visible&&m.updateTransform()}return p}_calculateBounds(){}_renderWithCulling(i){let m,p;let _=i.renderTexture.sourceFrame;if(!(_.width>0&&_.height>0))return;this.cullArea?(m=this.cullArea,p=this.worldTransform):this._render!==_Container2.prototype._render&&(m=this.getBounds(!0));let y=i.projection.transform;if(y&&(p?(p=x.copyFrom(p)).prepend(y):p=y),m&&_.intersects(m,p))this._render(i);else if(this.cullArea)return;for(let m=0,p=this.children.length;m<p;++m){let p=this.children[m],_=p.cullable;p.cullable=_||!this.cullArea,p.render(i),p.cullable=_}}render(i){if(!(!this.visible||this.worldAlpha<=0||!this.renderable)){if(this._mask||this.filters?.length)this.renderAdvanced(i);else if(this.cullable)this._renderWithCulling(i);else{this._render(i);for(let m=0,p=this.children.length;m<p;++m)this.children[m].render(i)}}}renderAdvanced(i){let m=this.filters,p=this._mask;if(m){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let i=0;i<m.length;i++)m[i].enabled&&this._enabledFilters.push(m[i])}let x=m&&this._enabledFilters?.length||p&&(!p.isMaskData||p.enabled&&(p.autoDetect||p.type!==_.A7.NONE));if(x&&i.batch.flush(),m&&this._enabledFilters?.length&&i.filter.push(this,this._enabledFilters),p&&i.mask.push(this,this._mask),this.cullable)this._renderWithCulling(i);else{this._render(i);for(let m=0,p=this.children.length;m<p;++m)this.children[m].render(i)}x&&i.batch.flush(),p&&i.mask.pop(this),m&&this._enabledFilters?.length&&i.filter.pop()}_render(i){}destroy(i){super.destroy(),this.sortDirty=!1;let m="boolean"==typeof i?i:i?.children,p=this.removeChildren(0,this.children.length);if(m)for(let m=0;m<p.length;++m)p[m].destroy(i)}get width(){return this.scale.x*this.getLocalBounds().width}set width(i){let m=this.getLocalBounds().width;0!==m?this.scale.x=i/m:this.scale.x=1,this._width=i}get height(){return this.scale.y*this.getLocalBounds().height}set height(i){let m=this.getLocalBounds().height;0!==m?this.scale.y=i/m:this.scale.y=1,this._height=i}};y.defaultSortableChildren=!1;let T=y;T.prototype.containerUpdateTransform=T.prototype.updateTransform,Object.defineProperties(_.Xd,{SORTABLE_CHILDREN:{get:()=>T.defaultSortableChildren,set(i){_.P6.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),T.defaultSortableChildren=i}}})},7731:function(i,m,p){"use strict";p.d(m,{TC:function(){return L}});var _,x,y=p(6392);let T={build(i){let m,p,_,x,T,v;let E=i.points;if(i.type===y.HS.CIRC){let y=i.shape;m=y.x,p=y.y,T=v=y.radius,_=x=0}else if(i.type===y.HS.ELIP){let y=i.shape;m=y.x,p=y.y,T=y.width,v=y.height,_=x=0}else{let y=i.shape,E=y.width/2,A=y.height/2;m=y.x+E,p=y.y+A,T=v=Math.max(0,Math.min(y.radius,Math.min(E,A))),_=E-T,x=A-v}if(!(T>=0&&v>=0&&_>=0&&x>=0)){E.length=0;return}let A=Math.ceil(2.3*Math.sqrt(T+v)),S=8*A+(_?4:0)+(x?4:0);if(E.length=S,0===S)return;if(0===A){E.length=8,E[0]=E[6]=m+_,E[1]=E[3]=p+x,E[2]=E[4]=m-_,E[5]=E[7]=p-x;return}let I=0,R=4*A+(_?2:0)+2,C=R,P=S;{let i=_+T,y=x,v=m+i,A=m-i,S=p+y;if(E[I++]=v,E[I++]=S,E[--R]=S,E[--R]=A,x){let i=p-y;E[C++]=A,E[C++]=i,E[--P]=i,E[--P]=v}}for(let i=1;i<A;i++){let y=Math.PI/2*(i/A),S=_+Math.cos(y)*T,k=x+Math.sin(y)*v,B=m+S,D=m-S,F=p+k,L=p-k;E[I++]=B,E[I++]=F,E[--R]=F,E[--R]=D,E[C++]=D,E[C++]=L,E[--P]=L,E[--P]=B}{let i=_,y=x+v,T=m+i,A=m-i,S=p+y,R=p-y;E[I++]=T,E[I++]=S,E[--P]=R,E[--P]=T,_&&(E[I++]=A,E[I++]=S,E[--P]=R,E[--P]=A)}},triangulate(i,m){let p,_;let x=i.points,T=m.points,v=m.indices;if(0===x.length)return;let E=T.length/2,A=E;if(i.type!==y.HS.RREC){let m=i.shape;p=m.x,_=m.y}else{let m=i.shape;p=m.x+m.width/2,_=m.y+m.height/2}let S=i.matrix;T.push(i.matrix?S.a*p+S.c*_+S.tx:p,i.matrix?S.b*p+S.d*_+S.ty:_),E++,T.push(x[0],x[1]);for(let i=2;i<x.length;i+=2)T.push(x[i],x[i+1]),v.push(E++,A,E);v.push(A+1,A,E)}};function fixOrientation(i,m=!1){let p=i.length;if(p<6)return;let _=0;for(let m=0,x=i[p-2],y=i[p-1];m<p;m+=2){let p=i[m],T=i[m+1];_+=(p-x)*(T+y),x=p,y=T}if(!m&&_>0||m&&_<=0){let m=p/2;for(let _=m+m%2;_<p;_+=2){let m=p-_-2,x=p-_-1,y=_,T=_+1;[i[m],i[y]]=[i[y],i[m]],[i[x],i[T]]=[i[T],i[x]]}}}let v={build(i){i.points=i.shape.points.slice()},triangulate(i,m){let p=i.points,_=i.holes,x=m.points,T=m.indices;if(p.length>=6){fixOrientation(p,!1);let i=[];for(let m=0;m<_.length;m++){let x=_[m];fixOrientation(x.points,!0),i.push(p.length/2),p=p.concat(x.points)}let m=y.P6.earcut(p,i,2);if(!m)return;let v=x.length/2;for(let i=0;i<m.length;i+=3)T.push(m[i]+v),T.push(m[i+1]+v),T.push(m[i+2]+v);for(let i=0;i<p.length;i++)x.push(p[i])}}};var E=((_=E||{}).MITER="miter",_.BEVEL="bevel",_.ROUND="round",_),A=((x=A||{}).BUTT="butt",x.ROUND="round",x.SQUARE="square",x);let S={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(i,m=20){if(!this.adaptive||!i||isNaN(i))return m;let p=Math.ceil(i/this.maxLength);return p<this.minSegments?p=this.minSegments:p>this.maxSegments&&(p=this.maxSegments),p}};let ArcUtils=class ArcUtils{static curveTo(i,m,p,_,x,y){let T=y[y.length-2],v=y[y.length-1]-m,E=T-i,A=_-m,S=p-i,I=Math.abs(v*S-E*A);if(I<1e-8||0===x)return(y[y.length-2]!==i||y[y.length-1]!==m)&&y.push(i,m),null;let R=v*v+E*E,C=A*A+S*S,P=v*A+E*S,k=x*Math.sqrt(R)/I,B=x*Math.sqrt(C)/I,D=k*P/R,F=B*P/C,L=k*S+B*E,O=k*A+B*v;return{cx:L+i,cy:O+m,radius:x,startAngle:Math.atan2(v*(B+D)-O,E*(B+D)-L),endAngle:Math.atan2(A*(k+F)-O,S*(k+F)-L),anticlockwise:E*A>S*v}}static arc(i,m,p,_,x,T,v,E,A){let I=v-T,R=S._segmentsCount(Math.abs(I)*x,40*Math.ceil(Math.abs(I)/y._b)),C=I/(2*R),P=2*C,k=Math.cos(C),B=Math.sin(C),D=R-1,F=D%1/D;for(let i=0;i<=D;++i){let m=i+F*i,y=C+T+P*m,v=Math.cos(y),E=-Math.sin(y);A.push((k*v+B*E)*x+p,(-(k*E)+B*v)*x+_)}}};let BezierUtils=class BezierUtils{static curveLength(i,m,p,_,x,y,T,v){let E=0,A=0,S=0,I=0,R=0,C=0,P=0,k=0,B=0,D=0,F=0,L=i,O=m;for(let V=1;V<=10;++V)I=(S=(A=V/10)*A)*A,k=(P=(C=(R=1-A)*R)*R)*i+3*C*A*p+3*R*S*x+I*T,B=P*m+3*C*A*_+3*R*S*y+I*v,D=L-k,F=O-B,L=k,O=B,E+=Math.sqrt(D*D+F*F);return E}static curveTo(i,m,p,_,x,y,T){let v=T[T.length-2],E=T[T.length-1];T.length-=2;let A=S._segmentsCount(BezierUtils.curveLength(v,E,i,m,p,_,x,y)),I=0,R=0,C=0,P=0,k=0;T.push(v,E);for(let S=1,B=0;S<=A;++S)C=(R=(I=1-(B=S/A))*I)*I,k=(P=B*B)*B,T.push(C*v+3*R*B*i+3*I*P*p+k*x,C*E+3*R*B*m+3*I*P*_+k*y)}};function square(i,m,p,_,x,y,T,v){let E,A;T?(E=_,A=-p):(E=-_,A=p);let S=i-p*x+E,I=m-_*x+A,R=i+p*y+E,C=m+_*y+A;return v.push(S,I,R,C),2}function round(i,m,p,_,x,y,T,v){let E=p-i,A=_-m,S=Math.atan2(E,A),I=Math.atan2(x-i,y-m);v&&S<I?S+=2*Math.PI:!v&&S>I&&(I+=2*Math.PI);let R=S,C=I-S,P=Math.sqrt(E*E+A*A),k=(15*Math.abs(C)*Math.sqrt(P)/Math.PI>>0)+1,B=C/k;if(R+=B,v){T.push(i,m,p,_);for(let p=1,_=R;p<k;p++,_+=B)T.push(i,m,i+Math.sin(_)*P,m+Math.cos(_)*P);T.push(i,m,x,y)}else{T.push(p,_,i,m);for(let p=1,_=R;p<k;p++,_+=B)T.push(i+Math.sin(_)*P,m+Math.cos(_)*P,i,m);T.push(x,y,i,m)}return 2*k}function buildNonNativeLine(i,m){let p=i.shape,_=i.points||p.points.slice(),x=m.closePointEps;if(0===_.length)return;let T=i.lineStyle,v=new y.E9(_[0],_[1]),I=new y.E9(_[_.length-2],_[_.length-1]),R=p.type!==y.HS.POLY||p.closeStroke,C=Math.abs(v.x-I.x)<x&&Math.abs(v.y-I.y)<x;if(R){_=_.slice(),C&&(_.pop(),_.pop(),I.set(_[_.length-2],_[_.length-1]));let i=(v.x+I.x)*.5,m=(I.y+v.y)*.5;_.unshift(i,m),_.push(i,m)}let P=m.points,k=_.length/2,B=_.length,D=P.length/2,F=T.width/2,L=F*F,O=T.miterLimit*T.miterLimit,V=_[0],U=_[1],X=_[2],Y=_[3],G=0,W=0,z=-(U-Y),j=V-X,Z=0,K=0,J=Math.sqrt(z*z+j*j);z/=J,j/=J,z*=F,j*=F;let Q=T.alignment,tt=(1-Q)*2,te=2*Q;R||(T.cap===A.ROUND?B+=round(V-z*(tt-te)*.5,U-j*(tt-te)*.5,V-z*tt,U-j*tt,V+z*te,U+j*te,P,!0)+2:T.cap===A.SQUARE&&(B+=square(V,U,z,j,tt,te,!0,P))),P.push(V-z*tt,U-j*tt,V+z*te,U+j*te);for(let i=1;i<k-1;++i){V=_[(i-1)*2],U=_[(i-1)*2+1],X=_[2*i],Y=_[2*i+1],G=_[(i+1)*2],W=_[(i+1)*2+1],J=Math.sqrt((z=-(U-Y))*z+(j=V-X)*j),z/=J,j/=J,z*=F,j*=F,J=Math.sqrt((Z=-(Y-W))*Z+(K=X-G)*K),Z/=J,K/=J,Z*=F,K*=F;let m=X-V,p=U-Y,x=X-G,y=W-Y,v=m*x+p*y,A=p*x-y*m,S=A<0;if(Math.abs(A)<.001*Math.abs(v)){P.push(X-z*tt,Y-j*tt,X+z*te,Y+j*te),v>=0&&(T.join===E.ROUND?B+=round(X,Y,X-z*tt,Y-j*tt,X-Z*tt,Y-K*tt,P,!1)+4:B+=2,P.push(X-Z*te,Y-K*te,X+Z*tt,Y+K*tt));continue}let I=(-z+V)*(-j+Y)-(-z+X)*(-j+U),R=(-Z+G)*(-K+Y)-(-Z+X)*(-K+W),C=(m*R-x*I)/A,k=(y*I-p*R)/A,D=(C-X)*(C-X)+(k-Y)*(k-Y),Q=X+(C-X)*tt,tr=Y+(k-Y)*tt,ti=X-(C-X)*te,ts=Y-(k-Y)*te,tn=Math.min(m*m+p*p,x*x+y*y),ta=S?tt:te,to=tn+ta*ta*L,tl=D<=to,th=T.join;if(th===E.MITER&&D/L>O&&(th=E.BEVEL),tl)switch(th){case E.MITER:P.push(Q,tr,ti,ts);break;case E.BEVEL:S?P.push(Q,tr,X+z*te,Y+j*te,Q,tr,X+Z*te,Y+K*te):P.push(X-z*tt,Y-j*tt,ti,ts,X-Z*tt,Y-K*tt,ti,ts),B+=2;break;case E.ROUND:S?(P.push(Q,tr,X+z*te,Y+j*te),B+=round(X,Y,X+z*te,Y+j*te,X+Z*te,Y+K*te,P,!0)+4,P.push(Q,tr,X+Z*te,Y+K*te)):(P.push(X-z*tt,Y-j*tt,ti,ts),B+=round(X,Y,X-z*tt,Y-j*tt,X-Z*tt,Y-K*tt,P,!1)+4,P.push(X-Z*tt,Y-K*tt,ti,ts))}else{switch(P.push(X-z*tt,Y-j*tt,X+z*te,Y+j*te),th){case E.MITER:S?P.push(ti,ts,ti,ts):P.push(Q,tr,Q,tr),B+=2;break;case E.ROUND:S?B+=round(X,Y,X+z*te,Y+j*te,X+Z*te,Y+K*te,P,!0)+2:B+=round(X,Y,X-z*tt,Y-j*tt,X-Z*tt,Y-K*tt,P,!1)+2}P.push(X-Z*tt,Y-K*tt,X+Z*te,Y+K*te),B+=2}}V=_[(k-2)*2],U=_[(k-2)*2+1],X=_[(k-1)*2],J=Math.sqrt((z=-(U-(Y=_[(k-1)*2+1])))*z+(j=V-X)*j),z/=J,j/=J,z*=F,j*=F,P.push(X-z*tt,Y-j*tt,X+z*te,Y+j*te),R||(T.cap===A.ROUND?B+=round(X-z*(tt-te)*.5,Y-j*(tt-te)*.5,X-z*tt,Y-j*tt,X+z*te,Y+j*te,P,!1)+2:T.cap===A.SQUARE&&(B+=square(X,Y,z,j,tt,te,!1,P)));let tr=m.indices,ti=S.epsilon*S.epsilon;for(let i=D;i<B+D-2;++i)V=P[2*i],U=P[2*i+1],X=P[(i+1)*2],Y=P[(i+1)*2+1],G=P[(i+2)*2],Math.abs(V*(Y-(W=P[(i+2)*2+1]))+X*(W-U)+G*(U-Y))<ti||tr.push(i,i+1,i+2)}function buildNativeLine(i,m){let p=0,_=i.shape,x=i.points||_.points,T=_.type!==y.HS.POLY||_.closeStroke;if(0===x.length)return;let v=m.points,E=m.indices,A=x.length/2,S=v.length/2,I=S;for(v.push(x[0],x[1]),p=1;p<A;p++)v.push(x[2*p],x[2*p+1]),E.push(I,I+1),I++;T&&E.push(I,S)}function buildLine(i,m){i.lineStyle.native?buildNativeLine(i,m):buildNonNativeLine(i,m)}let QuadraticUtils=class QuadraticUtils{static curveLength(i,m,p,_,x,y){let T=i-2*p+x,v=m-2*_+y,E=2*p-2*i,A=2*_-2*m,S=4*(T*T+v*v),I=4*(T*E+v*A),R=E*E+A*A,C=2*Math.sqrt(S+I+R),P=Math.sqrt(S),k=2*S*P,B=2*Math.sqrt(R),D=I/P;return(k*C+P*I*(C-B)+(4*R*S-I*I)*Math.log((2*P+D+C)/(D+B)))/(4*k)}static curveTo(i,m,p,_,x){let y=x[x.length-2],T=x[x.length-1],v=S._segmentsCount(QuadraticUtils.curveLength(y,T,i,m,p,_)),E=0,A=0;for(let S=1;S<=v;++S){let I=S/v;E=y+(i-y)*I,A=T+(m-T)*I,x.push(E+(i+(p-i)*I-E)*I,A+(m+(_-m)*I-A)*I)}}};let I={[y.HS.POLY]:v,[y.HS.CIRC]:T,[y.HS.ELIP]:T,[y.HS.RECT]:{build(i){let m=i.shape,p=m.x,_=m.y,x=m.width,y=m.height,T=i.points;T.length=0,x>=0&&y>=0&&T.push(p,_,p+x,_,p+x,_+y,p,_+y)},triangulate(i,m){let p=i.points,_=m.points;if(0===p.length)return;let x=_.length/2;_.push(p[0],p[1],p[2],p[3],p[6],p[7],p[4],p[5]),m.indices.push(x,x+1,x+2,x+1,x+2,x+3)}},[y.HS.RREC]:{build(i){T.build(i)},triangulate(i,m){T.triangulate(i,m)}}},R=[],C=[];var P=p(607);let GraphicsData=class GraphicsData{constructor(i,m=null,p=null,_=null){this.points=[],this.holes=[],this.shape=i,this.lineStyle=p,this.fillStyle=m,this.matrix=_,this.type=i.type}clone(){return new GraphicsData(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}};let BatchPart=class BatchPart{constructor(){this.reset()}begin(i,m,p){this.reset(),this.style=i,this.start=m,this.attribStart=p}end(i,m){this.attribSize=m-this.attribStart,this.size=i-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}};let k=new y.E9,B=class _GraphicsGeometry2 extends y.JZ{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new P.YZ,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let i=0;i<this.drawCalls.length;i++)this.drawCalls[i].texArray.clear(),C.push(this.drawCalls[i]);this.drawCalls.length=0;for(let i=0;i<this.batches.length;i++){let m=this.batches[i];m.reset(),R.push(m)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(i,m=null,p=null,_=null){let x=new GraphicsData(i,m,p,_);return this.graphicsData.push(x),this.dirty++,this}drawHole(i,m=null){if(!this.graphicsData.length)return null;let p=new GraphicsData(i,null,null,m),_=this.graphicsData[this.graphicsData.length-1];return p.lineStyle=_.lineStyle,_.holes.push(p),this.dirty++,this}destroy(){super.destroy();for(let i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(i){let m=this.graphicsData;for(let p=0;p<m.length;++p){let _=m[p];if(_.fillStyle.visible&&_.shape&&(_.matrix?_.matrix.applyInverse(i,k):k.copyFrom(i),_.shape.contains(k.x,k.y))){let i=!1;if(_.holes){for(let m=0;m<_.holes.length;m++)if(_.holes[m].shape.contains(k.x,k.y)){i=!0;break}}if(!i)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;let i=this.uvs,m=this.graphicsData,p=null,_=null;this.batches.length>0&&(_=(p=this.batches[this.batches.length-1]).style);for(let x=this.shapeIndex;x<m.length;x++){this.shapeIndex++;let T=m[x],v=T.fillStyle,E=T.lineStyle;I[T.type].build(T),T.matrix&&this.transformPoints(T.points,T.matrix),(v.visible||E.visible)&&this.processHoles(T.holes);for(let m=0;m<2;m++){let x=0===m?v:E;if(!x.visible)continue;let A=x.texture.baseTexture,S=this.indices.length,I=this.points.length/2;A.wrapMode=y.Nt.REPEAT,0===m?this.processFill(T):this.processLine(T);let C=this.points.length/2-I;0!==C&&(p&&!this._compareStyles(_,x)&&(p.end(S,I),p=null),p||((p=R.pop()||new BatchPart).begin(x,S,I),this.batches.push(p),_=x),this.addUvs(this.points,i,x.texture,I,C,x.matrix))}}let x=this.indices.length,T=this.points.length/2;if(p&&p.end(x,T),0===this.batches.length){this.batchable=!0;return}let v=T>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&v===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=v?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(i,m){return!(!i||!m||i.texture.baseTexture!==m.texture.baseTexture||i.color+i.alpha!==m.color+m.alpha||!!i.native!=!!m.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let i=0,m=this.graphicsData.length;i<m;i++){let m=this.graphicsData[i],p=m.fillStyle,_=m.lineStyle;if(p&&!p.texture.baseTexture.valid||_&&!_.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);let i=this.batches;for(let m=0,p=i.length;m<p;m++){let p=i[m];for(let i=0;i<p.size;i++){let m=p.start+i;this.indicesUint16[m]=this.indicesUint16[m]-p.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;let i=this.batches;for(let m=0;m<i.length;m++)if(i[m].style.native)return!1;return this.points.length<2*_GraphicsGeometry2.BATCHABLE_SIZE}buildDrawCalls(){let i=++y.VL._globalBatch;for(let i=0;i<this.drawCalls.length;i++)this.drawCalls[i].texArray.clear(),C.push(this.drawCalls[i]);this.drawCalls.length=0;let m=this.colors,p=this.textureIds,_=C.pop();_||((_=new y.a$).texArray=new y.Ie),_.texArray.count=0,_.start=0,_.size=0,_.type=y.lg.TRIANGLES;let x=0,T=null,v=0,E=!1,A=y.lg.TRIANGLES,S=0;this.drawCalls.push(_);for(let I=0;I<this.batches.length;I++){let R=this.batches[I],P=R.style,k=P.texture.baseTexture;!!P.native!==E&&(A=(E=!!P.native)?y.lg.LINES:y.lg.TRIANGLES,T=null,x=8,i++),T!==k&&(T=k,k._batchEnabled!==i&&(8===x&&(i++,x=0,_.size>0&&((_=C.pop())||((_=new y.a$).texArray=new y.Ie),this.drawCalls.push(_)),_.start=S,_.size=0,_.texArray.count=0,_.type=A),k.touched=1,k._batchEnabled=i,k._batchLocation=x,k.wrapMode=y.Nt.REPEAT,_.texArray.elements[_.texArray.count++]=k,x++)),_.size+=R.size,S+=R.size,v=k._batchLocation,this.addColors(m,P.color,P.alpha,R.attribSize,R.attribStart),this.addTextureIds(p,v,R.attribSize,R.attribStart)}y.VL._globalBatch=i,this.packAttributes()}packAttributes(){let i=this.points,m=this.uvs,p=this.colors,_=this.textureIds,x=new ArrayBuffer(12*i.length),y=new Float32Array(x),T=new Uint32Array(x),v=0;for(let x=0;x<i.length/2;x++)y[v++]=i[2*x],y[v++]=i[2*x+1],y[v++]=m[2*x],y[v++]=m[2*x+1],T[v++]=p[x],y[v++]=_[x];this._buffer.update(x),this._indexBuffer.update(this.indicesUint16)}processFill(i){i.holes.length?v.triangulate(i,this):I[i.type].triangulate(i,this)}processLine(i){buildLine(i,this);for(let m=0;m<i.holes.length;m++)buildLine(i.holes[m],this)}processHoles(i){for(let m=0;m<i.length;m++){let p=i[m];I[p.type].build(p),p.matrix&&this.transformPoints(p.points,p.matrix)}}calculateBounds(){let i=this._bounds;i.clear(),i.addVertexData(this.points,0,this.points.length),i.pad(this.boundsPadding,this.boundsPadding)}transformPoints(i,m){for(let p=0;p<i.length/2;p++){let _=i[2*p],x=i[2*p+1];i[2*p]=m.a*_+m.c*x+m.tx,i[2*p+1]=m.b*_+m.d*x+m.ty}}addColors(i,m,p,_,x=0){let T=y.Il.shared.setValue(m).toLittleEndianNumber(),v=y.Il.shared.setValue(T).toPremultiplied(p);i.length=Math.max(i.length,x+_);for(let m=0;m<_;m++)i[x+m]=v}addTextureIds(i,m,p,_=0){i.length=Math.max(i.length,_+p);for(let x=0;x<p;x++)i[_+x]=m}addUvs(i,m,p,_,x,y=null){let T=0,v=m.length,E=p.frame;for(;T<x;){let p=i[(_+T)*2],x=i[(_+T)*2+1];if(y){let i=y.a*p+y.c*x+y.tx;x=y.b*p+y.d*x+y.ty,p=i}T++,m.push(p/E.width,x/E.height)}let A=p.baseTexture;(E.width<A.width||E.height<A.height)&&this.adjustUvs(m,p,v,x)}adjustUvs(i,m,p,_){let x=m.baseTexture,y=p+2*_,T=m.frame,v=T.width/x.width,E=T.height/x.height,A=T.x/T.width,S=T.y/T.height,I=Math.floor(i[p]+1e-6),R=Math.floor(i[p+1]+1e-6);for(let m=p+2;m<y;m+=2)I=Math.min(I,Math.floor(i[m]+1e-6)),R=Math.min(R,Math.floor(i[m+1]+1e-6));A-=I,S-=R;for(let m=p;m<y;m+=2)i[m]=(i[m]+A)*v,i[m+1]=(i[m+1]+S)*E}};B.BATCHABLE_SIZE=100;let FillStyle=class FillStyle{constructor(){this.color=16777215,this.alpha=1,this.texture=y.xE.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){let i=new FillStyle;return i.color=this.color,i.alpha=this.alpha,i.texture=this.texture,i.matrix=this.matrix,i.visible=this.visible,i}reset(){this.color=16777215,this.alpha=1,this.texture=y.xE.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}};let LineStyle=class LineStyle extends FillStyle{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=A.BUTT,this.join=E.MITER,this.miterLimit=10}clone(){let i=new LineStyle;return i.color=this.color,i.alpha=this.alpha,i.texture=this.texture,i.matrix=this.matrix,i.visible=this.visible,i.width=this.width,i.alignment=this.alignment,i.native=this.native,i.cap=this.cap,i.join=this.join,i.miterLimit=this.miterLimit,i}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=A.BUTT,this.join=E.MITER,this.miterLimit=10}};let D={},F=class _Graphics2 extends P.W2{constructor(i=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new FillStyle,this._lineStyle=new LineStyle,this._matrix=null,this._holeMode=!1,this.state=y.ZM.for2d(),this._geometry=i||new B,this._geometry.refCount++,this._transformID=-1,this._tintColor=new y.Il(16777215),this.blendMode=y.T$.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new _Graphics2(this._geometry)}set blendMode(i){this.state.blendMode=i}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(i){this._tintColor.setValue(i)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(i=null,m=0,p,_=.5,x=!1){return"number"==typeof i&&(i={width:i,color:m,alpha:p,alignment:_,native:x}),this.lineTextureStyle(i)}lineTextureStyle(i){let m={width:0,texture:y.xE.WHITE,color:i?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:A.BUTT,join:E.MITER,miterLimit:10};i=Object.assign(m,i),this.normalizeColor(i),this.currentPath&&this.startPoly();let p=i.width>0&&i.alpha>0;return p?(i.matrix&&(i.matrix=i.matrix.clone(),i.matrix.invert()),Object.assign(this._lineStyle,{visible:p},i)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){let i=this.currentPath.points,m=this.currentPath.points.length;m>2&&(this.drawShape(this.currentPath),this.currentPath=new y.mg,this.currentPath.closeStroke=!1,this.currentPath.points.push(i[m-2],i[m-1]))}else this.currentPath=new y.mg,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(i,m){return this.startPoly(),this.currentPath.points[0]=i,this.currentPath.points[1]=m,this}lineTo(i,m){this.currentPath||this.moveTo(0,0);let p=this.currentPath.points,_=p[p.length-2],x=p[p.length-1];return(_!==i||x!==m)&&p.push(i,m),this}_initCurve(i=0,m=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[i,m]):this.moveTo(i,m)}quadraticCurveTo(i,m,p,_){this._initCurve();let x=this.currentPath.points;return 0===x.length&&this.moveTo(0,0),QuadraticUtils.curveTo(i,m,p,_,x),this}bezierCurveTo(i,m,p,_,x,y){return this._initCurve(),BezierUtils.curveTo(i,m,p,_,x,y,this.currentPath.points),this}arcTo(i,m,p,_,x){this._initCurve(i,m);let y=this.currentPath.points,T=ArcUtils.curveTo(i,m,p,_,x,y);if(T){let{cx:i,cy:m,radius:p,startAngle:_,endAngle:x,anticlockwise:y}=T;this.arc(i,m,p,_,x,y)}return this}arc(i,m,p,_,x,T=!1){if(_===x||(!T&&x<=_?x+=y._b:T&&_<=x&&(_+=y._b),x-_==0))return this;let v=i+Math.cos(_)*p,E=m+Math.sin(_)*p,A=this._geometry.closePointEps,S=this.currentPath?this.currentPath.points:null;if(S){let i=Math.abs(S[S.length-2]-v),m=Math.abs(S[S.length-1]-E);i<A&&m<A||S.push(v,E)}else this.moveTo(v,E),S=this.currentPath.points;return ArcUtils.arc(v,E,i,m,p,_,x,T,S),this}beginFill(i=0,m){return this.beginTextureFill({texture:y.xE.WHITE,color:i,alpha:m})}normalizeColor(i){let m=y.Il.shared.setValue(i.color??0);i.color=m.toNumber(),i.alpha??(i.alpha=m.alpha)}beginTextureFill(i){let m={texture:y.xE.WHITE,color:16777215,matrix:null};i=Object.assign(m,i),this.normalizeColor(i),this.currentPath&&this.startPoly();let p=i.alpha>0;return p?(i.matrix&&(i.matrix=i.matrix.clone(),i.matrix.invert()),Object.assign(this._fillStyle,{visible:p},i)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(i,m,p,_){return this.drawShape(new y.Ae(i,m,p,_))}drawRoundedRect(i,m,p,_,x){return this.drawShape(new y.c9(i,m,p,_,x))}drawCircle(i,m,p){return this.drawShape(new y.Cd(i,m,p))}drawEllipse(i,m,p,_){return this.drawShape(new y.Pj(i,m,p,_))}drawPolygon(...i){let m,p=!0,_=i[0];_.points?(p=_.closeStroke,m=_.points):m=Array.isArray(i[0])?i[0]:i;let x=new y.mg(m);return x.closeStroke=p,this.drawShape(x),this}drawShape(i){return this._holeMode?this._geometry.drawHole(i,this._matrix):this._geometry.drawShape(i,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){let i=this._geometry.graphicsData;return 1===i.length&&i[0].shape.type===y.HS.RECT&&!i[0].matrix&&!i[0].holes.length&&!(i[0].lineStyle.visible&&i[0].lineStyle.width)}_render(i){this.finishPoly();let m=this._geometry;m.updateBatches(),m.batchable?(this.batchDirty!==m.batchDirty&&this._populateBatches(),this._renderBatched(i)):(i.batch.flush(),this._renderDirect(i))}_populateBatches(){let i=this._geometry,m=this.blendMode,p=i.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=i.batchDirty,this.batches.length=p,this.vertexData=new Float32Array(i.points);for(let _=0;_<p;_++){let p=i.batches[_],x=p.style.color,T=new Float32Array(this.vertexData.buffer,8*p.attribStart,2*p.attribSize),v=new Float32Array(i.uvsFloat32.buffer,8*p.attribStart,2*p.attribSize),E=new Uint16Array(i.indicesUint16.buffer,2*p.start,p.size),A={vertexData:T,blendMode:m,indices:E,uvs:v,_batchRGB:y.Il.shared.setValue(x).toRgbArray(),_tintRGB:x,_texture:p.style.texture,alpha:p.style.alpha,worldAlpha:1};this.batches[_]=A}}_renderBatched(i){if(this.batches.length){i.batch.setObjectRenderer(i.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let m=0,p=this.batches.length;m<p;m++){let p=this.batches[m];p.worldAlpha=this.worldAlpha*p.alpha,i.plugins[this.pluginName].render(p)}}}_renderDirect(i){let m=this._resolveDirectShader(i),p=this._geometry,_=this.worldAlpha,x=m.uniforms,T=p.drawCalls;x.translationMatrix=this.transform.worldTransform,y.Il.shared.setValue(this._tintColor).premultiply(_).toArray(x.tint),i.shader.bind(m),i.geometry.bind(p,m),i.state.set(this.state);for(let m=0,_=T.length;m<_;m++)this._renderDrawCallDirect(i,p.drawCalls[m])}_renderDrawCallDirect(i,m){let{texArray:p,type:_,size:x,start:y}=m,T=p.count;for(let m=0;m<T;m++)i.texture.bind(p.elements[m],m);i.geometry.draw(_,x,y)}_resolveDirectShader(i){let m=this.shader,p=this.pluginName;if(!m){if(!D[p]){let{maxTextures:m}=i.plugins[p],_=new Int32Array(m);for(let i=0;i<m;i++)_[i]=i;let x={tint:new Float32Array([1,1,1,1]),translationMatrix:new y.y3,default:y.oo.from({uSamplers:_},!0)},T=i.plugins[p]._shader.program;D[p]=new y.ex(T,x)}m=D[p]}return m}_calculateBounds(){this.finishPoly();let i=this._geometry;if(!i.graphicsData.length)return;let{minX:m,minY:p,maxX:_,maxY:x}=i.bounds;this._bounds.addFrame(this.transform,m,p,_,x)}containsPoint(i){return this.worldTransform.applyInverse(i,_Graphics2._TEMP_POINT),this._geometry.containsPoint(_Graphics2._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let i=0;i<this.batches.length;i++){let m=this.batches[i];m._tintRGB=y.Il.shared.setValue(this._tintColor).multiply(m._batchRGB).toLittleEndianNumber()}}}calculateVertices(){let i=this.transform._worldID;if(this._transformID===i)return;this._transformID=i;let m=this.transform.worldTransform,p=m.a,_=m.b,x=m.c,y=m.d,T=m.tx,v=m.ty,E=this._geometry.points,A=this.vertexData,S=0;for(let i=0;i<E.length;i+=2){let m=E[i],I=E[i+1];A[S++]=p*m+x*I+T,A[S++]=y*I+_*m+v}}closePath(){let i=this.currentPath;return i&&(i.closeStroke=!0,this.finishPoly()),this}setMatrix(i){return this._matrix=i,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(i){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(i)}};F.curves=S,F._TEMP_POINT=new y.E9;let L=F},88:function(i,m,p){"use strict";p.d(m,{AL:function(){return SimpleMesh}});var _=p(2904),x=p(6392);let SimpleMesh=class SimpleMesh extends _.Kj{constructor(i=x.xE.EMPTY,m,p,y,T){let v=new _.xc(m,p,y);v.getBuffer("aVertexPosition").static=!1;let E=new _.rY(i);super(v,E,null,T),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(i){this.geometry.getBuffer("aVertexPosition").data=i}_render(i){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(i)}}},2904:function(i,m,p){"use strict";p.d(m,{Kj:function(){return E},xc:function(){return MeshGeometry},rY:function(){return MeshMaterial}});var _=p(6392),x=p(607);let MeshBatchUvs=class MeshBatchUvs{constructor(i,m){this.uvBuffer=i,this.uvMatrix=m,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(i){if(!i&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;let m=this.uvBuffer.data;this.data&&this.data.length===m.length||(this.data=new Float32Array(m.length)),this.uvMatrix.multiplyUvs(m,this.data),this._updateID++}};let y=new _.E9,T=new _.mg,v=class _Mesh2 extends x.W2{constructor(i,m,p,x=_.lg.TRIANGLES){super(),this.geometry=i,this.shader=m,this.state=p||_.ZM.for2d(),this.drawMode=x,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=_.Xd.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(i){this._geometry!==i&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=i,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(i){this.shader=i}get material(){return this.shader}set blendMode(i){this.state.blendMode=i}get blendMode(){return this.state.blendMode}set roundPixels(i){this._roundPixels!==i&&(this._transformID=-1),this._roundPixels=i}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(i){this.shader.tint=i}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(i){this.shader.texture=i}_render(i){let m=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===_.lg.TRIANGLES&&m.length<2*_Mesh2.BATCHABLE_SIZE?this._renderToBatch(i):this._renderDefault(i)}_renderDefault(i){let m=this.shader;m.alpha=this.worldAlpha,m.update&&m.update(),i.batch.flush(),m.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),i.shader.bind(m),i.state.set(this.state),i.geometry.bind(this.geometry,m),i.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(i){let m=this.geometry,p=this.shader;p.uvMatrix&&(p.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=m.indexBuffer.data,this._tintRGB=p._tintRGB,this._texture=p.texture;let _=this.material.pluginName;i.batch.setObjectRenderer(i.plugins[_]),i.plugins[_].render(this)}calculateVertices(){let i=this.geometry.buffers[0],m=i.data,p=i._updateID;if(p===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==m.length&&(this.vertexData=new Float32Array(m.length));let x=this.transform.worldTransform,y=x.a,T=x.b,v=x.c,E=x.d,A=x.tx,S=x.ty,I=this.vertexData;for(let i=0;i<I.length/2;i++){let p=m[2*i],_=m[2*i+1];I[2*i]=y*p+v*_+A,I[2*i+1]=T*p+E*_+S}if(this._roundPixels){let i=_.Xd.RESOLUTION;for(let m=0;m<I.length;++m)I[m]=Math.round(I[m]*i)/i}this.vertexDirty=p}calculateUvs(){let i=this.geometry.buffers[1],m=this.shader;m.uvMatrix.isSimple?this.uvs=i.data:(this.batchUvs||(this.batchUvs=new MeshBatchUvs(i,m.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(i){if(!this.getBounds().contains(i.x,i.y))return!1;this.worldTransform.applyInverse(i,y);let m=this.geometry.getBuffer("aVertexPosition").data,p=T.points,_=this.geometry.getIndex().data,x=_.length,v=4===this.drawMode?3:1;for(let i=0;i+2<x;i+=v){let x=2*_[i],v=2*_[i+1],E=2*_[i+2];if(p[0]=m[x],p[1]=m[x+1],p[2]=m[v],p[3]=m[v+1],p[4]=m[E],p[5]=m[E+1],T.contains(y.x,y.y))return!0}return!1}destroy(i){super.destroy(i),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};v.BATCHABLE_SIZE=100;let E=v;let MeshGeometry=class MeshGeometry extends _.wG{constructor(i,m,p){super();let x=new _.lW(i),y=new _.lW(m,!0),T=new _.lW(p,!0,!0);this.addAttribute("aVertexPosition",x,2,!1,_.vK.FLOAT).addAttribute("aTextureCoord",y,2,!1,_.vK.FLOAT).addIndex(T),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}};var A=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,S=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;let MeshMaterial=class MeshMaterial extends _.ex{constructor(i,m){let p={uSampler:i,alpha:1,uTextureMatrix:_.y3.IDENTITY,uColor:new Float32Array([1,1,1,1])};(m=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},m)).uniforms&&Object.assign(p,m.uniforms),super(m.program||_.$r.from(S,A),p),this._colorDirty=!1,this.uvMatrix=new _.UX(i),this.batchable=void 0===m.program,this.pluginName=m.pluginName,this._tintColor=new _.Il(m.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=m.alpha}get texture(){return this.uniforms.uSampler}set texture(i){this.uniforms.uSampler!==i&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!i.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=i,this.uvMatrix.texture=i)}set alpha(i){i!==this._alpha&&(this._alpha=i,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(i){i!==this.tint&&(this._tintColor.setValue(i),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;let i=this.texture.baseTexture.alphaMode;_.Il.shared.setValue(this._tintColor).premultiply(this._alpha,i).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}},9521:function(i,m,p){"use strict";p.d(m,{j:function(){return Sprite}});var _=p(6392),x=p(607);let y=new _.E9,T=new Uint16Array([0,1,2,0,2,3]);let Sprite=class Sprite extends x.W2{constructor(i){super(),this._anchor=new _.AB(this._onAnchorUpdate,this,i?i.defaultAnchor.x:0,i?i.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new _.Il(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=_.T$.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=i||_.xE.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=T,this.pluginName="batch",this.isSprite=!0,this._roundPixels=_.Xd.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=_.P6.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=_.P6.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){let i=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===i._updateID)return;this._textureID!==i._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=i._updateID;let m=this.transform.worldTransform,p=m.a,x=m.b,y=m.c,T=m.d,v=m.tx,E=m.ty,A=this.vertexData,S=i.trim,I=i.orig,R=this._anchor,C=0,P=0,k=0,B=0;if(S?(C=(P=S.x-R._x*I.width)+S.width,k=(B=S.y-R._y*I.height)+S.height):(C=(P=-R._x*I.width)+I.width,k=(B=-R._y*I.height)+I.height),A[0]=p*P+y*B+v,A[1]=T*B+x*P+E,A[2]=p*C+y*B+v,A[3]=T*B+x*C+E,A[4]=p*C+y*k+v,A[5]=T*k+x*C+E,A[6]=p*P+y*k+v,A[7]=T*k+x*P+E,this._roundPixels){let i=_.Xd.RESOLUTION;for(let m=0;m<A.length;++m)A[m]=Math.round(A[m]*i)/i}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;let i=this._texture,m=this.vertexTrimmedData,p=i.orig,x=this._anchor,y=this.transform.worldTransform,T=y.a,v=y.b,E=y.c,A=y.d,S=y.tx,I=y.ty,R=-x._x*p.width,C=R+p.width,P=-x._y*p.height,k=P+p.height;if(m[0]=T*R+E*P+S,m[1]=A*P+v*R+I,m[2]=T*C+E*P+S,m[3]=A*P+v*C+I,m[4]=T*C+E*k+S,m[5]=A*k+v*C+I,m[6]=T*R+E*k+S,m[7]=A*k+v*R+I,this._roundPixels){let i=_.Xd.RESOLUTION;for(let p=0;p<m.length;++p)m[p]=Math.round(m[p]*i)/i}}_render(i){this.calculateVertices(),i.batch.setObjectRenderer(i.plugins[this.pluginName]),i.plugins[this.pluginName].render(this)}_calculateBounds(){let i=this._texture.trim,m=this._texture.orig;i&&(i.width!==m.width||i.height!==m.height)?(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData)):(this.calculateVertices(),this._bounds.addQuad(this.vertexData))}getLocalBounds(i){return 0===this.children.length?(this._localBounds||(this._localBounds=new x.YZ),this._localBounds.minX=-(this._texture.orig.width*this._anchor._x),this._localBounds.minY=-(this._texture.orig.height*this._anchor._y),this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),i||(this._localBoundsRect||(this._localBoundsRect=new _.Ae),i=this._localBoundsRect),this._localBounds.getRectangle(i)):super.getLocalBounds.call(this,i)}containsPoint(i){this.worldTransform.applyInverse(i,y);let m=this._texture.orig.width,p=this._texture.orig.height,_=-m*this.anchor.x,x=0;return y.x>=_&&y.x<_+m&&(x=-p*this.anchor.y,y.y>=x&&y.y<x+p)}destroy(i){if(super.destroy(i),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof i?i:i?.texture){let m="boolean"==typeof i?i:i?.baseTexture;this._texture.destroy(!!m)}this._texture=null}static from(i,m){let p=i instanceof _.xE?i:_.xE.from(i,m);return new Sprite(p)}set roundPixels(i){this._roundPixels!==i&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=i}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(i){let m=_.P6.sign(this.scale.x)||1;this.scale.x=m*i/this._texture.orig.width,this._width=i}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(i){let m=_.P6.sign(this.scale.y)||1;this.scale.y=m*i/this._texture.orig.height,this._height=i}get anchor(){return this._anchor}set anchor(i){this._anchor.copyFrom(i)}get tint(){return this._tintColor.value}set tint(i){this._tintColor.setValue(i),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(i){this._texture!==i&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=i||_.xE.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,i&&(i.baseTexture.valid?this._onTextureUpdate():i.once("update",this._onTextureUpdate,this)))}}},7432:function(i,m,p){"use strict";p.d(m,{PY:function(){return loader_uni_lib_Spine_Spine}});var _,x,y,T,v,E,A,S,I,R,C,P,k,B,D,F,L,O,V={};p.r(V),p.d(V,{Animation:function(){return Animation},AnimationState:function(){return tU},AnimationStateAdapter:function(){return AnimationStateAdapter},AnimationStateData:function(){return tz},AtlasAttachmentLoader:function(){return AtlasAttachmentLoader},Attachment:function(){return Attachment},AttachmentTimeline:function(){return AttachmentTimeline},Bone:function(){return Bone},BoneData:function(){return BoneData},BoundingBoxAttachment:function(){return BoundingBoxAttachment},ClippingAttachment:function(){return ClippingAttachment},ColorTimeline:function(){return tI},ConstraintData:function(){return ConstraintData},CurveTimeline:function(){return tT},DeformTimeline:function(){return DeformTimeline},DrawOrderTimeline:function(){return DrawOrderTimeline},Event:function(){return Event},EventData:function(){return EventData},EventQueue:function(){return tH},EventTimeline:function(){return EventTimeline},EventType:function(){return tW},IkConstraint:function(){return IkConstraint},IkConstraintData:function(){return IkConstraintData},IkConstraintTimeline:function(){return tk},JitterEffect:function(){return JitterEffect},MeshAttachment:function(){return MeshAttachment},PathAttachment:function(){return PathAttachment},PathConstraint:function(){return tZ},PathConstraintData:function(){return PathConstraintData},PathConstraintMixTimeline:function(){return tO},PathConstraintPositionTimeline:function(){return tN},PathConstraintSpacingTimeline:function(){return PathConstraintSpacingTimeline},PointAttachment:function(){return PointAttachment},RegionAttachment:function(){return tg},RotateTimeline:function(){return tE},ScaleTimeline:function(){return ScaleTimeline},ShearTimeline:function(){return ShearTimeline},Skeleton:function(){return tJ},SkeletonBinary:function(){return t0},SkeletonBounds:function(){return SkeletonBounds},SkeletonData:function(){return SkeletonData},SkeletonJson:function(){return SkeletonJson},Skin:function(){return Skin},SkinEntry:function(){return SkinEntry},Slot:function(){return Slot},SlotData:function(){return SlotData},SpacingMode:function(){return tj},Spine:function(){return Spine},SwirlEffect:function(){return tx},TimelineType:function(){return ty},TrackEntry:function(){return tY},TransformConstraint:function(){return TransformConstraint},TransformConstraintData:function(){return TransformConstraintData},TransformConstraintTimeline:function(){return tD},TranslateTimeline:function(){return tS},TwoColorTimeline:function(){return tM},VertexAttachment:function(){return tf}});var U={};p.r(U),p.d(U,{Animation:function(){return Animation_Animation},AnimationState:function(){return ex},AnimationStateAdapter2:function(){return AnimationStateAdapter2},AnimationStateData:function(){return eS},AtlasAttachmentLoader:function(){return AtlasAttachmentLoader_AtlasAttachmentLoader},Attachment:function(){return Attachment_Attachment},AttachmentTimeline:function(){return Animation_AttachmentTimeline},Bone:function(){return Bone_Bone},BoneData:function(){return BoneData_BoneData},BoundingBoxAttachment:function(){return BoundingBoxAttachment_BoundingBoxAttachment},ClippingAttachment:function(){return ClippingAttachment_ClippingAttachment},ColorTimeline:function(){return en},CurveTimeline:function(){return t7},DeformTimeline:function(){return Animation_DeformTimeline},DrawOrderTimeline:function(){return Animation_DrawOrderTimeline},Event:function(){return Event_Event},EventData:function(){return EventData_EventData},EventQueue:function(){return ev},EventTimeline:function(){return Animation_EventTimeline},EventType:function(){return eE},IkConstraint:function(){return IkConstraint_IkConstraint},IkConstraintData:function(){return IkConstraintData_IkConstraintData},IkConstraintTimeline:function(){return eu},JitterEffect:function(){return JitterEffect_JitterEffect},MeshAttachment:function(){return MeshAttachment_MeshAttachment},PathAttachment:function(){return PathAttachment_PathAttachment},PathConstraint:function(){return eR},PathConstraintData:function(){return PathConstraintData_PathConstraintData},PathConstraintMixTimeline:function(){return eg},PathConstraintPositionTimeline:function(){return ef},PathConstraintSpacingTimeline:function(){return Animation_PathConstraintSpacingTimeline},PointAttachment:function(){return PointAttachment_PointAttachment},RegionAttachment:function(){return t4},RotateTimeline:function(){return ee},ScaleTimeline:function(){return Animation_ScaleTimeline},ShearTimeline:function(){return Animation_ShearTimeline},Skeleton:function(){return eC},SkeletonBounds:function(){return SkeletonBounds_SkeletonBounds},SkeletonData:function(){return SkeletonData_SkeletonData},SkeletonJson:function(){return SkeletonJson_SkeletonJson},Skin:function(){return Skin_Skin},Slot:function(){return Slot_Slot},SlotData:function(){return SlotData_SlotData},SpacingMode:function(){return ew},Spine:function(){return Spine_Spine},SwirlEffect:function(){return t5},TimelineType:function(){return t8},TrackEntry:function(){return eb},TransformConstraint:function(){return TransformConstraint_TransformConstraint},TransformConstraintData:function(){return TransformConstraintData_TransformConstraintData},TransformConstraintTimeline:function(){return ec},TranslateTimeline:function(){return ei},TwoColorTimeline:function(){return eo},VertexAttachment:function(){return t2}});var X={};p.r(X),p.d(X,{AlphaTimeline:function(){return AlphaTimeline},Animation:function(){return core_Animation_Animation},AnimationState:function(){return ez},AnimationStateAdapter:function(){return AnimationState_AnimationStateAdapter},AnimationStateData:function(){return lib_core_AnimationStateData_AnimationStateData},AtlasAttachmentLoader:function(){return core_AtlasAttachmentLoader_AtlasAttachmentLoader},Attachment:function(){return attachments_Attachment_Attachment},AttachmentTimeline:function(){return core_Animation_AttachmentTimeline},Bone:function(){return core_Bone_Bone},BoneData:function(){return core_BoneData_BoneData},BoundingBoxAttachment:function(){return attachments_BoundingBoxAttachment_BoundingBoxAttachment},ClippingAttachment:function(){return attachments_ClippingAttachment_ClippingAttachment},ConstraintData:function(){return ConstraintData_ConstraintData},CurveTimeline:function(){return lib_core_Animation_CurveTimeline},CurveTimeline1:function(){return CurveTimeline1},CurveTimeline2:function(){return CurveTimeline2},DeformTimeline:function(){return core_Animation_DeformTimeline},DrawOrderTimeline:function(){return eG},Event:function(){return core_Event_Event},EventData:function(){return core_EventData_EventData},EventQueue:function(){return lib_core_AnimationState_EventQueue},EventTimeline:function(){return eX},EventType:function(){return eZ},IkConstraint:function(){return core_IkConstraint_IkConstraint},IkConstraintData:function(){return core_IkConstraintData_IkConstraintData},IkConstraintTimeline:function(){return lib_core_Animation_IkConstraintTimeline},MeshAttachment:function(){return attachments_MeshAttachment_MeshAttachment},PathAttachment:function(){return attachments_PathAttachment_PathAttachment},PathConstraint:function(){return e5},PathConstraintData:function(){return core_PathConstraintData_PathConstraintData},PathConstraintMixTimeline:function(){return lib_core_Animation_PathConstraintMixTimeline},PathConstraintPositionTimeline:function(){return lib_core_Animation_PathConstraintPositionTimeline},PathConstraintSpacingTimeline:function(){return core_Animation_PathConstraintSpacingTimeline},PointAttachment:function(){return attachments_PointAttachment_PointAttachment},RGB2Timeline:function(){return RGB2Timeline},RGBA2Timeline:function(){return RGBA2Timeline},RGBATimeline:function(){return RGBATimeline},RGBTimeline:function(){return RGBTimeline},RegionAttachment:function(){return eD},RotateTimeline:function(){return lib_core_Animation_RotateTimeline},ScaleTimeline:function(){return core_Animation_ScaleTimeline},ScaleXTimeline:function(){return ScaleXTimeline},ScaleYTimeline:function(){return ScaleYTimeline},Sequence:function(){return eN},SequenceMode:function(){return eL},SequenceModeValues:function(){return eO},SequenceTimeline:function(){return eW},ShearTimeline:function(){return core_Animation_ShearTimeline},ShearXTimeline:function(){return ShearXTimeline},ShearYTimeline:function(){return ShearYTimeline},Skeleton:function(){return e9},SkeletonBinary:function(){return SkeletonBinary_SkeletonBinary},SkeletonBounds:function(){return core_SkeletonBounds_SkeletonBounds},SkeletonData:function(){return core_SkeletonData_SkeletonData},SkeletonJson:function(){return core_SkeletonJson_SkeletonJson},Skin:function(){return core_Skin_Skin},SkinEntry:function(){return Skin_SkinEntry},Slot:function(){return core_Slot_Slot},SlotData:function(){return core_SlotData_SlotData},SpacingMode:function(){return e4},Spine:function(){return lib_Spine_Spine},Timeline:function(){return Timeline},TrackEntry:function(){return eq},TransformConstraint:function(){return core_TransformConstraint_TransformConstraint},TransformConstraintData:function(){return core_TransformConstraintData_TransformConstraintData},TransformConstraintTimeline:function(){return lib_core_Animation_TransformConstraintTimeline},TranslateTimeline:function(){return lib_core_Animation_TranslateTimeline},TranslateXTimeline:function(){return TranslateXTimeline},TranslateYTimeline:function(){return TranslateYTimeline},VertexAttachment:function(){return ek}});var Y=((_=Y||{})[_.Region=0]="Region",_[_.BoundingBox=1]="BoundingBox",_[_.Mesh=2]="Mesh",_[_.LinkedMesh=3]="LinkedMesh",_[_.Path=4]="Path",_[_.Point=5]="Point",_[_.Clipping=6]="Clipping",_);let BinaryInput=class BinaryInput{constructor(i,m=[],p=0,_=new DataView(i.buffer)){this.strings=m,this.index=p,this.buffer=_}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){let i=this.buffer.getInt16(this.index);return this.index+=2,i}readInt32(){let i=this.buffer.getInt32(this.index);return this.index+=4,i}readInt(i){let m=this.readByte(),p=127&m;return(128&m)!=0&&(p|=(127&(m=this.readByte()))<<7,(128&m)!=0&&(p|=(127&(m=this.readByte()))<<14,(128&m)!=0&&(p|=(127&(m=this.readByte()))<<21,(128&m)!=0&&(p|=(127&(m=this.readByte()))<<28)))),i?p:p>>>1^-(1&p)}readStringRef(){let i=this.readInt(!0);return 0==i?null:this.strings[i-1]}readString(){let i=this.readInt(!0);switch(i){case 0:return null;case 1:return""}i--;let m="";for(let p=0;p<i;){let i=this.readUnsignedByte();switch(i>>4){case 12:case 13:m+=String.fromCharCode((31&i)<<6|63&this.readByte()),p+=2;break;case 14:m+=String.fromCharCode((15&i)<<12|(63&this.readByte())<<6|63&this.readByte()),p+=3;break;default:m+=String.fromCharCode(i),p++}}return m}readFloat(){let i=this.buffer.getFloat32(this.index);return this.index+=4,i}readBoolean(){return 0!=this.readByte()}};var G=((x=G||{})[x.setup=0]="setup",x[x.first=1]="first",x[x.replace=2]="replace",x[x.add=3]="add",x),W=((y=W||{})[y.mixIn=0]="mixIn",y[y.mixOut=1]="mixOut",y),z=((T=z||{})[T.Fixed=0]="Fixed",T[T.Percent=1]="Percent",T),j=((v=j||{})[v.Tangent=0]="Tangent",v[v.Chain=1]="Chain",v[v.ChainScale=2]="ChainScale",v),Z=((E=Z||{})[E.Normal=0]="Normal",E[E.OnlyTranslation=1]="OnlyTranslation",E[E.NoRotationOrReflection=2]="NoRotationOrReflection",E[E.NoScale=3]="NoScale",E[E.NoScaleOrReflection=4]="NoScaleOrReflection",E),K=p(6392);function filterFromString(i){switch(i.toLowerCase()){case"nearest":return J.Nearest;case"linear":return J.Linear;case"mipmap":return J.MipMap;case"mipmapnearestnearest":return J.MipMapNearestNearest;case"mipmaplinearnearest":return J.MipMapLinearNearest;case"mipmapnearestlinear":return J.MipMapNearestLinear;case"mipmaplinearlinear":return J.MipMapLinearLinear;default:throw Error(`Unknown texture filter ${i}`)}}var J=((A=J||{})[A.Nearest=9728]="Nearest",A[A.Linear=9729]="Linear",A[A.MipMap=9987]="MipMap",A[A.MipMapNearestNearest=9984]="MipMapNearestNearest",A[A.MipMapLinearNearest=9985]="MipMapLinearNearest",A[A.MipMapNearestLinear=9986]="MipMapNearestLinear",A[A.MipMapLinearLinear=9987]="MipMapLinearLinear",A),Q=((S=Q||{})[S.MirroredRepeat=33648]="MirroredRepeat",S[S.ClampToEdge=33071]="ClampToEdge",S[S.Repeat=10497]="Repeat",S);let TextureRegion=class TextureRegion{constructor(){this.size=null,this.names=null,this.values=null,this.renderObject=null}get width(){let i=this.texture;return i.trim?i.trim.width:i.orig.width}get height(){let i=this.texture;return i.trim?i.trim.height:i.orig.height}get u(){return this.texture._uvs.x0}get v(){return this.texture._uvs.y0}get u2(){return this.texture._uvs.x2}get v2(){return this.texture._uvs.y2}get offsetX(){let i=this.texture;return i.trim?i.trim.x:0}get offsetY(){return this.spineOffsetY}get pixiOffsetY(){let i=this.texture;return i.trim?i.trim.y:0}get spineOffsetY(){let i=this.texture;return this.originalHeight-this.height-(i.trim?i.trim.y:0)}get originalWidth(){return this.texture.orig.width}get originalHeight(){return this.texture.orig.height}get x(){return this.texture.frame.x}get y(){return this.texture.frame.y}get rotate(){return 0!==this.texture.rotate}get degrees(){return(360-45*this.texture.rotate)%360}};let RegionFields=class RegionFields{constructor(){this.x=0,this.y=0,this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.rotate=0,this.index=0}};let TextureAtlas=class TextureAtlas{constructor(i,m,p){this.pages=[],this.regions=[],i&&this.addSpineAtlas(i,m,p)}addTexture(i,m){let p=this.pages,_=null;for(let i=0;i<p.length;i++)if(p[i].baseTexture===m.baseTexture){_=p[i];break}if(null===_){(_=new TextureAtlasPage).name="texturePage";let i=m.baseTexture;_.width=i.realWidth,_.height=i.realHeight,_.baseTexture=i,_.minFilter=_.magFilter=J.Nearest,_.uWrap=Q.ClampToEdge,_.vWrap=Q.ClampToEdge,p.push(_)}let x=new TextureAtlasRegion;return x.name=i,x.page=_,x.texture=m,x.index=-1,this.regions.push(x),x}addTextureHash(i,m){for(let p in i)i.hasOwnProperty(p)&&this.addTexture(m&&-1!==p.indexOf(".")?p.substr(0,p.lastIndexOf(".")):p,i[p])}addSpineAtlas(i,m,p){return this.load(i,m,p)}load(i,m,p){if(null==m)throw Error("textureLoader cannot be null.");let _=new TextureAtlasReader(i),x=[,,,,],y=null,T={},v=null;T.size=()=>{y.width=parseInt(x[1]),y.height=parseInt(x[2])},T.format=()=>{},T.filter=()=>{y.minFilter=filterFromString(x[1]),y.magFilter=filterFromString(x[2])},T.repeat=()=>{-1!=x[1].indexOf("x")&&(y.uWrap=Q.Repeat),-1!=x[1].indexOf("y")&&(y.vWrap=Q.Repeat)},T.pma=()=>{y.pma="true"==x[1]};let E={};E.xy=()=>{v.x=parseInt(x[1]),v.y=parseInt(x[2])},E.size=()=>{v.width=parseInt(x[1]),v.height=parseInt(x[2])},E.bounds=()=>{v.x=parseInt(x[1]),v.y=parseInt(x[2]),v.width=parseInt(x[3]),v.height=parseInt(x[4])},E.offset=()=>{v.offsetX=parseInt(x[1]),v.offsetY=parseInt(x[2])},E.orig=()=>{v.originalWidth=parseInt(x[1]),v.originalHeight=parseInt(x[2])},E.offsets=()=>{v.offsetX=parseInt(x[1]),v.offsetY=parseInt(x[2]),v.originalWidth=parseInt(x[3]),v.originalHeight=parseInt(x[4])},E.rotate=()=>{let i=x[1],m=0;m="true"==i.toLocaleLowerCase()?6:"false"==i.toLocaleLowerCase()?0:(720-parseFloat(i))%360/45,v.rotate=m},E.index=()=>{v.index=parseInt(x[1])};let A=_.readLine();for(;null!=A&&0==A.trim().length;)A=_.readLine();for(;null!=A&&0!=A.trim().length&&0!=_.readEntry(x,A);)A=_.readLine();let iterateParser=()=>{for(;;){if(null==A)return p&&p(this);if(0==A.trim().length)y=null,A=_.readLine();else if(null===y){for((y=new TextureAtlasPage).name=A.trim();0!=_.readEntry(x,A=_.readLine());){let i=T[x[0]];i&&i()}this.pages.push(y),m(y.name,i=>{if(null===i)return this.pages.splice(this.pages.indexOf(y),1),p&&p(null);y.baseTexture=i,y.pma&&(i.alphaMode=K.iw.PMA),i.valid||i.setSize(y.width,y.height),y.setFilters(),y.width&&y.height||(y.width=i.realWidth,y.height=i.realHeight,y.width&&y.height||console.log(`ERROR spine atlas page ${y.name}: meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)`)),iterateParser()});break}else{v=new RegionFields;let i=new TextureAtlasRegion;i.name=A,i.page=y;let m=null,p=null;for(;;){let i=_.readEntry(x,A=_.readLine());if(0==i)break;let y=E[x[0]];if(y)y();else{null==m&&(m=[],p=[]),m.push(x[0]);let _=[];for(let m=0;m<i;m++)_.push(parseInt(x[m+1]));p.push(_)}}0==v.originalWidth&&0==v.originalHeight&&(v.originalWidth=v.width,v.originalHeight=v.height);let T=y.baseTexture.resolution;v.x/=T,v.y/=T,v.width/=T,v.height/=T,v.originalWidth/=T,v.originalHeight/=T,v.offsetX/=T,v.offsetY/=T;let S=v.rotate%4!=0,I=new K.Ae(v.x,v.y,S?v.height:v.width,S?v.width:v.height),R=new K.Ae(0,0,v.originalWidth,v.originalHeight),C=new K.Ae(v.offsetX,v.originalHeight-v.height-v.offsetY,v.width,v.height);i.texture=new K.xE(i.page.baseTexture,I,R,C,v.rotate),i.index=v.index,i.texture.updateUvs(),this.regions.push(i)}}};iterateParser()}findRegion(i){for(let m=0;m<this.regions.length;m++)if(this.regions[m].name==i)return this.regions[m];return null}dispose(){for(let i=0;i<this.pages.length;i++)this.pages[i].baseTexture.dispose()}};let TextureAtlasReader=class TextureAtlasReader{constructor(i){this.index=0,this.lines=i.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(i,m){if(null==m||0==(m=m.trim()).length)return 0;let p=m.indexOf(":");if(-1==p)return 0;i[0]=m.substr(0,p).trim();for(let _=1,x=p+1;;_++){let p=m.indexOf(",",x);if(-1==p)return i[_]=m.substr(x).trim(),_;if(i[_]=m.substr(x,p-x).trim(),x=p+1,4==_)return 4}}};let TextureAtlasPage=class TextureAtlasPage{constructor(){this.minFilter=J.Nearest,this.magFilter=J.Nearest,this.uWrap=Q.ClampToEdge,this.vWrap=Q.ClampToEdge}setFilters(){let i=this.baseTexture,m=this.minFilter;m==J.Linear?i.scaleMode=K.aH.LINEAR:this.minFilter==J.Nearest?i.scaleMode=K.aH.NEAREST:(i.mipmap=K.KI.POW2,m==J.MipMapNearestNearest?i.scaleMode=K.aH.NEAREST:i.scaleMode=K.aH.LINEAR)}};let TextureAtlasRegion=class TextureAtlasRegion extends TextureRegion{};let IntSet=class IntSet{constructor(){this.array=[]}add(i){let m=this.contains(i);return this.array[0|i]=0|i,!m}contains(i){return void 0!=this.array[0|i]}remove(i){this.array[0|i]=void 0}clear(){this.array.length=0}};let StringSet=class StringSet{constructor(){this.entries={},this.size=0}add(i){let m=this.entries[i];return this.entries[i]=!0,!m&&(this.size++,!0)}addAll(i){let m=this.size;for(let m=0,p=i.length;m<p;m++)this.add(i[m]);return m!=this.size}contains(i){return this.entries[i]}clear(){this.entries={},this.size=0}};let tt=class{constructor(i=0,m=0,p=0,_=0){this.r=i,this.g=m,this.b=p,this.a=_}set(i,m,p,_){return this.r=i,this.g=m,this.b=p,this.a=_,this.clamp()}setFromColor(i){return this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this}setFromString(i){return i="#"==i.charAt(0)?i.substr(1):i,this.r=parseInt(i.substr(0,2),16)/255,this.g=parseInt(i.substr(2,2),16)/255,this.b=parseInt(i.substr(4,2),16)/255,this.a=8!=i.length?1:parseInt(i.substr(6,2),16)/255,this}add(i,m,p,_){return this.r+=i,this.g+=m,this.b+=p,this.a+=_,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(i,m){i.r=((4278190080&m)>>>24)/255,i.g=((16711680&m)>>>16)/255,i.b=((65280&m)>>>8)/255,i.a=(255&m)/255}static rgb888ToColor(i,m){i.r=((16711680&m)>>>16)/255,i.g=((65280&m)>>>8)/255,i.b=(255&m)/255}static fromString(i){return new tt().setFromString(i)}};tt.WHITE=new tt(1,1,1,1),tt.RED=new tt(1,0,0,1),tt.GREEN=new tt(0,1,0,1),tt.BLUE=new tt(0,0,1,1),tt.MAGENTA=new tt(1,0,1,1);let te=class{static clamp(i,m,p){return i<m?m:i>p?p:i}static cosDeg(i){return Math.cos(i*te.degRad)}static sinDeg(i){return Math.sin(i*te.degRad)}static signum(i){return Math.sign(i)}static toInt(i){return i>0?Math.floor(i):Math.ceil(i)}static cbrt(i){let m=Math.pow(Math.abs(i),1/3);return i<0?-m:m}static randomTriangular(i,m){return te.randomTriangularWith(i,m,(i+m)*.5)}static randomTriangularWith(i,m,p){let _=Math.random(),x=m-i;return _<=(p-i)/x?i+Math.sqrt(_*x*(p-i)):m-Math.sqrt((1-_)*x*(m-p))}static isPowerOfTwo(i){return i&&(i&i-1)==0}};te.PI=3.1415927,te.PI2=2*te.PI,te.radiansToDegrees=180/te.PI,te.radDeg=te.radiansToDegrees,te.degreesToRadians=te.PI/180,te.degRad=te.degreesToRadians;let Interpolation=class Interpolation{apply(i,m,p){return i+(m-i)*this.applyInternal(p)}};let Pow=class Pow extends Interpolation{constructor(i){super(),this.power=2,this.power=i}applyInternal(i){return i<=.5?Math.pow(2*i,this.power)/2:Math.pow((i-1)*2,this.power)/(this.power%2==0?-2:2)+1}};let PowOut=class PowOut extends Pow{applyInternal(i){return Math.pow(i-1,this.power)*(this.power%2==0?-1:1)+1}};let tr=class{static arrayCopy(i,m,p,_,x){for(let y=m,T=_;y<m+x;y++,T++)p[T]=i[y]}static arrayFill(i,m,p,_){for(let x=m;x<p;x++)i[x]=_}static setArraySize(i,m,p=0){let _=i.length;if(_==m)return i;if(i.length=m,_<m)for(let x=_;x<m;x++)i[x]=p;return i}static ensureArrayCapacity(i,m,p=0){return i.length>=m?i:tr.setArraySize(i,m,p)}static newArray(i,m){let p=Array(i);for(let _=0;_<i;_++)p[_]=m;return p}static newFloatArray(i){if(tr.SUPPORTS_TYPED_ARRAYS)return new Float32Array(i);let m=Array(i);for(let i=0;i<m.length;i++)m[i]=0;return m}static newShortArray(i){if(tr.SUPPORTS_TYPED_ARRAYS)return new Int16Array(i);let m=Array(i);for(let i=0;i<m.length;i++)m[i]=0;return m}static toFloatArray(i){return tr.SUPPORTS_TYPED_ARRAYS?new Float32Array(i):i}static toSinglePrecision(i){return tr.SUPPORTS_TYPED_ARRAYS?Math.fround(i):i}static webkit602BugfixHelper(i,m){}static contains(i,m,p=!0){for(let p=0;p<i.length;p++)if(i[p]==m)return!0;return!1}static enumValue(i,m){return i[m[0].toUpperCase()+m.slice(1)]}};tr.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array;let Pool=class Pool{constructor(i){this.items=[],this.instantiator=i}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(i){i.reset&&i.reset(),this.items.push(i)}freeAll(i){for(let m=0;m<i.length;m++)this.free(i[m])}clear(){this.items.length=0}};let Vector2=class Vector2{constructor(i=0,m=0){this.x=i,this.y=m}set(i,m){return this.x=i,this.y=m,this}length(){let i=this.x,m=this.y;return Math.sqrt(i*i+m*m)}normalize(){let i=this.length();return 0!=i&&(this.x/=i,this.y/=i),this}};let SkeletonBoundsBase_SkeletonBoundsBase=class SkeletonBoundsBase_SkeletonBoundsBase{constructor(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=[],this.polygons=[],this.polygonPool=new Pool(()=>tr.newFloatArray(16))}update(i,m){if(!i)throw Error("skeleton cannot be null.");let p=this.boundingBoxes,_=this.polygons,x=this.polygonPool,y=i.slots,T=y.length;p.length=0,x.freeAll(_),_.length=0;for(let i=0;i<T;i++){let m=y[i];if(!m.bone.active)continue;let T=m.getAttachment();if(null!=T&&T.type===Y.BoundingBox){p.push(T);let i=x.obtain();i.length!=T.worldVerticesLength&&(i=tr.newFloatArray(T.worldVerticesLength)),_.push(i),T.computeWorldVertices(m,0,T.worldVerticesLength,i,0,2)}}m?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let i=Number.POSITIVE_INFINITY,m=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,_=Number.NEGATIVE_INFINITY,x=this.polygons;for(let y=0,T=x.length;y<T;y++){let T=x[y];for(let x=0,y=T.length;x<y;x+=2){let y=T[x],v=T[x+1];i=Math.min(i,y),m=Math.min(m,v),p=Math.max(p,y),_=Math.max(_,v)}}this.minX=i,this.minY=m,this.maxX=p,this.maxY=_}aabbContainsPoint(i,m){return i>=this.minX&&i<=this.maxX&&m>=this.minY&&m<=this.maxY}aabbIntersectsSegment(i,m,p,_){let x=this.minX,y=this.minY,T=this.maxX,v=this.maxY;if(i<=x&&p<=x||m<=y&&_<=y||i>=T&&p>=T||m>=v&&_>=v)return!1;let E=(_-m)/(p-i),A=E*(x-i)+m;if(A>y&&A<v||(A=E*(T-i)+m)>y&&A<v)return!0;let S=(y-m)/E+i;return S>x&&S<T||(S=(v-m)/E+i)>x&&S<T}aabbIntersectsSkeleton(i){return this.minX<i.maxX&&this.maxX>i.minX&&this.minY<i.maxY&&this.maxY>i.minY}containsPoint(i,m){let p=this.polygons;for(let _=0,x=p.length;_<x;_++)if(this.containsPointPolygon(p[_],i,m))return this.boundingBoxes[_];return null}containsPointPolygon(i,m,p){let _=i.length,x=_-2,y=!1;for(let T=0;T<_;T+=2){let _=i[T+1],v=i[x+1];if(_<p&&v>=p||v<p&&_>=p){let E=i[T];E+(p-_)/(v-_)*(i[x]-E)<m&&(y=!y)}x=T}return y}intersectsSegment(i,m,p,_){let x=this.polygons;for(let y=0,T=x.length;y<T;y++)if(this.intersectsSegmentPolygon(x[y],i,m,p,_))return this.boundingBoxes[y];return null}intersectsSegmentPolygon(i,m,p,_,x){let y=i.length,T=m-_,v=p-x,E=m*x-p*_,A=i[y-2],S=i[y-1];for(let I=0;I<y;I+=2){let y=i[I],R=i[I+1],C=A*R-S*y,P=A-y,k=S-R,B=T*k-v*P,D=(E*P-T*C)/B;if((D>=A&&D<=y||D>=y&&D<=A)&&(D>=m&&D<=_||D>=_&&D<=m)){let i=(E*k-v*C)/B;if((i>=S&&i<=R||i>=R&&i<=S)&&(i>=p&&i<=x||i>=x&&i<=p))return!0}A=y,S=R}return!1}getPolygon(i){if(!i)throw Error("boundingBox cannot be null.");let m=this.boundingBoxes.indexOf(i);return -1==m?null:this.polygons[m]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}};let ti={yDown:!0,FAIL_ON_NON_EXISTING_SKIN:!1,GLOBAL_AUTO_UPDATE:!0,GLOBAL_DELAY_LIMIT:0};var ts=p(607),tn=p(9521),ta=p(88),to=p(7731);let tl=[0,0,0];let SpineSprite=class SpineSprite extends tn.j{constructor(){super(...arguments),this.region=null,this.attachment=null}};let SpineMesh=class SpineMesh extends ta.AL{constructor(i,m,p,_,x){super(i,m,p,_,x),this.region=null,this.attachment=null}};let th=class extends ts.W2{constructor(i){if(super(),!i)throw Error("The spineData param is required.");if("string"==typeof i)throw Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');this.spineData=i,this.createSkeleton(i),this.slotContainers=[],this.tempClipContainers=[];for(let i=0,m=this.skeleton.slots.length;i<m;i++){let m=this.skeleton.slots[i],p=m.getAttachment(),_=this.newContainer();if(this.slotContainers.push(_),this.addChild(_),this.tempClipContainers.push(null),p){if(p.type===Y.Region){let i=p.name,x=this.createSprite(m,p,i);m.currentSprite=x,m.currentSpriteName=i,_.addChild(x)}else if(p.type===Y.Mesh){let i=this.createMesh(m,p);m.currentMesh=i,m.currentMeshId=p.id,m.currentMeshName=p.name,_.addChild(i)}else p.type===Y.Clipping&&(this.createGraphics(m,p),_.addChild(m.clippingContainer),_.addChild(m.currentGraphics))}}this.tintRgb=new Float32Array([1,1,1]),this.autoUpdate=!0,this.visible=!0}get debug(){return this._debug}set debug(i){i!=this._debug&&(this._debug?.unregisterSpine(this),i?.registerSpine(this),this._debug=i)}get autoUpdate(){return this._autoUpdate}set autoUpdate(i){i!==this._autoUpdate&&(this._autoUpdate=i,this.updateTransform=i?th.prototype.autoUpdateTransform:ts.W2.prototype.updateTransform)}get tint(){return K.P6.rgb2hex(this.tintRgb)}set tint(i){this.tintRgb=K.P6.hex2rgb(i,this.tintRgb)}get delayLimit(){let i=void 0!==this.localDelayLimit?this.localDelayLimit:ti.GLOBAL_DELAY_LIMIT;return i||Number.MAX_VALUE}update(i){let m=this.delayLimit;if(i>m&&(i=m),this.state.update(i),this.state.apply(this.skeleton),!this.skeleton)return;this.skeleton.updateWorldTransform();let p=this.skeleton.slots,_=this.color,x=null,y=null;_?(x=_.light,y=_.dark):x=this.tintRgb;for(let i=0,m=p.length;i<m;i++){let m=p[i],_=m.getAttachment(),T=this.slotContainers[i];if(!_){T.visible=!1;continue}let v=null;_.sequence&&_.sequence.apply(m,_);let E=_.region,A=_.color;switch(null!=_&&_.type){case Y.Region:let S=T.transform;if(S.setFromMatrix(m.bone.matrix),E=_.region,m.currentMesh&&(m.currentMesh.visible=!1,m.currentMesh=null,m.currentMeshId=void 0,m.currentMeshName=void 0),!E){m.currentSprite&&(m.currentSprite.renderable=!1);break}if(!m.currentSpriteName||m.currentSpriteName!==_.name){let i=_.name;if(m.currentSprite&&(m.currentSprite.visible=!1),m.sprites=m.sprites||{},void 0!==m.sprites[i])m.sprites[i].visible=!0;else{let p=this.createSprite(m,_,i);T.addChild(p)}m.currentSprite=m.sprites[i],m.currentSpriteName=i}m.currentSprite.renderable=!0,m.hackRegion||this.setSpriteRegion(_,m.currentSprite,E),m.currentSprite.color?v=m.currentSprite.color:(tl[0]=x[0]*m.color.r*A.r,tl[1]=x[1]*m.color.g*A.g,tl[2]=x[2]*m.color.b*A.b,m.currentSprite.tint=K.P6.rgb2hex(tl)),m.currentSprite.blendMode=m.blendMode;break;case Y.Mesh:if(m.currentSprite){m.currentSprite.visible=!1,m.currentSprite=null,m.currentSpriteName=void 0;let i=new K.wx;i._parentID=-1,i._worldID=T.transform._worldID,T.transform=i}if(!E){m.currentMesh&&(m.currentMesh.renderable=!1);break}let I=_.id;if(void 0===m.currentMeshId||m.currentMeshId!==I){if(m.currentMesh&&(m.currentMesh.visible=!1),m.meshes=m.meshes||{},void 0!==m.meshes[I])m.meshes[I].visible=!0;else{let i=this.createMesh(m,_);T.addChild(i)}m.currentMesh=m.meshes[I],m.currentMeshName=_.name,m.currentMeshId=I}m.currentMesh.renderable=!0,_.computeWorldVerticesOld(m,m.currentMesh.vertices),m.currentMesh.color?v=m.currentMesh.color:(tl[0]=x[0]*m.color.r*A.r,tl[1]=x[1]*m.color.g*A.g,tl[2]=x[2]*m.color.b*A.b,m.currentMesh.tint=K.P6.rgb2hex(tl)),m.currentMesh.blendMode=m.blendMode,m.hackRegion||this.setMeshRegion(_,m.currentMesh,E);break;case Y.Clipping:m.currentGraphics||(this.createGraphics(m,_),T.addChild(m.clippingContainer),T.addChild(m.currentGraphics)),this.updateGraphics(m,_),T.alpha=1,T.visible=!0;continue;default:T.visible=!1;continue}if(T.visible=!0,v){let i=m.color.r*A.r,p=m.color.g*A.g,_=m.color.b*A.b;v.setLight(x[0]*i+y[0]*(1-i),x[1]*p+y[1]*(1-p),x[2]*_+y[2]*(1-_)),m.darkColor?(i=m.darkColor.r,p=m.darkColor.g,_=m.darkColor.b):(i=0,p=0,_=0),v.setDark(x[0]*i+y[0]*(1-i),x[1]*p+y[1]*(1-p),x[2]*_+y[2]*(1-_))}T.alpha=m.color.a}let T=this.skeleton.drawOrder,v=null,E=null;for(let i=0,m=T.length;i<m;i++){let m=p[T[i].data.index],_=this.slotContainers[T[i].data.index];if(E||null===_.parent||_.parent===this||(_.parent.removeChild(_),_.parent=this),m.currentGraphics&&m.getAttachment())E=m.clippingContainer,v=m.getAttachment(),E.children.length=0,this.children[i]=_,v.endSlot===m.data&&(v.endSlot=null);else if(E){let p=this.tempClipContainers[i];p||((p=this.tempClipContainers[i]=this.newContainer()).visible=!1),this.children[i]=p,_.parent=null,E.addChild(_),v.endSlot==m.data&&(E.renderable=!0,E=null,v=null)}else this.children[i]=_}this._debug?.renderDebug(this)}setSpriteRegion(i,m,p){(m.attachment!==i||m.region!==p)&&(m.region=p,m.attachment=i,m.texture=p.texture,m.rotation=i.rotation*te.degRad,m.position.x=i.x,m.position.y=i.y,m.alpha=i.color.a,p.size?(m.scale.x=p.size.width/p.originalWidth,m.scale.y=-p.size.height/p.originalHeight):(m.scale.x=i.scaleX*i.width/p.originalWidth,m.scale.y=-i.scaleY*i.height/p.originalHeight))}setMeshRegion(i,m,p){(m.attachment!==i||m.region!==p)&&(m.region=p,m.attachment=i,m.texture=p.texture,p.texture.updateUvs(),m.uvBuffer.update(i.regionUVs))}autoUpdateTransform(){if(ti.GLOBAL_AUTO_UPDATE){this.lastTime=this.lastTime||Date.now();let i=(Date.now()-this.lastTime)*.001;this.lastTime=Date.now(),this.update(i)}else this.lastTime=0;ts.W2.prototype.updateTransform.call(this)}createSprite(i,m,p){let _=m.region;i.hackAttachment===m&&(_=i.hackRegion);let x=_?_.texture:null,y=this.newSprite(x);return y.anchor.set(.5),_&&this.setSpriteRegion(m,y,m.region),i.sprites=i.sprites||{},i.sprites[p]=y,y}createMesh(i,m){let p=m.region;i.hackAttachment===m&&(p=i.hackRegion,i.hackAttachment=null,i.hackRegion=null);let _=this.newMesh(p?p.texture:null,new Float32Array(m.regionUVs.length),m.regionUVs,new Uint16Array(m.triangles),K.lg.TRIANGLES);return void 0!==_._canvasPadding&&(_._canvasPadding=1.5),_.alpha=m.color.a,_.region=m.region,p&&this.setMeshRegion(m,_,p),i.meshes=i.meshes||{},i.meshes[m.id]=_,_}createGraphics(i,m){let p=this.newGraphics(),_=new K.mg([]);return p.clear(),p.beginFill(16777215,1),p.drawPolygon(_),p.renderable=!1,i.currentGraphics=p,i.clippingContainer=this.newContainer(),i.clippingContainer.mask=i.currentGraphics,p}updateGraphics(i,m){let p=i.currentGraphics.geometry,_=p.graphicsData[0].shape.points,x=m.worldVerticesLength;_.length=x,m.computeWorldVertices(i,0,x,_,0,2),p.invalidate()}hackTextureBySlotIndex(i,m=null,p=null){let _=this.skeleton.slots[i];if(!_)return!1;let x=_.getAttachment(),y=x.region;return m?((y=new TextureRegion).texture=m,y.size=p,_.hackRegion=y,_.hackAttachment=x):(_.hackRegion=null,_.hackAttachment=null),_.currentSprite?this.setSpriteRegion(x,_.currentSprite,y):_.currentMesh&&this.setMeshRegion(x,_.currentMesh,y),!0}hackTextureBySlotName(i,m=null,p=null){let _=this.skeleton.findSlotIndex(i);return -1!=_&&this.hackTextureBySlotIndex(_,m,p)}hackTextureAttachment(i,m,p,_=null){let x=this.skeleton.findSlotIndex(i),y=this.skeleton.getAttachmentByName(i,m);y.region.texture=p;let T=this.skeleton.slots[x];if(!T)return!1;let v=T.getAttachment();if(m===v.name){let i=y.region;return p?((i=new TextureRegion).texture=p,i.size=_,T.hackRegion=i,T.hackAttachment=v):(T.hackRegion=null,T.hackAttachment=null),T.currentSprite&&T.currentSprite.region!=i?(this.setSpriteRegion(v,T.currentSprite,i),T.currentSprite.region=i):T.currentMesh&&T.currentMesh.region!=i&&this.setMeshRegion(v,T.currentMesh,i),!0}return!1}newContainer(){return new ts.W2}newSprite(i){return new SpineSprite(i)}newGraphics(){return new to.TC}newMesh(i,m,p,_,x){return new SpineMesh(i,m,p,_,x)}transformHack(){return 1}hackAttachmentGroups(i,m,p){if(!i)return;let _=[],x=[];for(let y=0,T=this.skeleton.slots.length;y<T;y++){let T=this.skeleton.slots[y],v=T.currentSpriteName||T.currentMeshName||"",E=T.currentSprite||T.currentMesh;v.endsWith(i)?(E.parentGroup=m,x.push(E)):p&&E&&(E.parentGroup=p,_.push(E))}return[_,x]}destroy(i){this.debug=null;for(let m=0,p=this.skeleton.slots.length;m<p;m++){let p=this.skeleton.slots[m];for(let m in p.meshes)p.meshes[m].destroy(i);for(let m in p.meshes=null,p.sprites)p.sprites[m].destroy(i);p.sprites=null}for(let m=0,p=this.slotContainers.length;m<p;m++)this.slotContainers[m].destroy(i);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,super.destroy(i)}},tu=th;tu.clippingPolygon=[],Object.defineProperty(tu.prototype,"visible",{get(){return this._visible},set(i){i!==this._visible&&(this._visible=i,i&&(this.lastTime=0))}});var td=p(2857);let tc={extension:K.nw.Asset,loader:{extension:{type:K.nw.LoadParser,priority:td.Q2.Normal},test:i=>(0,td.gN)(i,".atlas"),async load(i){let m=await K.Xd.ADAPTER.fetch(i),p=await m.text();return p},testParse(i,m){let p=(0,td.gN)(m.src,".atlas");return Promise.resolve(p&&"string"==typeof i)},async parse(i,m,p){let _;let x=m.data,y=K.P6.path.dirname(m.src);y&&y.lastIndexOf("/")!==y.length-1&&(y+="/");let T=null,v=null,E=new Promise((i,m)=>{T=i,v=m}),resolveCallback=i=>{i||v("Something went terribly wrong loading a spine .atlas file\nMost likely your texture failed to load."),T(_)};if(x.image||x.images){let m=Object.assign(x.image?{default:x.image}:{},x.images);_=new TextureAtlas(i,(i,p)=>{let _=m[i]||m.default;p(_&&_.baseTexture?_.baseTexture:_)},resolveCallback)}else _=new TextureAtlas(i,makeSpineTextureAtlasLoaderFunctionFromPixiLoaderObject(p,y,x.imageMetadata),resolveCallback);return await E},unload(i){i.dispose()}}},makeSpineTextureAtlasLoaderFunctionFromPixiLoaderObject=(i,m,p)=>async(_,x)=>{let y=K.P6.path.normalize([...m.split(K.P6.path.sep),_].join(K.P6.path.sep)),T=await i.load({src:y,data:p});x(T.baseTexture)};function isJson(i){return i.hasOwnProperty("bones")}function isBuffer(i){return i instanceof ArrayBuffer}K.Rw.add(tc);let SpineLoaderAbstract=class SpineLoaderAbstract{constructor(){}installLoader(){let i=this,m={extension:K.nw.Asset,loader:{extension:{type:K.nw.LoadParser,priority:td.Q2.Normal},test:i=>(0,td.gN)(i,".skel"),async load(i){let m=await K.Xd.ADAPTER.fetch(i),p=await m.arrayBuffer();return p},testParse(i,m){let p=(0,td.gN)(m.src,".json")&&isJson(i),_=(0,td.gN)(m.src,".skel")&&isBuffer(i),x=m.data?.spineAtlas===!1;return Promise.resolve(p&&!x||_)},async parse(m,p,_){let x=K.P6.path.extname(p.src).toLowerCase(),y=K.P6.path.basename(p.src,x),T=K.P6.path.dirname(p.src);T&&T.lastIndexOf("/")!==T.length-1&&(T+="/");let v=(0,td.gN)(p.src,".json")&&isJson(m),E=null,A=m;v?E=i.createJsonParser():(E=i.createBinaryParser(),A=new Uint8Array(m));let S=p.data||{},I=S?.spineSkeletonScale??null;I&&(E.scale=I);let R=S.spineAtlas;if(R&&R.pages)return i.parseData(E,R,A);let C=S.atlasRawData;if(C){let m=null,p=null,x=new Promise((i,_)=>{m=i,p=_}),y=new TextureAtlas(C,makeSpineTextureAtlasLoaderFunctionFromPixiLoaderObject(_,T,S.imageMetadata),i=>{i||p("Something went terribly wrong loading a spine .atlas file\nMost likely your texture failed to load."),m(y)}),v=await x;return i.parseData(E,v,A)}let P=S.spineAtlasFile;P||(P=`${T+y}.atlas`);let k=await _.load({src:P,data:S,alias:S.spineAtlasAlias});return i.parseData(E,k,A)}}};return K.Rw.add(m),m}};let Attachment=class Attachment{constructor(i){if(null==i)throw Error("name cannot be null.");this.name=i}};let tm=class extends Attachment{constructor(i){super(i),this.id=(65535&tm.nextID++)<<11,this.worldVerticesLength=0,this.deformAttachment=this}computeWorldVerticesOld(i,m){this.computeWorldVertices(i,0,this.worldVerticesLength,m,0,2)}computeWorldVertices(i,m,p,_,x,y){p=x+(p>>1)*y;let T=i.bone.skeleton,v=i.deform,E=this.vertices,A=this.bones;if(null==A){v.length>0&&(E=v);let T=i.bone.matrix,A=T.tx,S=T.ty,I=T.a,R=T.c,C=T.b,P=T.d;for(let i=m,T=x;T<p;i+=2,T+=y){let m=E[i],p=E[i+1];_[T]=m*I+p*R+A,_[T+1]=m*C+p*P+S}return}let S=0,I=0;for(let i=0;i<m;i+=2){let i=A[S];S+=i+1,I+=i}let R=T.bones;if(0==v.length)for(let i=x,m=3*I;i<p;i+=y){let p=0,x=0,y=A[S++];for(y+=S;S<y;S++,m+=3){let i=R[A[S]].matrix,_=E[m],y=E[m+1],T=E[m+2];p+=(_*i.a+y*i.c+i.tx)*T,x+=(_*i.b+y*i.d+i.ty)*T}_[i]=p,_[i+1]=x}else for(let i=x,m=3*I,T=I<<1;i<p;i+=y){let p=0,x=0,y=A[S++];for(y+=S;S<y;S++,m+=3,T+=2){let i=R[A[S]].matrix,_=E[m]+v[T],y=E[m+1]+v[T+1],I=E[m+2];p+=(_*i.a+y*i.c+i.tx)*I,x+=(_*i.b+y*i.d+i.ty)*I}_[i]=p,_[i+1]=x}}copyTo(i){null!=this.bones?(i.bones=Array(this.bones.length),tr.arrayCopy(this.bones,0,i.bones,0,this.bones.length)):i.bones=null,null!=this.vertices?(i.vertices=tr.newFloatArray(this.vertices.length),tr.arrayCopy(this.vertices,0,i.vertices,0,this.vertices.length)):i.vertices=null,i.worldVerticesLength=this.worldVerticesLength,i.deformAttachment=this.deformAttachment}},tf=tm;tf.nextID=0;let BoundingBoxAttachment=class BoundingBoxAttachment extends tf{constructor(i){super(i),this.type=Y.BoundingBox,this.color=new tt(1,1,1,1)}copy(){let i=new BoundingBoxAttachment(this.name);return this.copyTo(i),i.color.setFromColor(this.color),i}};let ClippingAttachment=class ClippingAttachment extends tf{constructor(i){super(i),this.type=Y.Clipping,this.color=new tt(.2275,.2275,.8078,1)}copy(){let i=new ClippingAttachment(this.name);return this.copyTo(i),i.endSlot=this.endSlot,i.color.setFromColor(this.color),i}};let MeshAttachment=class MeshAttachment extends tf{constructor(i){super(i),this.type=Y.Mesh,this.color=new tt(1,1,1,1),this.tempColor=new tt(0,0,0,0)}getParentMesh(){return this.parentMesh}setParentMesh(i){this.parentMesh=i,null!=i&&(this.bones=i.bones,this.vertices=i.vertices,this.worldVerticesLength=i.worldVerticesLength,this.regionUVs=i.regionUVs,this.triangles=i.triangles,this.hullLength=i.hullLength,this.worldVerticesLength=i.worldVerticesLength)}copy(){if(null!=this.parentMesh)return this.newLinkedMesh();let i=new MeshAttachment(this.name);return i.region=this.region,i.path=this.path,i.color.setFromColor(this.color),this.copyTo(i),i.regionUVs=new Float32Array(this.regionUVs.length),tr.arrayCopy(this.regionUVs,0,i.regionUVs,0,this.regionUVs.length),i.triangles=Array(this.triangles.length),tr.arrayCopy(this.triangles,0,i.triangles,0,this.triangles.length),i.hullLength=this.hullLength,null!=this.edges&&(i.edges=Array(this.edges.length),tr.arrayCopy(this.edges,0,i.edges,0,this.edges.length)),i.width=this.width,i.height=this.height,i}newLinkedMesh(){let i=new MeshAttachment(this.name);return i.region=this.region,i.path=this.path,i.color.setFromColor(this.color),i.deformAttachment=this.deformAttachment,i.setParentMesh(null!=this.parentMesh?this.parentMesh:this),i}};let PathAttachment=class PathAttachment extends tf{constructor(i){super(i),this.type=Y.Path,this.closed=!1,this.constantSpeed=!1,this.color=new tt(1,1,1,1)}copy(){let i=new PathAttachment(this.name);return this.copyTo(i),i.lengths=Array(this.lengths.length),tr.arrayCopy(this.lengths,0,i.lengths,0,this.lengths.length),i.closed=closed,i.constantSpeed=this.constantSpeed,i.color.setFromColor(this.color),i}};let PointAttachment=class PointAttachment extends tf{constructor(i){super(i),this.type=Y.Point,this.color=new tt(.38,.94,0,1)}computeWorldPosition(i,m){let p=i.matrix;return m.x=this.x*p.a+this.y*p.c+i.worldX,m.y=this.x*p.b+this.y*p.d+i.worldY,m}computeWorldRotation(i){let m=i.matrix,p=te.cosDeg(this.rotation),_=te.sinDeg(this.rotation),x=p*m.a+_*m.c,y=p*m.b+_*m.d;return Math.atan2(y,x)*te.radDeg}copy(){let i=new PointAttachment(this.name);return i.x=this.x,i.y=this.y,i.rotation=this.rotation,i.color.setFromColor(this.color),i}};let Slot=class Slot{constructor(i,m){if(this.deform=[],null==i)throw Error("data cannot be null.");if(null==m)throw Error("bone cannot be null.");this.data=i,this.bone=m,this.color=new tt,this.darkColor=null==i.darkColor?null:new tt,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(i){this.attachment!=i&&(this.attachment=i,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)}setAttachmentTime(i){this.attachmentTime=this.bone.skeleton.time-i}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};let tp=class extends Attachment{constructor(i){super(i),this.type=Y.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new tt(1,1,1,1),this.offset=tr.newFloatArray(8),this.uvs=tr.newFloatArray(8),this.tempColor=new tt(1,1,1,1)}updateOffset(){let i=this.width/this.region.originalWidth*this.scaleX,m=this.height/this.region.originalHeight*this.scaleY,p=-this.width/2*this.scaleX+this.region.offsetX*i,_=-this.height/2*this.scaleY+this.region.offsetY*m,x=p+this.region.width*i,y=_+this.region.height*m,T=this.rotation*Math.PI/180,v=Math.cos(T),E=Math.sin(T),A=p*v+this.x,S=p*E,I=_*v+this.y,R=_*E,C=x*v+this.x,P=x*E,k=y*v+this.y,B=y*E,D=this.offset;D[tp.OX1]=A-R,D[tp.OY1]=I+S,D[tp.OX2]=A-B,D[tp.OY2]=k+S,D[tp.OX3]=C-B,D[tp.OY3]=k+P,D[tp.OX4]=C-R,D[tp.OY4]=I+P}setRegion(i){this.region=i;let m=this.uvs;i.rotate?(m[2]=i.u,m[3]=i.v2,m[4]=i.u,m[5]=i.v,m[6]=i.u2,m[7]=i.v,m[0]=i.u2,m[1]=i.v2):(m[0]=i.u,m[1]=i.v2,m[2]=i.u,m[3]=i.v,m[4]=i.u2,m[5]=i.v,m[6]=i.u2,m[7]=i.v2)}computeWorldVertices(i,m,p,_){let x=this.offset,y=i instanceof Slot?i.bone.matrix:i.matrix,T=y.tx,v=y.ty,E=y.a,A=y.c,S=y.b,I=y.d,R=0,C=0;R=x[tp.OX1],C=x[tp.OY1],m[p]=R*E+C*A+T,m[p+1]=R*S+C*I+v,p+=_,R=x[tp.OX2],C=x[tp.OY2],m[p]=R*E+C*A+T,m[p+1]=R*S+C*I+v,p+=_,R=x[tp.OX3],C=x[tp.OY3],m[p]=R*E+C*A+T,m[p+1]=R*S+C*I+v,p+=_,R=x[tp.OX4],C=x[tp.OY4],m[p]=R*E+C*A+T,m[p+1]=R*S+C*I+v}copy(){let i=new tp(this.name);return i.region=this.region,i.rendererObject=this.rendererObject,i.path=this.path,i.x=this.x,i.y=this.y,i.scaleX=this.scaleX,i.scaleY=this.scaleY,i.rotation=this.rotation,i.width=this.width,i.height=this.height,tr.arrayCopy(this.uvs,0,i.uvs,0,8),tr.arrayCopy(this.offset,0,i.offset,0,8),i.color.setFromColor(this.color),i}},tg=tp;tg.OX1=0,tg.OY1=1,tg.OX2=2,tg.OY2=3,tg.OX3=4,tg.OY3=5,tg.OX4=6,tg.OY4=7,tg.X1=0,tg.Y1=1,tg.C1R=2,tg.C1G=3,tg.C1B=4,tg.C1A=5,tg.U1=6,tg.V1=7,tg.X2=8,tg.Y2=9,tg.C2R=10,tg.C2G=11,tg.C2B=12,tg.C2A=13,tg.U2=14,tg.V2=15,tg.X3=16,tg.Y3=17,tg.C3R=18,tg.C3G=19,tg.C3B=20,tg.C3A=21,tg.U3=22,tg.V3=23,tg.X4=24,tg.Y4=25,tg.C4R=26,tg.C4G=27,tg.C4B=28,tg.C4A=29,tg.U4=30,tg.V4=31;let JitterEffect=class JitterEffect{constructor(i,m){this.jitterX=0,this.jitterY=0,this.jitterX=i,this.jitterY=m}begin(i){}transform(i,m,p,_){i.x+=te.randomTriangular(-this.jitterX,this.jitterY),i.y+=te.randomTriangular(-this.jitterX,this.jitterY)}end(){}};let t_=class{constructor(i){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=i}begin(i){this.worldX=i.x+this.centerX,this.worldY=i.y+this.centerY}transform(i,m,p,_){let x=this.angle*te.degreesToRadians,y=i.x-this.worldX,T=i.y-this.worldY,v=Math.sqrt(y*y+T*T);if(v<this.radius){let m=t_.interpolation.apply(0,x,(this.radius-v)/this.radius),p=Math.cos(m),_=Math.sin(m);i.x=p*y-_*T+this.worldX,i.y=_*y+p*T+this.worldY}}end(){}},tx=t_;tx.interpolation=new PowOut(2);let Animation=class Animation{constructor(i,m,p){if(null==i)throw Error("name cannot be null.");if(null==m)throw Error("timelines cannot be null.");this.name=i,this.timelines=m,this.timelineIds=[];for(let i=0;i<m.length;i++)this.timelineIds[m[i].getPropertyId()]=!0;this.duration=p}hasTimeline(i){return!0==this.timelineIds[i]}apply(i,m,p,_,x,y,T,v){if(null==i)throw Error("skeleton cannot be null.");_&&0!=this.duration&&(p%=this.duration,m>0&&(m%=this.duration));let E=this.timelines;for(let _=0,A=E.length;_<A;_++)E[_].apply(i,m,p,x,y,T,v)}static binarySearch(i,m,p=1){let _=0,x=i.length/p-2;if(0==x)return p;let y=x>>>1;for(;;){if(i[(y+1)*p]<=m?_=y+1:x=y,_==x)return(_+1)*p;y=_+x>>>1}}static linearSearch(i,m,p){for(let _=0,x=i.length-p;_<=x;_+=p)if(i[_]>m)return _;return -1}};var ty=((I=ty||{})[I.rotate=0]="rotate",I[I.translate=1]="translate",I[I.scale=2]="scale",I[I.shear=3]="shear",I[I.attachment=4]="attachment",I[I.color=5]="color",I[I.deform=6]="deform",I[I.event=7]="event",I[I.drawOrder=8]="drawOrder",I[I.ikConstraint=9]="ikConstraint",I[I.transformConstraint=10]="transformConstraint",I[I.pathConstraintPosition=11]="pathConstraintPosition",I[I.pathConstraintSpacing=12]="pathConstraintSpacing",I[I.pathConstraintMix=13]="pathConstraintMix",I[I.twoColor=14]="twoColor",I);let tb=class{constructor(i){if(i<=0)throw Error(`frameCount must be > 0: ${i}`);this.curves=tr.newFloatArray((i-1)*tb.BEZIER_SIZE)}getFrameCount(){return this.curves.length/tb.BEZIER_SIZE+1}setLinear(i){this.curves[i*tb.BEZIER_SIZE]=tb.LINEAR}setStepped(i){this.curves[i*tb.BEZIER_SIZE]=tb.STEPPED}getCurveType(i){let m=i*tb.BEZIER_SIZE;if(m==this.curves.length)return tb.LINEAR;let p=this.curves[m];return p==tb.LINEAR?tb.LINEAR:p==tb.STEPPED?tb.STEPPED:tb.BEZIER}setCurve(i,m,p,_,x){let y=(-(2*m)+_)*.03,T=(-(2*p)+x)*.03,v=((m-_)*3+1)*.006,E=((p-x)*3+1)*.006,A=2*y+v,S=2*T+E,I=.3*m+y+.16666667*v,R=.3*p+T+.16666667*E,C=i*tb.BEZIER_SIZE,P=this.curves;P[C++]=tb.BEZIER;let k=I,B=R;for(let i=C+tb.BEZIER_SIZE-1;C<i;C+=2)P[C]=k,P[C+1]=B,I+=A,R+=S,A+=v,S+=E,k+=I,B+=R}getCurvePercent(i,m){m=te.clamp(m,0,1);let p=this.curves,_=i*tb.BEZIER_SIZE,x=p[_];if(x==tb.LINEAR)return m;if(x==tb.STEPPED)return 0;_++;let y=0;for(let i=_,x=_+tb.BEZIER_SIZE-1;_<x;_+=2)if((y=p[_])>=m){let x,T;return _==i?(x=0,T=0):(x=p[_-2],T=p[_-1]),T+(p[_+1]-T)*(m-x)/(y-x)}let T=p[_-1];return T+(1-T)*(m-y)/(1-y)}},tT=tb;tT.LINEAR=0,tT.STEPPED=1,tT.BEZIER=2,tT.BEZIER_SIZE=19;let tv=class extends tT{constructor(i){super(i),this.frames=tr.newFloatArray(i<<1)}getPropertyId(){return 0+this.boneIndex}setFrame(i,m,p){i<<=1,this.frames[i]=m,this.frames[i+tv.ROTATION]=p}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.bones[this.boneIndex];if(!E.active)return;if(p<v[0]){switch(y){case G.setup:E.rotation=E.data.rotation;break;case G.first:let i=E.data.rotation-E.rotation;E.rotation+=(i-(16384-(16384.499999999996-i/360|0))*360)*x}return}if(p>=v[v.length-tv.ENTRIES]){let i=v[v.length+tv.PREV_ROTATION];switch(y){case G.setup:E.rotation=E.data.rotation+i*x;break;case G.first:case G.replace:i+=E.data.rotation-E.rotation,i-=(16384-(16384.499999999996-i/360|0))*360;case G.add:E.rotation+=i*x}return}let A=Animation.binarySearch(v,p,tv.ENTRIES),S=v[A+tv.PREV_ROTATION],I=v[A],R=this.getCurvePercent((A>>1)-1,1-(p-I)/(v[A+tv.PREV_TIME]-I)),C=v[A+tv.ROTATION]-S;switch(C=S+(C-(16384-(16384.499999999996-C/360|0))*360)*R,y){case G.setup:E.rotation=E.data.rotation+(C-(16384-(16384.499999999996-C/360|0))*360)*x;break;case G.first:case G.replace:C+=E.data.rotation-E.rotation;case G.add:E.rotation+=(C-(16384-(16384.499999999996-C/360|0))*360)*x}}},tE=tv;tE.ENTRIES=2,tE.PREV_TIME=-2,tE.PREV_ROTATION=-1,tE.ROTATION=1;let tA=class extends tT{constructor(i){super(i),this.frames=tr.newFloatArray(i*tA.ENTRIES)}getPropertyId(){return 16777216+this.boneIndex}setFrame(i,m,p,_){i*=tA.ENTRIES,this.frames[i]=m,this.frames[i+tA.X]=p,this.frames[i+tA.Y]=_}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.bones[this.boneIndex];if(!E.active)return;if(p<v[0]){switch(y){case G.setup:E.x=E.data.x,E.y=E.data.y;break;case G.first:E.x+=(E.data.x-E.x)*x,E.y+=(E.data.y-E.y)*x}return}let A=0,S=0;if(p>=v[v.length-tA.ENTRIES])A=v[v.length+tA.PREV_X],S=v[v.length+tA.PREV_Y];else{let i=Animation.binarySearch(v,p,tA.ENTRIES);A=v[i+tA.PREV_X],S=v[i+tA.PREV_Y];let m=v[i],_=this.getCurvePercent(i/tA.ENTRIES-1,1-(p-m)/(v[i+tA.PREV_TIME]-m));A+=(v[i+tA.X]-A)*_,S+=(v[i+tA.Y]-S)*_}switch(y){case G.setup:E.x=E.data.x+A*x,E.y=E.data.y+S*x;break;case G.first:case G.replace:E.x+=(E.data.x+A-E.x)*x,E.y+=(E.data.y+S-E.y)*x;break;case G.add:E.x+=A*x,E.y+=S*x}}},tS=tA;tS.ENTRIES=3,tS.PREV_TIME=-3,tS.PREV_X=-2,tS.PREV_Y=-1,tS.X=1,tS.Y=2;let ScaleTimeline=class ScaleTimeline extends tS{constructor(i){super(i)}getPropertyId(){return 33554432+this.boneIndex}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.bones[this.boneIndex];if(!E.active)return;if(p<v[0]){switch(y){case G.setup:E.scaleX=E.data.scaleX,E.scaleY=E.data.scaleY;break;case G.first:E.scaleX+=(E.data.scaleX-E.scaleX)*x,E.scaleY+=(E.data.scaleY-E.scaleY)*x}return}let A=0,S=0;if(p>=v[v.length-ScaleTimeline.ENTRIES])A=v[v.length+ScaleTimeline.PREV_X]*E.data.scaleX,S=v[v.length+ScaleTimeline.PREV_Y]*E.data.scaleY;else{let i=Animation.binarySearch(v,p,ScaleTimeline.ENTRIES);A=v[i+ScaleTimeline.PREV_X],S=v[i+ScaleTimeline.PREV_Y];let m=v[i],_=this.getCurvePercent(i/ScaleTimeline.ENTRIES-1,1-(p-m)/(v[i+ScaleTimeline.PREV_TIME]-m));A=(A+(v[i+ScaleTimeline.X]-A)*_)*E.data.scaleX,S=(S+(v[i+ScaleTimeline.Y]-S)*_)*E.data.scaleY}if(1==x)y==G.add?(E.scaleX+=A-E.data.scaleX,E.scaleY+=S-E.data.scaleY):(E.scaleX=A,E.scaleY=S);else{let i=0,m=0;if(T==W.mixOut)switch(y){case G.setup:i=E.data.scaleX,m=E.data.scaleY,E.scaleX=i+(Math.abs(A)*te.signum(i)-i)*x,E.scaleY=m+(Math.abs(S)*te.signum(m)-m)*x;break;case G.first:case G.replace:i=E.scaleX,m=E.scaleY,E.scaleX=i+(Math.abs(A)*te.signum(i)-i)*x,E.scaleY=m+(Math.abs(S)*te.signum(m)-m)*x;break;case G.add:i=E.scaleX,m=E.scaleY,E.scaleX=i+(Math.abs(A)*te.signum(i)-E.data.scaleX)*x,E.scaleY=m+(Math.abs(S)*te.signum(m)-E.data.scaleY)*x}else switch(y){case G.setup:i=Math.abs(E.data.scaleX)*te.signum(A),m=Math.abs(E.data.scaleY)*te.signum(S),E.scaleX=i+(A-i)*x,E.scaleY=m+(S-m)*x;break;case G.first:case G.replace:i=Math.abs(E.scaleX)*te.signum(A),m=Math.abs(E.scaleY)*te.signum(S),E.scaleX=i+(A-i)*x,E.scaleY=m+(S-m)*x;break;case G.add:i=te.signum(A),m=te.signum(S),E.scaleX=Math.abs(E.scaleX)*i+(A-Math.abs(E.data.scaleX)*i)*x,E.scaleY=Math.abs(E.scaleY)*m+(S-Math.abs(E.data.scaleY)*m)*x}}}};let ShearTimeline=class ShearTimeline extends tS{constructor(i){super(i)}getPropertyId(){return 50331648+this.boneIndex}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.bones[this.boneIndex];if(!E.active)return;if(p<v[0]){switch(y){case G.setup:E.shearX=E.data.shearX,E.shearY=E.data.shearY;break;case G.first:E.shearX+=(E.data.shearX-E.shearX)*x,E.shearY+=(E.data.shearY-E.shearY)*x}return}let A=0,S=0;if(p>=v[v.length-ShearTimeline.ENTRIES])A=v[v.length+ShearTimeline.PREV_X],S=v[v.length+ShearTimeline.PREV_Y];else{let i=Animation.binarySearch(v,p,ShearTimeline.ENTRIES);A=v[i+ShearTimeline.PREV_X],S=v[i+ShearTimeline.PREV_Y];let m=v[i],_=this.getCurvePercent(i/ShearTimeline.ENTRIES-1,1-(p-m)/(v[i+ShearTimeline.PREV_TIME]-m));A+=(v[i+ShearTimeline.X]-A)*_,S+=(v[i+ShearTimeline.Y]-S)*_}switch(y){case G.setup:E.shearX=E.data.shearX+A*x,E.shearY=E.data.shearY+S*x;break;case G.first:case G.replace:E.shearX+=(E.data.shearX+A-E.shearX)*x,E.shearY+=(E.data.shearY+S-E.shearY)*x;break;case G.add:E.shearX+=A*x,E.shearY+=S*x}}};let tw=class extends tT{constructor(i){super(i),this.frames=tr.newFloatArray(i*tw.ENTRIES)}getPropertyId(){return 83886080+this.slotIndex}setFrame(i,m,p,_,x,y){i*=tw.ENTRIES,this.frames[i]=m,this.frames[i+tw.R]=p,this.frames[i+tw.G]=_,this.frames[i+tw.B]=x,this.frames[i+tw.A]=y}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(!v.bone.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.color.setFromColor(v.data.color);break;case G.first:let i=v.color,m=v.data.color;i.add((m.r-i.r)*x,(m.g-i.g)*x,(m.b-i.b)*x,(m.a-i.a)*x)}return}let A=0,S=0,I=0,R=0;if(p>=E[E.length-tw.ENTRIES]){let i=E.length;A=E[i+tw.PREV_R],S=E[i+tw.PREV_G],I=E[i+tw.PREV_B],R=E[i+tw.PREV_A]}else{let i=Animation.binarySearch(E,p,tw.ENTRIES);A=E[i+tw.PREV_R],S=E[i+tw.PREV_G],I=E[i+tw.PREV_B],R=E[i+tw.PREV_A];let m=E[i],_=this.getCurvePercent(i/tw.ENTRIES-1,1-(p-m)/(E[i+tw.PREV_TIME]-m));A+=(E[i+tw.R]-A)*_,S+=(E[i+tw.G]-S)*_,I+=(E[i+tw.B]-I)*_,R+=(E[i+tw.A]-R)*_}if(1==x)v.color.set(A,S,I,R);else{let i=v.color;y==G.setup&&i.setFromColor(v.data.color),i.add((A-i.r)*x,(S-i.g)*x,(I-i.b)*x,(R-i.a)*x)}}},tI=tw;tI.ENTRIES=5,tI.PREV_TIME=-5,tI.PREV_R=-4,tI.PREV_G=-3,tI.PREV_B=-2,tI.PREV_A=-1,tI.R=1,tI.G=2,tI.B=3,tI.A=4;let tR=class extends tT{constructor(i){super(i),this.frames=tr.newFloatArray(i*tR.ENTRIES)}getPropertyId(){return 234881024+this.slotIndex}setFrame(i,m,p,_,x,y,T,v,E){i*=tR.ENTRIES,this.frames[i]=m,this.frames[i+tR.R]=p,this.frames[i+tR.G]=_,this.frames[i+tR.B]=x,this.frames[i+tR.A]=y,this.frames[i+tR.R2]=T,this.frames[i+tR.G2]=v,this.frames[i+tR.B2]=E}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(!v.bone.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.color.setFromColor(v.data.color),v.darkColor.setFromColor(v.data.darkColor);break;case G.first:let i=v.color,m=v.darkColor,p=v.data.color,_=v.data.darkColor;i.add((p.r-i.r)*x,(p.g-i.g)*x,(p.b-i.b)*x,(p.a-i.a)*x),m.add((_.r-m.r)*x,(_.g-m.g)*x,(_.b-m.b)*x,0)}return}let A=0,S=0,I=0,R=0,C=0,P=0,k=0;if(p>=E[E.length-tR.ENTRIES]){let i=E.length;A=E[i+tR.PREV_R],S=E[i+tR.PREV_G],I=E[i+tR.PREV_B],R=E[i+tR.PREV_A],C=E[i+tR.PREV_R2],P=E[i+tR.PREV_G2],k=E[i+tR.PREV_B2]}else{let i=Animation.binarySearch(E,p,tR.ENTRIES);A=E[i+tR.PREV_R],S=E[i+tR.PREV_G],I=E[i+tR.PREV_B],R=E[i+tR.PREV_A],C=E[i+tR.PREV_R2],P=E[i+tR.PREV_G2],k=E[i+tR.PREV_B2];let m=E[i],_=this.getCurvePercent(i/tR.ENTRIES-1,1-(p-m)/(E[i+tR.PREV_TIME]-m));A+=(E[i+tR.R]-A)*_,S+=(E[i+tR.G]-S)*_,I+=(E[i+tR.B]-I)*_,R+=(E[i+tR.A]-R)*_,C+=(E[i+tR.R2]-C)*_,P+=(E[i+tR.G2]-P)*_,k+=(E[i+tR.B2]-k)*_}if(1==x)v.color.set(A,S,I,R),v.darkColor.set(C,P,k,1);else{let i=v.color,m=v.darkColor;y==G.setup&&(i.setFromColor(v.data.color),m.setFromColor(v.data.darkColor)),i.add((A-i.r)*x,(S-i.g)*x,(I-i.b)*x,(R-i.a)*x),m.add((C-m.r)*x,(P-m.g)*x,(k-m.b)*x,0)}}},tM=tR;tM.ENTRIES=8,tM.PREV_TIME=-8,tM.PREV_R=-7,tM.PREV_G=-6,tM.PREV_B=-5,tM.PREV_A=-4,tM.PREV_R2=-3,tM.PREV_G2=-2,tM.PREV_B2=-1,tM.R=1,tM.G=2,tM.B=3,tM.A=4,tM.R2=5,tM.G2=6,tM.B2=7;let AttachmentTimeline=class AttachmentTimeline{constructor(i){this.frames=tr.newFloatArray(i),this.attachmentNames=Array(i)}getPropertyId(){return 67108864+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(i,m,p){this.frames[i]=m,this.attachmentNames[i]=p}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(!v.bone.active)return;if(T==W.mixOut){y==G.setup&&this.setAttachment(i,v,v.data.attachmentName);return}let E=this.frames;if(p<E[0]){(y==G.setup||y==G.first)&&this.setAttachment(i,v,v.data.attachmentName);return}let A=0;A=p>=E[E.length-1]?E.length-1:Animation.binarySearch(E,p,1)-1;let S=this.attachmentNames[A];i.slots[this.slotIndex].setAttachment(null==S?null:i.getAttachment(this.slotIndex,S))}setAttachment(i,m,p){m.setAttachment(null==p?null:i.getAttachment(this.slotIndex,p))}};let tC=null;let DeformTimeline=class DeformTimeline extends tT{constructor(i){super(i),this.frames=tr.newFloatArray(i),this.frameVertices=Array(i),null==tC&&(tC=tr.newFloatArray(64))}getPropertyId(){return 805306368+Number(this.attachment.id)+this.slotIndex}setFrame(i,m,p){this.frames[i]=m,this.frameVertices[i]=p}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(!v.bone.active)return;let E=v.getAttachment();if(!(E instanceof tf)||E.deformAttachment!=this.attachment)return;let A=v.deform;0==A.length&&(y=G.setup);let S=this.frameVertices,I=S[0].length,R=this.frames;if(p<R[0]){switch(y){case G.setup:A.length=0;break;case G.first:if(1==x){A.length=0;break}let i=tr.setArraySize(A,I);if(null==E.bones){let m=E.vertices;for(let p=0;p<I;p++)i[p]+=(m[p]-i[p])*x}else{x=1-x;for(let m=0;m<I;m++)i[m]*=x}}return}let C=tr.setArraySize(A,I);if(p>=R[R.length-1]){let i=S[R.length-1];if(1==x){if(y==G.add){if(null==E.bones){let m=E.vertices;for(let p=0;p<I;p++)C[p]+=i[p]-m[p]}else for(let m=0;m<I;m++)C[m]+=i[m]}else tr.arrayCopy(i,0,C,0,I)}else switch(y){case G.setup:if(null==E.bones){let m=E.vertices;for(let p=0;p<I;p++){let _=m[p];C[p]=_+(i[p]-_)*x}}else for(let m=0;m<I;m++)C[m]=i[m]*x;break;case G.first:case G.replace:for(let m=0;m<I;m++)C[m]+=(i[m]-C[m])*x;break;case G.add:if(null==E.bones){let m=E.vertices;for(let p=0;p<I;p++)C[p]+=(i[p]-m[p])*x}else for(let m=0;m<I;m++)C[m]+=i[m]*x}return}let P=Animation.binarySearch(R,p),k=S[P-1],B=S[P],D=R[P],F=this.getCurvePercent(P-1,1-(p-D)/(R[P-1]-D));if(1==x){if(y==G.add){if(null==E.bones){let i=E.vertices;for(let m=0;m<I;m++){let p=k[m];C[m]+=p+(B[m]-p)*F-i[m]}}else for(let i=0;i<I;i++){let m=k[i];C[i]+=m+(B[i]-m)*F}}else for(let i=0;i<I;i++){let m=k[i];C[i]=m+(B[i]-m)*F}}else switch(y){case G.setup:if(null==E.bones){let i=E.vertices;for(let m=0;m<I;m++){let p=k[m],_=i[m];C[m]=_+(p+(B[m]-p)*F-_)*x}}else for(let i=0;i<I;i++){let m=k[i];C[i]=(m+(B[i]-m)*F)*x}break;case G.first:case G.replace:for(let i=0;i<I;i++){let m=k[i];C[i]+=(m+(B[i]-m)*F-C[i])*x}break;case G.add:if(null==E.bones){let i=E.vertices;for(let m=0;m<I;m++){let p=k[m];C[m]+=(p+(B[m]-p)*F-i[m])*x}}else for(let i=0;i<I;i++){let m=k[i];C[i]+=(m+(B[i]-m)*F)*x}}}};let EventTimeline=class EventTimeline{constructor(i){this.frames=tr.newFloatArray(i),this.events=Array(i)}getPropertyId(){return 117440512}getFrameCount(){return this.frames.length}setFrame(i,m){this.frames[i]=m.time,this.events[i]=m}apply(i,m,p,_,x,y,T){if(null==_)return;let v=this.frames,E=this.frames.length;if(m>p)this.apply(i,m,Number.MAX_VALUE,_,x,y,T),m=-1;else if(m>=v[E-1])return;if(p<v[0])return;let A=0;if(m<v[0])A=0;else{A=Animation.binarySearch(v,m);let i=v[A];for(;A>0&&v[A-1]==i;)A--}for(;A<E&&p>=v[A];A++)_.push(this.events[A])}};let DrawOrderTimeline=class DrawOrderTimeline{constructor(i){this.frames=tr.newFloatArray(i),this.drawOrders=Array(i)}getPropertyId(){return 134217728}getFrameCount(){return this.frames.length}setFrame(i,m,p){this.frames[i]=m,this.drawOrders[i]=p}apply(i,m,p,_,x,y,T){let v=i.drawOrder,E=i.slots;if(T==W.mixOut&&y==G.setup){tr.arrayCopy(i.slots,0,i.drawOrder,0,i.slots.length);return}let A=this.frames;if(p<A[0]){(y==G.setup||y==G.first)&&tr.arrayCopy(i.slots,0,i.drawOrder,0,i.slots.length);return}let S=0;S=p>=A[A.length-1]?A.length-1:Animation.binarySearch(A,p)-1;let I=this.drawOrders[S];if(null==I)tr.arrayCopy(E,0,v,0,E.length);else for(let i=0,m=I.length;i<m;i++)v[i]=E[I[i]]}};let tP=class extends tT{constructor(i){super(i),this.frames=tr.newFloatArray(i*tP.ENTRIES)}getPropertyId(){return 150994944+this.ikConstraintIndex}setFrame(i,m,p,_,x,y,T){i*=tP.ENTRIES,this.frames[i]=m,this.frames[i+tP.MIX]=p,this.frames[i+tP.SOFTNESS]=_,this.frames[i+tP.BEND_DIRECTION]=x,this.frames[i+tP.COMPRESS]=y?1:0,this.frames[i+tP.STRETCH]=T?1:0}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.ikConstraints[this.ikConstraintIndex];if(!E.active)return;if(p<v[0]){switch(y){case G.setup:E.mix=E.data.mix,E.softness=E.data.softness,E.bendDirection=E.data.bendDirection,E.compress=E.data.compress,E.stretch=E.data.stretch;break;case G.first:E.mix+=(E.data.mix-E.mix)*x,E.softness+=(E.data.softness-E.softness)*x,E.bendDirection=E.data.bendDirection,E.compress=E.data.compress,E.stretch=E.data.stretch}return}if(p>=v[v.length-tP.ENTRIES]){y==G.setup?(E.mix=E.data.mix+(v[v.length+tP.PREV_MIX]-E.data.mix)*x,E.softness=E.data.softness+(v[v.length+tP.PREV_SOFTNESS]-E.data.softness)*x,T==W.mixOut?(E.bendDirection=E.data.bendDirection,E.compress=E.data.compress,E.stretch=E.data.stretch):(E.bendDirection=v[v.length+tP.PREV_BEND_DIRECTION],E.compress=0!=v[v.length+tP.PREV_COMPRESS],E.stretch=0!=v[v.length+tP.PREV_STRETCH])):(E.mix+=(v[v.length+tP.PREV_MIX]-E.mix)*x,E.softness+=(v[v.length+tP.PREV_SOFTNESS]-E.softness)*x,T==W.mixIn&&(E.bendDirection=v[v.length+tP.PREV_BEND_DIRECTION],E.compress=0!=v[v.length+tP.PREV_COMPRESS],E.stretch=0!=v[v.length+tP.PREV_STRETCH]));return}let A=Animation.binarySearch(v,p,tP.ENTRIES),S=v[A+tP.PREV_MIX],I=v[A+tP.PREV_SOFTNESS],R=v[A],C=this.getCurvePercent(A/tP.ENTRIES-1,1-(p-R)/(v[A+tP.PREV_TIME]-R));y==G.setup?(E.mix=E.data.mix+(S+(v[A+tP.MIX]-S)*C-E.data.mix)*x,E.softness=E.data.softness+(I+(v[A+tP.SOFTNESS]-I)*C-E.data.softness)*x,T==W.mixOut?(E.bendDirection=E.data.bendDirection,E.compress=E.data.compress,E.stretch=E.data.stretch):(E.bendDirection=v[A+tP.PREV_BEND_DIRECTION],E.compress=0!=v[A+tP.PREV_COMPRESS],E.stretch=0!=v[A+tP.PREV_STRETCH])):(E.mix+=(S+(v[A+tP.MIX]-S)*C-E.mix)*x,E.softness+=(I+(v[A+tP.SOFTNESS]-I)*C-E.softness)*x,T==W.mixIn&&(E.bendDirection=v[A+tP.PREV_BEND_DIRECTION],E.compress=0!=v[A+tP.PREV_COMPRESS],E.stretch=0!=v[A+tP.PREV_STRETCH]))}},tk=tP;tk.ENTRIES=6,tk.PREV_TIME=-6,tk.PREV_MIX=-5,tk.PREV_SOFTNESS=-4,tk.PREV_BEND_DIRECTION=-3,tk.PREV_COMPRESS=-2,tk.PREV_STRETCH=-1,tk.MIX=1,tk.SOFTNESS=2,tk.BEND_DIRECTION=3,tk.COMPRESS=4,tk.STRETCH=5;let tB=class extends tT{constructor(i){super(i),this.frames=tr.newFloatArray(i*tB.ENTRIES)}getPropertyId(){return 167772160+this.transformConstraintIndex}setFrame(i,m,p,_,x,y){i*=tB.ENTRIES,this.frames[i]=m,this.frames[i+tB.ROTATE]=p,this.frames[i+tB.TRANSLATE]=_,this.frames[i+tB.SCALE]=x,this.frames[i+tB.SHEAR]=y}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.transformConstraints[this.transformConstraintIndex];if(!E.active)return;if(p<v[0]){let i=E.data;switch(y){case G.setup:E.rotateMix=i.rotateMix,E.translateMix=i.translateMix,E.scaleMix=i.scaleMix,E.shearMix=i.shearMix;break;case G.first:E.rotateMix+=(i.rotateMix-E.rotateMix)*x,E.translateMix+=(i.translateMix-E.translateMix)*x,E.scaleMix+=(i.scaleMix-E.scaleMix)*x,E.shearMix+=(i.shearMix-E.shearMix)*x}return}let A=0,S=0,I=0,R=0;if(p>=v[v.length-tB.ENTRIES]){let i=v.length;A=v[i+tB.PREV_ROTATE],S=v[i+tB.PREV_TRANSLATE],I=v[i+tB.PREV_SCALE],R=v[i+tB.PREV_SHEAR]}else{let i=Animation.binarySearch(v,p,tB.ENTRIES);A=v[i+tB.PREV_ROTATE],S=v[i+tB.PREV_TRANSLATE],I=v[i+tB.PREV_SCALE],R=v[i+tB.PREV_SHEAR];let m=v[i],_=this.getCurvePercent(i/tB.ENTRIES-1,1-(p-m)/(v[i+tB.PREV_TIME]-m));A+=(v[i+tB.ROTATE]-A)*_,S+=(v[i+tB.TRANSLATE]-S)*_,I+=(v[i+tB.SCALE]-I)*_,R+=(v[i+tB.SHEAR]-R)*_}if(y==G.setup){let i=E.data;E.rotateMix=i.rotateMix+(A-i.rotateMix)*x,E.translateMix=i.translateMix+(S-i.translateMix)*x,E.scaleMix=i.scaleMix+(I-i.scaleMix)*x,E.shearMix=i.shearMix+(R-i.shearMix)*x}else E.rotateMix+=(A-E.rotateMix)*x,E.translateMix+=(S-E.translateMix)*x,E.scaleMix+=(I-E.scaleMix)*x,E.shearMix+=(R-E.shearMix)*x}},tD=tB;tD.ENTRIES=5,tD.PREV_TIME=-5,tD.PREV_ROTATE=-4,tD.PREV_TRANSLATE=-3,tD.PREV_SCALE=-2,tD.PREV_SHEAR=-1,tD.ROTATE=1,tD.TRANSLATE=2,tD.SCALE=3,tD.SHEAR=4;let tF=class extends tT{constructor(i){super(i),this.frames=tr.newFloatArray(i*tF.ENTRIES)}getPropertyId(){return 184549376+this.pathConstraintIndex}setFrame(i,m,p){i*=tF.ENTRIES,this.frames[i]=m,this.frames[i+tF.VALUE]=p}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.pathConstraints[this.pathConstraintIndex];if(!E.active)return;if(p<v[0]){switch(y){case G.setup:E.position=E.data.position;break;case G.first:E.position+=(E.data.position-E.position)*x}return}let A=0;if(p>=v[v.length-tF.ENTRIES])A=v[v.length+tF.PREV_VALUE];else{let i=Animation.binarySearch(v,p,tF.ENTRIES);A=v[i+tF.PREV_VALUE];let m=v[i],_=this.getCurvePercent(i/tF.ENTRIES-1,1-(p-m)/(v[i+tF.PREV_TIME]-m));A+=(v[i+tF.VALUE]-A)*_}y==G.setup?E.position=E.data.position+(A-E.data.position)*x:E.position+=(A-E.position)*x}},tN=tF;tN.ENTRIES=2,tN.PREV_TIME=-2,tN.PREV_VALUE=-1,tN.VALUE=1;let PathConstraintSpacingTimeline=class PathConstraintSpacingTimeline extends tN{constructor(i){super(i)}getPropertyId(){return 201326592+this.pathConstraintIndex}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.pathConstraints[this.pathConstraintIndex];if(!E.active)return;if(p<v[0]){switch(y){case G.setup:E.spacing=E.data.spacing;break;case G.first:E.spacing+=(E.data.spacing-E.spacing)*x}return}let A=0;if(p>=v[v.length-PathConstraintSpacingTimeline.ENTRIES])A=v[v.length+PathConstraintSpacingTimeline.PREV_VALUE];else{let i=Animation.binarySearch(v,p,PathConstraintSpacingTimeline.ENTRIES);A=v[i+PathConstraintSpacingTimeline.PREV_VALUE];let m=v[i],_=this.getCurvePercent(i/PathConstraintSpacingTimeline.ENTRIES-1,1-(p-m)/(v[i+PathConstraintSpacingTimeline.PREV_TIME]-m));A+=(v[i+PathConstraintSpacingTimeline.VALUE]-A)*_}y==G.setup?E.spacing=E.data.spacing+(A-E.data.spacing)*x:E.spacing+=(A-E.spacing)*x}};let tL=class extends tT{constructor(i){super(i),this.frames=tr.newFloatArray(i*tL.ENTRIES)}getPropertyId(){return 218103808+this.pathConstraintIndex}setFrame(i,m,p,_){i*=tL.ENTRIES,this.frames[i]=m,this.frames[i+tL.ROTATE]=p,this.frames[i+tL.TRANSLATE]=_}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.pathConstraints[this.pathConstraintIndex];if(!E.active)return;if(p<v[0]){switch(y){case G.setup:E.rotateMix=E.data.rotateMix,E.translateMix=E.data.translateMix;break;case G.first:E.rotateMix+=(E.data.rotateMix-E.rotateMix)*x,E.translateMix+=(E.data.translateMix-E.translateMix)*x}return}let A=0,S=0;if(p>=v[v.length-tL.ENTRIES])A=v[v.length+tL.PREV_ROTATE],S=v[v.length+tL.PREV_TRANSLATE];else{let i=Animation.binarySearch(v,p,tL.ENTRIES);A=v[i+tL.PREV_ROTATE],S=v[i+tL.PREV_TRANSLATE];let m=v[i],_=this.getCurvePercent(i/tL.ENTRIES-1,1-(p-m)/(v[i+tL.PREV_TIME]-m));A+=(v[i+tL.ROTATE]-A)*_,S+=(v[i+tL.TRANSLATE]-S)*_}y==G.setup?(E.rotateMix=E.data.rotateMix+(A-E.data.rotateMix)*x,E.translateMix=E.data.translateMix+(S-E.data.translateMix)*x):(E.rotateMix+=(A-E.rotateMix)*x,E.translateMix+=(S-E.translateMix)*x)}},tO=tL;tO.ENTRIES=3,tO.PREV_TIME=-3,tO.PREV_ROTATE=-2,tO.PREV_TRANSLATE=-1,tO.ROTATE=1,tO.TRANSLATE=2;let tV=class{constructor(i){this.tracks=[],this.timeScale=1,this.unkeyedState=0,this.events=[],this.listeners=[],this.queue=new tH(this),this.propertyIDs=new IntSet,this.animationsChanged=!1,this.trackEntryPool=new Pool(()=>new tY),this.data=i}update(i){i*=this.timeScale;let m=this.tracks;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(null==_)continue;_.animationLast=_.nextAnimationLast,_.trackLast=_.nextTrackLast;let x=i*_.timeScale;if(_.delay>0){if(_.delay-=x,_.delay>0)continue;x=-_.delay,_.delay=0}let y=_.next;if(null!=y){let m=_.trackLast-y.delay;if(m>=0){for(y.delay=0,y.trackTime+=0==_.timeScale?0:(m/_.timeScale+i)*y.timeScale,_.trackTime+=x,this.setCurrent(p,y,!0);null!=y.mixingFrom;)y.mixTime+=i,y=y.mixingFrom;continue}}else if(_.trackLast>=_.trackEnd&&null==_.mixingFrom){m[p]=null,this.queue.end(_),this.disposeNext(_);continue}if(null!=_.mixingFrom&&this.updateMixingFrom(_,i)){let i=_.mixingFrom;for(_.mixingFrom=null,null!=i&&(i.mixingTo=null);null!=i;)this.queue.end(i),i=i.mixingFrom}_.trackTime+=x}this.queue.drain()}updateMixingFrom(i,m){let p=i.mixingFrom;if(null==p)return!0;let _=this.updateMixingFrom(p,m);return(p.animationLast=p.nextAnimationLast,p.trackLast=p.nextTrackLast,i.mixTime>0&&i.mixTime>=i.mixDuration)?((0==p.totalAlpha||0==i.mixDuration)&&(i.mixingFrom=p.mixingFrom,null!=p.mixingFrom&&(p.mixingFrom.mixingTo=i),i.interruptAlpha=p.interruptAlpha,this.queue.end(p)),_):(p.trackTime+=m*p.timeScale,i.mixTime+=m,!1)}apply(i){if(null==i)throw Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let m=this.events,p=this.tracks,_=!1;for(let x=0,y=p.length;x<y;x++){let y=p[x];if(null==y||y.delay>0)continue;_=!0;let T=0==x?G.first:y.mixBlend,v=y.alpha;null!=y.mixingFrom?v*=this.applyMixingFrom(y,i,T):y.trackTime>=y.trackEnd&&null==y.next&&(v=0);let E=y.animationLast,A=y.getAnimationTime(),S=y.animation.timelines.length,I=y.animation.timelines;if(0==x&&1==v||T==G.add)for(let p=0;p<S;p++){tr.webkit602BugfixHelper(v,T);let _=I[p];_ instanceof AttachmentTimeline?this.applyAttachmentTimeline(_,i,A,T,!0):_.apply(i,E,A,m,v,T,W.mixIn)}else{let p=y.timelineMode,_=0==y.timelinesRotation.length;_&&tr.setArraySize(y.timelinesRotation,S<<1,null);let x=y.timelinesRotation;for(let y=0;y<S;y++){let S=I[y],R=p[y]==tV.SUBSEQUENT?T:G.setup;S instanceof tE?this.applyRotateTimeline(S,i,A,v,R,x,y<<1,_):S instanceof AttachmentTimeline?this.applyAttachmentTimeline(S,i,A,T,!0):(tr.webkit602BugfixHelper(v,T),S.apply(i,E,A,m,v,R,W.mixIn))}}this.queueEvents(y,A),m.length=0,y.nextAnimationLast=A,y.nextTrackLast=y.trackTime}let x=this.unkeyedState+tV.SETUP,y=i.slots;for(let m=0,p=i.slots.length;m<p;m++){let p=y[m];if(p.attachmentState==x){let m=p.data.attachmentName;p.setAttachment(null==m?null:i.getAttachment(p.data.index,m))}}return this.unkeyedState+=2,this.queue.drain(),_}applyMixingFrom(i,m,p){let _=i.mixingFrom;null!=_.mixingFrom&&this.applyMixingFrom(_,m,p);let x=0;0==i.mixDuration?(x=1,p==G.first&&(p=G.setup)):((x=i.mixTime/i.mixDuration)>1&&(x=1),p!=G.first&&(p=_.mixBlend));let y=x<_.eventThreshold?this.events:null,T=x<_.attachmentThreshold,v=x<_.drawOrderThreshold,E=_.animationLast,A=_.getAnimationTime(),S=_.animation.timelines.length,I=_.animation.timelines,R=_.alpha*i.interruptAlpha,C=R*(1-x);if(p==G.add)for(let i=0;i<S;i++)I[i].apply(m,E,A,y,C,p,W.mixOut);else{let i=_.timelineMode,x=_.timelineHoldMix,P=0==_.timelinesRotation.length;P&&tr.setArraySize(_.timelinesRotation,S<<1,null);let k=_.timelinesRotation;_.totalAlpha=0;for(let B=0;B<S;B++){let S;let D=I[B],F=W.mixOut,L=0;switch(i[B]){case tV.SUBSEQUENT:if(!v&&D instanceof DrawOrderTimeline)continue;S=p,L=C;break;case tV.FIRST:S=G.setup,L=C;break;case tV.HOLD_SUBSEQUENT:S=p,L=R;break;case tV.HOLD_FIRST:S=G.setup,L=R;break;default:S=G.setup;let O=x[B];L=R*Math.max(0,1-O.mixTime/O.mixDuration)}_.totalAlpha+=L,D instanceof tE?this.applyRotateTimeline(D,m,A,L,S,k,B<<1,P):D instanceof AttachmentTimeline?this.applyAttachmentTimeline(D,m,A,S,T):(tr.webkit602BugfixHelper(L,p),v&&D instanceof DrawOrderTimeline&&S==G.setup&&(F=W.mixIn),D.apply(m,E,A,y,L,S,F))}}return i.mixDuration>0&&this.queueEvents(_,A),this.events.length=0,_.nextAnimationLast=A,_.nextTrackLast=_.trackTime,x}applyAttachmentTimeline(i,m,p,_,x){let y=m.slots[i.slotIndex];if(!y.bone.active)return;let T=i.frames;if(p<T[0])(_==G.setup||_==G.first)&&this.setAttachment(m,y,y.data.attachmentName,x);else{let _;_=p>=T[T.length-1]?T.length-1:Animation.binarySearch(T,p)-1,this.setAttachment(m,y,i.attachmentNames[_],x)}y.attachmentState<=this.unkeyedState&&(y.attachmentState=this.unkeyedState+tV.SETUP)}setAttachment(i,m,p,_){m.setAttachment(null==p?null:i.getAttachment(m.data.index,p)),_&&(m.attachmentState=this.unkeyedState+tV.CURRENT)}applyRotateTimeline(i,m,p,_,x,y,T,v){if(v&&(y[T]=0),1==_){i.apply(m,0,p,null,1,x,W.mixIn);return}let E=i.frames,A=m.bones[i.boneIndex];if(!A.active)return;let S=0,I=0;if(p<E[0])switch(x){case G.setup:A.rotation=A.data.rotation;default:return;case G.first:S=A.rotation,I=A.data.rotation}else if(S=x==G.setup?A.data.rotation:A.rotation,p>=E[E.length-tE.ENTRIES])I=A.data.rotation+E[E.length+tE.PREV_ROTATION];else{let m=Animation.binarySearch(E,p,tE.ENTRIES),_=E[m+tE.PREV_ROTATION],x=E[m],y=i.getCurvePercent((m>>1)-1,1-(p-x)/(E[m+tE.PREV_TIME]-x));I=E[m+tE.ROTATION]-_,I-=(16384-(16384.499999999996-I/360|0))*360,I=_+I*y+A.data.rotation,I-=(16384-(16384.499999999996-I/360|0))*360}let R=0,C=I-S;if(0==(C-=(16384-(16384.499999999996-C/360|0))*360))R=y[T];else{let i=0,m=0;v?(i=0,m=C):(i=y[T],m=y[T+1]);let p=C>0,_=i>=0;te.signum(m)!=te.signum(C)&&90>=Math.abs(m)&&(Math.abs(i)>180&&(i+=360*te.signum(i)),_=p),R=C+i-i%360,_!=p&&(R+=360*te.signum(i)),y[T]=R}y[T+1]=C,S+=R*_,A.rotation=S-(16384-(16384.499999999996-S/360|0))*360}queueEvents(i,m){let p=i.animationStart,_=i.animationEnd,x=_-p,y=i.trackLast%x,T=this.events,v=0,E=T.length;for(;v<E;v++){let m=T[v];if(m.time<y)break;m.time>_||this.queue.event(i,m)}for((i.loop?0==x||y>i.trackTime%x:m>=_&&i.animationLast<_)&&this.queue.complete(i);v<E;v++){let m=T[v];m.time<p||this.queue.event(i,T[v])}}clearTracks(){let i=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let i=0,m=this.tracks.length;i<m;i++)this.clearTrack(i);this.tracks.length=0,this.queue.drainDisabled=i,this.queue.drain()}clearTrack(i){if(i>=this.tracks.length)return;let m=this.tracks[i];if(null==m)return;this.queue.end(m),this.disposeNext(m);let p=m;for(;;){let i=p.mixingFrom;if(null==i)break;this.queue.end(i),p.mixingFrom=null,p.mixingTo=null,p=i}this.tracks[m.trackIndex]=null,this.queue.drain()}setCurrent(i,m,p){let _=this.expandToIndex(i);this.tracks[i]=m,null!=_&&(p&&this.queue.interrupt(_),m.mixingFrom=_,_.mixingTo=m,m.mixTime=0,null!=_.mixingFrom&&_.mixDuration>0&&(m.interruptAlpha*=Math.min(1,_.mixTime/_.mixDuration)),_.timelinesRotation.length=0),this.queue.start(m)}setAnimation(i,m,p){let _=this.data.skeletonData.findAnimation(m);if(null==_)throw Error(`Animation not found: ${m}`);return this.setAnimationWith(i,_,p)}setAnimationWith(i,m,p){if(null==m)throw Error("animation cannot be null.");let _=!0,x=this.expandToIndex(i);null!=x&&(-1==x.nextTrackLast?(this.tracks[i]=x.mixingFrom,this.queue.interrupt(x),this.queue.end(x),this.disposeNext(x),x=x.mixingFrom,_=!1):this.disposeNext(x));let y=this.trackEntry(i,m,p,x);return this.setCurrent(i,y,_),this.queue.drain(),y}addAnimation(i,m,p,_){let x=this.data.skeletonData.findAnimation(m);if(null==x)throw Error(`Animation not found: ${m}`);return this.addAnimationWith(i,x,p,_)}addAnimationWith(i,m,p,_){if(null==m)throw Error("animation cannot be null.");let x=this.expandToIndex(i);if(null!=x)for(;null!=x.next;)x=x.next;let y=this.trackEntry(i,m,p,x);if(null==x)this.setCurrent(i,y,!0),this.queue.drain();else if(x.next=y,_<=0){let i=x.animationEnd-x.animationStart;0!=i?(x.loop?_+=i*(1+(x.trackTime/i|0)):_+=Math.max(i,x.trackTime),_-=this.data.getMix(x.animation,m)):_=x.trackTime}return y.delay=_,y}setEmptyAnimation(i,m){let p=this.setAnimationWith(i,tV.emptyAnimation,!1);return p.mixDuration=m,p.trackEnd=m,p}addEmptyAnimation(i,m,p){p<=0&&(p-=m);let _=this.addAnimationWith(i,tV.emptyAnimation,!1,p);return _.mixDuration=m,_.trackEnd=m,_}setEmptyAnimations(i){let m=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let m=0,p=this.tracks.length;m<p;m++){let p=this.tracks[m];null!=p&&this.setEmptyAnimation(p.trackIndex,i)}this.queue.drainDisabled=m,this.queue.drain()}expandToIndex(i){return i<this.tracks.length?this.tracks[i]:(tr.ensureArrayCapacity(this.tracks,i+1,null),this.tracks.length=i+1,null)}trackEntry(i,m,p,_){let x=this.trackEntryPool.obtain();return x.trackIndex=i,x.animation=m,x.loop=p,x.holdPrevious=!1,x.eventThreshold=0,x.attachmentThreshold=0,x.drawOrderThreshold=0,x.animationStart=0,x.animationEnd=m.duration,x.animationLast=-1,x.nextAnimationLast=-1,x.delay=0,x.trackTime=0,x.trackLast=-1,x.nextTrackLast=-1,x.trackEnd=Number.MAX_VALUE,x.timeScale=1,x.alpha=1,x.interruptAlpha=1,x.mixTime=0,x.mixDuration=null==_?0:this.data.getMix(_.animation,m),x.mixBlend=G.replace,x}disposeNext(i){let m=i.next;for(;null!=m;)this.queue.dispose(m),m=m.next;i.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let i=0,m=this.tracks.length;i<m;i++){let m=this.tracks[i];if(null!=m){for(;null!=m.mixingFrom;)m=m.mixingFrom;do(null==m.mixingFrom||m.mixBlend!=G.add)&&this.computeHold(m),m=m.mixingTo;while(null!=m)}}}computeHold(i){let m=i.mixingTo,p=i.animation.timelines,_=i.animation.timelines.length,x=tr.setArraySize(i.timelineMode,_);i.timelineHoldMix.length=0;let y=tr.setArraySize(i.timelineHoldMix,_),T=this.propertyIDs;if(null!=m&&m.holdPrevious){for(let i=0;i<_;i++)x[i]=T.add(p[i].getPropertyId())?tV.HOLD_FIRST:tV.HOLD_SUBSEQUENT;return}t:for(let v=0;v<_;v++){let _=p[v],E=_.getPropertyId();if(T.add(E)){if(null==m||_ instanceof AttachmentTimeline||_ instanceof DrawOrderTimeline||_ instanceof EventTimeline||!m.animation.hasTimeline(E))x[v]=tV.FIRST;else{for(let p=m.mixingTo;null!=p;p=p.mixingTo)if(!p.animation.hasTimeline(E)){if(i.mixDuration>0){x[v]=tV.HOLD_MIX,y[v]=p;continue t}break}x[v]=tV.HOLD_FIRST}}else x[v]=tV.SUBSEQUENT}}getCurrent(i){return i>=this.tracks.length?null:this.tracks[i]}addListener(i){if(null==i)throw Error("listener cannot be null.");this.listeners.push(i)}removeListener(i){let m=this.listeners.indexOf(i);m>=0&&this.listeners.splice(m,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(i,m,p){tV.deprecatedWarning1||(tV.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(i,m,p)}addAnimationByName(i,m,p,_){tV.deprecatedWarning2||(tV.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(i,m,p,_)}hasAnimation(i){let m=this.data.skeletonData.findAnimation(i);return null!==m}hasAnimationByName(i){return tV.deprecatedWarning3||(tV.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(i)}},tU=tV;tU.emptyAnimation=new Animation("<empty>",[],0),tU.SUBSEQUENT=0,tU.FIRST=1,tU.HOLD_SUBSEQUENT=2,tU.HOLD_FIRST=3,tU.HOLD_MIX=4,tU.SETUP=1,tU.CURRENT=2,tU.deprecatedWarning1=!1,tU.deprecatedWarning2=!1,tU.deprecatedWarning3=!1;let tX=class{constructor(){this.mixBlend=G.replace,this.timelineMode=[],this.timelineHoldMix=[],this.timelinesRotation=[]}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let i=this.animationEnd-this.animationStart;return 0==i?this.animationStart:this.trackTime%i+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(i){this.animationLast=i,this.nextAnimationLast=i}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return tX.deprecatedWarning1||(tX.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(i){tX.deprecatedWarning1||(tX.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=i}get endTime(){return tX.deprecatedWarning2||(tX.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(i){tX.deprecatedWarning2||(tX.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=i}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}},tY=tX;tY.deprecatedWarning1=!1,tY.deprecatedWarning2=!1;let tG=class{constructor(i){this.objects=[],this.drainDisabled=!1,this.animState=i}start(i){this.objects.push(tW.start),this.objects.push(i),this.animState.animationsChanged=!0}interrupt(i){this.objects.push(tW.interrupt),this.objects.push(i)}end(i){this.objects.push(tW.end),this.objects.push(i),this.animState.animationsChanged=!0}dispose(i){this.objects.push(tW.dispose),this.objects.push(i)}complete(i){this.objects.push(tW.complete),this.objects.push(i)}event(i,m){this.objects.push(tW.event),this.objects.push(i),this.objects.push(m)}deprecateStuff(){return tG.deprecatedWarning1||(tG.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let i=this.objects,m=this.animState.listeners;for(let p=0;p<i.length;p+=2){let _=i[p],x=i[p+1];switch(_){case tW.start:null!=x.listener&&x.listener.start&&x.listener.start(x);for(let i=0;i<m.length;i++)m[i].start&&m[i].start(x);x.onStart&&this.deprecateStuff()&&x.onStart(x.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(x.trackIndex);break;case tW.interrupt:null!=x.listener&&x.listener.interrupt&&x.listener.interrupt(x);for(let i=0;i<m.length;i++)m[i].interrupt&&m[i].interrupt(x);break;case tW.end:null!=x.listener&&x.listener.end&&x.listener.end(x);for(let i=0;i<m.length;i++)m[i].end&&m[i].end(x);x.onEnd&&this.deprecateStuff()&&x.onEnd(x.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(x.trackIndex);case tW.dispose:null!=x.listener&&x.listener.dispose&&x.listener.dispose(x);for(let i=0;i<m.length;i++)m[i].dispose&&m[i].dispose(x);this.animState.trackEntryPool.free(x);break;case tW.complete:null!=x.listener&&x.listener.complete&&x.listener.complete(x);for(let i=0;i<m.length;i++)m[i].complete&&m[i].complete(x);let y=te.toInt(x.loopsCount());x.onComplete&&this.deprecateStuff()&&x.onComplete(x.trackIndex,y),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(x.trackIndex,y);break;case tW.event:let T=i[p+++2];null!=x.listener&&x.listener.event&&x.listener.event(x,T);for(let i=0;i<m.length;i++)m[i].event&&m[i].event(x,T);x.onEvent&&this.deprecateStuff()&&x.onEvent(x.trackIndex,T),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(x.trackIndex,T)}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}},tH=tG;tH.deprecatedWarning1=!1;var tW=((R=tW||{})[R.start=0]="start",R[R.interrupt=1]="interrupt",R[R.end=2]="end",R[R.dispose=3]="dispose",R[R.complete=4]="complete",R[R.event=5]="event",R);let AnimationStateAdapter=class AnimationStateAdapter{start(i){}interrupt(i){}end(i){}dispose(i){}complete(i){}event(i,m){}};let t$=class{constructor(i){if(this.animationToMixTime={},this.defaultMix=0,null==i)throw Error("skeletonData cannot be null.");this.skeletonData=i}setMix(i,m,p){let _=this.skeletonData.findAnimation(i);if(null==_)throw Error(`Animation not found: ${i}`);let x=this.skeletonData.findAnimation(m);if(null==x)throw Error(`Animation not found: ${m}`);this.setMixWith(_,x,p)}setMixByName(i,m,p){t$.deprecatedWarning1||(t$.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(i,m,p)}setMixWith(i,m,p){if(null==i)throw Error("from cannot be null.");if(null==m)throw Error("to cannot be null.");let _=`${i.name}.${m.name}`;this.animationToMixTime[_]=p}getMix(i,m){let p=`${i.name}.${m.name}`,_=this.animationToMixTime[p];return void 0===_?this.defaultMix:_}},tz=t$;tz.deprecatedWarning1=!1;let AtlasAttachmentLoader=class AtlasAttachmentLoader{constructor(i){this.atlas=i}newRegionAttachment(i,m,p){let _=this.atlas.findRegion(p);if(null==_)throw Error(`Region not found in atlas: ${p} (region attachment: ${m})`);let x=new tg(m);return x.region=_,x}newMeshAttachment(i,m,p){let _=this.atlas.findRegion(p);if(null==_)throw Error(`Region not found in atlas: ${p} (mesh attachment: ${m})`);let x=new MeshAttachment(m);return x.region=_,x}newBoundingBoxAttachment(i,m){return new BoundingBoxAttachment(m)}newPathAttachment(i,m){return new PathAttachment(m)}newPointAttachment(i,m){return new PointAttachment(m)}newClippingAttachment(i,m){return new ClippingAttachment(m)}};let Bone=class Bone{constructor(i,m,p){if(this.matrix=new K.y3,this.children=[],this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!1,null==i)throw Error("data cannot be null.");if(null==m)throw Error("skeleton cannot be null.");this.data=i,this.skeleton=m,this.parent=p,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(i,m,p,_,x,y,T){this.ax=i,this.ay=m,this.arotation=p,this.ascaleX=_,this.ascaleY=x,this.ashearX=y,this.ashearY=T,this.appliedValid=!0;let v=this.parent,E=this.matrix,A=this.skeleton.scaleX,S=ti.yDown?-this.skeleton.scaleY:this.skeleton.scaleY;if(null==v){let v=this.skeleton,I=p+90+T;E.a=te.cosDeg(p+y)*_*A,E.c=te.cosDeg(I)*x*A,E.b=te.sinDeg(p+y)*_*S,E.d=te.sinDeg(I)*x*S,E.tx=i*A+v.x,E.ty=m*S+v.y;return}let I=v.matrix.a,R=v.matrix.c,C=v.matrix.b,P=v.matrix.d;switch(E.tx=I*i+R*m+v.matrix.tx,E.ty=C*i+P*m+v.matrix.ty,this.data.transformMode){case Z.Normal:{let i=p+90+T,m=te.cosDeg(p+y)*_,v=te.cosDeg(i)*x,A=te.sinDeg(p+y)*_,S=te.sinDeg(i)*x;E.a=I*m+R*A,E.c=I*v+R*S,E.b=C*m+P*A,E.d=C*v+P*S;return}case Z.OnlyTranslation:{let i=p+90+T;E.a=te.cosDeg(p+y)*_,E.c=te.cosDeg(i)*x,E.b=te.sinDeg(p+y)*_,E.d=te.sinDeg(i)*x;break}case Z.NoRotationOrReflection:{let i=I*I+C*C,m=0;i>1e-4?(i=Math.abs(I*P-R*C)/i,I/=this.skeleton.scaleX,C/=this.skeleton.scaleY,R=C*i,P=I*i,m=Math.atan2(C,I)*te.radDeg):(I=0,C=0,m=90-Math.atan2(P,R)*te.radDeg);let v=p+y-m,A=p+T-m+90,S=te.cosDeg(v)*_,k=te.cosDeg(A)*x,B=te.sinDeg(v)*_,D=te.sinDeg(A)*x;E.a=I*S-R*B,E.c=I*k-R*D,E.b=C*S+P*B,E.d=C*k+P*D;break}case Z.NoScale:case Z.NoScaleOrReflection:{let i=te.cosDeg(p),m=te.sinDeg(p),v=(I*i+R*m)/A,k=(C*i+P*m)/S,B=Math.sqrt(v*v+k*k);B>1e-5&&(B=1/B),v*=B,k*=B,B=Math.sqrt(v*v+k*k),this.data.transformMode==Z.NoScale&&I*P-R*C<0!=(ti.yDown?this.skeleton.scaleX<0!=this.skeleton.scaleY>0:this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(B=-B);let D=Math.PI/2+Math.atan2(k,v),F=Math.cos(D)*B,L=Math.sin(D)*B,O=te.cosDeg(y)*_,V=te.cosDeg(90+T)*x,U=te.sinDeg(y)*_,X=te.sinDeg(90+T)*x;E.a=v*O+F*U,E.c=v*V+F*X,E.b=k*O+L*U,E.d=k*V+L*X}}E.a*=A,E.c*=A,E.b*=S,E.d*=S}setToSetupPose(){let i=this.data;this.x=i.x,this.y=i.y,this.rotation=i.rotation,this.scaleX=i.scaleX,this.scaleY=i.scaleY,this.shearX=i.shearX,this.shearY=i.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*te.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*te.radDeg}getWorldScaleX(){let i=this.matrix;return Math.sqrt(i.a*i.a+i.c*i.c)}getWorldScaleY(){let i=this.matrix;return Math.sqrt(i.b*i.b+i.d*i.d)}updateAppliedTransform(){this.appliedValid=!0;let i=this.parent,m=this.matrix;if(null==i){this.ax=m.tx,this.ay=m.ty,this.arotation=Math.atan2(m.b,m.a)*te.radDeg,this.ascaleX=Math.sqrt(m.a*m.a+m.b*m.b),this.ascaleY=Math.sqrt(m.c*m.c+m.d*m.d),this.ashearX=0,this.ashearY=Math.atan2(m.a*m.c+m.b*m.d,m.a*m.d-m.b*m.c)*te.radDeg;return}let p=i.matrix,_=1/(p.a*p.d-p.b*p.c),x=m.tx-p.tx,y=m.ty-p.ty;this.ax=x*p.d*_-y*p.c*_,this.ay=y*p.a*_-x*p.b*_;let T=_*p.d,v=_*p.a,E=_*p.c,A=_*p.b,S=T*m.a-E*m.b,I=T*m.c-E*m.d,R=v*m.b-A*m.a,C=v*m.d-A*m.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(S*S+R*R),this.ascaleX>1e-4){let i=S*C-I*R;this.ascaleY=i/this.ascaleX,this.ashearY=Math.atan2(S*I+R*C,i)*te.radDeg,this.arotation=Math.atan2(R,S)*te.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(I*I+C*C),this.ashearY=0,this.arotation=90-Math.atan2(C,I)*te.radDeg}worldToLocal(i){let m=this.matrix,p=m.a,_=m.c,x=m.b,y=m.d,T=1/(p*y-_*x),v=i.x-m.tx,E=i.y-m.ty;return i.x=v*y*T-E*_*T,i.y=E*p*T-v*x*T,i}localToWorld(i){let m=this.matrix,p=i.x,_=i.y;return i.x=p*m.a+_*m.c+m.tx,i.y=p*m.b+_*m.d+m.ty,i}worldToLocalRotation(i){let m=te.sinDeg(i),p=te.cosDeg(i),_=this.matrix;return Math.atan2(_.a*m-_.b*p,_.d*p-_.c*m)*te.radDeg}localToWorldRotation(i){let m=te.sinDeg(i),p=te.cosDeg(i),_=this.matrix;return Math.atan2(p*_.b+m*_.d,p*_.a+m*_.c)*te.radDeg}rotateWorld(i){let m=this.matrix,p=m.a,_=m.c,x=m.b,y=m.d,T=te.cosDeg(i),v=te.sinDeg(i);m.a=T*p-v*x,m.c=T*_-v*y,m.b=v*p+T*x,m.d=v*_+T*y,this.appliedValid=!1}};let BoneData=class BoneData{constructor(i,m,p){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Z.Normal,this.skinRequired=!1,this.color=new tt,i<0)throw Error("index must be >= 0.");if(null==m)throw Error("name cannot be null.");this.index=i,this.name=m,this.parent=p}};let ConstraintData=class ConstraintData{constructor(i,m,p){this.name=i,this.order=m,this.skinRequired=p}};let Event=class Event{constructor(i,m){if(null==m)throw Error("data cannot be null.");this.time=i,this.data=m}};let EventData=class EventData{constructor(i){this.name=i}};let IkConstraint=class IkConstraint{constructor(i,m){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,null==i)throw Error("data cannot be null.");if(null==m)throw Error("skeleton cannot be null.");this.data=i,this.mix=i.mix,this.softness=i.softness,this.bendDirection=i.bendDirection,this.compress=i.compress,this.stretch=i.stretch,this.bones=[];for(let p=0;p<i.bones.length;p++)this.bones.push(m.findBone(i.bones[p].name));this.target=m.findBone(i.target.name)}isActive(){return this.active}apply(){this.update()}update(){let i=this.target,m=this.bones;switch(m.length){case 1:this.apply1(m[0],i.worldX,i.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(m[0],m[1],i.worldX,i.worldY,this.bendDirection,this.stretch,this.softness,this.mix)}}apply1(i,m,p,_,x,y,T){i.appliedValid||i.updateAppliedTransform();let v=i.parent.matrix,E=v.a,A=v.c,S=v.b,I=v.d,R=-i.ashearX-i.arotation,C=0,P=0;switch(i.data.transformMode){case Z.OnlyTranslation:C=m-i.worldX,P=p-i.worldY;break;case Z.NoRotationOrReflection:let k=Math.abs(E*I-A*S)/(E*E+S*S),B=E/i.skeleton.scaleX,D=S/i.skeleton.scaleY;A=-D*k*i.skeleton.scaleX,I=B*k*i.skeleton.scaleY,R+=Math.atan2(D,B)*te.radDeg;default:let F=m-v.tx,L=p-v.ty,O=E*I-A*S;C=(F*I-L*A)/O-i.ax,P=(L*E-F*S)/O-i.ay}R+=Math.atan2(P,C)*te.radDeg,i.ascaleX<0&&(R+=180),R>180?R-=360:R<-180&&(R+=360);let V=i.ascaleX,U=i.ascaleY;if(_||x){switch(i.data.transformMode){case Z.NoScale:case Z.NoScaleOrReflection:C=m-i.worldX,P=p-i.worldY}let v=i.data.length*V,E=Math.sqrt(C*C+P*P);if(_&&E<v||x&&E>v&&v>1e-4){let i=(E/v-1)*T+1;V*=i,y&&(U*=i)}}i.updateWorldTransformWith(i.ax,i.ay,i.arotation+R*T,V,U,i.ashearX,i.ashearY)}apply2(i,m,p,_,x,y,T,v){let E,A;if(0==v){m.updateWorldTransform();return}i.appliedValid||i.updateAppliedTransform(),m.appliedValid||m.updateAppliedTransform();let S=i.ax,I=i.ay,R=i.ascaleX,C=R,P=i.ascaleY,k=m.ascaleX,B=i.matrix,D=0,F=0,L=0;R<0?(R=-R,D=180,L=-1):(D=0,L=1),P<0&&(P=-P,L=-L),k<0?(k=-k,F=180):F=0;let O=m.ax,V=0,U=0,X=0,Y=B.a,G=B.c,W=B.b,z=B.d,j=1e-4>=Math.abs(R-P);j?(U=Y*O+G*(V=m.ay)+B.tx,X=W*O+z*V+B.ty):(V=0,U=Y*O+B.tx,X=W*O+B.ty);let Z=i.parent.matrix;Y=Z.a,G=Z.c,W=Z.b,z=Z.d;let K=1/(Y*z-G*W),J=U-Z.tx,Q=X-Z.ty,tt=(J*z-Q*G)*K-S,tr=(Q*Y-J*W)*K-I,ti=Math.sqrt(tt*tt+tr*tr),ts=m.data.length*k;if(ti<1e-4){this.apply1(i,p,_,!1,y,!1,v),m.updateWorldTransformWith(O,V,0,m.ascaleX,m.ascaleY,m.ashearX,m.ashearY);return}let tn=((J=p-Z.tx)*z-(Q=_-Z.ty)*G)*K-S,ta=(Q*Y-J*W)*K-I,to=tn*tn+ta*ta;if(0!=T){T*=R*(k+1)/2;let i=Math.sqrt(to),m=i-ti-ts*R+T;if(m>0){let p=Math.min(1,m/(2*T))-1;p=(m-T*(1-p*p))/i,tn-=p*tn,ta-=p*ta,to=tn*tn+ta*ta}}t:if(j){let i=(to-ti*ti-(ts*=R)*ts)/(2*ti*ts);i<-1?i=-1:i>1&&(i=1,y&&(C*=(Math.sqrt(to)/(ti+ts)-1)*v+1)),A=Math.acos(i)*x,E=Math.atan2(ta*(Y=ti+ts*i)-tn*(G=ts*Math.sin(A)),tn*Y+ta*G)}else{Y=R*ts,G=P*ts;let i=Y*Y,m=G*G,p=Math.atan2(ta,tn);W=m*ti*ti+i*to-i*m;let _=-2*m*ti,y=m-i;if((z=_*_-4*y*W)>=0){let i=Math.sqrt(z);_<0&&(i=-i),i=-(_+i)/2;let m=i/y,T=W/i,v=Math.abs(m)<Math.abs(T)?m:T;if(v*v<=to){E=p-Math.atan2(Q=Math.sqrt(to-v*v)*x,v),A=Math.atan2(Q/P,(v-ti)/R);break t}}let T=te.PI,v=ti-Y,S=v*v,I=0,C=0,k=ti+Y,B=k*k,D=0;(W=-Y*ti/(i-m))>=-1&&W<=1&&((z=(J=Y*Math.cos(W=Math.acos(W))+ti)*J+(Q=G*Math.sin(W))*Q)<S&&(T=W,S=z,v=J,I=Q),z>B&&(C=W,B=z,k=J,D=Q)),to<=(S+B)/2?(E=p-Math.atan2(I*x,v),A=T*x):(E=p-Math.atan2(D*x,k),A=C*x)}let tl=Math.atan2(V,O)*L,th=i.arotation;(E=(E-tl)*te.radDeg+D-th)>180?E-=360:E<-180&&(E+=360),i.updateWorldTransformWith(S,I,th+E*v,C,i.ascaleY,0,0),th=m.arotation,(A=((A+tl)*te.radDeg-m.ashearX)*L+F-th)>180?A-=360:A<-180&&(A+=360),m.updateWorldTransformWith(O,V,th+A*v,m.ascaleX,m.ascaleY,m.ashearX,m.ashearY)}};let IkConstraintData=class IkConstraintData extends ConstraintData{constructor(i){super(i,0,!1),this.bones=[],this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}};let PathConstraintData=class PathConstraintData extends ConstraintData{constructor(i){super(i,0,!1),this.bones=[]}};var tj=((C=tj||{})[C.Length=0]="Length",C[C.Fixed=1]="Fixed",C[C.Percent=2]="Percent",C);let tq=class{constructor(i,m){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=[],this.positions=[],this.world=[],this.curves=[],this.lengths=[],this.segments=[],this.active=!1,null==i)throw Error("data cannot be null.");if(null==m)throw Error("skeleton cannot be null.");this.data=i,this.bones=[];for(let p=0,_=i.bones.length;p<_;p++)this.bones.push(m.findBone(i.bones[p].name));this.target=m.findSlot(i.target.name),this.position=i.position,this.spacing=i.spacing,this.rotateMix=i.rotateMix,this.translateMix=i.translateMix}isActive(){return this.active}apply(){this.update()}update(){let i=this.target.getAttachment();if(!(i instanceof PathAttachment))return;let m=this.rotateMix,p=this.translateMix,_=m>0;if(!(p>0)&&!_)return;let x=this.data,y=x.spacingMode,T=y==tj.Length,v=x.rotateMode,E=v==j.Tangent,A=v==j.ChainScale,S=this.bones.length,I=E?S:S+1,R=this.bones,C=tr.setArraySize(this.spaces,I),P=null,k=this.spacing;if(A||T){A&&(P=tr.setArraySize(this.lengths,S));for(let i=0,m=I-1;i<m;){let m=R[i],p=m.data.length;if(p<tq.epsilon)A&&(P[i]=0),C[++i]=0;else{let _=p*m.matrix.a,x=p*m.matrix.b,y=Math.sqrt(_*_+x*x);A&&(P[i]=y),C[++i]=(T?p+k:k)*y/p}}}else for(let i=1;i<I;i++)C[i]=k;let B=this.computeWorldPositions(i,I,E,x.positionMode==z.Percent,y==tj.Percent),D=B[0],F=B[1],L=x.offsetRotation,O=!1;if(0==L)O=v==j.Chain;else{O=!1;let i=this.target.bone.matrix;L*=i.a*i.d-i.b*i.c>0?te.degRad:-te.degRad}for(let i=0,x=3;i<S;i++,x+=3){let y=R[i],T=y.matrix;T.tx+=(D-T.tx)*p,T.ty+=(F-T.ty)*p;let v=B[x],S=B[x+1],I=v-D,k=S-F;if(A){let p=P[i];if(0!=p){let i=(Math.sqrt(I*I+k*k)/p-1)*m+1;T.a*=i,T.b*=i}}if(D=v,F=S,_){let p=T.a,_=T.c,v=T.b,A=T.d,S=0,R=0,P=0;if(E&&(S=E?B[x-1]:0==C[i+1]?B[x+2]:Math.atan2(k,I)),S-=Math.atan2(v,p),O){R=Math.cos(S),P=Math.sin(S);let i=y.data.length;D+=(i*(R*p-P*v)-I)*m,F+=(i*(P*p+R*v)-k)*m}else S+=L;S>te.PI?S-=te.PI2:S<-te.PI&&(S+=te.PI2),S*=m,R=Math.cos(S),P=Math.sin(S),T.a=R*p-P*v,T.c=R*_-P*A,T.b=P*p+R*v,T.d=P*_+R*A}y.appliedValid=!1}}computeWorldPositions(i,m,p,_,x){let y=this.target,T=this.position,v=this.spaces,E=tr.setArraySize(this.positions,3*m+2),A=null,S=i.closed,I=i.worldVerticesLength,R=I/6,C=tq.NONE;if(!i.constantSpeed){let P=i.lengths;R-=S?1:2;let k=P[R];if(_&&(T*=k),x)for(let i=0;i<m;i++)v[i]*=k;A=tr.setArraySize(this.world,8);for(let _=0,x=0,B=0;_<m;_++,x+=3){let m=v[_],D=T+=m;if(S)(D%=k)<0&&(D+=k),B=0;else if(D<0){C!=tq.BEFORE&&(C=tq.BEFORE,i.computeWorldVertices(y,2,4,A,0,2)),this.addBeforePosition(D,A,0,E,x);continue}else if(D>k){C!=tq.AFTER&&(C=tq.AFTER,i.computeWorldVertices(y,I-6,4,A,0,2)),this.addAfterPosition(D-k,A,0,E,x);continue}for(;;B++){let i=P[B];if(!(D>i)){if(0==B)D/=i;else{let m=P[B-1];D=(D-m)/(i-m)}break}}B!=C&&(C=B,S&&B==R?(i.computeWorldVertices(y,I-4,4,A,0,2),i.computeWorldVertices(y,0,4,A,4,2)):i.computeWorldVertices(y,6*B+2,8,A,0,2)),this.addCurvePosition(D,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],E,x,p||_>0&&0==m)}return E}S?(I+=2,A=tr.setArraySize(this.world,I),i.computeWorldVertices(y,2,I-4,A,0,2),i.computeWorldVertices(y,0,2,A,I-4,2),A[I-2]=A[0],A[I-1]=A[1]):(R--,I-=4,A=tr.setArraySize(this.world,I),i.computeWorldVertices(y,2,I,A,0,2));let P=tr.setArraySize(this.curves,R),k=0,B=A[0],D=A[1],F=0,L=0,O=0,V=0,U=0,X=0,Y=0,G=0,W=0,z=0,j=0,Z=0,K=0,J=0;for(let i=0,m=2;i<R;i++,m+=6)F=A[m],L=A[m+1],O=A[m+2],V=A[m+3],U=A[m+4],X=A[m+5],Y=(B-2*F+O)*.1875,G=(D-2*L+V)*.1875,W=((F-O)*3-B+U)*.09375,z=((L-V)*3-D+X)*.09375,j=2*Y+W,Z=2*G+z,k+=Math.sqrt((K=(F-B)*.75+Y+.16666667*W)*K+(J=(L-D)*.75+G+.16666667*z)*J),K+=j,J+=Z,j+=W,Z+=z,k+=Math.sqrt(K*K+J*J),K+=j,J+=Z,k+=Math.sqrt(K*K+J*J),K+=j+W,J+=Z+z,k+=Math.sqrt(K*K+J*J),P[i]=k,B=U,D=X;if(_&&(T*=k),x)for(let i=0;i<m;i++)v[i]*=k;let Q=this.segments,tt=0;for(let i=0,_=0,x=0,y=0;i<m;i++,_+=3){let m=v[i],R=T+=m;if(S)(R%=k)<0&&(R+=k),x=0;else if(R<0){this.addBeforePosition(R,A,0,E,_);continue}else if(R>k){this.addAfterPosition(R-k,A,I-4,E,_);continue}for(;;x++){let i=P[x];if(!(R>i)){if(0==x)R/=i;else{let m=P[x-1];R=(R-m)/(i-m)}break}}if(x!=C){C=x;let i=6*x;for(B=A[i],D=A[i+1],F=A[i+2],L=A[i+3],O=A[i+4],V=A[i+5],U=A[i+6],X=A[i+7],Y=(B-2*F+O)*.03,G=(D-2*L+V)*.03,W=((F-O)*3-B+U)*.006,z=((L-V)*3-D+X)*.006,j=2*Y+W,Z=2*G+z,tt=Math.sqrt((K=(F-B)*.3+Y+.16666667*W)*K+(J=(L-D)*.3+G+.16666667*z)*J),Q[0]=tt,i=1;i<8;i++)K+=j,J+=Z,j+=W,Z+=z,tt+=Math.sqrt(K*K+J*J),Q[i]=tt;K+=j,J+=Z,tt+=Math.sqrt(K*K+J*J),Q[8]=tt,K+=j+W,J+=Z+z,tt+=Math.sqrt(K*K+J*J),Q[9]=tt,y=0}for(R*=tt;;y++){let i=Q[y];if(!(R>i)){if(0==y)R/=i;else{let m=Q[y-1];R=y+(R-m)/(i-m)}break}}this.addCurvePosition(.1*R,B,D,F,L,O,V,U,X,E,_,p||i>0&&0==m)}return E}addBeforePosition(i,m,p,_,x){let y=m[p],T=m[p+1],v=m[p+2]-y,E=m[p+3]-T,A=Math.atan2(E,v);_[x]=y+i*Math.cos(A),_[x+1]=T+i*Math.sin(A),_[x+2]=A}addAfterPosition(i,m,p,_,x){let y=m[p+2],T=m[p+3],v=y-m[p],E=T-m[p+1],A=Math.atan2(E,v);_[x]=y+i*Math.cos(A),_[x+1]=T+i*Math.sin(A),_[x+2]=A}addCurvePosition(i,m,p,_,x,y,T,v,E,A,S,I){(0==i||isNaN(i))&&(i=1e-4);let R=i*i,C=R*i,P=1-i,k=P*P,B=k*P,D=P*i,F=3*D,L=P*F,O=F*i,V=m*B+_*L+y*O+v*C,U=p*B+x*L+T*O+E*C;A[S]=V,A[S+1]=U,I&&(A[S+2]=Math.atan2(U-(p*k+x*D*2+T*R),V-(m*k+_*D*2+y*R)))}},tZ=tq;tZ.NONE=-1,tZ.BEFORE=-2,tZ.AFTER=-3,tZ.epsilon=1e-5;let TransformConstraint=class TransformConstraint{constructor(i,m){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new Vector2,this.active=!1,null==i)throw Error("data cannot be null.");if(null==m)throw Error("skeleton cannot be null.");this.data=i,this.rotateMix=i.rotateMix,this.translateMix=i.translateMix,this.scaleMix=i.scaleMix,this.shearMix=i.shearMix,this.bones=[];for(let p=0;p<i.bones.length;p++)this.bones.push(m.findBone(i.bones[p].name));this.target=m.findBone(i.target.name)}isActive(){return this.active}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){let i=this.rotateMix,m=this.translateMix,p=this.scaleMix,_=this.shearMix,x=this.target,y=x.matrix,T=y.a,v=y.c,E=y.b,A=y.d,S=T*A-v*E>0?te.degRad:-te.degRad,I=this.data.offsetRotation*S,R=this.data.offsetShearY*S,C=this.bones;for(let y=0,S=C.length;y<S;y++){let S=C[y],P=!1,k=S.matrix;if(0!=i){let m=k.a,p=k.c,_=k.b,x=k.d,y=Math.atan2(E,T)-Math.atan2(_,m)+I;y>te.PI?y-=te.PI2:y<-te.PI&&(y+=te.PI2),y*=i;let v=Math.cos(y),A=Math.sin(y);k.a=v*m-A*_,k.c=v*p-A*x,k.b=A*m+v*_,k.d=A*p+v*x,P=!0}if(0!=m){let i=this.temp;x.localToWorld(i.set(this.data.offsetX,this.data.offsetY)),k.tx+=(i.x-k.tx)*m,k.ty+=(i.y-k.ty)*m,P=!0}if(p>0){let i=Math.sqrt(k.a*k.a+k.b*k.b),m=Math.sqrt(T*T+E*E);i>1e-5&&(i=(i+(m-i+this.data.offsetScaleX)*p)/i),k.a*=i,k.b*=i,i=Math.sqrt(k.c*k.c+k.d*k.d),m=Math.sqrt(v*v+A*A),i>1e-5&&(i=(i+(m-i+this.data.offsetScaleY)*p)/i),k.c*=i,k.d*=i,P=!0}if(_>0){let i=k.c,m=k.d,p=Math.atan2(m,i),x=Math.atan2(A,v)-Math.atan2(E,T)-(p-Math.atan2(k.b,k.a));x>te.PI?x-=te.PI2:x<-te.PI&&(x+=te.PI2),x=p+(x+R)*_;let y=Math.sqrt(i*i+m*m);k.c=Math.cos(x)*y,k.d=Math.sin(x)*y,P=!0}P&&(S.appliedValid=!1)}}applyRelativeWorld(){let i=this.rotateMix,m=this.translateMix,p=this.scaleMix,_=this.shearMix,x=this.target,y=x.matrix,T=y.a,v=y.c,E=y.b,A=y.d,S=T*A-v*E>0?te.degRad:-te.degRad,I=this.data.offsetRotation*S,R=this.data.offsetShearY*S,C=this.bones;for(let y=0,S=C.length;y<S;y++){let S=C[y],P=!1,k=S.matrix;if(0!=i){let m=k.a,p=k.c,_=k.b,x=k.d,y=Math.atan2(E,T)+I;y>te.PI?y-=te.PI2:y<-te.PI&&(y+=te.PI2),y*=i;let v=Math.cos(y),A=Math.sin(y);k.a=v*m-A*_,k.c=v*p-A*x,k.b=A*m+v*_,k.d=A*p+v*x,P=!0}if(0!=m){let i=this.temp;x.localToWorld(i.set(this.data.offsetX,this.data.offsetY)),k.tx+=i.x*m,k.ty+=i.y*m,P=!0}if(p>0){let i=(Math.sqrt(T*T+E*E)-1+this.data.offsetScaleX)*p+1;k.a*=i,k.b*=i,i=(Math.sqrt(v*v+A*A)-1+this.data.offsetScaleY)*p+1,k.c*=i,k.d*=i,P=!0}if(_>0){let i=Math.atan2(A,v)-Math.atan2(E,T);i>te.PI?i-=te.PI2:i<-te.PI&&(i+=te.PI2);let m=k.c,p=k.d;i=Math.atan2(p,m)+(i-te.PI/2+R)*_;let x=Math.sqrt(m*m+p*p);k.c=Math.cos(i)*x,k.d=Math.sin(i)*x,P=!0}P&&(S.appliedValid=!1)}}applyAbsoluteLocal(){let i=this.rotateMix,m=this.translateMix,p=this.scaleMix,_=this.shearMix,x=this.target;x.appliedValid||x.updateAppliedTransform();let y=this.bones;for(let T=0,v=y.length;T<v;T++){let v=y[T];v.appliedValid||v.updateAppliedTransform();let E=v.arotation;if(0!=i){let m=x.arotation-E+this.data.offsetRotation;m-=(16384-(16384.499999999996-m/360|0))*360,E+=m*i}let A=v.ax,S=v.ay;0!=m&&(A+=(x.ax-A+this.data.offsetX)*m,S+=(x.ay-S+this.data.offsetY)*m);let I=v.ascaleX,R=v.ascaleY;p>0&&(I>1e-5&&(I=(I+(x.ascaleX-I+this.data.offsetScaleX)*p)/I),R>1e-5&&(R=(R+(x.ascaleY-R+this.data.offsetScaleY)*p)/R));let C=v.ashearY;if(_>0){let i=x.ashearY-C+this.data.offsetShearY;i-=(16384-(16384.499999999996-i/360|0))*360,v.shearY+=i*_}v.updateWorldTransformWith(A,S,E,I,R,v.ashearX,C)}}applyRelativeLocal(){let i=this.rotateMix,m=this.translateMix,p=this.scaleMix,_=this.shearMix,x=this.target;x.appliedValid||x.updateAppliedTransform();let y=this.bones;for(let T=0,v=y.length;T<v;T++){let v=y[T];v.appliedValid||v.updateAppliedTransform();let E=v.arotation;0!=i&&(E+=(x.arotation+this.data.offsetRotation)*i);let A=v.ax,S=v.ay;0!=m&&(A+=(x.ax+this.data.offsetX)*m,S+=(x.ay+this.data.offsetY)*m);let I=v.ascaleX,R=v.ascaleY;p>0&&(I>1e-5&&(I*=(x.ascaleX-1+this.data.offsetScaleX)*p+1),R>1e-5&&(R*=(x.ascaleY-1+this.data.offsetScaleY)*p+1));let C=v.ashearY;_>0&&(C+=(x.ashearY+this.data.offsetShearY)*_),v.updateWorldTransformWith(A,S,E,I,R,v.ashearX,C)}}};let tK=class{constructor(i){if(this._updateCache=[],this.updateCacheReset=[],this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==i)throw Error("data cannot be null.");this.data=i,this.bones=[];for(let m=0;m<i.bones.length;m++){let p;let _=i.bones[m];if(null==_.parent)p=new Bone(_,this,null);else{let i=this.bones[_.parent.index];p=new Bone(_,this,i),i.children.push(p)}this.bones.push(p)}this.slots=[],this.drawOrder=[];for(let m=0;m<i.slots.length;m++){let p=i.slots[m],_=this.bones[p.boneData.index],x=new Slot(p,_);this.slots.push(x),this.drawOrder.push(x)}this.ikConstraints=[];for(let m=0;m<i.ikConstraints.length;m++){let p=i.ikConstraints[m];this.ikConstraints.push(new IkConstraint(p,this))}this.transformConstraints=[];for(let m=0;m<i.transformConstraints.length;m++){let p=i.transformConstraints[m];this.transformConstraints.push(new TransformConstraint(p,this))}this.pathConstraints=[];for(let m=0;m<i.pathConstraints.length;m++){let p=i.pathConstraints[m];this.pathConstraints.push(new tZ(p,this))}this.color=new tt(1,1,1,1),this.updateCache()}updateCache(){let i=this._updateCache;i.length=0,this.updateCacheReset.length=0;let m=this.bones;for(let i=0,p=m.length;i<p;i++){let p=m[i];p.sorted=p.data.skinRequired,p.active=!p.sorted}if(null!=this.skin){let i=this.skin.bones;for(let m=0,p=this.skin.bones.length;m<p;m++){let p=this.bones[i[m].index];do p.sorted=!1,p.active=!0,p=p.parent;while(null!=p)}}let p=this.ikConstraints,_=this.transformConstraints,x=this.pathConstraints,y=p.length,T=_.length,v=x.length,E=y+T+v;t:for(let i=0;i<E;i++){for(let m=0;m<y;m++){let _=p[m];if(_.data.order==i){this.sortIkConstraint(_);continue t}}for(let m=0;m<T;m++){let p=_[m];if(p.data.order==i){this.sortTransformConstraint(p);continue t}}for(let m=0;m<v;m++){let p=x[m];if(p.data.order==i){this.sortPathConstraint(p);continue t}}}for(let i=0,p=m.length;i<p;i++)this.sortBone(m[i])}sortIkConstraint(i){if(i.active=i.target.isActive()&&(!i.data.skinRequired||null!=this.skin&&tr.contains(this.skin.constraints,i.data,!0)),!i.active)return;let m=i.target;this.sortBone(m);let p=i.bones,_=p[0];if(this.sortBone(_),p.length>1){let i=p[p.length-1];this._updateCache.indexOf(i)>-1||this.updateCacheReset.push(i)}this._updateCache.push(i),this.sortReset(_.children),p[p.length-1].sorted=!0}sortPathConstraint(i){if(i.active=i.target.bone.isActive()&&(!i.data.skinRequired||null!=this.skin&&tr.contains(this.skin.constraints,i.data,!0)),!i.active)return;let m=i.target,p=m.data.index,_=m.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,p,_),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,p,_);for(let i=0,m=this.data.skins.length;i<m;i++)this.sortPathConstraintAttachment(this.data.skins[i],p,_);let x=m.getAttachment();x instanceof PathAttachment&&this.sortPathConstraintAttachmentWith(x,_);let y=i.bones,T=y.length;for(let i=0;i<T;i++)this.sortBone(y[i]);this._updateCache.push(i);for(let i=0;i<T;i++)this.sortReset(y[i].children);for(let i=0;i<T;i++)y[i].sorted=!0}sortTransformConstraint(i){if(i.active=i.target.isActive()&&(!i.data.skinRequired||null!=this.skin&&tr.contains(this.skin.constraints,i.data,!0)),!i.active)return;this.sortBone(i.target);let m=i.bones,p=m.length;if(i.data.local)for(let i=0;i<p;i++){let p=m[i];this.sortBone(p.parent),this._updateCache.indexOf(p)>-1||this.updateCacheReset.push(p)}else for(let i=0;i<p;i++)this.sortBone(m[i]);this._updateCache.push(i);for(let i=0;i<p;i++)this.sortReset(m[i].children);for(let i=0;i<p;i++)m[i].sorted=!0}sortPathConstraintAttachment(i,m,p){let _=i.attachments[m];if(_)for(let i in _)this.sortPathConstraintAttachmentWith(_[i],p)}sortPathConstraintAttachmentWith(i,m){if(!(i instanceof PathAttachment))return;let p=i.bones;if(null==p)this.sortBone(m);else{let i=this.bones,m=0;for(;m<p.length;){let _=p[m++];for(let x=m+_;m<x;m++){let _=p[m];this.sortBone(i[_])}}}}sortBone(i){if(i.sorted)return;let m=i.parent;null!=m&&this.sortBone(m),i.sorted=!0,this._updateCache.push(i)}sortReset(i){for(let m=0,p=i.length;m<p;m++){let p=i[m];p.active&&(p.sorted&&this.sortReset(p.children),p.sorted=!1)}}updateWorldTransform(){let i=this.updateCacheReset;for(let m=0,p=i.length;m<p;m++){let p=i[m];p.ax=p.x,p.ay=p.y,p.arotation=p.rotation,p.ascaleX=p.scaleX,p.ascaleY=p.scaleY,p.ashearX=p.shearX,p.ashearY=p.shearY,p.appliedValid=!0}let m=this._updateCache;for(let i=0,p=m.length;i<p;i++)m[i].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){let i=this.bones;for(let m=0,p=i.length;m<p;m++)i[m].setToSetupPose();let m=this.ikConstraints;for(let i=0,p=m.length;i<p;i++){let p=m[i];p.mix=p.data.mix,p.softness=p.data.softness,p.bendDirection=p.data.bendDirection,p.compress=p.data.compress,p.stretch=p.data.stretch}let p=this.transformConstraints;for(let i=0,m=p.length;i<m;i++){let m=p[i],_=m.data;m.rotateMix=_.rotateMix,m.translateMix=_.translateMix,m.scaleMix=_.scaleMix,m.shearMix=_.shearMix}let _=this.pathConstraints;for(let i=0,m=_.length;i<m;i++){let m=_[i],p=m.data;m.position=p.position,m.spacing=p.spacing,m.rotateMix=p.rotateMix,m.translateMix=p.translateMix}}setSlotsToSetupPose(){let i=this.slots;tr.arrayCopy(i,0,this.drawOrder,0,i.length);for(let m=0,p=i.length;m<p;m++)i[m].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(i){if(null==i)throw Error("boneName cannot be null.");let m=this.bones;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}findBoneIndex(i){if(null==i)throw Error("boneName cannot be null.");let m=this.bones;for(let p=0,_=m.length;p<_;p++)if(m[p].data.name==i)return p;return -1}findSlot(i){if(null==i)throw Error("slotName cannot be null.");let m=this.slots;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}findSlotIndex(i){if(null==i)throw Error("slotName cannot be null.");let m=this.slots;for(let p=0,_=m.length;p<_;p++)if(m[p].data.name==i)return p;return -1}setSkinByName(i){let m=this.data.findSkin(i);if(null==m)throw Error(`Skin not found: ${i}`);this.setSkin(m)}setSkin(i){if(i!=this.skin){if(null!=i){if(null!=this.skin)i.attachAll(this,this.skin);else{let m=this.slots;for(let p=0,_=m.length;p<_;p++){let _=m[p],x=_.data.attachmentName;if(null!=x){let m=i.getAttachment(p,x);null!=m&&_.setAttachment(m)}}}}this.skin=i,this.updateCache()}}getAttachmentByName(i,m){return this.getAttachment(this.data.findSlotIndex(i),m)}getAttachment(i,m){if(null==m)throw Error("attachmentName cannot be null.");if(null!=this.skin){let p=this.skin.getAttachment(i,m);if(null!=p)return p}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(i,m):null}setAttachment(i,m){if(null==i)throw Error("slotName cannot be null.");let p=this.slots;for(let _=0,x=p.length;_<x;_++){let x=p[_];if(x.data.name==i){let p=null;if(null!=m&&null==(p=this.getAttachment(_,m)))throw Error(`Attachment not found: ${m}, for slot: ${i}`);x.setAttachment(p);return}}throw Error(`Slot not found: ${i}`)}findIkConstraint(i){if(null==i)throw Error("constraintName cannot be null.");let m=this.ikConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}findTransformConstraint(i){if(null==i)throw Error("constraintName cannot be null.");let m=this.transformConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}findPathConstraint(i){if(null==i)throw Error("constraintName cannot be null.");let m=this.pathConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}getBounds(i,m,p=[,,]){if(null==i)throw Error("offset cannot be null.");if(null==m)throw Error("size cannot be null.");let _=this.drawOrder,x=Number.POSITIVE_INFINITY,y=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY,v=Number.NEGATIVE_INFINITY;for(let i=0,m=_.length;i<m;i++){let m=_[i];if(!m.bone.active)continue;let E=0,A=null,S=m.getAttachment();if(S instanceof tg?(E=8,A=tr.setArraySize(p,E,0),S.computeWorldVertices(m.bone,A,0,2)):S instanceof MeshAttachment&&(E=S.worldVerticesLength,A=tr.setArraySize(p,E,0),S.computeWorldVertices(m,0,E,A,0,2)),null!=A)for(let i=0,m=A.length;i<m;i+=2){let m=A[i],p=A[i+1];x=Math.min(x,m),y=Math.min(y,p),T=Math.max(T,m),v=Math.max(v,p)}}i.set(x,y),m.set(T-x,v-y)}update(i){this.time+=i}get flipX(){return -1==this.scaleX}set flipX(i){tK.deprecatedWarning1||(tK.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=i?1:-1}get flipY(){return -1==this.scaleY}set flipY(i){tK.deprecatedWarning1||(tK.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=i?1:-1}},tJ=tK;tJ.deprecatedWarning1=!1;let SkeletonData=class SkeletonData{constructor(){this.bones=[],this.slots=[],this.skins=[],this.events=[],this.animations=[],this.ikConstraints=[],this.transformConstraints=[],this.pathConstraints=[],this.fps=0}findBone(i){if(null==i)throw Error("boneName cannot be null.");let m=this.bones;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findBoneIndex(i){if(null==i)throw Error("boneName cannot be null.");let m=this.bones;for(let p=0,_=m.length;p<_;p++)if(m[p].name==i)return p;return -1}findSlot(i){if(null==i)throw Error("slotName cannot be null.");let m=this.slots;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findSlotIndex(i){if(null==i)throw Error("slotName cannot be null.");let m=this.slots;for(let p=0,_=m.length;p<_;p++)if(m[p].name==i)return p;return -1}findSkin(i){if(null==i)throw Error("skinName cannot be null.");let m=this.skins;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findEvent(i){if(null==i)throw Error("eventDataName cannot be null.");let m=this.events;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findAnimation(i){if(null==i)throw Error("animationName cannot be null.");let m=this.animations;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findIkConstraint(i){if(null==i)throw Error("constraintName cannot be null.");let m=this.ikConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findTransformConstraint(i){if(null==i)throw Error("constraintName cannot be null.");let m=this.transformConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findPathConstraint(i){if(null==i)throw Error("constraintName cannot be null.");let m=this.pathConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findPathConstraintIndex(i){if(null==i)throw Error("pathConstraintName cannot be null.");let m=this.pathConstraints;for(let p=0,_=m.length;p<_;p++)if(m[p].name==i)return p;return -1}};let SlotData=class SlotData{constructor(i,m,p){if(this.color=new tt(1,1,1,1),i<0)throw Error("index must be >= 0.");if(null==m)throw Error("name cannot be null.");if(null==p)throw Error("boneData cannot be null.");this.index=i,this.name=m,this.boneData=p}};let TransformConstraintData=class TransformConstraintData extends ConstraintData{constructor(i){super(i,0,!1),this.bones=[],this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}};let SkinEntry=class SkinEntry{constructor(i,m,p){this.slotIndex=i,this.name=m,this.attachment=p}};let Skin=class Skin{constructor(i){if(this.attachments=[],this.bones=[],this.constraints=[],null==i)throw Error("name cannot be null.");this.name=i}setAttachment(i,m,p){if(null==p)throw Error("attachment cannot be null.");let _=this.attachments;i>=_.length&&(_.length=i+1),_[i]||(_[i]={}),_[i][m]=p}addSkin(i){for(let m=0;m<i.bones.length;m++){let p=i.bones[m],_=!1;for(let i=0;i<this.bones.length;i++)if(this.bones[i]==p){_=!0;break}_||this.bones.push(p)}for(let m=0;m<i.constraints.length;m++){let p=i.constraints[m],_=!1;for(let i=0;i<this.constraints.length;i++)if(this.constraints[i]==p){_=!0;break}_||this.constraints.push(p)}let m=i.getAttachments();for(let i=0;i<m.length;i++){let p=m[i];this.setAttachment(p.slotIndex,p.name,p.attachment)}}copySkin(i){for(let m=0;m<i.bones.length;m++){let p=i.bones[m],_=!1;for(let i=0;i<this.bones.length;i++)if(this.bones[i]==p){_=!0;break}_||this.bones.push(p)}for(let m=0;m<i.constraints.length;m++){let p=i.constraints[m],_=!1;for(let i=0;i<this.constraints.length;i++)if(this.constraints[i]==p){_=!0;break}_||this.constraints.push(p)}let m=i.getAttachments();for(let i=0;i<m.length;i++){let p=m[i];null!=p.attachment&&(p.attachment instanceof MeshAttachment?p.attachment=p.attachment.newLinkedMesh():p.attachment=p.attachment.copy(),this.setAttachment(p.slotIndex,p.name,p.attachment))}}getAttachment(i,m){let p=this.attachments[i];return p?p[m]:null}removeAttachment(i,m){let p=this.attachments[i];p&&(p[m]=null)}getAttachments(){let i=[];for(let m=0;m<this.attachments.length;m++){let p=this.attachments[m];if(p)for(let _ in p){let x=p[_];x&&i.push(new SkinEntry(m,_,x))}}return i}getAttachmentsForSlot(i,m){let p=this.attachments[i];if(p)for(let _ in p){let x=p[_];x&&m.push(new SkinEntry(i,_,x))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(i,m){let p=0;for(let _=0;_<i.slots.length;_++){let x=i.slots[_],y=x.getAttachment();if(y&&p<m.attachments.length){let i=m.attachments[p];for(let m in i){let _=i[m];if(y==_){let i=this.getAttachment(p,m);null!=i&&x.setAttachment(i);break}}}p++}}};let tQ=class{constructor(i){this.scale=1,this.linkedMeshes=[],this.attachmentLoader=i}readSkeletonData(i){let m=this.scale,p=new SkeletonData;p.name="";let _=new BinaryInput(i);p.hash=_.readString(),p.version=_.readString(),"3.8.75"===p.version&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),p.x=_.readFloat(),p.y=_.readFloat(),p.width=_.readFloat(),p.height=_.readFloat();let x=_.readBoolean();x&&(p.fps=_.readFloat(),p.imagesPath=_.readString(),p.audioPath=_.readString());let y=0;y=_.readInt(!0);for(let i=0;i<y;i++)_.strings.push(_.readString());y=_.readInt(!0);for(let i=0;i<y;i++){let y=_.readString(),T=0==i?null:p.bones[_.readInt(!0)],v=new BoneData(i,y,T);v.rotation=_.readFloat(),v.x=_.readFloat()*m,v.y=_.readFloat()*m,v.scaleX=_.readFloat(),v.scaleY=_.readFloat(),v.shearX=_.readFloat(),v.shearY=_.readFloat(),v.length=_.readFloat()*m,v.transformMode=tQ.TransformModeValues[_.readInt(!0)],v.skinRequired=_.readBoolean(),x&&tt.rgba8888ToColor(v.color,_.readInt32()),p.bones.push(v)}y=_.readInt(!0);for(let i=0;i<y;i++){let m=_.readString(),x=p.bones[_.readInt(!0)],y=new SlotData(i,m,x);tt.rgba8888ToColor(y.color,_.readInt32());let T=_.readInt32();-1!=T&&tt.rgb888ToColor(y.darkColor=new tt,T),y.attachmentName=_.readStringRef(),y.blendMode=tQ.BlendModeValues[_.readInt(!0)],p.slots.push(y)}y=_.readInt(!0);for(let i=0,x;i<y;i++){let i=new IkConstraintData(_.readString());i.order=_.readInt(!0),i.skinRequired=_.readBoolean(),x=_.readInt(!0);for(let m=0;m<x;m++)i.bones.push(p.bones[_.readInt(!0)]);i.target=p.bones[_.readInt(!0)],i.mix=_.readFloat(),i.softness=_.readFloat()*m,i.bendDirection=_.readByte(),i.compress=_.readBoolean(),i.stretch=_.readBoolean(),i.uniform=_.readBoolean(),p.ikConstraints.push(i)}y=_.readInt(!0);for(let i=0,x;i<y;i++){let i=new TransformConstraintData(_.readString());i.order=_.readInt(!0),i.skinRequired=_.readBoolean(),x=_.readInt(!0);for(let m=0;m<x;m++)i.bones.push(p.bones[_.readInt(!0)]);i.target=p.bones[_.readInt(!0)],i.local=_.readBoolean(),i.relative=_.readBoolean(),i.offsetRotation=_.readFloat(),i.offsetX=_.readFloat()*m,i.offsetY=_.readFloat()*m,i.offsetScaleX=_.readFloat(),i.offsetScaleY=_.readFloat(),i.offsetShearY=_.readFloat(),i.rotateMix=_.readFloat(),i.translateMix=_.readFloat(),i.scaleMix=_.readFloat(),i.shearMix=_.readFloat(),p.transformConstraints.push(i)}y=_.readInt(!0);for(let i=0,x;i<y;i++){let i=new PathConstraintData(_.readString());i.order=_.readInt(!0),i.skinRequired=_.readBoolean(),x=_.readInt(!0);for(let m=0;m<x;m++)i.bones.push(p.bones[_.readInt(!0)]);i.target=p.slots[_.readInt(!0)],i.positionMode=tQ.PositionModeValues[_.readInt(!0)],i.spacingMode=tQ.SpacingModeValues[_.readInt(!0)],i.rotateMode=tQ.RotateModeValues[_.readInt(!0)],i.offsetRotation=_.readFloat(),i.position=_.readFloat(),i.positionMode==z.Fixed&&(i.position*=m),i.spacing=_.readFloat(),(i.spacingMode==tj.Length||i.spacingMode==tj.Fixed)&&(i.spacing*=m),i.rotateMix=_.readFloat(),i.translateMix=_.readFloat(),p.pathConstraints.push(i)}let T=this.readSkin(_,p,!0,x);null!=T&&(p.defaultSkin=T,p.skins.push(T));{let i=p.skins.length;for(tr.setArraySize(p.skins,y=i+_.readInt(!0));i<y;i++)p.skins[i]=this.readSkin(_,p,!1,x)}y=this.linkedMeshes.length;for(let i=0;i<y;i++){let m=this.linkedMeshes[i],_=null==m.skin?p.defaultSkin:p.findSkin(m.skin);if(null==_)throw Error(`Skin not found: ${m.skin}`);let x=_.getAttachment(m.slotIndex,m.parent);if(null==x)throw Error(`Parent mesh not found: ${m.parent}`);m.mesh.deformAttachment=m.inheritDeform?x:m.mesh,m.mesh.setParentMesh(x)}this.linkedMeshes.length=0,y=_.readInt(!0);for(let i=0;i<y;i++){let i=new EventData(_.readStringRef());i.intValue=_.readInt(!1),i.floatValue=_.readFloat(),i.stringValue=_.readString(),i.audioPath=_.readString(),null!=i.audioPath&&(i.volume=_.readFloat(),i.balance=_.readFloat()),p.events.push(i)}y=_.readInt(!0);for(let i=0;i<y;i++)p.animations.push(this.readAnimation(_,_.readString(),p));return p}readSkin(i,m,p,_){let x=null,y=0;if(p){if(0==(y=i.readInt(!0)))return null;x=new Skin("default")}else{(x=new Skin(i.readStringRef())).bones.length=i.readInt(!0);for(let p=0,_=x.bones.length;p<_;p++)x.bones[p]=m.bones[i.readInt(!0)];for(let p=0,_=i.readInt(!0);p<_;p++)x.constraints.push(m.ikConstraints[i.readInt(!0)]);for(let p=0,_=i.readInt(!0);p<_;p++)x.constraints.push(m.transformConstraints[i.readInt(!0)]);for(let p=0,_=i.readInt(!0);p<_;p++)x.constraints.push(m.pathConstraints[i.readInt(!0)]);y=i.readInt(!0)}for(let p=0;p<y;p++){let p=i.readInt(!0);for(let y=0,T=i.readInt(!0);y<T;y++){let y=i.readStringRef(),T=this.readAttachment(i,m,x,p,y,_);null!=T&&x.setAttachment(p,y,T)}}return x}readAttachment(i,m,p,_,x,y){let T=this.scale,v=i.readStringRef();null==v&&(v=x);let E=i.readByte(),A=tQ.AttachmentTypeValues[E];switch(A){case Y.Region:{let m=i.readStringRef(),_=i.readFloat(),x=i.readFloat(),y=i.readFloat(),E=i.readFloat(),A=i.readFloat(),S=i.readFloat(),I=i.readFloat(),R=i.readInt32();null==m&&(m=v);let C=this.attachmentLoader.newRegionAttachment(p,v,m);if(null==C)return null;return C.path=m,C.x=x*T,C.y=y*T,C.scaleX=E,C.scaleY=A,C.rotation=_,C.width=S*T,C.height=I*T,tt.rgba8888ToColor(C.color,R),C}case Y.BoundingBox:{let m=i.readInt(!0),_=this.readVertices(i,m),x=y?i.readInt32():0,T=this.attachmentLoader.newBoundingBoxAttachment(p,v);if(null==T)return null;return T.worldVerticesLength=m<<1,T.vertices=_.vertices,T.bones=_.bones,y&&tt.rgba8888ToColor(T.color,x),T}case Y.Mesh:{let m=i.readStringRef(),_=i.readInt32(),x=i.readInt(!0),E=this.readFloatArray(i,x<<1,1),A=this.readShortArray(i),S=this.readVertices(i,x),I=i.readInt(!0),R=null,C=0,P=0;y&&(R=this.readShortArray(i),C=i.readFloat(),P=i.readFloat()),null==m&&(m=v);let k=this.attachmentLoader.newMeshAttachment(p,v,m);if(null==k)return null;return k.path=m,tt.rgba8888ToColor(k.color,_),k.bones=S.bones,k.vertices=S.vertices,k.worldVerticesLength=x<<1,k.triangles=A,k.regionUVs=new Float32Array(E),k.hullLength=I<<1,y&&(k.edges=R,k.width=C*T,k.height=P*T),k}case Y.LinkedMesh:{let m=i.readStringRef(),x=i.readInt32(),E=i.readStringRef(),A=i.readStringRef(),S=i.readBoolean(),I=0,R=0;y&&(I=i.readFloat(),R=i.readFloat()),null==m&&(m=v);let C=this.attachmentLoader.newMeshAttachment(p,v,m);if(null==C)return null;return C.path=m,tt.rgba8888ToColor(C.color,x),y&&(C.width=I*T,C.height=R*T),this.linkedMeshes.push(new LinkedMesh(C,E,_,A,S)),C}case Y.Path:{let m=i.readBoolean(),_=i.readBoolean(),x=i.readInt(!0),E=this.readVertices(i,x),A=tr.newArray(x/3,0);for(let m=0,p=A.length;m<p;m++)A[m]=i.readFloat()*T;let S=y?i.readInt32():0,I=this.attachmentLoader.newPathAttachment(p,v);if(null==I)return null;return I.closed=m,I.constantSpeed=_,I.worldVerticesLength=x<<1,I.vertices=E.vertices,I.bones=E.bones,I.lengths=A,y&&tt.rgba8888ToColor(I.color,S),I}case Y.Point:{let m=i.readFloat(),_=i.readFloat(),x=i.readFloat(),E=y?i.readInt32():0,A=this.attachmentLoader.newPointAttachment(p,v);if(null==A)return null;return A.x=_*T,A.y=x*T,A.rotation=m,y&&tt.rgba8888ToColor(A.color,E),A}case Y.Clipping:{let _=i.readInt(!0),x=i.readInt(!0),T=this.readVertices(i,x),E=y?i.readInt32():0,A=this.attachmentLoader.newClippingAttachment(p,v);if(null==A)return null;return A.endSlot=m.slots[_],A.worldVerticesLength=x<<1,A.vertices=T.vertices,A.bones=T.bones,y&&tt.rgba8888ToColor(A.color,E),A}}return null}readVertices(i,m){let p=new Vertices,_=this.scale;if(!i.readBoolean())return p.vertices=this.readFloatArray(i,m<<1,_),p;let x=[],y=[];for(let p=0;p<m;p++){let m=i.readInt(!0);y.push(m);for(let p=0;p<m;p++)y.push(i.readInt(!0)),x.push(i.readFloat()*_),x.push(i.readFloat()*_),x.push(i.readFloat())}return p.vertices=tr.toFloatArray(x),p.bones=y,p}readFloatArray(i,m,p){let _=Array(m);if(1==p)for(let p=0;p<m;p++)_[p]=i.readFloat();else for(let x=0;x<m;x++)_[x]=i.readFloat()*p;return _}readShortArray(i){let m=i.readInt(!0),p=Array(m);for(let _=0;_<m;_++)p[_]=i.readShort();return p}readAnimation(i,m,p){let _=[],x=this.scale,y=0,T=new tt,v=new tt;for(let m=0,p=i.readInt(!0);m<p;m++){let m=i.readInt(!0);for(let p=0,x=i.readInt(!0);p<x;p++){let p=i.readByte(),x=i.readInt(!0);switch(p){case tQ.SLOT_ATTACHMENT:{let p=new AttachmentTimeline(x);p.slotIndex=m;for(let m=0;m<x;m++)p.setFrame(m,i.readFloat(),i.readStringRef());_.push(p),y=Math.max(y,p.frames[x-1]);break}case tQ.SLOT_COLOR:{let p=new tI(x);p.slotIndex=m;for(let m=0;m<x;m++){let _=i.readFloat();tt.rgba8888ToColor(T,i.readInt32()),p.setFrame(m,_,T.r,T.g,T.b,T.a),m<x-1&&this.readCurve(i,m,p)}_.push(p),y=Math.max(y,p.frames[(x-1)*tI.ENTRIES]);break}case tQ.SLOT_TWO_COLOR:{let p=new tM(x);p.slotIndex=m;for(let m=0;m<x;m++){let _=i.readFloat();tt.rgba8888ToColor(T,i.readInt32()),tt.rgb888ToColor(v,i.readInt32()),p.setFrame(m,_,T.r,T.g,T.b,T.a,v.r,v.g,v.b),m<x-1&&this.readCurve(i,m,p)}_.push(p),y=Math.max(y,p.frames[(x-1)*tM.ENTRIES])}}}}for(let m=0,p=i.readInt(!0);m<p;m++){let m=i.readInt(!0);for(let p=0,T=i.readInt(!0);p<T;p++){let p=i.readByte(),T=i.readInt(!0);switch(p){case tQ.BONE_ROTATE:{let p=new tE(T);p.boneIndex=m;for(let m=0;m<T;m++)p.setFrame(m,i.readFloat(),i.readFloat()),m<T-1&&this.readCurve(i,m,p);_.push(p),y=Math.max(y,p.frames[(T-1)*tE.ENTRIES]);break}case tQ.BONE_TRANSLATE:case tQ.BONE_SCALE:case tQ.BONE_SHEAR:{let v;let E=1;p==tQ.BONE_SCALE?v=new ScaleTimeline(T):p==tQ.BONE_SHEAR?v=new ShearTimeline(T):(v=new tS(T),E=x),v.boneIndex=m;for(let m=0;m<T;m++)v.setFrame(m,i.readFloat(),i.readFloat()*E,i.readFloat()*E),m<T-1&&this.readCurve(i,m,v);_.push(v),y=Math.max(y,v.frames[(T-1)*tS.ENTRIES])}}}}for(let m=0,p=i.readInt(!0);m<p;m++){let m=i.readInt(!0),p=i.readInt(!0),T=new tk(p);T.ikConstraintIndex=m;for(let m=0;m<p;m++)T.setFrame(m,i.readFloat(),i.readFloat(),i.readFloat()*x,i.readByte(),i.readBoolean(),i.readBoolean()),m<p-1&&this.readCurve(i,m,T);_.push(T),y=Math.max(y,T.frames[(p-1)*tk.ENTRIES])}for(let m=0,p=i.readInt(!0);m<p;m++){let m=i.readInt(!0),p=i.readInt(!0),x=new tD(p);x.transformConstraintIndex=m;for(let m=0;m<p;m++)x.setFrame(m,i.readFloat(),i.readFloat(),i.readFloat(),i.readFloat(),i.readFloat()),m<p-1&&this.readCurve(i,m,x);_.push(x),y=Math.max(y,x.frames[(p-1)*tD.ENTRIES])}for(let m=0,T=i.readInt(!0);m<T;m++){let m=i.readInt(!0),T=p.pathConstraints[m];for(let p=0,v=i.readInt(!0);p<v;p++){let p=i.readByte(),v=i.readInt(!0);switch(p){case tQ.PATH_POSITION:case tQ.PATH_SPACING:{let E;let A=1;p==tQ.PATH_SPACING?(E=new PathConstraintSpacingTimeline(v),(T.spacingMode==tj.Length||T.spacingMode==tj.Fixed)&&(A=x)):(E=new tN(v),T.positionMode==z.Fixed&&(A=x)),E.pathConstraintIndex=m;for(let m=0;m<v;m++)E.setFrame(m,i.readFloat(),i.readFloat()*A),m<v-1&&this.readCurve(i,m,E);_.push(E),y=Math.max(y,E.frames[(v-1)*tN.ENTRIES]);break}case tQ.PATH_MIX:{let p=new tO(v);p.pathConstraintIndex=m;for(let m=0;m<v;m++)p.setFrame(m,i.readFloat(),i.readFloat(),i.readFloat()),m<v-1&&this.readCurve(i,m,p);_.push(p),y=Math.max(y,p.frames[(v-1)*tO.ENTRIES])}}}}for(let m=0,T=i.readInt(!0);m<T;m++){let m=p.skins[i.readInt(!0)];for(let p=0,T=i.readInt(!0);p<T;p++){let p=i.readInt(!0);for(let T=0,v=i.readInt(!0);T<v;T++){let T=m.getAttachment(p,i.readStringRef()),v=null!=T.bones,E=T.vertices,A=v?E.length/3*2:E.length,S=i.readInt(!0),I=new DeformTimeline(S);I.slotIndex=p,I.attachment=T;for(let m=0;m<S;m++){let p;let _=i.readFloat(),y=i.readInt(!0);if(0==y)p=v?tr.newFloatArray(A):E;else{p=tr.newFloatArray(A);let m=i.readInt(!0);if(y+=m,1==x)for(let _=m;_<y;_++)p[_]=i.readFloat();else for(let _=m;_<y;_++)p[_]=i.readFloat()*x;if(!v)for(let i=0,m=p.length;i<m;i++)p[i]+=E[i]}I.setFrame(m,_,p),m<S-1&&this.readCurve(i,m,I)}_.push(I),y=Math.max(y,I.frames[S-1])}}}let E=i.readInt(!0);if(E>0){let m=new DrawOrderTimeline(E),x=p.slots.length;for(let p=0;p<E;p++){let _=i.readFloat(),y=i.readInt(!0),T=tr.newArray(x,0);for(let i=x-1;i>=0;i--)T[i]=-1;let v=tr.newArray(x-y,0),E=0,A=0;for(let m=0;m<y;m++){let m=i.readInt(!0);for(;E!=m;)v[A++]=E++;T[E+i.readInt(!0)]=E++}for(;E<x;)v[A++]=E++;for(let i=x-1;i>=0;i--)-1==T[i]&&(T[i]=v[--A]);m.setFrame(p,_,T)}_.push(m),y=Math.max(y,m.frames[E-1])}let A=i.readInt(!0);if(A>0){let m=new EventTimeline(A);for(let _=0;_<A;_++){let x=i.readFloat(),y=p.events[i.readInt(!0)],T=new Event(x,y);T.intValue=i.readInt(!1),T.floatValue=i.readFloat(),T.stringValue=i.readBoolean()?i.readString():y.stringValue,null!=T.data.audioPath&&(T.volume=i.readFloat(),T.balance=i.readFloat()),m.setFrame(_,T)}_.push(m),y=Math.max(y,m.frames[A-1])}return new Animation(m,_,y)}readCurve(i,m,p){switch(i.readByte()){case tQ.CURVE_STEPPED:p.setStepped(m);break;case tQ.CURVE_BEZIER:this.setCurve(p,m,i.readFloat(),i.readFloat(),i.readFloat(),i.readFloat())}}setCurve(i,m,p,_,x,y){i.setCurve(m,p,_,x,y)}},t0=tQ;t0.AttachmentTypeValues=[0,1,2,3,4,5,6],t0.TransformModeValues=[Z.Normal,Z.OnlyTranslation,Z.NoRotationOrReflection,Z.NoScale,Z.NoScaleOrReflection],t0.PositionModeValues=[z.Fixed,z.Percent],t0.SpacingModeValues=[tj.Length,tj.Fixed,tj.Percent],t0.RotateModeValues=[j.Tangent,j.Chain,j.ChainScale],t0.BlendModeValues=[K.T$.NORMAL,K.T$.ADD,K.T$.MULTIPLY,K.T$.SCREEN],t0.BONE_ROTATE=0,t0.BONE_TRANSLATE=1,t0.BONE_SCALE=2,t0.BONE_SHEAR=3,t0.SLOT_ATTACHMENT=0,t0.SLOT_COLOR=1,t0.SLOT_TWO_COLOR=2,t0.PATH_POSITION=0,t0.PATH_SPACING=1,t0.PATH_MIX=2,t0.CURVE_LINEAR=0,t0.CURVE_STEPPED=1,t0.CURVE_BEZIER=2;let LinkedMesh=class LinkedMesh{constructor(i,m,p,_,x){this.mesh=i,this.skin=m,this.slotIndex=p,this.parent=_,this.inheritDeform=x}};let Vertices=class Vertices{constructor(i=null,m=null){this.bones=i,this.vertices=m}};let SkeletonBounds=class SkeletonBounds extends SkeletonBoundsBase_SkeletonBoundsBase{};let SkeletonJson=class SkeletonJson{constructor(i){this.scale=1,this.linkedMeshes=[],this.attachmentLoader=i}readSkeletonData(i){let m=this.scale,p=new SkeletonData,_="string"==typeof i?JSON.parse(i):i,x=_.skeleton;if(null!=x){if(p.hash=x.hash,p.version=x.spine,"3.8"!==p.version.substr(0,3)){let i=`Spine 3.8 loader cant load version ${x.spine}. Please configure your pixi-spine bundle`;console.error(i)}"3.8.75"===p.version&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),p.x=x.x,p.y=x.y,p.width=x.width,p.height=x.height,p.fps=x.fps,p.imagesPath=x.images}if(_.bones)for(let i=0;i<_.bones.length;i++){let x=_.bones[i],y=null,T=this.getValue(x,"parent",null);if(null!=T&&null==(y=p.findBone(T)))throw Error(`Parent bone not found: ${T}`);let v=new BoneData(p.bones.length,x.name,y);v.length=this.getValue(x,"length",0)*m,v.x=this.getValue(x,"x",0)*m,v.y=this.getValue(x,"y",0)*m,v.rotation=this.getValue(x,"rotation",0),v.scaleX=this.getValue(x,"scaleX",1),v.scaleY=this.getValue(x,"scaleY",1),v.shearX=this.getValue(x,"shearX",0),v.shearY=this.getValue(x,"shearY",0),v.transformMode=SkeletonJson.transformModeFromString(this.getValue(x,"transform","normal")),v.skinRequired=this.getValue(x,"skin",!1),p.bones.push(v)}if(_.slots)for(let i=0;i<_.slots.length;i++){let m=_.slots[i],x=m.name,y=m.bone,T=p.findBone(y);if(null==T)throw Error(`Slot bone not found: ${y}`);let v=new SlotData(p.slots.length,x,T),E=this.getValue(m,"color",null);null!=E&&v.color.setFromString(E);let A=this.getValue(m,"dark",null);null!=A&&(v.darkColor=new tt(1,1,1,1),v.darkColor.setFromString(A)),v.attachmentName=this.getValue(m,"attachment",null),v.blendMode=SkeletonJson.blendModeFromString(this.getValue(m,"blend","normal")),p.slots.push(v)}if(_.ik)for(let i=0;i<_.ik.length;i++){let x=_.ik[i],y=new IkConstraintData(x.name);y.order=this.getValue(x,"order",0),y.skinRequired=this.getValue(x,"skin",!1);for(let i=0;i<x.bones.length;i++){let m=x.bones[i],_=p.findBone(m);if(null==_)throw Error(`IK bone not found: ${m}`);y.bones.push(_)}let T=x.target;if(y.target=p.findBone(T),null==y.target)throw Error(`IK target bone not found: ${T}`);y.mix=this.getValue(x,"mix",1),y.softness=this.getValue(x,"softness",0)*m,y.bendDirection=this.getValue(x,"bendPositive",!0)?1:-1,y.compress=this.getValue(x,"compress",!1),y.stretch=this.getValue(x,"stretch",!1),y.uniform=this.getValue(x,"uniform",!1),p.ikConstraints.push(y)}if(_.transform)for(let i=0;i<_.transform.length;i++){let x=_.transform[i],y=new TransformConstraintData(x.name);y.order=this.getValue(x,"order",0),y.skinRequired=this.getValue(x,"skin",!1);for(let i=0;i<x.bones.length;i++){let m=x.bones[i],_=p.findBone(m);if(null==_)throw Error(`Transform constraint bone not found: ${m}`);y.bones.push(_)}let T=x.target;if(y.target=p.findBone(T),null==y.target)throw Error(`Transform constraint target bone not found: ${T}`);y.local=this.getValue(x,"local",!1),y.relative=this.getValue(x,"relative",!1),y.offsetRotation=this.getValue(x,"rotation",0),y.offsetX=this.getValue(x,"x",0)*m,y.offsetY=this.getValue(x,"y",0)*m,y.offsetScaleX=this.getValue(x,"scaleX",0),y.offsetScaleY=this.getValue(x,"scaleY",0),y.offsetShearY=this.getValue(x,"shearY",0),y.rotateMix=this.getValue(x,"rotateMix",1),y.translateMix=this.getValue(x,"translateMix",1),y.scaleMix=this.getValue(x,"scaleMix",1),y.shearMix=this.getValue(x,"shearMix",1),p.transformConstraints.push(y)}if(_.path)for(let i=0;i<_.path.length;i++){let x=_.path[i],y=new PathConstraintData(x.name);y.order=this.getValue(x,"order",0),y.skinRequired=this.getValue(x,"skin",!1);for(let i=0;i<x.bones.length;i++){let m=x.bones[i],_=p.findBone(m);if(null==_)throw Error(`Transform constraint bone not found: ${m}`);y.bones.push(_)}let T=x.target;if(y.target=p.findSlot(T),null==y.target)throw Error(`Path target slot not found: ${T}`);y.positionMode=SkeletonJson.positionModeFromString(this.getValue(x,"positionMode","percent")),y.spacingMode=SkeletonJson.spacingModeFromString(this.getValue(x,"spacingMode","length")),y.rotateMode=SkeletonJson.rotateModeFromString(this.getValue(x,"rotateMode","tangent")),y.offsetRotation=this.getValue(x,"rotation",0),y.position=this.getValue(x,"position",0),y.positionMode==z.Fixed&&(y.position*=m),y.spacing=this.getValue(x,"spacing",0),(y.spacingMode==tj.Length||y.spacingMode==tj.Fixed)&&(y.spacing*=m),y.rotateMix=this.getValue(x,"rotateMix",1),y.translateMix=this.getValue(x,"translateMix",1),p.pathConstraints.push(y)}if(_.skins)for(let i=0;i<_.skins.length;i++){let m=_.skins[i],x=new Skin(m.name);if(m.bones)for(let _=0;_<m.bones.length;_++){let y=p.findBone(m.bones[_]);if(null==y)throw Error(`Skin bone not found: ${m.bones[i]}`);x.bones.push(y)}if(m.ik)for(let _=0;_<m.ik.length;_++){let y=p.findIkConstraint(m.ik[_]);if(null==y)throw Error(`Skin IK constraint not found: ${m.ik[i]}`);x.constraints.push(y)}if(m.transform)for(let _=0;_<m.transform.length;_++){let y=p.findTransformConstraint(m.transform[_]);if(null==y)throw Error(`Skin transform constraint not found: ${m.transform[i]}`);x.constraints.push(y)}if(m.path)for(let _=0;_<m.path.length;_++){let y=p.findPathConstraint(m.path[_]);if(null==y)throw Error(`Skin path constraint not found: ${m.path[i]}`);x.constraints.push(y)}for(let i in m.attachments){let _=p.findSlot(i);if(null==_)throw Error(`Slot not found: ${i}`);let y=m.attachments[i];for(let i in y){let m=this.readAttachment(y[i],x,_.index,i,p);null!=m&&x.setAttachment(_.index,i,m)}}p.skins.push(x),"default"==x.name&&(p.defaultSkin=x)}for(let i=0,m=this.linkedMeshes.length;i<m;i++){let m=this.linkedMeshes[i],_=null==m.skin?p.defaultSkin:p.findSkin(m.skin);if(null==_)throw Error(`Skin not found: ${m.skin}`);let x=_.getAttachment(m.slotIndex,m.parent);if(null==x)throw Error(`Parent mesh not found: ${m.parent}`);m.mesh.deformAttachment=m.inheritDeform?x:m.mesh,m.mesh.setParentMesh(x)}if(this.linkedMeshes.length=0,_.events)for(let i in _.events){let m=_.events[i],x=new EventData(i);x.intValue=this.getValue(m,"int",0),x.floatValue=this.getValue(m,"float",0),x.stringValue=this.getValue(m,"string",""),x.audioPath=this.getValue(m,"audio",null),null!=x.audioPath&&(x.volume=this.getValue(m,"volume",1),x.balance=this.getValue(m,"balance",0)),p.events.push(x)}if(_.animations)for(let i in _.animations){let m=_.animations[i];this.readAnimation(m,i,p)}return p}readAttachment(i,m,p,_,x){let y=this.scale;_=this.getValue(i,"name",_);let T=this.getValue(i,"type","region");switch(T){case"region":{let p=this.getValue(i,"path",_),x=this.attachmentLoader.newRegionAttachment(m,_,p);if(null==x)return null;x.path=p,x.x=this.getValue(i,"x",0)*y,x.y=this.getValue(i,"y",0)*y,x.scaleX=this.getValue(i,"scaleX",1),x.scaleY=this.getValue(i,"scaleY",1),x.rotation=this.getValue(i,"rotation",0),x.width=i.width*y,x.height=i.height*y;let T=this.getValue(i,"color",null);return null!=T&&x.color.setFromString(T),x}case"boundingbox":{let p=this.attachmentLoader.newBoundingBoxAttachment(m,_);if(null==p)return null;this.readVertices(i,p,i.vertexCount<<1);let x=this.getValue(i,"color",null);return null!=x&&p.color.setFromString(x),p}case"mesh":case"linkedmesh":{let x=this.getValue(i,"path",_),T=this.attachmentLoader.newMeshAttachment(m,_,x);if(null==T)return null;T.path=x;let v=this.getValue(i,"color",null);null!=v&&T.color.setFromString(v),T.width=this.getValue(i,"width",0)*y,T.height=this.getValue(i,"height",0)*y;let E=this.getValue(i,"parent",null);if(null!=E)return this.linkedMeshes.push(new SkeletonJson_LinkedMesh(T,this.getValue(i,"skin",null),p,E,this.getValue(i,"deform",!0))),T;let A=i.uvs;return this.readVertices(i,T,A.length),T.triangles=i.triangles,T.regionUVs=new Float32Array(A),T.edges=this.getValue(i,"edges",null),T.hullLength=2*this.getValue(i,"hull",0),T}case"path":{let p=this.attachmentLoader.newPathAttachment(m,_);if(null==p)return null;p.closed=this.getValue(i,"closed",!1),p.constantSpeed=this.getValue(i,"constantSpeed",!0);let x=i.vertexCount;this.readVertices(i,p,x<<1);let T=tr.newArray(x/3,0);for(let m=0;m<i.lengths.length;m++)T[m]=i.lengths[m]*y;p.lengths=T;let v=this.getValue(i,"color",null);return null!=v&&p.color.setFromString(v),p}case"point":{let p=this.attachmentLoader.newPointAttachment(m,_);if(null==p)return null;p.x=this.getValue(i,"x",0)*y,p.y=this.getValue(i,"y",0)*y,p.rotation=this.getValue(i,"rotation",0);let x=this.getValue(i,"color",null);return null!=x&&p.color.setFromString(x),p}case"clipping":{let p=this.attachmentLoader.newClippingAttachment(m,_);if(null==p)return null;let y=this.getValue(i,"end",null);if(null!=y){let i=x.findSlot(y);if(null==i)throw Error(`Clipping end slot not found: ${y}`);p.endSlot=i}let T=i.vertexCount;this.readVertices(i,p,T<<1);let v=this.getValue(i,"color",null);return null!=v&&p.color.setFromString(v),p}}return null}readVertices(i,m,p){let _=this.scale;m.worldVerticesLength=p;let x=i.vertices;if(p==x.length){let i=tr.toFloatArray(x);if(1!=_)for(let m=0,p=x.length;m<p;m++)i[m]*=_;m.vertices=i;return}let y=[],T=[];for(let i=0,m=x.length;i<m;){let m=x[i++];T.push(m);for(let p=i+4*m;i<p;i+=4)T.push(x[i]),y.push(x[i+1]*_),y.push(x[i+2]*_),y.push(x[i+3])}m.bones=T,m.vertices=tr.toFloatArray(y)}readAnimation(i,m,p){let _=this.scale,x=[],y=0;if(i.slots)for(let m in i.slots){let _=i.slots[m],T=p.findSlotIndex(m);if(-1==T)throw Error(`Slot not found: ${m}`);for(let i in _){let p=_[i];if("attachment"==i){let i=new AttachmentTimeline(p.length);i.slotIndex=T;let m=0;for(let _=0;_<p.length;_++){let x=p[_];i.setFrame(m++,this.getValue(x,"time",0),x.name)}x.push(i),y=Math.max(y,i.frames[i.getFrameCount()-1])}else if("color"==i){let i=new tI(p.length);i.slotIndex=T;let m=0;for(let _=0;_<p.length;_++){let x=p[_],y=new tt;y.setFromString(x.color||"ffffffff"),i.setFrame(m,this.getValue(x,"time",0),y.r,y.g,y.b,y.a),this.readCurve(x,i,m),m++}x.push(i),y=Math.max(y,i.frames[(i.getFrameCount()-1)*tI.ENTRIES])}else if("twoColor"==i){let i=new tM(p.length);i.slotIndex=T;let m=0;for(let _=0;_<p.length;_++){let x=p[_],y=new tt,T=new tt;y.setFromString(x.light),T.setFromString(x.dark),i.setFrame(m,this.getValue(x,"time",0),y.r,y.g,y.b,y.a,T.r,T.g,T.b),this.readCurve(x,i,m),m++}x.push(i),y=Math.max(y,i.frames[(i.getFrameCount()-1)*tM.ENTRIES])}else throw Error(`Invalid timeline type for a slot: ${i} (${m})`)}}if(i.bones)for(let m in i.bones){let T=i.bones[m],v=p.findBoneIndex(m);if(-1==v)throw Error(`Bone not found: ${m}`);for(let i in T){let p=T[i];if("rotate"===i){let i=new tE(p.length);i.boneIndex=v;let m=0;for(let _=0;_<p.length;_++){let x=p[_];i.setFrame(m,this.getValue(x,"time",0),this.getValue(x,"angle",0)),this.readCurve(x,i,m),m++}x.push(i),y=Math.max(y,i.frames[(i.getFrameCount()-1)*tE.ENTRIES])}else if("translate"===i||"scale"===i||"shear"===i){let m=null,T=1,E=0;"scale"===i?(m=new ScaleTimeline(p.length),E=1):"shear"===i?m=new ShearTimeline(p.length):(m=new tS(p.length),T=_),m.boneIndex=v;let A=0;for(let i=0;i<p.length;i++){let _=p[i],x=this.getValue(_,"x",E),y=this.getValue(_,"y",E);m.setFrame(A,this.getValue(_,"time",0),x*T,y*T),this.readCurve(_,m,A),A++}x.push(m),y=Math.max(y,m.frames[(m.getFrameCount()-1)*tS.ENTRIES])}else throw Error(`Invalid timeline type for a bone: ${i} (${m})`)}}if(i.ik)for(let m in i.ik){let T=i.ik[m],v=p.findIkConstraint(m),E=new tk(T.length);E.ikConstraintIndex=p.ikConstraints.indexOf(v);let A=0;for(let i=0;i<T.length;i++){let m=T[i];E.setFrame(A,this.getValue(m,"time",0),this.getValue(m,"mix",1),this.getValue(m,"softness",0)*_,this.getValue(m,"bendPositive",!0)?1:-1,this.getValue(m,"compress",!1),this.getValue(m,"stretch",!1)),this.readCurve(m,E,A),A++}x.push(E),y=Math.max(y,E.frames[(E.getFrameCount()-1)*tk.ENTRIES])}if(i.transform)for(let m in i.transform){let _=i.transform[m],T=p.findTransformConstraint(m),v=new tD(_.length);v.transformConstraintIndex=p.transformConstraints.indexOf(T);let E=0;for(let i=0;i<_.length;i++){let m=_[i];v.setFrame(E,this.getValue(m,"time",0),this.getValue(m,"rotateMix",1),this.getValue(m,"translateMix",1),this.getValue(m,"scaleMix",1),this.getValue(m,"shearMix",1)),this.readCurve(m,v,E),E++}x.push(v),y=Math.max(y,v.frames[(v.getFrameCount()-1)*tD.ENTRIES])}if(i.path)for(let m in i.path){let T=i.path[m],v=p.findPathConstraintIndex(m);if(-1==v)throw Error(`Path constraint not found: ${m}`);let E=p.pathConstraints[v];for(let i in T){let m=T[i];if("position"===i||"spacing"===i){let p=null,T=1;"spacing"===i?(p=new PathConstraintSpacingTimeline(m.length),(E.spacingMode==tj.Length||E.spacingMode==tj.Fixed)&&(T=_)):(p=new tN(m.length),E.positionMode==z.Fixed&&(T=_)),p.pathConstraintIndex=v;let A=0;for(let _=0;_<m.length;_++){let x=m[_];p.setFrame(A,this.getValue(x,"time",0),this.getValue(x,i,0)*T),this.readCurve(x,p,A),A++}x.push(p),y=Math.max(y,p.frames[(p.getFrameCount()-1)*tN.ENTRIES])}else if("mix"===i){let i=new tO(m.length);i.pathConstraintIndex=v;let p=0;for(let _=0;_<m.length;_++){let x=m[_];i.setFrame(p,this.getValue(x,"time",0),this.getValue(x,"rotateMix",1),this.getValue(x,"translateMix",1)),this.readCurve(x,i,p),p++}x.push(i),y=Math.max(y,i.frames[(i.getFrameCount()-1)*tO.ENTRIES])}}}if(i.deform)for(let m in i.deform){let T=i.deform[m],v=p.findSkin(m);if(null==v){if(!ti.FAIL_ON_NON_EXISTING_SKIN)continue;throw Error(`Skin not found: ${m}`)}for(let i in T){let m=T[i],E=p.findSlotIndex(i);if(-1==E)throw Error(`Slot not found: ${m.name}`);for(let i in m){let p=m[i],T=v.getAttachment(E,i);if(null==T)throw Error(`Deform attachment not found: ${p.name}`);let A=null!=T.bones,S=T.vertices,I=A?S.length/3*2:S.length,R=new DeformTimeline(p.length);R.slotIndex=E,R.attachment=T;let C=0;for(let i=0;i<p.length;i++){let m;let x=p[i],y=this.getValue(x,"vertices",null);if(null==y)m=A?tr.newFloatArray(I):S;else{m=tr.newFloatArray(I);let i=this.getValue(x,"offset",0);if(tr.arrayCopy(y,0,m,i,y.length),1!=_)for(let p=i,x=p+y.length;p<x;p++)m[p]*=_;if(!A)for(let i=0;i<I;i++)m[i]+=S[i]}R.setFrame(C,this.getValue(x,"time",0),m),this.readCurve(x,R,C),C++}x.push(R),y=Math.max(y,R.frames[R.getFrameCount()-1])}}}let T=i.drawOrder;if(null==T&&(T=i.draworder),null!=T){let i=new DrawOrderTimeline(T.length),m=p.slots.length,_=0;for(let x=0;x<T.length;x++){let y=T[x],v=null,E=this.getValue(y,"offsets",null);if(null!=E){v=tr.newArray(m,-1);let i=tr.newArray(m-E.length,0),_=0,x=0;for(let m=0;m<E.length;m++){let y=E[m],T=p.findSlotIndex(y.slot);if(-1==T)throw Error(`Slot not found: ${y.slot}`);for(;_!=T;)i[x++]=_++;v[_+y.offset]=_++}for(;_<m;)i[x++]=_++;for(let p=m-1;p>=0;p--)-1==v[p]&&(v[p]=i[--x])}i.setFrame(_++,this.getValue(y,"time",0),v)}x.push(i),y=Math.max(y,i.frames[i.getFrameCount()-1])}if(i.events){let m=new EventTimeline(i.events.length),_=0;for(let x=0;x<i.events.length;x++){let y=i.events[x],T=p.findEvent(y.name);if(null==T)throw Error(`Event not found: ${y.name}`);let v=new Event(tr.toSinglePrecision(this.getValue(y,"time",0)),T);v.intValue=this.getValue(y,"int",T.intValue),v.floatValue=this.getValue(y,"float",T.floatValue),v.stringValue=this.getValue(y,"string",T.stringValue),null!=v.data.audioPath&&(v.volume=this.getValue(y,"volume",1),v.balance=this.getValue(y,"balance",0)),m.setFrame(_++,v)}x.push(m),y=Math.max(y,m.frames[m.getFrameCount()-1])}if(isNaN(y))throw Error("Error while parsing animation, duration is NaN");p.animations.push(new Animation(m,x,y))}readCurve(i,m,p){if(i.hasOwnProperty("curve")){if("stepped"===i.curve)m.setStepped(p);else{let _=i.curve;m.setCurve(p,_,this.getValue(i,"c2",0),this.getValue(i,"c3",1),this.getValue(i,"c4",1))}}}getValue(i,m,p){return void 0!==i[m]?i[m]:p}static blendModeFromString(i){if("normal"==(i=i.toLowerCase()))return K.T$.NORMAL;if("additive"==i)return K.T$.ADD;if("multiply"==i)return K.T$.MULTIPLY;if("screen"==i)return K.T$.SCREEN;throw Error(`Unknown blend mode: ${i}`)}static positionModeFromString(i){if("fixed"==(i=i.toLowerCase()))return z.Fixed;if("percent"==i)return z.Percent;throw Error(`Unknown position mode: ${i}`)}static spacingModeFromString(i){if("length"==(i=i.toLowerCase()))return tj.Length;if("fixed"==i)return tj.Fixed;if("percent"==i)return tj.Percent;throw Error(`Unknown position mode: ${i}`)}static rotateModeFromString(i){if("tangent"==(i=i.toLowerCase()))return j.Tangent;if("chain"==i)return j.Chain;if("chainscale"==i)return j.ChainScale;throw Error(`Unknown rotate mode: ${i}`)}static transformModeFromString(i){if("normal"==(i=i.toLowerCase()))return Z.Normal;if("onlytranslation"==i)return Z.OnlyTranslation;if("norotationorreflection"==i)return Z.NoRotationOrReflection;if("noscale"==i)return Z.NoScale;if("noscaleorreflection"==i)return Z.NoScaleOrReflection;throw Error(`Unknown transform mode: ${i}`)}};let SkeletonJson_LinkedMesh=class SkeletonJson_LinkedMesh{constructor(i,m,p,_,x){this.mesh=i,this.skin=m,this.slotIndex=p,this.parent=_,this.inheritDeform=x}};let Spine=class Spine extends tu{createSkeleton(i){this.skeleton=new tJ(i),this.skeleton.updateWorldTransform(),this.stateData=new tz(i),this.state=new tU(this.stateData)}};let Attachment_Attachment=class Attachment_Attachment{constructor(i){if(null==i)throw Error("name cannot be null.");this.name=i}};let t1=class extends Attachment_Attachment{constructor(i){super(i),this.id=(65535&t1.nextID++)<<11,this.worldVerticesLength=0}computeWorldVerticesOld(i,m){this.computeWorldVertices(i,0,this.worldVerticesLength,m,0,2)}computeWorldVertices(i,m,p,_,x,y){p=x+(p>>1)*y;let T=i.bone.skeleton,v=i.attachmentVertices,E=this.vertices,A=this.bones;if(null==A){v.length>0&&(E=v);let T=i.bone.matrix,A=T.tx,S=T.ty,I=T.a,R=T.c,C=T.b,P=T.d;for(let i=m,T=x;T<p;i+=2,T+=y){let m=E[i],p=E[i+1];_[T]=m*I+p*R+A,_[T+1]=m*C+p*P+S}return}let S=0,I=0;for(let i=0;i<m;i+=2){let i=A[S];S+=i+1,I+=i}let R=T.bones;if(0==v.length)for(let i=x,m=3*I;i<p;i+=y){let p=0,x=0,y=A[S++];for(y+=S;S<y;S++,m+=3){let i=R[A[S]].matrix,_=E[m],y=E[m+1],T=E[m+2];p+=(_*i.a+y*i.c+i.tx)*T,x+=(_*i.b+y*i.d+i.ty)*T}_[i]=p,_[i+1]=x}else for(let i=x,m=3*I,T=I<<1;i<p;i+=y){let p=0,x=0,y=A[S++];for(y+=S;S<y;S++,m+=3,T+=2){let i=R[A[S]].matrix,_=E[m]+v[T],y=E[m+1]+v[T+1],I=E[m+2];p+=(_*i.a+y*i.c+i.tx)*I,x+=(_*i.b+y*i.d+i.ty)*I}_[i]=p,_[i+1]=x}}applyDeform(i){return this==i}},t2=t1;t2.nextID=0;let BoundingBoxAttachment_BoundingBoxAttachment=class BoundingBoxAttachment_BoundingBoxAttachment extends t2{constructor(i){super(i),this.type=Y.BoundingBox,this.color=new tt(1,1,1,1)}};let ClippingAttachment_ClippingAttachment=class ClippingAttachment_ClippingAttachment extends t2{constructor(i){super(i),this.type=Y.Clipping,this.color=new tt(.2275,.2275,.8078,1)}};let MeshAttachment_MeshAttachment=class MeshAttachment_MeshAttachment extends t2{constructor(i){super(i),this.type=Y.Mesh,this.color=new tt(1,1,1,1),this.inheritDeform=!1,this.tempColor=new tt(0,0,0,0)}applyDeform(i){return this==i||this.inheritDeform&&this.parentMesh==i}getParentMesh(){return this.parentMesh}setParentMesh(i){this.parentMesh=i,null!=i&&(this.bones=i.bones,this.vertices=i.vertices,this.worldVerticesLength=i.worldVerticesLength,this.regionUVs=i.regionUVs,this.triangles=i.triangles,this.hullLength=i.hullLength,this.worldVerticesLength=i.worldVerticesLength)}};let PathAttachment_PathAttachment=class PathAttachment_PathAttachment extends t2{constructor(i){super(i),this.type=Y.Path,this.closed=!1,this.constantSpeed=!1,this.color=new tt(1,1,1,1)}};let PointAttachment_PointAttachment=class PointAttachment_PointAttachment extends t2{constructor(i){super(i),this.type=Y.Point,this.color=new tt(.38,.94,0,1)}computeWorldPosition(i,m){let p=i.matrix;return m.x=this.x*p.a+this.y*p.c+i.worldX,m.y=this.x*p.b+this.y*p.d+i.worldY,m}computeWorldRotation(i){let m=i.matrix,p=te.cosDeg(this.rotation),_=te.sinDeg(this.rotation),x=p*m.a+_*m.c,y=p*m.b+_*m.d;return Math.atan2(y,x)*te.radDeg}};let Slot_Slot=class Slot_Slot{constructor(i,m){if(this.attachmentVertices=[],null==i)throw Error("data cannot be null.");if(null==m)throw Error("bone cannot be null.");this.data=i,this.bone=m,this.color=new tt,this.darkColor=null==i.darkColor?null:new tt,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(i){this.attachment!=i&&(this.attachment=i,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)}setAttachmentTime(i){this.attachmentTime=this.bone.skeleton.time-i}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};let t3=class extends Attachment_Attachment{constructor(i){super(i),this.type=Y.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new tt(1,1,1,1),this.offset=tr.newFloatArray(8),this.uvs=tr.newFloatArray(8),this.tempColor=new tt(1,1,1,1)}updateOffset(){let i=this.width/this.region.originalWidth*this.scaleX,m=this.height/this.region.originalHeight*this.scaleY,p=-this.width/2*this.scaleX+this.region.offsetX*i,_=-this.height/2*this.scaleY+this.region.offsetY*m,x=p+this.region.width*i,y=_+this.region.height*m,T=this.rotation*Math.PI/180,v=Math.cos(T),E=Math.sin(T),A=p*v+this.x,S=p*E,I=_*v+this.y,R=_*E,C=x*v+this.x,P=x*E,k=y*v+this.y,B=y*E,D=this.offset;D[t3.OX1]=A-R,D[t3.OY1]=I+S,D[t3.OX2]=A-B,D[t3.OY2]=k+S,D[t3.OX3]=C-B,D[t3.OY3]=k+P,D[t3.OX4]=C-R,D[t3.OY4]=I+P}setRegion(i){this.region=i;let m=this.uvs;i.rotate?(m[2]=i.u,m[3]=i.v2,m[4]=i.u,m[5]=i.v,m[6]=i.u2,m[7]=i.v,m[0]=i.u2,m[1]=i.v2):(m[0]=i.u,m[1]=i.v2,m[2]=i.u,m[3]=i.v,m[4]=i.u2,m[5]=i.v,m[6]=i.u2,m[7]=i.v2)}computeWorldVertices(i,m,p,_){let x=this.offset,y=i instanceof Slot_Slot?i.bone.matrix:i.matrix,T=y.tx,v=y.ty,E=y.a,A=y.c,S=y.b,I=y.d,R=0,C=0;R=x[t3.OX1],C=x[t3.OY1],m[p]=R*E+C*A+T,m[p+1]=R*S+C*I+v,p+=_,R=x[t3.OX2],C=x[t3.OY2],m[p]=R*E+C*A+T,m[p+1]=R*S+C*I+v,p+=_,R=x[t3.OX3],C=x[t3.OY3],m[p]=R*E+C*A+T,m[p+1]=R*S+C*I+v,p+=_,R=x[t3.OX4],C=x[t3.OY4],m[p]=R*E+C*A+T,m[p+1]=R*S+C*I+v}},t4=t3;t4.OX1=0,t4.OY1=1,t4.OX2=2,t4.OY2=3,t4.OX3=4,t4.OY3=5,t4.OX4=6,t4.OY4=7,t4.X1=0,t4.Y1=1,t4.C1R=2,t4.C1G=3,t4.C1B=4,t4.C1A=5,t4.U1=6,t4.V1=7,t4.X2=8,t4.Y2=9,t4.C2R=10,t4.C2G=11,t4.C2B=12,t4.C2A=13,t4.U2=14,t4.V2=15,t4.X3=16,t4.Y3=17,t4.C3R=18,t4.C3G=19,t4.C3B=20,t4.C3A=21,t4.U3=22,t4.V3=23,t4.X4=24,t4.Y4=25,t4.C4R=26,t4.C4G=27,t4.C4B=28,t4.C4A=29,t4.U4=30,t4.V4=31;let JitterEffect_JitterEffect=class JitterEffect_JitterEffect{constructor(i,m){this.jitterX=0,this.jitterY=0,this.jitterX=i,this.jitterY=m}begin(i){}transform(i,m,p,_){i.x+=te.randomTriangular(-this.jitterX,this.jitterY),i.y+=te.randomTriangular(-this.jitterX,this.jitterY)}end(){}};let t6=class{constructor(i){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=i}begin(i){this.worldX=i.x+this.centerX,this.worldY=i.y+this.centerY}transform(i,m,p,_){let x=this.angle*te.degreesToRadians,y=i.x-this.worldX,T=i.y-this.worldY,v=Math.sqrt(y*y+T*T);if(v<this.radius){let m=t6.interpolation.apply(0,x,(this.radius-v)/this.radius),p=Math.cos(m),_=Math.sin(m);i.x=p*y-_*T+this.worldX,i.y=_*y+p*T+this.worldY}}end(){}},t5=t6;t5.interpolation=new PowOut(2);let Animation_Animation=class Animation_Animation{constructor(i,m,p){if(null==i)throw Error("name cannot be null.");if(null==m)throw Error("timelines cannot be null.");this.name=i,this.timelines=m,this.duration=p}apply(i,m,p,_,x,y,T,v){if(null==i)throw Error("skeleton cannot be null.");_&&0!=this.duration&&(p%=this.duration,m>0&&(m%=this.duration));let E=this.timelines;for(let _=0,A=E.length;_<A;_++)E[_].apply(i,m,p,x,y,T,v)}static binarySearch(i,m,p=1){let _=0,x=i.length/p-2;if(0==x)return p;let y=x>>>1;for(;;){if(i[(y+1)*p]<=m?_=y+1:x=y,_==x)return(_+1)*p;y=_+x>>>1}}static linearSearch(i,m,p){for(let _=0,x=i.length-p;_<=x;_+=p)if(i[_]>m)return _;return -1}};var t8=((P=t8||{})[P.rotate=0]="rotate",P[P.translate=1]="translate",P[P.scale=2]="scale",P[P.shear=3]="shear",P[P.attachment=4]="attachment",P[P.color=5]="color",P[P.deform=6]="deform",P[P.event=7]="event",P[P.drawOrder=8]="drawOrder",P[P.ikConstraint=9]="ikConstraint",P[P.transformConstraint=10]="transformConstraint",P[P.pathConstraintPosition=11]="pathConstraintPosition",P[P.pathConstraintSpacing=12]="pathConstraintSpacing",P[P.pathConstraintMix=13]="pathConstraintMix",P[P.twoColor=14]="twoColor",P);let t9=class{constructor(i){if(i<=0)throw Error(`frameCount must be > 0: ${i}`);this.curves=tr.newFloatArray((i-1)*t9.BEZIER_SIZE)}getFrameCount(){return this.curves.length/t9.BEZIER_SIZE+1}setLinear(i){this.curves[i*t9.BEZIER_SIZE]=t9.LINEAR}setStepped(i){this.curves[i*t9.BEZIER_SIZE]=t9.STEPPED}getCurveType(i){let m=i*t9.BEZIER_SIZE;if(m==this.curves.length)return t9.LINEAR;let p=this.curves[m];return p==t9.LINEAR?t9.LINEAR:p==t9.STEPPED?t9.STEPPED:t9.BEZIER}setCurve(i,m,p,_,x){let y=(-(2*m)+_)*.03,T=(-(2*p)+x)*.03,v=((m-_)*3+1)*.006,E=((p-x)*3+1)*.006,A=2*y+v,S=2*T+E,I=.3*m+y+.16666667*v,R=.3*p+T+.16666667*E,C=i*t9.BEZIER_SIZE,P=this.curves;P[C++]=t9.BEZIER;let k=I,B=R;for(let i=C+t9.BEZIER_SIZE-1;C<i;C+=2)P[C]=k,P[C+1]=B,I+=A,R+=S,A+=v,S+=E,k+=I,B+=R}getCurvePercent(i,m){m=te.clamp(m,0,1);let p=this.curves,_=i*t9.BEZIER_SIZE,x=p[_];if(x==t9.LINEAR)return m;if(x==t9.STEPPED)return 0;_++;let y=0;for(let i=_,x=_+t9.BEZIER_SIZE-1;_<x;_+=2)if((y=p[_])>=m){let x,T;return _==i?(x=0,T=0):(x=p[_-2],T=p[_-1]),T+(p[_+1]-T)*(m-x)/(y-x)}let T=p[_-1];return T+(1-T)*(m-y)/(1-y)}},t7=t9;t7.LINEAR=0,t7.STEPPED=1,t7.BEZIER=2,t7.BEZIER_SIZE=19;let et=class extends t7{constructor(i){super(i),this.frames=tr.newFloatArray(i<<1)}getPropertyId(){return 0+this.boneIndex}setFrame(i,m,p){i<<=1,this.frames[i]=m,this.frames[i+et.ROTATION]=p}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.bones[this.boneIndex];if(p<v[0]){switch(y){case G.setup:E.rotation=E.data.rotation;break;case G.first:let i=E.data.rotation-E.rotation;E.rotation+=(i-(16384-(16384.499999999996-i/360|0))*360)*x}return}if(p>=v[v.length-et.ENTRIES]){let i=v[v.length+et.PREV_ROTATION];switch(y){case G.setup:E.rotation=E.data.rotation+i*x;break;case G.first:case G.replace:i+=E.data.rotation-E.rotation,i-=(16384-(16384.499999999996-i/360|0))*360;case G.add:E.rotation+=i*x}return}let A=Animation_Animation.binarySearch(v,p,et.ENTRIES),S=v[A+et.PREV_ROTATION],I=v[A],R=this.getCurvePercent((A>>1)-1,1-(p-I)/(v[A+et.PREV_TIME]-I)),C=v[A+et.ROTATION]-S;switch(C=S+(C-(16384-(16384.499999999996-C/360|0))*360)*R,y){case G.setup:E.rotation=E.data.rotation+(C-(16384-(16384.499999999996-C/360|0))*360)*x;break;case G.first:case G.replace:C+=E.data.rotation-E.rotation;case G.add:E.rotation+=(C-(16384-(16384.499999999996-C/360|0))*360)*x}}},ee=et;ee.ENTRIES=2,ee.PREV_TIME=-2,ee.PREV_ROTATION=-1,ee.ROTATION=1;let er=class extends t7{constructor(i){super(i),this.frames=tr.newFloatArray(i*er.ENTRIES)}getPropertyId(){return 16777216+this.boneIndex}setFrame(i,m,p,_){i*=er.ENTRIES,this.frames[i]=m,this.frames[i+er.X]=p,this.frames[i+er.Y]=_}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.bones[this.boneIndex];if(p<v[0]){switch(y){case G.setup:E.x=E.data.x,E.y=E.data.y;break;case G.first:E.x+=(E.data.x-E.x)*x,E.y+=(E.data.y-E.y)*x}return}let A=0,S=0;if(p>=v[v.length-er.ENTRIES])A=v[v.length+er.PREV_X],S=v[v.length+er.PREV_Y];else{let i=Animation_Animation.binarySearch(v,p,er.ENTRIES);A=v[i+er.PREV_X],S=v[i+er.PREV_Y];let m=v[i],_=this.getCurvePercent(i/er.ENTRIES-1,1-(p-m)/(v[i+er.PREV_TIME]-m));A+=(v[i+er.X]-A)*_,S+=(v[i+er.Y]-S)*_}switch(y){case G.setup:E.x=E.data.x+A*x,E.y=E.data.y+S*x;break;case G.first:case G.replace:E.x+=(E.data.x+A-E.x)*x,E.y+=(E.data.y+S-E.y)*x;break;case G.add:E.x+=A*x,E.y+=S*x}}},ei=er;ei.ENTRIES=3,ei.PREV_TIME=-3,ei.PREV_X=-2,ei.PREV_Y=-1,ei.X=1,ei.Y=2;let Animation_ScaleTimeline=class Animation_ScaleTimeline extends ei{constructor(i){super(i)}getPropertyId(){return 33554432+this.boneIndex}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.bones[this.boneIndex];if(p<v[0]){switch(y){case G.setup:E.scaleX=E.data.scaleX,E.scaleY=E.data.scaleY;break;case G.first:E.scaleX+=(E.data.scaleX-E.scaleX)*x,E.scaleY+=(E.data.scaleY-E.scaleY)*x}return}let A=0,S=0;if(p>=v[v.length-Animation_ScaleTimeline.ENTRIES])A=v[v.length+Animation_ScaleTimeline.PREV_X]*E.data.scaleX,S=v[v.length+Animation_ScaleTimeline.PREV_Y]*E.data.scaleY;else{let i=Animation_Animation.binarySearch(v,p,Animation_ScaleTimeline.ENTRIES);A=v[i+Animation_ScaleTimeline.PREV_X],S=v[i+Animation_ScaleTimeline.PREV_Y];let m=v[i],_=this.getCurvePercent(i/Animation_ScaleTimeline.ENTRIES-1,1-(p-m)/(v[i+Animation_ScaleTimeline.PREV_TIME]-m));A=(A+(v[i+Animation_ScaleTimeline.X]-A)*_)*E.data.scaleX,S=(S+(v[i+Animation_ScaleTimeline.Y]-S)*_)*E.data.scaleY}if(1==x)y==G.add?(E.scaleX+=A-E.data.scaleX,E.scaleY+=S-E.data.scaleY):(E.scaleX=A,E.scaleY=S);else{let i=0,m=0;if(T==W.mixOut)switch(y){case G.setup:i=E.data.scaleX,m=E.data.scaleY,E.scaleX=i+(Math.abs(A)*te.signum(i)-i)*x,E.scaleY=m+(Math.abs(S)*te.signum(m)-m)*x;break;case G.first:case G.replace:i=E.scaleX,m=E.scaleY,E.scaleX=i+(Math.abs(A)*te.signum(i)-i)*x,E.scaleY=m+(Math.abs(S)*te.signum(m)-m)*x;break;case G.add:i=E.scaleX,m=E.scaleY,E.scaleX=i+(Math.abs(A)*te.signum(i)-E.data.scaleX)*x,E.scaleY=m+(Math.abs(S)*te.signum(m)-E.data.scaleY)*x}else switch(y){case G.setup:i=Math.abs(E.data.scaleX)*te.signum(A),m=Math.abs(E.data.scaleY)*te.signum(S),E.scaleX=i+(A-i)*x,E.scaleY=m+(S-m)*x;break;case G.first:case G.replace:i=Math.abs(E.scaleX)*te.signum(A),m=Math.abs(E.scaleY)*te.signum(S),E.scaleX=i+(A-i)*x,E.scaleY=m+(S-m)*x;break;case G.add:i=te.signum(A),m=te.signum(S),E.scaleX=Math.abs(E.scaleX)*i+(A-Math.abs(E.data.scaleX)*i)*x,E.scaleY=Math.abs(E.scaleY)*m+(S-Math.abs(E.data.scaleY)*m)*x}}}};let Animation_ShearTimeline=class Animation_ShearTimeline extends ei{constructor(i){super(i)}getPropertyId(){return 50331648+this.boneIndex}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.bones[this.boneIndex];if(p<v[0]){switch(y){case G.setup:E.shearX=E.data.shearX,E.shearY=E.data.shearY;break;case G.first:E.shearX+=(E.data.shearX-E.shearX)*x,E.shearY+=(E.data.shearY-E.shearY)*x}return}let A=0,S=0;if(p>=v[v.length-Animation_ShearTimeline.ENTRIES])A=v[v.length+Animation_ShearTimeline.PREV_X],S=v[v.length+Animation_ShearTimeline.PREV_Y];else{let i=Animation_Animation.binarySearch(v,p,Animation_ShearTimeline.ENTRIES);A=v[i+Animation_ShearTimeline.PREV_X],S=v[i+Animation_ShearTimeline.PREV_Y];let m=v[i],_=this.getCurvePercent(i/Animation_ShearTimeline.ENTRIES-1,1-(p-m)/(v[i+Animation_ShearTimeline.PREV_TIME]-m));A+=(v[i+Animation_ShearTimeline.X]-A)*_,S+=(v[i+Animation_ShearTimeline.Y]-S)*_}switch(y){case G.setup:E.shearX=E.data.shearX+A*x,E.shearY=E.data.shearY+S*x;break;case G.first:case G.replace:E.shearX+=(E.data.shearX+A-E.shearX)*x,E.shearY+=(E.data.shearY+S-E.shearY)*x;break;case G.add:E.shearX+=A*x,E.shearY+=S*x}}};let es=class extends t7{constructor(i){super(i),this.frames=tr.newFloatArray(i*es.ENTRIES)}getPropertyId(){return 83886080+this.slotIndex}setFrame(i,m,p,_,x,y){i*=es.ENTRIES,this.frames[i]=m,this.frames[i+es.R]=p,this.frames[i+es.G]=_,this.frames[i+es.B]=x,this.frames[i+es.A]=y}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex],E=this.frames;if(p<E[0]){switch(y){case G.setup:v.color.setFromColor(v.data.color);break;case G.first:let i=v.color,m=v.data.color;i.add((m.r-i.r)*x,(m.g-i.g)*x,(m.b-i.b)*x,(m.a-i.a)*x)}return}let A=0,S=0,I=0,R=0;if(p>=E[E.length-es.ENTRIES]){let i=E.length;A=E[i+es.PREV_R],S=E[i+es.PREV_G],I=E[i+es.PREV_B],R=E[i+es.PREV_A]}else{let i=Animation_Animation.binarySearch(E,p,es.ENTRIES);A=E[i+es.PREV_R],S=E[i+es.PREV_G],I=E[i+es.PREV_B],R=E[i+es.PREV_A];let m=E[i],_=this.getCurvePercent(i/es.ENTRIES-1,1-(p-m)/(E[i+es.PREV_TIME]-m));A+=(E[i+es.R]-A)*_,S+=(E[i+es.G]-S)*_,I+=(E[i+es.B]-I)*_,R+=(E[i+es.A]-R)*_}if(1==x)v.color.set(A,S,I,R);else{let i=v.color;y==G.setup&&i.setFromColor(v.data.color),i.add((A-i.r)*x,(S-i.g)*x,(I-i.b)*x,(R-i.a)*x)}}},en=es;en.ENTRIES=5,en.PREV_TIME=-5,en.PREV_R=-4,en.PREV_G=-3,en.PREV_B=-2,en.PREV_A=-1,en.R=1,en.G=2,en.B=3,en.A=4;let ea=class extends t7{constructor(i){super(i),this.frames=tr.newFloatArray(i*ea.ENTRIES)}getPropertyId(){return 234881024+this.slotIndex}setFrame(i,m,p,_,x,y,T,v,E){i*=ea.ENTRIES,this.frames[i]=m,this.frames[i+ea.R]=p,this.frames[i+ea.G]=_,this.frames[i+ea.B]=x,this.frames[i+ea.A]=y,this.frames[i+ea.R2]=T,this.frames[i+ea.G2]=v,this.frames[i+ea.B2]=E}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex],E=this.frames;if(p<E[0]){switch(y){case G.setup:v.color.setFromColor(v.data.color),v.darkColor.setFromColor(v.data.darkColor);break;case G.first:let i=v.color,m=v.darkColor,p=v.data.color,_=v.data.darkColor;i.add((p.r-i.r)*x,(p.g-i.g)*x,(p.b-i.b)*x,(p.a-i.a)*x),m.add((_.r-m.r)*x,(_.g-m.g)*x,(_.b-m.b)*x,0)}return}let A=0,S=0,I=0,R=0,C=0,P=0,k=0;if(p>=E[E.length-ea.ENTRIES]){let i=E.length;A=E[i+ea.PREV_R],S=E[i+ea.PREV_G],I=E[i+ea.PREV_B],R=E[i+ea.PREV_A],C=E[i+ea.PREV_R2],P=E[i+ea.PREV_G2],k=E[i+ea.PREV_B2]}else{let i=Animation_Animation.binarySearch(E,p,ea.ENTRIES);A=E[i+ea.PREV_R],S=E[i+ea.PREV_G],I=E[i+ea.PREV_B],R=E[i+ea.PREV_A],C=E[i+ea.PREV_R2],P=E[i+ea.PREV_G2],k=E[i+ea.PREV_B2];let m=E[i],_=this.getCurvePercent(i/ea.ENTRIES-1,1-(p-m)/(E[i+ea.PREV_TIME]-m));A+=(E[i+ea.R]-A)*_,S+=(E[i+ea.G]-S)*_,I+=(E[i+ea.B]-I)*_,R+=(E[i+ea.A]-R)*_,C+=(E[i+ea.R2]-C)*_,P+=(E[i+ea.G2]-P)*_,k+=(E[i+ea.B2]-k)*_}if(1==x)v.color.set(A,S,I,R),v.darkColor.set(C,P,k,1);else{let i=v.color,m=v.darkColor;y==G.setup&&(i.setFromColor(v.data.color),m.setFromColor(v.data.darkColor)),i.add((A-i.r)*x,(S-i.g)*x,(I-i.b)*x,(R-i.a)*x),m.add((C-m.r)*x,(P-m.g)*x,(k-m.b)*x,0)}}},eo=ea;eo.ENTRIES=8,eo.PREV_TIME=-8,eo.PREV_R=-7,eo.PREV_G=-6,eo.PREV_B=-5,eo.PREV_A=-4,eo.PREV_R2=-3,eo.PREV_G2=-2,eo.PREV_B2=-1,eo.R=1,eo.G=2,eo.B=3,eo.A=4,eo.R2=5,eo.G2=6,eo.B2=7;let Animation_AttachmentTimeline=class Animation_AttachmentTimeline{constructor(i){this.frames=tr.newFloatArray(i),this.attachmentNames=Array(i)}getPropertyId(){return 67108864+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(i,m,p){this.frames[i]=m,this.attachmentNames[i]=p}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(T==W.mixOut&&y==G.setup){let m=v.data.attachmentName;v.setAttachment(null==m?null:i.getAttachment(this.slotIndex,m));return}let E=this.frames;if(p<E[0]){if(y==G.setup||y==G.first){let m=v.data.attachmentName;v.setAttachment(null==m?null:i.getAttachment(this.slotIndex,m))}return}let A=0;A=p>=E[E.length-1]?E.length-1:Animation_Animation.binarySearch(E,p,1)-1;let S=this.attachmentNames[A];i.slots[this.slotIndex].setAttachment(null==S?null:i.getAttachment(this.slotIndex,S))}};let el=null;let Animation_DeformTimeline=class Animation_DeformTimeline extends t7{constructor(i){super(i),this.frames=tr.newFloatArray(i),this.frameVertices=Array(i),null==el&&(el=tr.newFloatArray(64))}getPropertyId(){return 805306368+Number(this.attachment.id)+this.slotIndex}setFrame(i,m,p){this.frames[i]=m,this.frameVertices[i]=p}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex],E=v.getAttachment();if(!(E instanceof t2)||!E.applyDeform(this.attachment))return;let A=v.attachmentVertices;0==A.length&&(y=G.setup);let S=this.frameVertices,I=S[0].length,R=this.frames;if(p<R[0]){switch(y){case G.setup:A.length=0;break;case G.first:if(1==x){A.length=0;break}let i=tr.setArraySize(A,I);if(null==E.bones){let m=E.vertices;for(let p=0;p<I;p++)i[p]+=(m[p]-i[p])*x}else{x=1-x;for(let m=0;m<I;m++)i[m]*=x}}return}let C=tr.setArraySize(A,I);if(p>=R[R.length-1]){let i=S[R.length-1];if(1==x){if(y==G.add){if(null==E.bones){let m=E.vertices;for(let p=0;p<I;p++)C[p]+=i[p]-m[p]}else for(let m=0;m<I;m++)C[m]+=i[m]}else tr.arrayCopy(i,0,C,0,I)}else switch(y){case G.setup:if(null==E.bones){let m=E.vertices;for(let p=0;p<I;p++){let _=m[p];C[p]=_+(i[p]-_)*x}}else for(let m=0;m<I;m++)C[m]=i[m]*x;break;case G.first:case G.replace:for(let m=0;m<I;m++)C[m]+=(i[m]-C[m])*x;case G.add:if(null==E.bones){let m=E.vertices;for(let p=0;p<I;p++)C[p]+=(i[p]-m[p])*x}else for(let m=0;m<I;m++)C[m]+=i[m]*x}return}let P=Animation_Animation.binarySearch(R,p),k=S[P-1],B=S[P],D=R[P],F=this.getCurvePercent(P-1,1-(p-D)/(R[P-1]-D));if(1==x){if(y==G.add){if(null==E.bones){let i=E.vertices;for(let m=0;m<I;m++){let p=k[m];C[m]+=p+(B[m]-p)*F-i[m]}}else for(let i=0;i<I;i++){let m=k[i];C[i]+=m+(B[i]-m)*F}}else for(let i=0;i<I;i++){let m=k[i];C[i]=m+(B[i]-m)*F}}else switch(y){case G.setup:if(null==E.bones){let i=E.vertices;for(let m=0;m<I;m++){let p=k[m],_=i[m];C[m]=_+(p+(B[m]-p)*F-_)*x}}else for(let i=0;i<I;i++){let m=k[i];C[i]=(m+(B[i]-m)*F)*x}break;case G.first:case G.replace:for(let i=0;i<I;i++){let m=k[i];C[i]+=(m+(B[i]-m)*F-C[i])*x}break;case G.add:if(null==E.bones){let i=E.vertices;for(let m=0;m<I;m++){let p=k[m];C[m]+=(p+(B[m]-p)*F-i[m])*x}}else for(let i=0;i<I;i++){let m=k[i];C[i]+=(m+(B[i]-m)*F)*x}}}};let Animation_EventTimeline=class Animation_EventTimeline{constructor(i){this.frames=tr.newFloatArray(i),this.events=Array(i)}getPropertyId(){return 117440512}getFrameCount(){return this.frames.length}setFrame(i,m){this.frames[i]=m.time,this.events[i]=m}apply(i,m,p,_,x,y,T){if(null==_)return;let v=this.frames,E=this.frames.length;if(m>p)this.apply(i,m,Number.MAX_VALUE,_,x,y,T),m=-1;else if(m>=v[E-1])return;if(p<v[0])return;let A=0;if(m<v[0])A=0;else{A=Animation_Animation.binarySearch(v,m);let i=v[A];for(;A>0&&v[A-1]==i;)A--}for(;A<E&&p>=v[A];A++)_.push(this.events[A])}};let Animation_DrawOrderTimeline=class Animation_DrawOrderTimeline{constructor(i){this.frames=tr.newFloatArray(i),this.drawOrders=Array(i)}getPropertyId(){return 134217728}getFrameCount(){return this.frames.length}setFrame(i,m,p){this.frames[i]=m,this.drawOrders[i]=p}apply(i,m,p,_,x,y,T){let v=i.drawOrder,E=i.slots;if(T==W.mixOut&&y==G.setup){tr.arrayCopy(i.slots,0,i.drawOrder,0,i.slots.length);return}let A=this.frames;if(p<A[0]){(y==G.setup||y==G.first)&&tr.arrayCopy(i.slots,0,i.drawOrder,0,i.slots.length);return}let S=0;S=p>=A[A.length-1]?A.length-1:Animation_Animation.binarySearch(A,p)-1;let I=this.drawOrders[S];if(null==I)tr.arrayCopy(E,0,v,0,E.length);else for(let i=0,m=I.length;i<m;i++)v[i]=E[I[i]]}};let eh=class extends t7{constructor(i){super(i),this.frames=tr.newFloatArray(i*eh.ENTRIES)}getPropertyId(){return 150994944+this.ikConstraintIndex}setFrame(i,m,p,_,x,y){i*=eh.ENTRIES,this.frames[i]=m,this.frames[i+eh.MIX]=p,this.frames[i+eh.BEND_DIRECTION]=_,this.frames[i+eh.COMPRESS]=x?1:0,this.frames[i+eh.STRETCH]=y?1:0}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.ikConstraints[this.ikConstraintIndex];if(p<v[0]){switch(y){case G.setup:E.mix=E.data.mix,E.bendDirection=E.data.bendDirection,E.compress=E.data.compress,E.stretch=E.data.stretch;break;case G.first:E.mix+=(E.data.mix-E.mix)*x,E.bendDirection=E.data.bendDirection,E.compress=E.data.compress,E.stretch=E.data.stretch}return}if(p>=v[v.length-eh.ENTRIES]){y==G.setup?(E.mix=E.data.mix+(v[v.length+eh.PREV_MIX]-E.data.mix)*x,T==W.mixOut?(E.bendDirection=E.data.bendDirection,E.compress=E.data.compress,E.stretch=E.data.stretch):(E.bendDirection=v[v.length+eh.PREV_BEND_DIRECTION],E.compress=0!=v[v.length+eh.PREV_COMPRESS],E.stretch=0!=v[v.length+eh.PREV_STRETCH])):(E.mix+=(v[v.length+eh.PREV_MIX]-E.mix)*x,T==W.mixIn&&(E.bendDirection=v[v.length+eh.PREV_BEND_DIRECTION],E.compress=0!=v[v.length+eh.PREV_COMPRESS],E.stretch=0!=v[v.length+eh.PREV_STRETCH]));return}let A=Animation_Animation.binarySearch(v,p,eh.ENTRIES),S=v[A+eh.PREV_MIX],I=v[A],R=this.getCurvePercent(A/eh.ENTRIES-1,1-(p-I)/(v[A+eh.PREV_TIME]-I));y==G.setup?(E.mix=E.data.mix+(S+(v[A+eh.MIX]-S)*R-E.data.mix)*x,T==W.mixOut?(E.bendDirection=E.data.bendDirection,E.compress=E.data.compress,E.stretch=E.data.stretch):(E.bendDirection=v[A+eh.PREV_BEND_DIRECTION],E.compress=0!=v[A+eh.PREV_COMPRESS],E.stretch=0!=v[A+eh.PREV_STRETCH])):(E.mix+=(S+(v[A+eh.MIX]-S)*R-E.mix)*x,T==W.mixIn&&(E.bendDirection=v[A+eh.PREV_BEND_DIRECTION],E.compress=0!=v[A+eh.PREV_COMPRESS],E.stretch=0!=v[A+eh.PREV_STRETCH]))}},eu=eh;eu.ENTRIES=5,eu.PREV_TIME=-5,eu.PREV_MIX=-4,eu.PREV_BEND_DIRECTION=-3,eu.PREV_COMPRESS=-2,eu.PREV_STRETCH=-1,eu.MIX=1,eu.BEND_DIRECTION=2,eu.COMPRESS=3,eu.STRETCH=4;let ed=class extends t7{constructor(i){super(i),this.frames=tr.newFloatArray(i*ed.ENTRIES)}getPropertyId(){return 167772160+this.transformConstraintIndex}setFrame(i,m,p,_,x,y){i*=ed.ENTRIES,this.frames[i]=m,this.frames[i+ed.ROTATE]=p,this.frames[i+ed.TRANSLATE]=_,this.frames[i+ed.SCALE]=x,this.frames[i+ed.SHEAR]=y}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.transformConstraints[this.transformConstraintIndex];if(p<v[0]){let i=E.data;switch(y){case G.setup:E.rotateMix=i.rotateMix,E.translateMix=i.translateMix,E.scaleMix=i.scaleMix,E.shearMix=i.shearMix;break;case G.first:E.rotateMix+=(i.rotateMix-E.rotateMix)*x,E.translateMix+=(i.translateMix-E.translateMix)*x,E.scaleMix+=(i.scaleMix-E.scaleMix)*x,E.shearMix+=(i.shearMix-E.shearMix)*x}return}let A=0,S=0,I=0,R=0;if(p>=v[v.length-ed.ENTRIES]){let i=v.length;A=v[i+ed.PREV_ROTATE],S=v[i+ed.PREV_TRANSLATE],I=v[i+ed.PREV_SCALE],R=v[i+ed.PREV_SHEAR]}else{let i=Animation_Animation.binarySearch(v,p,ed.ENTRIES);A=v[i+ed.PREV_ROTATE],S=v[i+ed.PREV_TRANSLATE],I=v[i+ed.PREV_SCALE],R=v[i+ed.PREV_SHEAR];let m=v[i],_=this.getCurvePercent(i/ed.ENTRIES-1,1-(p-m)/(v[i+ed.PREV_TIME]-m));A+=(v[i+ed.ROTATE]-A)*_,S+=(v[i+ed.TRANSLATE]-S)*_,I+=(v[i+ed.SCALE]-I)*_,R+=(v[i+ed.SHEAR]-R)*_}if(y==G.setup){let i=E.data;E.rotateMix=i.rotateMix+(A-i.rotateMix)*x,E.translateMix=i.translateMix+(S-i.translateMix)*x,E.scaleMix=i.scaleMix+(I-i.scaleMix)*x,E.shearMix=i.shearMix+(R-i.shearMix)*x}else E.rotateMix+=(A-E.rotateMix)*x,E.translateMix+=(S-E.translateMix)*x,E.scaleMix+=(I-E.scaleMix)*x,E.shearMix+=(R-E.shearMix)*x}},ec=ed;ec.ENTRIES=5,ec.PREV_TIME=-5,ec.PREV_ROTATE=-4,ec.PREV_TRANSLATE=-3,ec.PREV_SCALE=-2,ec.PREV_SHEAR=-1,ec.ROTATE=1,ec.TRANSLATE=2,ec.SCALE=3,ec.SHEAR=4;let em=class extends t7{constructor(i){super(i),this.frames=tr.newFloatArray(i*em.ENTRIES)}getPropertyId(){return 184549376+this.pathConstraintIndex}setFrame(i,m,p){i*=em.ENTRIES,this.frames[i]=m,this.frames[i+em.VALUE]=p}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.pathConstraints[this.pathConstraintIndex];if(p<v[0]){switch(y){case G.setup:E.position=E.data.position;break;case G.first:E.position+=(E.data.position-E.position)*x}return}let A=0;if(p>=v[v.length-em.ENTRIES])A=v[v.length+em.PREV_VALUE];else{let i=Animation_Animation.binarySearch(v,p,em.ENTRIES);A=v[i+em.PREV_VALUE];let m=v[i],_=this.getCurvePercent(i/em.ENTRIES-1,1-(p-m)/(v[i+em.PREV_TIME]-m));A+=(v[i+em.VALUE]-A)*_}y==G.setup?E.position=E.data.position+(A-E.data.position)*x:E.position+=(A-E.position)*x}},ef=em;ef.ENTRIES=2,ef.PREV_TIME=-2,ef.PREV_VALUE=-1,ef.VALUE=1;let Animation_PathConstraintSpacingTimeline=class Animation_PathConstraintSpacingTimeline extends ef{constructor(i){super(i)}getPropertyId(){return 201326592+this.pathConstraintIndex}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.pathConstraints[this.pathConstraintIndex];if(p<v[0]){switch(y){case G.setup:E.spacing=E.data.spacing;break;case G.first:E.spacing+=(E.data.spacing-E.spacing)*x}return}let A=0;if(p>=v[v.length-Animation_PathConstraintSpacingTimeline.ENTRIES])A=v[v.length+Animation_PathConstraintSpacingTimeline.PREV_VALUE];else{let i=Animation_Animation.binarySearch(v,p,Animation_PathConstraintSpacingTimeline.ENTRIES);A=v[i+Animation_PathConstraintSpacingTimeline.PREV_VALUE];let m=v[i],_=this.getCurvePercent(i/Animation_PathConstraintSpacingTimeline.ENTRIES-1,1-(p-m)/(v[i+Animation_PathConstraintSpacingTimeline.PREV_TIME]-m));A+=(v[i+Animation_PathConstraintSpacingTimeline.VALUE]-A)*_}y==G.setup?E.spacing=E.data.spacing+(A-E.data.spacing)*x:E.spacing+=(A-E.spacing)*x}};let ep=class extends t7{constructor(i){super(i),this.frames=tr.newFloatArray(i*ep.ENTRIES)}getPropertyId(){return 218103808+this.pathConstraintIndex}setFrame(i,m,p,_){i*=ep.ENTRIES,this.frames[i]=m,this.frames[i+ep.ROTATE]=p,this.frames[i+ep.TRANSLATE]=_}apply(i,m,p,_,x,y,T){let v=this.frames,E=i.pathConstraints[this.pathConstraintIndex];if(p<v[0]){switch(y){case G.setup:E.rotateMix=E.data.rotateMix,E.translateMix=E.data.translateMix;break;case G.first:E.rotateMix+=(E.data.rotateMix-E.rotateMix)*x,E.translateMix+=(E.data.translateMix-E.translateMix)*x}return}let A=0,S=0;if(p>=v[v.length-ep.ENTRIES])A=v[v.length+ep.PREV_ROTATE],S=v[v.length+ep.PREV_TRANSLATE];else{let i=Animation_Animation.binarySearch(v,p,ep.ENTRIES);A=v[i+ep.PREV_ROTATE],S=v[i+ep.PREV_TRANSLATE];let m=v[i],_=this.getCurvePercent(i/ep.ENTRIES-1,1-(p-m)/(v[i+ep.PREV_TIME]-m));A+=(v[i+ep.ROTATE]-A)*_,S+=(v[i+ep.TRANSLATE]-S)*_}y==G.setup?(E.rotateMix=E.data.rotateMix+(A-E.data.rotateMix)*x,E.translateMix=E.data.translateMix+(S-E.data.translateMix)*x):(E.rotateMix+=(A-E.rotateMix)*x,E.translateMix+=(S-E.translateMix)*x)}},eg=ep;eg.ENTRIES=3,eg.PREV_TIME=-3,eg.PREV_ROTATE=-2,eg.PREV_TRANSLATE=-1,eg.ROTATE=1,eg.TRANSLATE=2;let e_=class{constructor(i){this.tracks=[],this.events=[],this.listeners=[],this.queue=new ev(this),this.propertyIDs=new IntSet,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new Pool(()=>new eb),this.data=i}update(i){i*=this.timeScale;let m=this.tracks;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(null==_)continue;_.animationLast=_.nextAnimationLast,_.trackLast=_.nextTrackLast;let x=i*_.timeScale;if(_.delay>0){if(_.delay-=x,_.delay>0)continue;x=-_.delay,_.delay=0}let y=_.next;if(null!=y){let m=_.trackLast-y.delay;if(m>=0){for(y.delay=0,y.trackTime=0==_.timeScale?0:(m/_.timeScale+i)*y.timeScale,_.trackTime+=x,this.setCurrent(p,y,!0);null!=y.mixingFrom;)y.mixTime+=i,y=y.mixingFrom;continue}}else if(_.trackLast>=_.trackEnd&&null==_.mixingFrom){m[p]=null,this.queue.end(_),this.disposeNext(_);continue}if(null!=_.mixingFrom&&this.updateMixingFrom(_,i)){let i=_.mixingFrom;for(_.mixingFrom=null,null!=i&&(i.mixingTo=null);null!=i;)this.queue.end(i),i=i.mixingFrom}_.trackTime+=x}this.queue.drain()}updateMixingFrom(i,m){let p=i.mixingFrom;if(null==p)return!0;let _=this.updateMixingFrom(p,m);return(p.animationLast=p.nextAnimationLast,p.trackLast=p.nextTrackLast,i.mixTime>0&&i.mixTime>=i.mixDuration)?((0==p.totalAlpha||0==i.mixDuration)&&(i.mixingFrom=p.mixingFrom,null!=p.mixingFrom&&(p.mixingFrom.mixingTo=i),i.interruptAlpha=p.interruptAlpha,this.queue.end(p)),_):(p.trackTime+=m*p.timeScale,i.mixTime+=m,!1)}apply(i){if(null==i)throw Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let m=this.events,p=this.tracks,_=!1;for(let x=0,y=p.length;x<y;x++){let y=p[x];if(null==y||y.delay>0)continue;_=!0;let T=0==x?G.first:y.mixBlend,v=y.alpha;null!=y.mixingFrom?v*=this.applyMixingFrom(y,i,T):y.trackTime>=y.trackEnd&&null==y.next&&(v=0);let E=y.animationLast,A=y.getAnimationTime(),S=y.animation.timelines.length,I=y.animation.timelines;if(0==x&&1==v||T==G.add)for(let p=0;p<S;p++)tr.webkit602BugfixHelper(v,T),I[p].apply(i,E,A,m,v,T,W.mixIn);else{let p=y.timelineMode,_=0==y.timelinesRotation.length;_&&tr.setArraySize(y.timelinesRotation,S<<1,null);let x=y.timelinesRotation;for(let y=0;y<S;y++){let S=I[y],R=p[y]==e_.SUBSEQUENT?T:G.setup;S instanceof ee?this.applyRotateTimeline(S,i,A,v,R,x,y<<1,_):(tr.webkit602BugfixHelper(v,T),S.apply(i,E,A,m,v,R,W.mixIn))}}this.queueEvents(y,A),m.length=0,y.nextAnimationLast=A,y.nextTrackLast=y.trackTime}return this.queue.drain(),_}applyMixingFrom(i,m,p){let _=i.mixingFrom;null!=_.mixingFrom&&this.applyMixingFrom(_,m,p);let x=0;0==i.mixDuration?(x=1,p==G.first&&(p=G.setup)):((x=i.mixTime/i.mixDuration)>1&&(x=1),p!=G.first&&(p=_.mixBlend));let y=x<_.eventThreshold?this.events:null,T=x<_.attachmentThreshold,v=x<_.drawOrderThreshold,E=_.animationLast,A=_.getAnimationTime(),S=_.animation.timelines.length,I=_.animation.timelines,R=_.alpha*i.interruptAlpha,C=R*(1-x);if(p==G.add)for(let i=0;i<S;i++)I[i].apply(m,E,A,y,C,p,W.mixOut);else{let i=_.timelineMode,x=_.timelineHoldMix,P=0==_.timelinesRotation.length;P&&tr.setArraySize(_.timelinesRotation,S<<1,null);let k=_.timelinesRotation;_.totalAlpha=0;for(let B=0;B<S;B++){let S;let D=I[B],F=W.mixOut,L=0;switch(i[B]){case e_.SUBSEQUENT:if(!T&&D instanceof Animation_AttachmentTimeline||!v&&D instanceof Animation_DrawOrderTimeline)continue;S=p,L=C;break;case e_.FIRST:S=G.setup,L=C;break;case e_.HOLD:S=G.setup,L=R;break;default:S=G.setup;let O=x[B];L=R*Math.max(0,1-O.mixTime/O.mixDuration)}_.totalAlpha+=L,D instanceof ee?this.applyRotateTimeline(D,m,A,L,S,k,B<<1,P):(tr.webkit602BugfixHelper(L,p),S==G.setup&&(D instanceof Animation_AttachmentTimeline?T&&(F=W.mixOut):D instanceof Animation_DrawOrderTimeline&&v&&(F=W.mixOut)),D.apply(m,E,A,y,L,S,F))}}return i.mixDuration>0&&this.queueEvents(_,A),this.events.length=0,_.nextAnimationLast=A,_.nextTrackLast=_.trackTime,x}applyRotateTimeline(i,m,p,_,x,y,T,v){if(v&&(y[T]=0),1==_){i.apply(m,0,p,null,1,x,W.mixIn);return}let E=i.frames,A=m.bones[i.boneIndex],S=0,I=0;if(p<E[0])switch(x){case G.setup:A.rotation=A.data.rotation;default:return;case G.first:S=A.rotation,I=A.data.rotation}else if(S=x==G.setup?A.data.rotation:A.rotation,p>=E[E.length-ee.ENTRIES])I=A.data.rotation+E[E.length+ee.PREV_ROTATION];else{let m=Animation_Animation.binarySearch(E,p,ee.ENTRIES),_=E[m+ee.PREV_ROTATION],x=E[m],y=i.getCurvePercent((m>>1)-1,1-(p-x)/(E[m+ee.PREV_TIME]-x));I=E[m+ee.ROTATION]-_,I-=(16384-(16384.499999999996-I/360|0))*360,I=_+I*y+A.data.rotation,I-=(16384-(16384.499999999996-I/360|0))*360}let R=0,C=I-S;if(0==(C-=(16384-(16384.499999999996-C/360|0))*360))R=y[T];else{let i=0,m=0;v?(i=0,m=C):(i=y[T],m=y[T+1]);let p=C>0,_=i>=0;te.signum(m)!=te.signum(C)&&90>=Math.abs(m)&&(Math.abs(i)>180&&(i+=360*te.signum(i)),_=p),R=C+i-i%360,_!=p&&(R+=360*te.signum(i)),y[T]=R}y[T+1]=C,S+=R*_,A.rotation=S-(16384-(16384.499999999996-S/360|0))*360}queueEvents(i,m){let p=i.animationStart,_=i.animationEnd,x=_-p,y=i.trackLast%x,T=this.events,v=0,E=T.length;for(;v<E;v++){let m=T[v];if(m.time<y)break;m.time>_||this.queue.event(i,m)}for((i.loop?0==x||y>i.trackTime%x:m>=_&&i.animationLast<_)&&this.queue.complete(i);v<E;v++){let m=T[v];m.time<p||this.queue.event(i,T[v])}}clearTracks(){let i=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let i=0,m=this.tracks.length;i<m;i++)this.clearTrack(i);this.tracks.length=0,this.queue.drainDisabled=i,this.queue.drain()}clearTrack(i){if(i>=this.tracks.length)return;let m=this.tracks[i];if(null==m)return;this.queue.end(m),this.disposeNext(m);let p=m;for(;;){let i=p.mixingFrom;if(null==i)break;this.queue.end(i),p.mixingFrom=null,p.mixingTo=null,p=i}this.tracks[m.trackIndex]=null,this.queue.drain()}setCurrent(i,m,p){let _=this.expandToIndex(i);this.tracks[i]=m,null!=_&&(p&&this.queue.interrupt(_),m.mixingFrom=_,_.mixingTo=m,m.mixTime=0,null!=_.mixingFrom&&_.mixDuration>0&&(m.interruptAlpha*=Math.min(1,_.mixTime/_.mixDuration)),_.timelinesRotation.length=0),this.queue.start(m)}setAnimation(i,m,p){let _=this.data.skeletonData.findAnimation(m);if(null==_)throw Error(`Animation not found: ${m}`);return this.setAnimationWith(i,_,p)}setAnimationWith(i,m,p){if(null==m)throw Error("animation cannot be null.");let _=!0,x=this.expandToIndex(i);null!=x&&(-1==x.nextTrackLast?(this.tracks[i]=x.mixingFrom,this.queue.interrupt(x),this.queue.end(x),this.disposeNext(x),x=x.mixingFrom,_=!1):this.disposeNext(x));let y=this.trackEntry(i,m,p,x);return this.setCurrent(i,y,_),this.queue.drain(),y}addAnimation(i,m,p,_){let x=this.data.skeletonData.findAnimation(m);if(null==x)throw Error(`Animation not found: ${m}`);return this.addAnimationWith(i,x,p,_)}addAnimationWith(i,m,p,_){if(null==m)throw Error("animation cannot be null.");let x=this.expandToIndex(i);if(null!=x)for(;null!=x.next;)x=x.next;let y=this.trackEntry(i,m,p,x);if(null==x)this.setCurrent(i,y,!0),this.queue.drain();else if(x.next=y,_<=0){let i=x.animationEnd-x.animationStart;0!=i?(x.loop?_+=i*(1+(x.trackTime/i|0)):_+=Math.max(i,x.trackTime),_-=this.data.getMix(x.animation,m)):_=x.trackTime}return y.delay=_,y}setEmptyAnimation(i,m){let p=this.setAnimationWith(i,e_.emptyAnimation,!1);return p.mixDuration=m,p.trackEnd=m,p}addEmptyAnimation(i,m,p){p<=0&&(p-=m);let _=this.addAnimationWith(i,e_.emptyAnimation,!1,p);return _.mixDuration=m,_.trackEnd=m,_}setEmptyAnimations(i){let m=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let m=0,p=this.tracks.length;m<p;m++){let p=this.tracks[m];null!=p&&this.setEmptyAnimation(p.trackIndex,i)}this.queue.drainDisabled=m,this.queue.drain()}expandToIndex(i){return i<this.tracks.length?this.tracks[i]:(tr.ensureArrayCapacity(this.tracks,i-this.tracks.length+1,null),this.tracks.length=i+1,null)}trackEntry(i,m,p,_){let x=this.trackEntryPool.obtain();return x.trackIndex=i,x.animation=m,x.loop=p,x.holdPrevious=!1,x.eventThreshold=0,x.attachmentThreshold=0,x.drawOrderThreshold=0,x.animationStart=0,x.animationEnd=m.duration,x.animationLast=-1,x.nextAnimationLast=-1,x.delay=0,x.trackTime=0,x.trackLast=-1,x.nextTrackLast=-1,x.trackEnd=Number.MAX_VALUE,x.timeScale=1,x.alpha=1,x.interruptAlpha=1,x.mixTime=0,x.mixDuration=null==_?0:this.data.getMix(_.animation,m),x}disposeNext(i){let m=i.next;for(;null!=m;)this.queue.dispose(m),m=m.next;i.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let i=0,m=this.tracks.length;i<m;i++){let m=this.tracks[i];if(null!=m){for(;null!=m.mixingFrom;)m=m.mixingFrom;do(null==m.mixingFrom||m.mixBlend!=G.add)&&this.setTimelineModes(m),m=m.mixingTo;while(null!=m)}}}setTimelineModes(i){let m=i.mixingTo,p=i.animation.timelines,_=i.animation.timelines.length,x=tr.setArraySize(i.timelineMode,_);i.timelineHoldMix.length=0;let y=tr.setArraySize(i.timelineHoldMix,_),T=this.propertyIDs;if(null!=m&&m.holdPrevious){for(let i=0;i<_;i++)T.add(p[i].getPropertyId()),x[i]=e_.HOLD;return}t:for(let v=0;v<_;v++){let _=p[v].getPropertyId();if(T.add(_)){if(null!=m&&this.hasTimeline(m,_)){for(let p=m.mixingTo;null!=p;p=p.mixingTo)if(!this.hasTimeline(p,_)){if(i.mixDuration>0){x[v]=e_.HOLD_MIX,y[v]=p;continue t}break}x[v]=e_.HOLD}else x[v]=e_.FIRST}else x[v]=e_.SUBSEQUENT}}hasTimeline(i,m){let p=i.animation.timelines;for(let i=0,_=p.length;i<_;i++)if(p[i].getPropertyId()==m)return!0;return!1}getCurrent(i){return i>=this.tracks.length?null:this.tracks[i]}addListener(i){if(null==i)throw Error("listener cannot be null.");this.listeners.push(i)}removeListener(i){let m=this.listeners.indexOf(i);m>=0&&this.listeners.splice(m,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(i,m,p){e_.deprecatedWarning1||(e_.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(i,m,p)}addAnimationByName(i,m,p,_){e_.deprecatedWarning2||(e_.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(i,m,p,_)}hasAnimation(i){let m=this.data.skeletonData.findAnimation(i);return null!==m}hasAnimationByName(i){return e_.deprecatedWarning3||(e_.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(i)}},ex=e_;ex.emptyAnimation=new Animation_Animation("<empty>",[],0),ex.SUBSEQUENT=0,ex.FIRST=1,ex.HOLD=2,ex.HOLD_MIX=3,ex.deprecatedWarning1=!1,ex.deprecatedWarning2=!1,ex.deprecatedWarning3=!1;let ey=class{constructor(){this.mixBlend=G.replace,this.timelineMode=[],this.timelineHoldMix=[],this.timelinesRotation=[]}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let i=this.animationEnd-this.animationStart;return 0==i?this.animationStart:this.trackTime%i+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(i){this.animationLast=i,this.nextAnimationLast=i}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return ey.deprecatedWarning1||(ey.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(i){ey.deprecatedWarning1||(ey.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=i}get endTime(){return ey.deprecatedWarning2||(ey.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(i){ey.deprecatedWarning2||(ey.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=i}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}},eb=ey;eb.deprecatedWarning1=!1,eb.deprecatedWarning2=!1;let eT=class{constructor(i){this.objects=[],this.drainDisabled=!1,this.animState=i}start(i){this.objects.push(eE.start),this.objects.push(i),this.animState.animationsChanged=!0}interrupt(i){this.objects.push(eE.interrupt),this.objects.push(i)}end(i){this.objects.push(eE.end),this.objects.push(i),this.animState.animationsChanged=!0}dispose(i){this.objects.push(eE.dispose),this.objects.push(i)}complete(i){this.objects.push(eE.complete),this.objects.push(i)}event(i,m){this.objects.push(eE.event),this.objects.push(i),this.objects.push(m)}deprecateStuff(){return eT.deprecatedWarning1||(eT.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let i=this.objects,m=this.animState.listeners;for(let p=0;p<i.length;p+=2){let _=i[p],x=i[p+1];switch(_){case eE.start:null!=x.listener&&x.listener.start&&x.listener.start(x);for(let i=0;i<m.length;i++)m[i].start&&m[i].start(x);x.onStart&&this.deprecateStuff()&&x.onStart(x.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(x.trackIndex);break;case eE.interrupt:null!=x.listener&&x.listener.interrupt&&x.listener.interrupt(x);for(let i=0;i<m.length;i++)m[i].interrupt&&m[i].interrupt(x);break;case eE.end:null!=x.listener&&x.listener.end&&x.listener.end(x);for(let i=0;i<m.length;i++)m[i].end&&m[i].end(x);x.onEnd&&this.deprecateStuff()&&x.onEnd(x.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(x.trackIndex);case eE.dispose:null!=x.listener&&x.listener.dispose&&x.listener.dispose(x);for(let i=0;i<m.length;i++)m[i].dispose&&m[i].dispose(x);this.animState.trackEntryPool.free(x);break;case eE.complete:null!=x.listener&&x.listener.complete&&x.listener.complete(x);for(let i=0;i<m.length;i++)m[i].complete&&m[i].complete(x);let y=te.toInt(x.loopsCount());x.onComplete&&this.deprecateStuff()&&x.onComplete(x.trackIndex,y),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(x.trackIndex,y);break;case eE.event:let T=i[p+++2];null!=x.listener&&x.listener.event&&x.listener.event(x,T);for(let i=0;i<m.length;i++)m[i].event&&m[i].event(x,T);x.onEvent&&this.deprecateStuff()&&x.onEvent(x.trackIndex,T),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(x.trackIndex,T)}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}},ev=eT;ev.deprecatedWarning1=!1;var eE=((k=eE||{})[k.start=0]="start",k[k.interrupt=1]="interrupt",k[k.end=2]="end",k[k.dispose=3]="dispose",k[k.complete=4]="complete",k[k.event=5]="event",k);let AnimationStateAdapter2=class AnimationStateAdapter2{start(i){}interrupt(i){}end(i){}dispose(i){}complete(i){}event(i,m){}};let eA=class{constructor(i){if(this.animationToMixTime={},this.defaultMix=0,null==i)throw Error("skeletonData cannot be null.");this.skeletonData=i}setMix(i,m,p){let _=this.skeletonData.findAnimation(i);if(null==_)throw Error(`Animation not found: ${i}`);let x=this.skeletonData.findAnimation(m);if(null==x)throw Error(`Animation not found: ${m}`);this.setMixWith(_,x,p)}setMixByName(i,m,p){eA.deprecatedWarning1||(eA.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(i,m,p)}setMixWith(i,m,p){if(null==i)throw Error("from cannot be null.");if(null==m)throw Error("to cannot be null.");let _=`${i.name}.${m.name}`;this.animationToMixTime[_]=p}getMix(i,m){let p=`${i.name}.${m.name}`,_=this.animationToMixTime[p];return void 0===_?this.defaultMix:_}},eS=eA;eS.deprecatedWarning1=!1;let AtlasAttachmentLoader_AtlasAttachmentLoader=class AtlasAttachmentLoader_AtlasAttachmentLoader{constructor(i){this.atlas=i}newRegionAttachment(i,m,p){let _=this.atlas.findRegion(p);if(null==_)throw Error(`Region not found in atlas: ${p} (region attachment: ${m})`);let x=new t4(m);return x.region=_,x}newMeshAttachment(i,m,p){let _=this.atlas.findRegion(p);if(null==_)throw Error(`Region not found in atlas: ${p} (mesh attachment: ${m})`);let x=new MeshAttachment_MeshAttachment(m);return x.region=_,x}newBoundingBoxAttachment(i,m){return new BoundingBoxAttachment_BoundingBoxAttachment(m)}newPathAttachment(i,m){return new PathAttachment_PathAttachment(m)}newPointAttachment(i,m){return new PointAttachment_PointAttachment(m)}newClippingAttachment(i,m){return new ClippingAttachment_ClippingAttachment(m)}};let Bone_Bone=class Bone_Bone{constructor(i,m,p){if(this.matrix=new K.y3,this.children=[],this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!0,null==i)throw Error("data cannot be null.");if(null==m)throw Error("skeleton cannot be null.");this.data=i,this.skeleton=m,this.parent=p,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(i,m,p,_,x,y,T){this.ax=i,this.ay=m,this.arotation=p,this.ascaleX=_,this.ascaleY=x,this.ashearX=y,this.ashearY=T,this.appliedValid=!0;let v=this.parent,E=this.matrix,A=this.skeleton.scaleX,S=ti.yDown?-this.skeleton.scaleY:this.skeleton.scaleY;if(null==v){let v=this.skeleton,I=p+90+T;E.a=te.cosDeg(p+y)*_*A,E.c=te.cosDeg(I)*x*A,E.b=te.sinDeg(p+y)*_*S,E.d=te.sinDeg(I)*x*S,E.tx=i*A+v.x,E.ty=m*S+v.y;return}let I=v.matrix.a,R=v.matrix.c,C=v.matrix.b,P=v.matrix.d;switch(E.tx=I*i+R*m+v.matrix.tx,E.ty=C*i+P*m+v.matrix.ty,this.data.transformMode){case Z.Normal:{let i=p+90+T,m=te.cosDeg(p+y)*_,v=te.cosDeg(i)*x,A=te.sinDeg(p+y)*_,S=te.sinDeg(i)*x;E.a=I*m+R*A,E.c=I*v+R*S,E.b=C*m+P*A,E.d=C*v+P*S;return}case Z.OnlyTranslation:{let i=p+90+T;E.a=te.cosDeg(p+y)*_,E.c=te.cosDeg(i)*x,E.b=te.sinDeg(p+y)*_,E.d=te.sinDeg(i)*x;break}case Z.NoRotationOrReflection:{let i=I*I+C*C,m=0;i>1e-4?(i=Math.abs(I*P-R*C)/i,R=C*i,P=I*i,m=Math.atan2(C,I)*te.radDeg):(I=0,C=0,m=90-Math.atan2(P,R)*te.radDeg);let v=p+y-m,A=p+T-m+90,S=te.cosDeg(v)*_,k=te.cosDeg(A)*x,B=te.sinDeg(v)*_,D=te.sinDeg(A)*x;E.a=I*S-R*B,E.c=I*k-R*D,E.b=C*S+P*B,E.d=C*k+P*D;break}case Z.NoScale:case Z.NoScaleOrReflection:{let i=te.cosDeg(p),m=te.sinDeg(p),v=(I*i+R*m)/A,k=(C*i+P*m)/S,B=Math.sqrt(v*v+k*k);B>1e-5&&(B=1/B),v*=B,k*=B,B=Math.sqrt(v*v+k*k),this.data.transformMode==Z.NoScale&&I*P-R*C<0!=(ti.yDown?this.skeleton.scaleX<0!=this.skeleton.scaleY>0:this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(B=-B);let D=Math.PI/2+Math.atan2(k,v),F=Math.cos(D)*B,L=Math.sin(D)*B,O=te.cosDeg(y)*_,V=te.cosDeg(90+T)*x,U=te.sinDeg(y)*_,X=te.sinDeg(90+T)*x;E.a=v*O+F*U,E.c=v*V+F*X,E.b=k*O+L*U,E.d=k*V+L*X}}E.a*=A,E.c*=A,E.b*=S,E.d*=S}setToSetupPose(){let i=this.data;this.x=i.x,this.y=i.y,this.rotation=i.rotation,this.scaleX=i.scaleX,this.scaleY=i.scaleY,this.shearX=i.shearX,this.shearY=i.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*te.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*te.radDeg}getWorldScaleX(){let i=this.matrix;return Math.sqrt(i.a*i.a+i.c*i.c)}getWorldScaleY(){let i=this.matrix;return Math.sqrt(i.b*i.b+i.d*i.d)}updateAppliedTransform(){this.appliedValid=!0;let i=this.parent,m=this.matrix;if(null==i){this.ax=m.tx,this.ay=m.ty,this.arotation=Math.atan2(m.b,m.a)*te.radDeg,this.ascaleX=Math.sqrt(m.a*m.a+m.b*m.b),this.ascaleY=Math.sqrt(m.c*m.c+m.d*m.d),this.ashearX=0,this.ashearY=Math.atan2(m.a*m.c+m.b*m.d,m.a*m.d-m.b*m.c)*te.radDeg;return}let p=i.matrix,_=1/(p.a*p.d-p.b*p.c),x=m.tx-p.tx,y=m.ty-p.ty;this.ax=x*p.d*_-y*p.c*_,this.ay=y*p.a*_-x*p.b*_;let T=_*p.d,v=_*p.a,E=_*p.c,A=_*p.b,S=T*m.a-E*m.b,I=T*m.c-E*m.d,R=v*m.b-A*m.a,C=v*m.d-A*m.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(S*S+R*R),this.ascaleX>1e-4){let i=S*C-I*R;this.ascaleY=i/this.ascaleX,this.ashearY=Math.atan2(S*I+R*C,i)*te.radDeg,this.arotation=Math.atan2(R,S)*te.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(I*I+C*C),this.ashearY=0,this.arotation=90-Math.atan2(C,I)*te.radDeg}worldToLocal(i){let m=this.matrix,p=m.a,_=m.c,x=m.b,y=m.d,T=1/(p*y-_*x),v=i.x-m.tx,E=i.y-m.ty;return i.x=v*y*T-E*_*T,i.y=E*p*T-v*x*T,i}localToWorld(i){let m=this.matrix,p=i.x,_=i.y;return i.x=p*m.a+_*m.c+m.tx,i.y=p*m.b+_*m.d+m.ty,i}worldToLocalRotation(i){let m=te.sinDeg(i),p=te.cosDeg(i),_=this.matrix;return Math.atan2(_.a*m-_.b*p,_.d*p-_.c*m)*te.radDeg}localToWorldRotation(i){let m=te.sinDeg(i),p=te.cosDeg(i),_=this.matrix;return Math.atan2(p*_.b+m*_.d,p*_.a+m*_.c)*te.radDeg}rotateWorld(i){let m=this.matrix,p=m.a,_=m.c,x=m.b,y=m.d,T=te.cosDeg(i),v=te.sinDeg(i);m.a=T*p-v*x,m.c=T*_-v*y,m.b=v*p+T*x,m.d=v*_+T*y,this.appliedValid=!1}};let BoneData_BoneData=class BoneData_BoneData{constructor(i,m,p){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Z.Normal,i<0)throw Error("index must be >= 0.");if(null==m)throw Error("name cannot be null.");this.index=i,this.name=m,this.parent=p}};let Event_Event=class Event_Event{constructor(i,m){if(null==m)throw Error("data cannot be null.");this.time=i,this.data=m}};let EventData_EventData=class EventData_EventData{constructor(i){this.name=i}};let IkConstraint_IkConstraint=class IkConstraint_IkConstraint{constructor(i,m){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,null==i)throw Error("data cannot be null.");if(null==m)throw Error("skeleton cannot be null.");this.data=i,this.mix=i.mix,this.bendDirection=i.bendDirection,this.compress=i.compress,this.stretch=i.stretch,this.bones=[];for(let p=0;p<i.bones.length;p++)this.bones.push(m.findBone(i.bones[p].name));this.target=m.findBone(i.target.name)}getOrder(){return this.data.order}apply(){this.update()}update(){let i=this.target,m=this.bones;switch(m.length){case 1:this.apply1(m[0],i.worldX,i.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(m[0],m[1],i.worldX,i.worldY,this.bendDirection,this.stretch,this.mix)}}apply1(i,m,p,_,x,y,T){i.appliedValid||i.updateAppliedTransform();let v=i.parent.matrix,E=1/(v.a*v.d-v.b*v.c),A=m-v.tx,S=p-v.ty,I=(A*v.d-S*v.c)*E-i.ax,R=(S*v.a-A*v.b)*E-i.ay,C=Math.atan2(R,I)*te.radDeg-i.ashearX-i.arotation;i.ascaleX<0&&(C+=180),C>180?C-=360:C<-180&&(C+=360);let P=i.ascaleX,k=i.ascaleY;if(_||x){let m=i.data.length*P,p=Math.sqrt(I*I+R*R);if(_&&p<m||x&&p>m&&m>1e-4){let i=(p/m-1)*T+1;P*=i,y&&(k*=i)}}i.updateWorldTransformWith(i.ax,i.ay,i.arotation+C*T,P,k,i.ashearX,i.ashearY)}apply2(i,m,p,_,x,y,T){if(0==T){m.updateWorldTransform();return}i.appliedValid||i.updateAppliedTransform(),m.appliedValid||m.updateAppliedTransform();let v=i.ax,E=i.ay,A=i.ascaleX,S=A,I=i.ascaleY,R=m.ascaleX,C=i.matrix,P=0,k=0,B=0;A<0?(A=-A,P=180,B=-1):(P=0,B=1),I<0&&(I=-I,B=-B),R<0?(R=-R,k=180):k=0;let D=m.ax,F=0,L=0,O=0,V=C.a,U=C.c,X=C.b,Y=C.d,G=1e-4>=Math.abs(A-I);G?(L=V*D+U*(F=m.ay)+C.tx,O=X*D+Y*F+C.ty):(F=0,L=V*D+C.tx,O=X*D+C.ty);let W=i.parent.matrix;V=W.a,U=W.c,X=W.b,Y=W.d;let z=1/(V*Y-U*X),j=p-W.tx,Z=_-W.ty,K=(j*Y-Z*U)*z-v,J=(Z*V-j*X)*z-E,Q=K*K+J*J;j=L-W.tx,Z=O-W.ty;let tt=(j*Y-Z*U)*z-v,tr=(Z*V-j*X)*z-E,ti=Math.sqrt(tt*tt+tr*tr),ts=m.data.length*R,tn=0,ta=0;t:if(G){let i=(Q-ti*ti-(ts*=A)*ts)/(2*ti*ts);i<-1?i=-1:i>1&&(i=1,y&&ti+ts>1e-4&&(S*=(Math.sqrt(Q)/(ti+ts)-1)*T+1)),ta=Math.acos(i)*x,tn=Math.atan2(J*(V=ti+ts*i)-K*(U=ts*Math.sin(ta)),K*V+J*U)}else{V=A*ts,U=I*ts;let i=V*V,m=U*U,p=Math.atan2(J,K);X=m*ti*ti+i*Q-i*m;let _=-2*m*ti,y=m-i;if((Y=_*_-4*y*X)>=0){let i=Math.sqrt(Y);_<0&&(i=-i),i=-(_+i)/2;let m=i/y,T=X/i,v=Math.abs(m)<Math.abs(T)?m:T;if(v*v<=Q){tn=p-Math.atan2(Z=Math.sqrt(Q-v*v)*x,v),ta=Math.atan2(Z/I,(v-ti)/A);break t}}let T=te.PI,v=ti-V,E=v*v,S=0,R=0,C=ti+V,P=C*C,k=0;(X=-V*ti/(i-m))>=-1&&X<=1&&((Y=(j=V*Math.cos(X=Math.acos(X))+ti)*j+(Z=U*Math.sin(X))*Z)<E&&(T=X,E=Y,v=j,S=Z),Y>P&&(R=X,P=Y,C=j,k=Z)),Q<=(E+P)/2?(tn=p-Math.atan2(S*x,v),ta=T*x):(tn=p-Math.atan2(k*x,C),ta=R*x)}let to=Math.atan2(F,D)*B,tl=i.arotation;(tn=(tn-to)*te.radDeg+P-tl)>180?tn-=360:tn<-180&&(tn+=360),i.updateWorldTransformWith(v,E,tl+tn*T,S,i.ascaleY,0,0),tl=m.arotation,(ta=((ta+to)*te.radDeg-m.ashearX)*B+k-tl)>180?ta-=360:ta<-180&&(ta+=360),m.updateWorldTransformWith(D,F,tl+ta*T,m.ascaleX,m.ascaleY,m.ashearX,m.ashearY)}};let IkConstraintData_IkConstraintData=class IkConstraintData_IkConstraintData{constructor(i){this.order=0,this.bones=[],this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.name=i}};let PathConstraintData_PathConstraintData=class PathConstraintData_PathConstraintData{constructor(i){this.order=0,this.bones=[],this.name=i}};var ew=((B=ew||{})[B.Length=0]="Length",B[B.Fixed=1]="Fixed",B[B.Percent=2]="Percent",B);let eI=class{constructor(i,m){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=[],this.positions=[],this.world=[],this.curves=[],this.lengths=[],this.segments=[],null==i)throw Error("data cannot be null.");if(null==m)throw Error("skeleton cannot be null.");this.data=i,this.bones=[];for(let p=0,_=i.bones.length;p<_;p++)this.bones.push(m.findBone(i.bones[p].name));this.target=m.findSlot(i.target.name),this.position=i.position,this.spacing=i.spacing,this.rotateMix=i.rotateMix,this.translateMix=i.translateMix}apply(){this.update()}update(){let i=this.target.getAttachment();if(!(i instanceof PathAttachment_PathAttachment))return;let m=this.rotateMix,p=this.translateMix,_=m>0;if(!(p>0)&&!_)return;let x=this.data,y=x.spacingMode,T=y==ew.Length,v=x.rotateMode,E=v==j.Tangent,A=v==j.ChainScale,S=this.bones.length,I=E?S:S+1,R=this.bones,C=tr.setArraySize(this.spaces,I),P=null,k=this.spacing;if(A||T){A&&(P=tr.setArraySize(this.lengths,S));for(let i=0,m=I-1;i<m;){let m=R[i],p=m.data.length;if(p<eI.epsilon)A&&(P[i]=0),C[++i]=0;else{let _=p*m.matrix.a,x=p*m.matrix.b,y=Math.sqrt(_*_+x*x);A&&(P[i]=y),C[++i]=(T?p+k:k)*y/p}}}else for(let i=1;i<I;i++)C[i]=k;let B=this.computeWorldPositions(i,I,E,x.positionMode==z.Percent,y==ew.Percent),D=B[0],F=B[1],L=x.offsetRotation,O=!1;if(0==L)O=v==j.Chain;else{O=!1;let i=this.target.bone.matrix;L*=i.a*i.d-i.b*i.c>0?te.degRad:-te.degRad}for(let i=0,x=3;i<S;i++,x+=3){let y=R[i],T=y.matrix;T.tx+=(D-T.tx)*p,T.ty+=(F-T.ty)*p;let v=B[x],S=B[x+1],I=v-D,k=S-F;if(A){let p=P[i];if(0!=p){let i=(Math.sqrt(I*I+k*k)/p-1)*m+1;T.a*=i,T.b*=i}}if(D=v,F=S,_){let p=T.a,_=T.c,v=T.b,A=T.d,S=0,R=0,P=0;if(E&&(S=E?B[x-1]:0==C[i+1]?B[x+2]:Math.atan2(k,I)),S-=Math.atan2(v,p),O){R=Math.cos(S),P=Math.sin(S);let i=y.data.length;D+=(i*(R*p-P*v)-I)*m,F+=(i*(P*p+R*v)-k)*m}else S+=L;S>te.PI?S-=te.PI2:S<-te.PI&&(S+=te.PI2),S*=m,R=Math.cos(S),P=Math.sin(S),T.a=R*p-P*v,T.c=R*_-P*A,T.b=P*p+R*v,T.d=P*_+R*A}y.appliedValid=!1}}computeWorldPositions(i,m,p,_,x){let y=this.target,T=this.position,v=this.spaces,E=tr.setArraySize(this.positions,3*m+2),A=null,S=i.closed,I=i.worldVerticesLength,R=I/6,C=eI.NONE;if(!i.constantSpeed){let P=i.lengths;R-=S?1:2;let k=P[R];if(_&&(T*=k),x)for(let i=0;i<m;i++)v[i]*=k;A=tr.setArraySize(this.world,8);for(let _=0,x=0,B=0;_<m;_++,x+=3){let m=v[_],D=T+=m;if(S)(D%=k)<0&&(D+=k),B=0;else if(D<0){C!=eI.BEFORE&&(C=eI.BEFORE,i.computeWorldVertices(y,2,4,A,0,2)),this.addBeforePosition(D,A,0,E,x);continue}else if(D>k){C!=eI.AFTER&&(C=eI.AFTER,i.computeWorldVertices(y,I-6,4,A,0,2)),this.addAfterPosition(D-k,A,0,E,x);continue}for(;;B++){let i=P[B];if(!(D>i)){if(0==B)D/=i;else{let m=P[B-1];D=(D-m)/(i-m)}break}}B!=C&&(C=B,S&&B==R?(i.computeWorldVertices(y,I-4,4,A,0,2),i.computeWorldVertices(y,0,4,A,4,2)):i.computeWorldVertices(y,6*B+2,8,A,0,2)),this.addCurvePosition(D,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],E,x,p||_>0&&0==m)}return E}S?(I+=2,A=tr.setArraySize(this.world,I),i.computeWorldVertices(y,2,I-4,A,0,2),i.computeWorldVertices(y,0,2,A,I-4,2),A[I-2]=A[0],A[I-1]=A[1]):(R--,I-=4,A=tr.setArraySize(this.world,I),i.computeWorldVertices(y,2,I,A,0,2));let P=tr.setArraySize(this.curves,R),k=0,B=A[0],D=A[1],F=0,L=0,O=0,V=0,U=0,X=0,Y=0,G=0,W=0,z=0,j=0,Z=0,K=0,J=0;for(let i=0,m=2;i<R;i++,m+=6)F=A[m],L=A[m+1],O=A[m+2],V=A[m+3],U=A[m+4],X=A[m+5],Y=(B-2*F+O)*.1875,G=(D-2*L+V)*.1875,W=((F-O)*3-B+U)*.09375,z=((L-V)*3-D+X)*.09375,j=2*Y+W,Z=2*G+z,k+=Math.sqrt((K=(F-B)*.75+Y+.16666667*W)*K+(J=(L-D)*.75+G+.16666667*z)*J),K+=j,J+=Z,j+=W,Z+=z,k+=Math.sqrt(K*K+J*J),K+=j,J+=Z,k+=Math.sqrt(K*K+J*J),K+=j+W,J+=Z+z,k+=Math.sqrt(K*K+J*J),P[i]=k,B=U,D=X;if(_&&(T*=k),x)for(let i=0;i<m;i++)v[i]*=k;let Q=this.segments,tt=0;for(let i=0,_=0,x=0,y=0;i<m;i++,_+=3){let m=v[i],R=T+=m;if(S)(R%=k)<0&&(R+=k),x=0;else if(R<0){this.addBeforePosition(R,A,0,E,_);continue}else if(R>k){this.addAfterPosition(R-k,A,I-4,E,_);continue}for(;;x++){let i=P[x];if(!(R>i)){if(0==x)R/=i;else{let m=P[x-1];R=(R-m)/(i-m)}break}}if(x!=C){C=x;let i=6*x;for(B=A[i],D=A[i+1],F=A[i+2],L=A[i+3],O=A[i+4],V=A[i+5],U=A[i+6],X=A[i+7],Y=(B-2*F+O)*.03,G=(D-2*L+V)*.03,W=((F-O)*3-B+U)*.006,z=((L-V)*3-D+X)*.006,j=2*Y+W,Z=2*G+z,tt=Math.sqrt((K=(F-B)*.3+Y+.16666667*W)*K+(J=(L-D)*.3+G+.16666667*z)*J),Q[0]=tt,i=1;i<8;i++)K+=j,J+=Z,j+=W,Z+=z,tt+=Math.sqrt(K*K+J*J),Q[i]=tt;K+=j,J+=Z,tt+=Math.sqrt(K*K+J*J),Q[8]=tt,K+=j+W,J+=Z+z,tt+=Math.sqrt(K*K+J*J),Q[9]=tt,y=0}for(R*=tt;;y++){let i=Q[y];if(!(R>i)){if(0==y)R/=i;else{let m=Q[y-1];R=y+(R-m)/(i-m)}break}}this.addCurvePosition(.1*R,B,D,F,L,O,V,U,X,E,_,p||i>0&&0==m)}return E}addBeforePosition(i,m,p,_,x){let y=m[p],T=m[p+1],v=m[p+2]-y,E=m[p+3]-T,A=Math.atan2(E,v);_[x]=y+i*Math.cos(A),_[x+1]=T+i*Math.sin(A),_[x+2]=A}addAfterPosition(i,m,p,_,x){let y=m[p+2],T=m[p+3],v=y-m[p],E=T-m[p+1],A=Math.atan2(E,v);_[x]=y+i*Math.cos(A),_[x+1]=T+i*Math.sin(A),_[x+2]=A}addCurvePosition(i,m,p,_,x,y,T,v,E,A,S,I){(0==i||isNaN(i))&&(i=1e-4);let R=i*i,C=R*i,P=1-i,k=P*P,B=k*P,D=P*i,F=3*D,L=P*F,O=F*i,V=m*B+_*L+y*O+v*C,U=p*B+x*L+T*O+E*C;A[S]=V,A[S+1]=U,I&&(A[S+2]=Math.atan2(U-(p*k+x*D*2+T*R),V-(m*k+_*D*2+y*R)))}getOrder(){return this.data.order}},eR=eI;eR.NONE=-1,eR.BEFORE=-2,eR.AFTER=-3,eR.epsilon=1e-5;let TransformConstraint_TransformConstraint=class TransformConstraint_TransformConstraint{constructor(i,m){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new Vector2,null==i)throw Error("data cannot be null.");if(null==m)throw Error("skeleton cannot be null.");this.data=i,this.rotateMix=i.rotateMix,this.translateMix=i.translateMix,this.scaleMix=i.scaleMix,this.shearMix=i.shearMix,this.bones=[];for(let p=0;p<i.bones.length;p++)this.bones.push(m.findBone(i.bones[p].name));this.target=m.findBone(i.target.name)}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){let i=this.rotateMix,m=this.translateMix,p=this.scaleMix,_=this.shearMix,x=this.target,y=x.matrix,T=y.a,v=y.c,E=y.b,A=y.d,S=T*A-v*E>0?te.degRad:-te.degRad,I=this.data.offsetRotation*S,R=this.data.offsetShearY*S,C=this.bones;for(let y=0,S=C.length;y<S;y++){let S=C[y],P=!1,k=S.matrix;if(0!=i){let m=k.a,p=k.c,_=k.b,x=k.d,y=Math.atan2(E,T)-Math.atan2(_,m)+I;y>te.PI?y-=te.PI2:y<-te.PI&&(y+=te.PI2),y*=i;let v=Math.cos(y),A=Math.sin(y);k.a=v*m-A*_,k.c=v*p-A*x,k.b=A*m+v*_,k.d=A*p+v*x,P=!0}if(0!=m){let i=this.temp;x.localToWorld(i.set(this.data.offsetX,this.data.offsetY)),k.tx+=(i.x-k.tx)*m,k.ty+=(i.y-k.ty)*m,P=!0}if(p>0){let i=Math.sqrt(k.a*k.a+k.b*k.b),m=Math.sqrt(T*T+E*E);i>1e-5&&(i=(i+(m-i+this.data.offsetScaleX)*p)/i),k.a*=i,k.b*=i,i=Math.sqrt(k.c*k.c+k.d*k.d),m=Math.sqrt(v*v+A*A),i>1e-5&&(i=(i+(m-i+this.data.offsetScaleY)*p)/i),k.c*=i,k.d*=i,P=!0}if(_>0){let i=k.c,m=k.d,p=Math.atan2(m,i),x=Math.atan2(A,v)-Math.atan2(E,T)-(p-Math.atan2(k.b,k.a));x>te.PI?x-=te.PI2:x<-te.PI&&(x+=te.PI2),x=p+(x+R)*_;let y=Math.sqrt(i*i+m*m);k.c=Math.cos(x)*y,k.d=Math.sin(x)*y,P=!0}P&&(S.appliedValid=!1)}}applyRelativeWorld(){let i=this.rotateMix,m=this.translateMix,p=this.scaleMix,_=this.shearMix,x=this.target,y=x.matrix,T=y.a,v=y.c,E=y.b,A=y.d,S=T*A-v*E>0?te.degRad:-te.degRad,I=this.data.offsetRotation*S,R=this.data.offsetShearY*S,C=this.bones;for(let y=0,S=C.length;y<S;y++){let S=C[y],P=!1,k=S.matrix;if(0!=i){let m=k.a,p=k.c,_=k.b,x=k.d,y=Math.atan2(E,T)+I;y>te.PI?y-=te.PI2:y<-te.PI&&(y+=te.PI2),y*=i;let v=Math.cos(y),A=Math.sin(y);k.a=v*m-A*_,k.c=v*p-A*x,k.b=A*m+v*_,k.d=A*p+v*x,P=!0}if(0!=m){let i=this.temp;x.localToWorld(i.set(this.data.offsetX,this.data.offsetY)),k.tx+=i.x*m,k.ty+=i.y*m,P=!0}if(p>0){let i=(Math.sqrt(T*T+E*E)-1+this.data.offsetScaleX)*p+1;k.a*=i,k.b*=i,i=(Math.sqrt(v*v+A*A)-1+this.data.offsetScaleY)*p+1,k.c*=i,k.d*=i,P=!0}if(_>0){let i=Math.atan2(A,v)-Math.atan2(E,T);i>te.PI?i-=te.PI2:i<-te.PI&&(i+=te.PI2);let m=k.c,p=k.d;i=Math.atan2(p,m)+(i-te.PI/2+R)*_;let x=Math.sqrt(m*m+p*p);k.c=Math.cos(i)*x,k.d=Math.sin(i)*x,P=!0}P&&(S.appliedValid=!1)}}applyAbsoluteLocal(){let i=this.rotateMix,m=this.translateMix,p=this.scaleMix,_=this.shearMix,x=this.target;x.appliedValid||x.updateAppliedTransform();let y=this.bones;for(let T=0,v=y.length;T<v;T++){let v=y[T];v.appliedValid||v.updateAppliedTransform();let E=v.arotation;if(0!=i){let m=x.arotation-E+this.data.offsetRotation;m-=(16384-(16384.499999999996-m/360|0))*360,E+=m*i}let A=v.ax,S=v.ay;0!=m&&(A+=(x.ax-A+this.data.offsetX)*m,S+=(x.ay-S+this.data.offsetY)*m);let I=v.ascaleX,R=v.ascaleY;p>0&&(I>1e-5&&(I=(I+(x.ascaleX-I+this.data.offsetScaleX)*p)/I),R>1e-5&&(R=(R+(x.ascaleY-R+this.data.offsetScaleY)*p)/R));let C=v.ashearY;if(_>0){let i=x.ashearY-C+this.data.offsetShearY;i-=(16384-(16384.499999999996-i/360|0))*360,v.shearY+=i*_}v.updateWorldTransformWith(A,S,E,I,R,v.ashearX,C)}}applyRelativeLocal(){let i=this.rotateMix,m=this.translateMix,p=this.scaleMix,_=this.shearMix,x=this.target;x.appliedValid||x.updateAppliedTransform();let y=this.bones;for(let T=0,v=y.length;T<v;T++){let v=y[T];v.appliedValid||v.updateAppliedTransform();let E=v.arotation;0!=i&&(E+=(x.arotation+this.data.offsetRotation)*i);let A=v.ax,S=v.ay;0!=m&&(A+=(x.ax+this.data.offsetX)*m,S+=(x.ay+this.data.offsetY)*m);let I=v.ascaleX,R=v.ascaleY;p>0&&(I>1e-5&&(I*=(x.ascaleX-1+this.data.offsetScaleX)*p+1),R>1e-5&&(R*=(x.ascaleY-1+this.data.offsetScaleY)*p+1));let C=v.ashearY;_>0&&(C+=(x.ashearY+this.data.offsetShearY)*_),v.updateWorldTransformWith(A,S,E,I,R,v.ashearX,C)}}getOrder(){return this.data.order}};let eM=class{constructor(i){if(this._updateCache=[],this.updateCacheReset=[],this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==i)throw Error("data cannot be null.");this.data=i,this.bones=[];for(let m=0;m<i.bones.length;m++){let p;let _=i.bones[m];if(null==_.parent)p=new Bone_Bone(_,this,null);else{let i=this.bones[_.parent.index];p=new Bone_Bone(_,this,i),i.children.push(p)}this.bones.push(p)}this.slots=[],this.drawOrder=[];for(let m=0;m<i.slots.length;m++){let p=i.slots[m],_=this.bones[p.boneData.index],x=new Slot_Slot(p,_);this.slots.push(x),this.drawOrder.push(x)}this.ikConstraints=[];for(let m=0;m<i.ikConstraints.length;m++){let p=i.ikConstraints[m];this.ikConstraints.push(new IkConstraint_IkConstraint(p,this))}this.transformConstraints=[];for(let m=0;m<i.transformConstraints.length;m++){let p=i.transformConstraints[m];this.transformConstraints.push(new TransformConstraint_TransformConstraint(p,this))}this.pathConstraints=[];for(let m=0;m<i.pathConstraints.length;m++){let p=i.pathConstraints[m];this.pathConstraints.push(new eR(p,this))}this.color=new tt(1,1,1,1),this.updateCache()}updateCache(){let i=this._updateCache;i.length=0,this.updateCacheReset.length=0;let m=this.bones;for(let i=0,p=m.length;i<p;i++)m[i].sorted=!1;let p=this.ikConstraints,_=this.transformConstraints,x=this.pathConstraints,y=p.length,T=_.length,v=x.length,E=y+T+v;t:for(let i=0;i<E;i++){for(let m=0;m<y;m++){let _=p[m];if(_.data.order==i){this.sortIkConstraint(_);continue t}}for(let m=0;m<T;m++){let p=_[m];if(p.data.order==i){this.sortTransformConstraint(p);continue t}}for(let m=0;m<v;m++){let p=x[m];if(p.data.order==i){this.sortPathConstraint(p);continue t}}}for(let i=0,p=m.length;i<p;i++)this.sortBone(m[i])}sortIkConstraint(i){let m=i.target;this.sortBone(m);let p=i.bones,_=p[0];if(this.sortBone(_),p.length>1){let i=p[p.length-1];this._updateCache.indexOf(i)>-1||this.updateCacheReset.push(i)}this._updateCache.push(i),this.sortReset(_.children),p[p.length-1].sorted=!0}sortPathConstraint(i){let m=i.target,p=m.data.index,_=m.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,p,_),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,p,_);for(let i=0,m=this.data.skins.length;i<m;i++)this.sortPathConstraintAttachment(this.data.skins[i],p,_);let x=m.getAttachment();x instanceof PathAttachment_PathAttachment&&this.sortPathConstraintAttachmentWith(x,_);let y=i.bones,T=y.length;for(let i=0;i<T;i++)this.sortBone(y[i]);this._updateCache.push(i);for(let i=0;i<T;i++)this.sortReset(y[i].children);for(let i=0;i<T;i++)y[i].sorted=!0}sortTransformConstraint(i){this.sortBone(i.target);let m=i.bones,p=m.length;if(i.data.local)for(let i=0;i<p;i++){let p=m[i];this.sortBone(p.parent),this._updateCache.indexOf(p)>-1||this.updateCacheReset.push(p)}else for(let i=0;i<p;i++)this.sortBone(m[i]);this._updateCache.push(i);for(let i=0;i<p;i++)this.sortReset(m[i].children);for(let i=0;i<p;i++)m[i].sorted=!0}sortPathConstraintAttachment(i,m,p){let _=i.attachments[m];if(_)for(let i in _)this.sortPathConstraintAttachmentWith(_[i],p)}sortPathConstraintAttachmentWith(i,m){if(!(i instanceof PathAttachment_PathAttachment))return;let p=i.bones;if(null==p)this.sortBone(m);else{let i=this.bones,m=0;for(;m<p.length;){let _=p[m++];for(let x=m+_;m<x;m++){let _=p[m];this.sortBone(i[_])}}}}sortBone(i){if(i.sorted)return;let m=i.parent;null!=m&&this.sortBone(m),i.sorted=!0,this._updateCache.push(i)}sortReset(i){for(let m=0,p=i.length;m<p;m++){let p=i[m];p.sorted&&this.sortReset(p.children),p.sorted=!1}}updateWorldTransform(){let i=this.updateCacheReset;for(let m=0,p=i.length;m<p;m++){let p=i[m];p.ax=p.x,p.ay=p.y,p.arotation=p.rotation,p.ascaleX=p.scaleX,p.ascaleY=p.scaleY,p.ashearX=p.shearX,p.ashearY=p.shearY,p.appliedValid=!0}let m=this._updateCache;for(let i=0,p=m.length;i<p;i++)m[i].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){let i=this.bones;for(let m=0,p=i.length;m<p;m++)i[m].setToSetupPose();let m=this.ikConstraints;for(let i=0,p=m.length;i<p;i++){let p=m[i];p.bendDirection=p.data.bendDirection,p.mix=p.data.mix}let p=this.transformConstraints;for(let i=0,m=p.length;i<m;i++){let m=p[i],_=m.data;m.rotateMix=_.rotateMix,m.translateMix=_.translateMix,m.scaleMix=_.scaleMix,m.shearMix=_.shearMix}let _=this.pathConstraints;for(let i=0,m=_.length;i<m;i++){let m=_[i],p=m.data;m.position=p.position,m.spacing=p.spacing,m.rotateMix=p.rotateMix,m.translateMix=p.translateMix}}setSlotsToSetupPose(){let i=this.slots;tr.arrayCopy(i,0,this.drawOrder,0,i.length);for(let m=0,p=i.length;m<p;m++)i[m].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(i){if(null==i)throw Error("boneName cannot be null.");let m=this.bones;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}findBoneIndex(i){if(null==i)throw Error("boneName cannot be null.");let m=this.bones;for(let p=0,_=m.length;p<_;p++)if(m[p].data.name==i)return p;return -1}findSlot(i){if(null==i)throw Error("slotName cannot be null.");let m=this.slots;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}findSlotIndex(i){if(null==i)throw Error("slotName cannot be null.");let m=this.slots;for(let p=0,_=m.length;p<_;p++)if(m[p].data.name==i)return p;return -1}setSkinByName(i){let m=this.data.findSkin(i);if(null==m)throw Error(`Skin not found: ${i}`);this.setSkin(m)}setSkin(i){if(null!=i){if(null!=this.skin)i.attachAll(this,this.skin);else{let m=this.slots;for(let p=0,_=m.length;p<_;p++){let _=m[p],x=_.data.attachmentName;if(null!=x){let m=i.getAttachment(p,x);null!=m&&_.setAttachment(m)}}}}this.skin=i}getAttachmentByName(i,m){return this.getAttachment(this.data.findSlotIndex(i),m)}getAttachment(i,m){if(null==m)throw Error("attachmentName cannot be null.");if(null!=this.skin){let p=this.skin.getAttachment(i,m);if(null!=p)return p}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(i,m):null}setAttachment(i,m){if(null==i)throw Error("slotName cannot be null.");let p=this.slots;for(let _=0,x=p.length;_<x;_++){let x=p[_];if(x.data.name==i){let p=null;if(null!=m&&null==(p=this.getAttachment(_,m)))throw Error(`Attachment not found: ${m}, for slot: ${i}`);x.setAttachment(p);return}}throw Error(`Slot not found: ${i}`)}findIkConstraint(i){if(null==i)throw Error("constraintName cannot be null.");let m=this.ikConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}findTransformConstraint(i){if(null==i)throw Error("constraintName cannot be null.");let m=this.transformConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}findPathConstraint(i){if(null==i)throw Error("constraintName cannot be null.");let m=this.pathConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}getBounds(i,m,p){if(null==i)throw Error("offset cannot be null.");if(null==m)throw Error("size cannot be null.");let _=this.drawOrder,x=Number.POSITIVE_INFINITY,y=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY,v=Number.NEGATIVE_INFINITY;for(let i=0,m=_.length;i<m;i++){let m=_[i],E=0,A=null,S=m.getAttachment();if(S instanceof t4?(E=8,A=tr.setArraySize(p,E,0),S.computeWorldVertices(m.bone,A,0,2)):S instanceof MeshAttachment_MeshAttachment&&(E=S.worldVerticesLength,A=tr.setArraySize(p,E,0),S.computeWorldVertices(m,0,E,A,0,2)),null!=A)for(let i=0,m=A.length;i<m;i+=2){let m=A[i],p=A[i+1];x=Math.min(x,m),y=Math.min(y,p),T=Math.max(T,m),v=Math.max(v,p)}}i.set(x,y),m.set(T-x,v-y)}update(i){this.time+=i}get flipX(){return -1==this.scaleX}set flipX(i){eM.deprecatedWarning1||(eM.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=i?1:-1}get flipY(){return -1==this.scaleY}set flipY(i){eM.deprecatedWarning1||(eM.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=i?1:-1}},eC=eM;eC.deprecatedWarning1=!1;let SkeletonBounds_SkeletonBounds=class SkeletonBounds_SkeletonBounds extends SkeletonBoundsBase_SkeletonBoundsBase{};let SkeletonData_SkeletonData=class SkeletonData_SkeletonData{constructor(){this.bones=[],this.slots=[],this.skins=[],this.events=[],this.animations=[],this.ikConstraints=[],this.transformConstraints=[],this.pathConstraints=[],this.fps=0}findBone(i){if(null==i)throw Error("boneName cannot be null.");let m=this.bones;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findBoneIndex(i){if(null==i)throw Error("boneName cannot be null.");let m=this.bones;for(let p=0,_=m.length;p<_;p++)if(m[p].name==i)return p;return -1}findSlot(i){if(null==i)throw Error("slotName cannot be null.");let m=this.slots;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findSlotIndex(i){if(null==i)throw Error("slotName cannot be null.");let m=this.slots;for(let p=0,_=m.length;p<_;p++)if(m[p].name==i)return p;return -1}findSkin(i){if(null==i)throw Error("skinName cannot be null.");let m=this.skins;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findEvent(i){if(null==i)throw Error("eventDataName cannot be null.");let m=this.events;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findAnimation(i){if(null==i)throw Error("animationName cannot be null.");let m=this.animations;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findIkConstraint(i){if(null==i)throw Error("constraintName cannot be null.");let m=this.ikConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findTransformConstraint(i){if(null==i)throw Error("constraintName cannot be null.");let m=this.transformConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findPathConstraint(i){if(null==i)throw Error("constraintName cannot be null.");let m=this.pathConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findPathConstraintIndex(i){if(null==i)throw Error("pathConstraintName cannot be null.");let m=this.pathConstraints;for(let p=0,_=m.length;p<_;p++)if(m[p].name==i)return p;return -1}};let SlotData_SlotData=class SlotData_SlotData{constructor(i,m,p){if(this.color=new tt(1,1,1,1),i<0)throw Error("index must be >= 0.");if(null==m)throw Error("name cannot be null.");if(null==p)throw Error("boneData cannot be null.");this.index=i,this.name=m,this.boneData=p}};let TransformConstraintData_TransformConstraintData=class TransformConstraintData_TransformConstraintData{constructor(i){if(this.order=0,this.bones=[],this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,null==i)throw Error("name cannot be null.");this.name=i}};let Skin_Skin=class Skin_Skin{constructor(i){if(this.attachments=[],null==i)throw Error("name cannot be null.");this.name=i}addAttachment(i,m,p){if(null==p)throw Error("attachment cannot be null.");let _=this.attachments;i>=_.length&&(_.length=i+1),_[i]||(_[i]={}),_[i][m]=p}getAttachment(i,m){let p=this.attachments[i];return p?p[m]:null}attachAll(i,m){let p=0;for(let _=0;_<i.slots.length;_++){let x=i.slots[_],y=x.getAttachment();if(y&&p<m.attachments.length){let i=m.attachments[p];for(let m in i){let _=i[m];if(y==_){let i=this.getAttachment(p,m);null!=i&&x.setAttachment(i);break}}}p++}}};let SkeletonJson_SkeletonJson=class SkeletonJson_SkeletonJson{constructor(i){this.scale=1,this.linkedMeshes=[],this.attachmentLoader=i}readSkeletonData(i){let m=this.scale,p=new SkeletonData_SkeletonData,_="string"==typeof i?JSON.parse(i):i,x=_.skeleton;if(null!=x&&(p.hash=x.hash,p.version=x.spine,p.width=x.width,p.height=x.height,p.fps=x.fps,p.imagesPath=x.images),_.bones)for(let i=0;i<_.bones.length;i++){let x=_.bones[i],y=null,T=this.getValue(x,"parent",null);if(null!=T&&null==(y=p.findBone(T)))throw Error(`Parent bone not found: ${T}`);let v=new BoneData_BoneData(p.bones.length,x.name,y);v.length=this.getValue(x,"length",0)*m,v.x=this.getValue(x,"x",0)*m,v.y=this.getValue(x,"y",0)*m,v.rotation=this.getValue(x,"rotation",0),v.scaleX=this.getValue(x,"scaleX",1),v.scaleY=this.getValue(x,"scaleY",1),v.shearX=this.getValue(x,"shearX",0),v.shearY=this.getValue(x,"shearY",0),v.transformMode=SkeletonJson_SkeletonJson.transformModeFromString(this.getValue(x,"transform","normal")),p.bones.push(v)}if(_.slots)for(let i=0;i<_.slots.length;i++){let m=_.slots[i],x=m.name,y=m.bone,T=p.findBone(y);if(null==T)throw Error(`Slot bone not found: ${y}`);let v=new SlotData_SlotData(p.slots.length,x,T),E=this.getValue(m,"color",null);null!=E&&v.color.setFromString(E);let A=this.getValue(m,"dark",null);null!=A&&(v.darkColor=new tt(1,1,1,1),v.darkColor.setFromString(A)),v.attachmentName=this.getValue(m,"attachment",null),v.blendMode=SkeletonJson_SkeletonJson.blendModeFromString(this.getValue(m,"blend","normal")),p.slots.push(v)}if(_.ik)for(let i=0;i<_.ik.length;i++){let m=_.ik[i],x=new IkConstraintData_IkConstraintData(m.name);x.order=this.getValue(m,"order",0);for(let i=0;i<m.bones.length;i++){let _=m.bones[i],y=p.findBone(_);if(null==y)throw Error(`IK bone not found: ${_}`);x.bones.push(y)}let y=m.target;if(x.target=p.findBone(y),null==x.target)throw Error(`IK target bone not found: ${y}`);x.bendDirection=this.getValue(m,"bendPositive",!0)?1:-1,x.mix=this.getValue(m,"mix",1),p.ikConstraints.push(x)}if(_.transform)for(let i=0;i<_.transform.length;i++){let x=_.transform[i],y=new TransformConstraintData_TransformConstraintData(x.name);y.order=this.getValue(x,"order",0);for(let i=0;i<x.bones.length;i++){let m=x.bones[i],_=p.findBone(m);if(null==_)throw Error(`Transform constraint bone not found: ${m}`);y.bones.push(_)}let T=x.target;if(y.target=p.findBone(T),null==y.target)throw Error(`Transform constraint target bone not found: ${T}`);y.local=this.getValue(x,"local",!1),y.relative=this.getValue(x,"relative",!1),y.offsetRotation=this.getValue(x,"rotation",0),y.offsetX=this.getValue(x,"x",0)*m,y.offsetY=this.getValue(x,"y",0)*m,y.offsetScaleX=this.getValue(x,"scaleX",0),y.offsetScaleY=this.getValue(x,"scaleY",0),y.offsetShearY=this.getValue(x,"shearY",0),y.rotateMix=this.getValue(x,"rotateMix",1),y.translateMix=this.getValue(x,"translateMix",1),y.scaleMix=this.getValue(x,"scaleMix",1),y.shearMix=this.getValue(x,"shearMix",1),p.transformConstraints.push(y)}if(_.path)for(let i=0;i<_.path.length;i++){let x=_.path[i],y=new PathConstraintData_PathConstraintData(x.name);y.order=this.getValue(x,"order",0);for(let i=0;i<x.bones.length;i++){let m=x.bones[i],_=p.findBone(m);if(null==_)throw Error(`Transform constraint bone not found: ${m}`);y.bones.push(_)}let T=x.target;if(y.target=p.findSlot(T),null==y.target)throw Error(`Path target slot not found: ${T}`);y.positionMode=SkeletonJson_SkeletonJson.positionModeFromString(this.getValue(x,"positionMode","percent")),y.spacingMode=SkeletonJson_SkeletonJson.spacingModeFromString(this.getValue(x,"spacingMode","length")),y.rotateMode=SkeletonJson_SkeletonJson.rotateModeFromString(this.getValue(x,"rotateMode","tangent")),y.offsetRotation=this.getValue(x,"rotation",0),y.position=this.getValue(x,"position",0),y.positionMode==z.Fixed&&(y.position*=m),y.spacing=this.getValue(x,"spacing",0),(y.spacingMode==ew.Length||y.spacingMode==ew.Fixed)&&(y.spacing*=m),y.rotateMix=this.getValue(x,"rotateMix",1),y.translateMix=this.getValue(x,"translateMix",1),p.pathConstraints.push(y)}if(_.skins)for(let i in _.skins){let m=_.skins[i],x=new Skin_Skin(i);for(let i in m){let _=p.findSlotIndex(i);if(-1==_)throw Error(`Slot not found: ${i}`);let y=m[i];for(let i in y){let m=this.readAttachment(y[i],x,_,i,p);null!=m&&x.addAttachment(_,i,m)}}p.skins.push(x),"default"==x.name&&(p.defaultSkin=x)}for(let i=0,m=this.linkedMeshes.length;i<m;i++){let m=this.linkedMeshes[i],_=null==m.skin?p.defaultSkin:p.findSkin(m.skin);if(null==_)throw Error(`Skin not found: ${m.skin}`);let x=_.getAttachment(m.slotIndex,m.parent);if(null==x)throw Error(`Parent mesh not found: ${m.parent}`);m.mesh.setParentMesh(x)}if(this.linkedMeshes.length=0,_.events)for(let i in _.events){let m=_.events[i],x=new EventData_EventData(i);x.intValue=this.getValue(m,"int",0),x.floatValue=this.getValue(m,"float",0),x.stringValue=this.getValue(m,"string",""),x.audioPath=this.getValue(m,"audio",null),null!=x.audioPath&&(x.volume=this.getValue(m,"volume",1),x.balance=this.getValue(m,"balance",0)),p.events.push(x)}if(_.animations)for(let i in _.animations){let m=_.animations[i];this.readAnimation(m,i,p)}return p}readAttachment(i,m,p,_,x){let y=this.scale;_=this.getValue(i,"name",_);let T=this.getValue(i,"type","region");switch(T){case"region":{let p=this.getValue(i,"path",_),x=this.attachmentLoader.newRegionAttachment(m,_,p);if(null==x)return null;x.path=p,x.x=this.getValue(i,"x",0)*y,x.y=this.getValue(i,"y",0)*y,x.scaleX=this.getValue(i,"scaleX",1),x.scaleY=this.getValue(i,"scaleY",1),x.rotation=this.getValue(i,"rotation",0),x.width=i.width*y,x.height=i.height*y;let T=this.getValue(i,"color",null);return null!=T&&x.color.setFromString(T),x}case"boundingbox":{let p=this.attachmentLoader.newBoundingBoxAttachment(m,_);if(null==p)return null;this.readVertices(i,p,i.vertexCount<<1);let x=this.getValue(i,"color",null);return null!=x&&p.color.setFromString(x),p}case"mesh":case"linkedmesh":{let x=this.getValue(i,"path",_),y=this.attachmentLoader.newMeshAttachment(m,_,x);if(null==y)return null;y.path=x;let T=this.getValue(i,"color",null);null!=T&&y.color.setFromString(T);let v=this.getValue(i,"parent",null);if(null!=v)return y.inheritDeform=this.getValue(i,"deform",!0),this.linkedMeshes.push(new core_SkeletonJson_LinkedMesh(y,this.getValue(i,"skin",null),p,v)),y;let E=i.uvs;return this.readVertices(i,y,E.length),y.triangles=i.triangles,y.regionUVs=new Float32Array(E),y.hullLength=2*this.getValue(i,"hull",0),y}case"path":{let p=this.attachmentLoader.newPathAttachment(m,_);if(null==p)return null;p.closed=this.getValue(i,"closed",!1),p.constantSpeed=this.getValue(i,"constantSpeed",!0);let x=i.vertexCount;this.readVertices(i,p,x<<1);let T=tr.newArray(x/3,0);for(let m=0;m<i.lengths.length;m++)T[m]=i.lengths[m]*y;p.lengths=T;let v=this.getValue(i,"color",null);return null!=v&&p.color.setFromString(v),p}case"point":{let p=this.attachmentLoader.newPointAttachment(m,_);if(null==p)return null;p.x=this.getValue(i,"x",0)*y,p.y=this.getValue(i,"y",0)*y,p.rotation=this.getValue(i,"rotation",0);let x=this.getValue(i,"color",null);return null!=x&&p.color.setFromString(x),p}case"clipping":{let p=this.attachmentLoader.newClippingAttachment(m,_);if(null==p)return null;let y=this.getValue(i,"end",null);if(null!=y){let i=x.findSlot(y);if(null==i)throw Error(`Clipping end slot not found: ${y}`);p.endSlot=i}let T=i.vertexCount;this.readVertices(i,p,T<<1);let v=this.getValue(i,"color",null);return null!=v&&p.color.setFromString(v),p}}return null}readVertices(i,m,p){let _=this.scale;m.worldVerticesLength=p;let x=i.vertices;if(p==x.length){let i=tr.toFloatArray(x);if(1!=_)for(let m=0,p=x.length;m<p;m++)i[m]*=_;m.vertices=i;return}let y=[],T=[];for(let i=0,m=x.length;i<m;){let m=x[i++];T.push(m);for(let p=i+4*m;i<p;i+=4)T.push(x[i]),y.push(x[i+1]*_),y.push(x[i+2]*_),y.push(x[i+3])}m.bones=T,m.vertices=tr.toFloatArray(y)}readAnimation(i,m,p){let _=this.scale,x=[],y=0;if(i.slots)for(let m in i.slots){let _=i.slots[m],T=p.findSlotIndex(m);if(-1==T)throw Error(`Slot not found: ${m}`);for(let i in _){let p=_[i];if("attachment"==i){let i=new Animation_AttachmentTimeline(p.length);i.slotIndex=T;let m=0;for(let _=0;_<p.length;_++){let x=p[_];i.setFrame(m++,x.time,x.name)}x.push(i),y=Math.max(y,i.frames[i.getFrameCount()-1])}else if("color"==i){let i=new en(p.length);i.slotIndex=T;let m=0;for(let _=0;_<p.length;_++){let x=p[_],y=new tt;y.setFromString(x.color||"ffffffff"),i.setFrame(m,x.time,y.r,y.g,y.b,y.a),this.readCurve(x,i,m),m++}x.push(i),y=Math.max(y,i.frames[(i.getFrameCount()-1)*en.ENTRIES])}else if("twoColor"==i){let i=new eo(p.length);i.slotIndex=T;let m=0;for(let _=0;_<p.length;_++){let x=p[_],y=new tt,T=new tt;y.setFromString(x.light),T.setFromString(x.dark),i.setFrame(m,x.time,y.r,y.g,y.b,y.a,T.r,T.g,T.b),this.readCurve(x,i,m),m++}x.push(i),y=Math.max(y,i.frames[(i.getFrameCount()-1)*eo.ENTRIES])}else throw Error(`Invalid timeline type for a slot: ${i} (${m})`)}}if(i.bones)for(let m in i.bones){let T=i.bones[m],v=p.findBoneIndex(m);if(-1==v)throw Error(`Bone not found: ${m}`);for(let i in T){let p=T[i];if("rotate"===i){let i=new ee(p.length);i.boneIndex=v;let m=0;for(let _=0;_<p.length;_++){let x=p[_];i.setFrame(m,x.time,x.angle),this.readCurve(x,i,m),m++}x.push(i),y=Math.max(y,i.frames[(i.getFrameCount()-1)*ee.ENTRIES])}else if("translate"===i||"scale"===i||"shear"===i){let m=null,T=1;"scale"===i?m=new Animation_ScaleTimeline(p.length):"shear"===i?m=new Animation_ShearTimeline(p.length):(m=new ei(p.length),T=_),m.boneIndex=v;let E=0;for(let i=0;i<p.length;i++){let _=p[i],x=this.getValue(_,"x",0),y=this.getValue(_,"y",0);m.setFrame(E,_.time,x*T,y*T),this.readCurve(_,m,E),E++}x.push(m),y=Math.max(y,m.frames[(m.getFrameCount()-1)*ei.ENTRIES])}else throw Error(`Invalid timeline type for a bone: ${i} (${m})`)}}if(i.ik)for(let m in i.ik){let _=i.ik[m],T=p.findIkConstraint(m),v=new eu(_.length);v.ikConstraintIndex=p.ikConstraints.indexOf(T);let E=0;for(let i=0;i<_.length;i++){let m=_[i];v.setFrame(E,m.time,this.getValue(m,"mix",1),this.getValue(m,"bendPositive",!0)?1:-1,this.getValue(m,"compress",!1),this.getValue(m,"stretch",!1)),this.readCurve(m,v,E),E++}x.push(v),y=Math.max(y,v.frames[(v.getFrameCount()-1)*eu.ENTRIES])}if(i.transform)for(let m in i.transform){let _=i.transform[m],T=p.findTransformConstraint(m),v=new ec(_.length);v.transformConstraintIndex=p.transformConstraints.indexOf(T);let E=0;for(let i=0;i<_.length;i++){let m=_[i];v.setFrame(E,m.time,this.getValue(m,"rotateMix",1),this.getValue(m,"translateMix",1),this.getValue(m,"scaleMix",1),this.getValue(m,"shearMix",1)),this.readCurve(m,v,E),E++}x.push(v),y=Math.max(y,v.frames[(v.getFrameCount()-1)*ec.ENTRIES])}if(i.paths)for(let m in i.paths){let T=i.paths[m],v=p.findPathConstraintIndex(m);if(-1==v)throw Error(`Path constraint not found: ${m}`);let E=p.pathConstraints[v];for(let i in T){let m=T[i];if("position"===i||"spacing"===i){let p=null,T=1;"spacing"===i?(p=new Animation_PathConstraintSpacingTimeline(m.length),(E.spacingMode==ew.Length||E.spacingMode==ew.Fixed)&&(T=_)):(p=new ef(m.length),E.positionMode==z.Fixed&&(T=_)),p.pathConstraintIndex=v;let A=0;for(let _=0;_<m.length;_++){let x=m[_];p.setFrame(A,x.time,this.getValue(x,i,0)*T),this.readCurve(x,p,A),A++}x.push(p),y=Math.max(y,p.frames[(p.getFrameCount()-1)*ef.ENTRIES])}else if("mix"===i){let i=new eg(m.length);i.pathConstraintIndex=v;let p=0;for(let _=0;_<m.length;_++){let x=m[_];i.setFrame(p,x.time,this.getValue(x,"rotateMix",1),this.getValue(x,"translateMix",1)),this.readCurve(x,i,p),p++}x.push(i),y=Math.max(y,i.frames[(i.getFrameCount()-1)*eg.ENTRIES])}}}if(i.deform)for(let m in i.deform){let T=i.deform[m],v=p.findSkin(m);if(null==v){if(!ti.FAIL_ON_NON_EXISTING_SKIN)continue;throw Error(`Skin not found: ${m}`)}for(let i in T){let m=T[i],E=p.findSlotIndex(i);if(-1==E)throw Error(`Slot not found: ${m.name}`);for(let i in m){let p=m[i],T=v.getAttachment(E,i);if(null==T)throw Error(`Deform attachment not found: ${p.name}`);let A=null!=T.bones,S=T.vertices,I=A?S.length/3*2:S.length,R=new Animation_DeformTimeline(p.length);R.slotIndex=E,R.attachment=T;let C=0;for(let i=0;i<p.length;i++){let m;let x=p[i],y=this.getValue(x,"vertices",null);if(null==y)m=A?tr.newFloatArray(I):S;else{m=tr.newFloatArray(I);let i=this.getValue(x,"offset",0);if(tr.arrayCopy(y,0,m,i,y.length),1!=_)for(let p=i,x=p+y.length;p<x;p++)m[p]*=_;if(!A)for(let i=0;i<I;i++)m[i]+=S[i]}R.setFrame(C,x.time,m),this.readCurve(x,R,C),C++}x.push(R),y=Math.max(y,R.frames[R.getFrameCount()-1])}}}let T=i.drawOrder;if(null==T&&(T=i.draworder),null!=T){let i=new Animation_DrawOrderTimeline(T.length),m=p.slots.length,_=0;for(let x=0;x<T.length;x++){let y=T[x],v=null,E=this.getValue(y,"offsets",null);if(null!=E){v=tr.newArray(m,-1);let i=tr.newArray(m-E.length,0),_=0,x=0;for(let m=0;m<E.length;m++){let y=E[m],T=p.findSlotIndex(y.slot);if(-1==T)throw Error(`Slot not found: ${y.slot}`);for(;_!=T;)i[x++]=_++;v[_+y.offset]=_++}for(;_<m;)i[x++]=_++;for(let p=m-1;p>=0;p--)-1==v[p]&&(v[p]=i[--x])}i.setFrame(_++,y.time,v)}x.push(i),y=Math.max(y,i.frames[i.getFrameCount()-1])}if(i.events){let m=new Animation_EventTimeline(i.events.length),_=0;for(let x=0;x<i.events.length;x++){let y=i.events[x],T=p.findEvent(y.name);if(null==T)throw Error(`Event not found: ${y.name}`);let v=new Event_Event(tr.toSinglePrecision(y.time),T);v.intValue=this.getValue(y,"int",T.intValue),v.floatValue=this.getValue(y,"float",T.floatValue),v.stringValue=this.getValue(y,"string",T.stringValue),null!=v.data.audioPath&&(v.volume=this.getValue(y,"volume",1),v.balance=this.getValue(y,"balance",0)),m.setFrame(_++,v)}x.push(m),y=Math.max(y,m.frames[m.getFrameCount()-1])}if(isNaN(y))throw Error("Error while parsing animation, duration is NaN");p.animations.push(new Animation_Animation(m,x,y))}readCurve(i,m,p){if(i.curve){if("stepped"===i.curve)m.setStepped(p);else if("[object Array]"===Object.prototype.toString.call(i.curve)){let _=i.curve;m.setCurve(p,_[0],_[1],_[2],_[3])}}}getValue(i,m,p){return void 0!==i[m]?i[m]:p}static blendModeFromString(i){if("normal"==(i=i.toLowerCase()))return K.T$.NORMAL;if("additive"==i)return K.T$.ADD;if("multiply"==i)return K.T$.MULTIPLY;if("screen"==i)return K.T$.SCREEN;throw Error(`Unknown blend mode: ${i}`)}static positionModeFromString(i){if("fixed"==(i=i.toLowerCase()))return z.Fixed;if("percent"==i)return z.Percent;throw Error(`Unknown position mode: ${i}`)}static spacingModeFromString(i){if("length"==(i=i.toLowerCase()))return ew.Length;if("fixed"==i)return ew.Fixed;if("percent"==i)return ew.Percent;throw Error(`Unknown position mode: ${i}`)}static rotateModeFromString(i){if("tangent"==(i=i.toLowerCase()))return j.Tangent;if("chain"==i)return j.Chain;if("chainscale"==i)return j.ChainScale;throw Error(`Unknown rotate mode: ${i}`)}static transformModeFromString(i){if("normal"==(i=i.toLowerCase()))return Z.Normal;if("onlytranslation"==i)return Z.OnlyTranslation;if("norotationorreflection"==i)return Z.NoRotationOrReflection;if("noscale"==i)return Z.NoScale;if("noscaleorreflection"==i)return Z.NoScaleOrReflection;throw Error(`Unknown transform mode: ${i}`)}};let core_SkeletonJson_LinkedMesh=class core_SkeletonJson_LinkedMesh{constructor(i,m,p,_){this.mesh=i,this.skin=m,this.slotIndex=p,this.parent=_}};let Spine_Spine=class Spine_Spine extends tu{createSkeleton(i){this.skeleton=new eC(i),this.skeleton.updateWorldTransform(),this.stateData=new eS(i),this.state=new ex(this.stateData)}};let attachments_Attachment_Attachment=class attachments_Attachment_Attachment{constructor(i){if(!i)throw Error("name cannot be null.");this.name=i}};let eP=class extends attachments_Attachment_Attachment{constructor(i){super(i),this.id=eP.nextID++,this.bones=null,this.vertices=[],this.worldVerticesLength=0,this.timelineAttachment=this}computeWorldVerticesOld(i,m){this.computeWorldVertices(i,0,this.worldVerticesLength,m,0,2)}computeWorldVertices(i,m,p,_,x,y){p=x+(p>>1)*y;let T=i.bone.skeleton,v=i.deform,E=this.vertices,A=this.bones;if(!A){v.length>0&&(E=v);let T=i.bone.matrix,A=T.tx,S=T.ty,I=T.a,R=T.c,C=T.b,P=T.d;for(let i=m,T=x;T<p;i+=2,T+=y){let m=E[i],p=E[i+1];_[T]=m*I+p*R+A,_[T+1]=m*C+p*P+S}return}let S=0,I=0;for(let i=0;i<m;i+=2){let i=A[S];S+=i+1,I+=i}let R=T.bones;if(0==v.length)for(let i=x,m=3*I;i<p;i+=y){let p=0,x=0,y=A[S++];for(y+=S;S<y;S++,m+=3){let i=R[A[S]].matrix,_=E[m],y=E[m+1],T=E[m+2];p+=(_*i.a+y*i.c+i.tx)*T,x+=(_*i.b+y*i.d+i.ty)*T}_[i]=p,_[i+1]=x}else for(let i=x,m=3*I,T=I<<1;i<p;i+=y){let p=0,x=0,y=A[S++];for(y+=S;S<y;S++,m+=3,T+=2){let i=R[A[S]].matrix,_=E[m]+v[T],y=E[m+1]+v[T+1],I=E[m+2];p+=(_*i.a+y*i.c+i.tx)*I,x+=(_*i.b+y*i.d+i.ty)*I}_[i]=p,_[i+1]=x}}copyTo(i){this.bones?(i.bones=Array(this.bones.length),tr.arrayCopy(this.bones,0,i.bones,0,this.bones.length)):i.bones=null,this.vertices&&(i.vertices=tr.newFloatArray(this.vertices.length),tr.arrayCopy(this.vertices,0,i.vertices,0,this.vertices.length)),i.worldVerticesLength=this.worldVerticesLength,i.timelineAttachment=this.timelineAttachment}},ek=eP;ek.nextID=0;let attachments_BoundingBoxAttachment_BoundingBoxAttachment=class attachments_BoundingBoxAttachment_BoundingBoxAttachment extends ek{constructor(i){super(i),this.type=Y.BoundingBox,this.color=new tt(1,1,1,1)}copy(){let i=new attachments_BoundingBoxAttachment_BoundingBoxAttachment(this.name);return this.copyTo(i),i.color.setFromColor(this.color),i}};let attachments_ClippingAttachment_ClippingAttachment=class attachments_ClippingAttachment_ClippingAttachment extends ek{constructor(i){super(i),this.type=Y.Clipping,this.endSlot=null,this.color=new tt(.2275,.2275,.8078,1)}copy(){let i=new attachments_ClippingAttachment_ClippingAttachment(this.name);return this.copyTo(i),i.endSlot=this.endSlot,i.color.setFromColor(this.color),i}};let attachments_MeshAttachment_MeshAttachment=class attachments_MeshAttachment_MeshAttachment extends ek{constructor(i,m){super(i),this.type=Y.Mesh,this.region=null,this.triangles=[],this.color=new tt(1,1,1,1),this.width=0,this.height=0,this.hullLength=0,this.edges=[],this.parentMesh=null,this.sequence=null,this.tempColor=new tt(0,0,0,0),this.path=m}getParentMesh(){return this.parentMesh}setParentMesh(i){this.parentMesh=i,i&&(this.bones=i.bones,this.vertices=i.vertices,this.worldVerticesLength=i.worldVerticesLength,this.regionUVs=i.regionUVs,this.triangles=i.triangles,this.hullLength=i.hullLength,this.worldVerticesLength=i.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let i=new attachments_MeshAttachment_MeshAttachment(this.name,this.path);return i.region=this.region,i.color.setFromColor(this.color),this.copyTo(i),i.regionUVs=new Float32Array(this.regionUVs.length),tr.arrayCopy(this.regionUVs,0,i.regionUVs,0,this.regionUVs.length),i.triangles=Array(this.triangles.length),tr.arrayCopy(this.triangles,0,i.triangles,0,this.triangles.length),i.hullLength=this.hullLength,i.sequence=null!=this.sequence?this.sequence.copy():null,this.edges&&(i.edges=Array(this.edges.length),tr.arrayCopy(this.edges,0,i.edges,0,this.edges.length)),i.width=this.width,i.height=this.height,i}computeWorldVertices(i,m,p,_,x,y){null!=this.sequence&&this.sequence.apply(i,this),super.computeWorldVertices(i,m,p,_,x,y)}newLinkedMesh(){let i=new attachments_MeshAttachment_MeshAttachment(this.name,this.path);return i.region=this.region,i.color.setFromColor(this.color),i.timelineAttachment=this.timelineAttachment,i.setParentMesh(this.parentMesh?this.parentMesh:this),i}};let attachments_PathAttachment_PathAttachment=class attachments_PathAttachment_PathAttachment extends ek{constructor(i){super(i),this.type=Y.Path,this.lengths=[],this.closed=!1,this.constantSpeed=!1,this.color=new tt(1,1,1,1)}copy(){let i=new attachments_PathAttachment_PathAttachment(this.name);return this.copyTo(i),i.lengths=Array(this.lengths.length),tr.arrayCopy(this.lengths,0,i.lengths,0,this.lengths.length),i.closed=closed,i.constantSpeed=this.constantSpeed,i.color.setFromColor(this.color),i}};let attachments_PointAttachment_PointAttachment=class attachments_PointAttachment_PointAttachment extends ek{constructor(i){super(i),this.type=Y.Point,this.x=0,this.y=0,this.rotation=0,this.color=new tt(.38,.94,0,1)}computeWorldPosition(i,m){let p=i.matrix;return m.x=this.x*p.a+this.y*p.c+i.worldX,m.y=this.x*p.b+this.y*p.d+i.worldY,m}computeWorldRotation(i){let m=i.matrix,p=te.cosDeg(this.rotation),_=te.sinDeg(this.rotation),x=p*m.a+_*m.c,y=p*m.b+_*m.d;return Math.atan2(y,x)*te.radDeg}copy(){let i=new attachments_PointAttachment_PointAttachment(this.name);return i.x=this.x,i.y=this.y,i.rotation=this.rotation,i.color.setFromColor(this.color),i}};let eB=class extends attachments_Attachment_Attachment{constructor(i,m){super(i),this.type=Y.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new tt(1,1,1,1),this.rendererObject=null,this.region=null,this.sequence=null,this.offset=tr.newFloatArray(8),this.uvs=tr.newFloatArray(8),this.tempColor=new tt(1,1,1,1),this.path=m}updateRegion(){if(!this.region)throw Error("Region not set.");let i=this.region,m=this.width/this.region.originalWidth*this.scaleX,p=this.height/this.region.originalHeight*this.scaleY,_=-this.width/2*this.scaleX+this.region.offsetX*m,x=-this.height/2*this.scaleY+this.region.offsetY*p,y=_+this.region.width*m,T=x+this.region.height*p,v=this.rotation*Math.PI/180,E=Math.cos(v),A=Math.sin(v),S=this.x,I=this.y,R=_*E+S,C=_*A,P=x*E+I,k=x*A,B=y*E+S,D=y*A,F=T*E+I,L=T*A,O=this.offset;O[0]=R-k,O[1]=P+C,O[2]=R-L,O[3]=F+C,O[4]=B-L,O[5]=F+D,O[6]=B-k,O[7]=P+D;let V=this.uvs;90==i.degrees?(V[2]=i.u,V[3]=i.v2,V[4]=i.u,V[5]=i.v,V[6]=i.u2,V[7]=i.v,V[0]=i.u2,V[1]=i.v2):(V[0]=i.u,V[1]=i.v2,V[2]=i.u,V[3]=i.v,V[4]=i.u2,V[5]=i.v,V[6]=i.u2,V[7]=i.v2)}computeWorldVertices(i,m,p,_){null!=this.sequence&&this.sequence.apply(i,this);let x=i.bone,y=this.offset,T=x.matrix,v=T.tx,E=T.ty,A=T.a,S=T.c,I=T.b,R=T.d,C=0,P=0;C=y[0],P=y[1],m[p]=C*A+P*S+v,m[p+1]=C*I+P*R+E,p+=_,C=y[2],P=y[3],m[p]=C*A+P*S+v,m[p+1]=C*I+P*R+E,p+=_,C=y[4],P=y[5],m[p]=C*A+P*S+v,m[p+1]=C*I+P*R+E,p+=_,C=y[6],P=y[7],m[p]=C*A+P*S+v,m[p+1]=C*I+P*R+E}copy(){let i=new eB(this.name,this.path);return i.region=this.region,i.rendererObject=this.rendererObject,i.x=this.x,i.y=this.y,i.scaleX=this.scaleX,i.scaleY=this.scaleY,i.rotation=this.rotation,i.width=this.width,i.height=this.height,tr.arrayCopy(this.uvs,0,i.uvs,0,8),tr.arrayCopy(this.offset,0,i.offset,0,8),i.color.setFromColor(this.color),i.sequence=null!=this.sequence?this.sequence.copy():null,i}},eD=eB;eD.X1=0,eD.Y1=1,eD.C1R=2,eD.C1G=3,eD.C1B=4,eD.C1A=5,eD.U1=6,eD.V1=7,eD.X2=8,eD.Y2=9,eD.C2R=10,eD.C2G=11,eD.C2B=12,eD.C2A=13,eD.U2=14,eD.V2=15,eD.X3=16,eD.Y3=17,eD.C3R=18,eD.C3G=19,eD.C3B=20,eD.C3A=21,eD.U3=22,eD.V3=23,eD.X4=24,eD.Y4=25,eD.C4R=26,eD.C4G=27,eD.C4B=28,eD.C4A=29,eD.U4=30,eD.V4=31;let eF=class{constructor(i){this.id=eF.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=Array(i)}copy(){let i=new eF(this.regions.length);return tr.arrayCopy(this.regions,0,i.regions,0,this.regions.length),i.start=this.start,i.digits=this.digits,i.setupIndex=this.setupIndex,i}apply(i,m){let p=i.sequenceIndex;-1==p&&(p=this.setupIndex),p>=this.regions.length&&(p=this.regions.length-1);let _=this.regions[p];m.region!=_&&(m.region=_)}getPath(i,m){let p=i,_=(this.start+m).toString();for(let i=this.digits-_.length;i>0;i--)p+="0";return p+_}static nextID(){return eF._nextID++}},eN=eF;eN._nextID=0;var eL=((D=eL||{})[D.hold=0]="hold",D[D.once=1]="once",D[D.loop=2]="loop",D[D.pingpong=3]="pingpong",D[D.onceReverse=4]="onceReverse",D[D.loopReverse=5]="loopReverse",D[D.pingpongReverse=6]="pingpongReverse",D);let eO=[0,1,2,3,4,5,6];let core_Animation_Animation=class core_Animation_Animation{constructor(i,m,p){if(this.timelines=[],this.timelineIds=new StringSet,!i)throw Error("name cannot be null.");this.name=i,this.setTimelines(m),this.duration=p}setTimelines(i){if(!i)throw Error("timelines cannot be null.");this.timelines=i,this.timelineIds.clear();for(let m=0;m<i.length;m++)this.timelineIds.addAll(i[m].getPropertyIds())}hasTimeline(i){for(let m=0;m<i.length;m++)if(this.timelineIds.contains(i[m]))return!0;return!1}apply(i,m,p,_,x,y,T,v){if(!i)throw Error("skeleton cannot be null.");_&&0!=this.duration&&(p%=this.duration,m>0&&(m%=this.duration));let E=this.timelines;for(let _=0,A=E.length;_<A;_++)E[_].apply(i,m,p,x,y,T,v)}};let eV={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,rgb:7,alpha:8,rgb2:9,attachment:10,deform:11,event:12,drawOrder:13,ikConstraint:14,transformConstraint:15,pathConstraintPosition:16,pathConstraintSpacing:17,pathConstraintMix:18,sequence:19};let Timeline=class Timeline{constructor(i,m){this.propertyIds=m,this.frames=tr.newFloatArray(i*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(i,m){let p=i.length;for(let _=1;_<p;_++)if(i[_]>m)return _-1;return p-1}static search(i,m,p){let _=i.length;for(let x=p;x<_;x+=p)if(i[x]>m)return x-p;return _-p}};let lib_core_Animation_CurveTimeline=class lib_core_Animation_CurveTimeline extends Timeline{constructor(i,m,p){super(i,p),this.curves=tr.newFloatArray(i+18*m),this.curves[i-1]=1}setLinear(i){this.curves[i]=0}setStepped(i){this.curves[i]=1}shrink(i){let m=this.getFrameCount()+18*i;if(this.curves.length>m){let i=tr.newFloatArray(m);tr.arrayCopy(this.curves,0,i,0,m),this.curves=i}}setBezier(i,m,p,_,x,y,T,v,E,A,S){let I=this.curves,R=this.getFrameCount()+18*i;0==p&&(I[m]=2+R);let C=(_-2*y+v)*.03,P=(x-2*T+E)*.03,k=((y-v)*3-_+A)*.006,B=((T-E)*3-x+S)*.006,D=2*C+k,F=2*P+B,L=(y-_)*.3+C+.16666667*k,O=(T-x)*.3+P+.16666667*B,V=_+L,U=x+O;for(let i=R+18;R<i;R+=2)I[R]=V,I[R+1]=U,L+=D,O+=F,D+=k,F+=B,V+=L,U+=O}getBezierValue(i,m,p,_){let x=this.curves;if(x[_]>i){let y=this.frames[m],T=this.frames[m+p];return T+(i-y)/(x[_]-y)*(x[_+1]-T)}let y=_+18;for(_+=2;_<y;_+=2)if(x[_]>=i){let m=x[_-2],p=x[_-1];return p+(i-m)/(x[_]-m)*(x[_+1]-p)}m+=this.getFrameEntries();let T=x[y-2],v=x[y-1];return v+(i-T)/(this.frames[m]-T)*(this.frames[m+p]-v)}};let CurveTimeline1=class CurveTimeline1 extends lib_core_Animation_CurveTimeline{constructor(i,m,p){super(i,m,[p])}getFrameEntries(){return 2}setFrame(i,m,p){i<<=1,this.frames[i]=m,this.frames[i+1]=p}getCurveValue(i){let m=this.frames,p=m.length-2;for(let _=2;_<=p;_+=2)if(m[_]>i){p=_-2;break}let _=this.curves[p>>1];switch(_){case 0:let x=m[p],y=m[p+1];return y+(i-x)/(m[p+2]-x)*(m[p+2+1]-y);case 1:return m[p+1]}return this.getBezierValue(i,p,1,_-2)}};let CurveTimeline2=class CurveTimeline2 extends lib_core_Animation_CurveTimeline{constructor(i,m,p,_){super(i,m,[p,_])}getFrameEntries(){return 3}setFrame(i,m,p,_){i*=3,this.frames[i]=m,this.frames[i+1]=p,this.frames[i+2]=_}};let lib_core_Animation_RotateTimeline=class lib_core_Animation_RotateTimeline extends CurveTimeline1{constructor(i,m,p){super(i,m,`${eV.rotate}|${p}`),this.boneIndex=0,this.boneIndex=p}apply(i,m,p,_,x,y,T){let v=i.bones[this.boneIndex];if(!v.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.rotation=v.data.rotation;break;case G.first:v.rotation+=(v.data.rotation-v.rotation)*x}return}let A=this.getCurveValue(p);switch(y){case G.setup:v.rotation=v.data.rotation+A*x;break;case G.first:case G.replace:A+=v.data.rotation-v.rotation;case G.add:v.rotation+=A*x}}};let lib_core_Animation_TranslateTimeline=class lib_core_Animation_TranslateTimeline extends CurveTimeline2{constructor(i,m,p){super(i,m,`${eV.x}|${p}`,`${eV.y}|${p}`),this.boneIndex=0,this.boneIndex=p}apply(i,m,p,_,x,y,T){let v=i.bones[this.boneIndex];if(!v.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.x=v.data.x,v.y=v.data.y;break;case G.first:v.x+=(v.data.x-v.x)*x,v.y+=(v.data.y-v.y)*x}return}let A=0,S=0,I=Timeline.search(E,p,3),R=this.curves[I/3];switch(R){case 0:let C=E[I];A=E[I+1],S=E[I+2];let P=(p-C)/(E[I+3]-C);A+=(E[I+3+1]-A)*P,S+=(E[I+3+2]-S)*P;break;case 1:A=E[I+1],S=E[I+2];break;default:A=this.getBezierValue(p,I,1,R-2),S=this.getBezierValue(p,I,2,R+18-2)}switch(y){case G.setup:v.x=v.data.x+A*x,v.y=v.data.y+S*x;break;case G.first:case G.replace:v.x+=(v.data.x+A-v.x)*x,v.y+=(v.data.y+S-v.y)*x;break;case G.add:v.x+=A*x,v.y+=S*x}}};let TranslateXTimeline=class TranslateXTimeline extends CurveTimeline1{constructor(i,m,p){super(i,m,`${eV.x}|${p}`),this.boneIndex=0,this.boneIndex=p}apply(i,m,p,_,x,y,T){let v=i.bones[this.boneIndex];if(!v.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.x=v.data.x;break;case G.first:v.x+=(v.data.x-v.x)*x}return}let A=this.getCurveValue(p);switch(y){case G.setup:v.x=v.data.x+A*x;break;case G.first:case G.replace:v.x+=(v.data.x+A-v.x)*x;break;case G.add:v.x+=A*x}}};let TranslateYTimeline=class TranslateYTimeline extends CurveTimeline1{constructor(i,m,p){super(i,m,`${eV.y}|${p}`),this.boneIndex=0,this.boneIndex=p}apply(i,m,p,_,x,y,T){let v=i.bones[this.boneIndex];if(!v.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.y=v.data.y;break;case G.first:v.y+=(v.data.y-v.y)*x}return}let A=this.getCurveValue(p);switch(y){case G.setup:v.y=v.data.y+A*x;break;case G.first:case G.replace:v.y+=(v.data.y+A-v.y)*x;break;case G.add:v.y+=A*x}}};let core_Animation_ScaleTimeline=class core_Animation_ScaleTimeline extends CurveTimeline2{constructor(i,m,p){super(i,m,`${eV.scaleX}|${p}`,`${eV.scaleY}|${p}`),this.boneIndex=0,this.boneIndex=p}apply(i,m,p,_,x,y,T){let v,E;let A=i.bones[this.boneIndex];if(!A.active)return;let S=this.frames;if(p<S[0]){switch(y){case G.setup:A.scaleX=A.data.scaleX,A.scaleY=A.data.scaleY;break;case G.first:A.scaleX+=(A.data.scaleX-A.scaleX)*x,A.scaleY+=(A.data.scaleY-A.scaleY)*x}return}let I=Timeline.search(S,p,3),R=this.curves[I/3];switch(R){case 0:let C=S[I];v=S[I+1],E=S[I+2];let P=(p-C)/(S[I+3]-C);v+=(S[I+3+1]-v)*P,E+=(S[I+3+2]-E)*P;break;case 1:v=S[I+1],E=S[I+2];break;default:v=this.getBezierValue(p,I,1,R-2),E=this.getBezierValue(p,I,2,R+18-2)}if(v*=A.data.scaleX,E*=A.data.scaleY,1==x)y==G.add?(A.scaleX+=v-A.data.scaleX,A.scaleY+=E-A.data.scaleY):(A.scaleX=v,A.scaleY=E);else{let i=0,m=0;if(T==W.mixOut)switch(y){case G.setup:i=A.data.scaleX,m=A.data.scaleY,A.scaleX=i+(Math.abs(v)*te.signum(i)-i)*x,A.scaleY=m+(Math.abs(E)*te.signum(m)-m)*x;break;case G.first:case G.replace:i=A.scaleX,m=A.scaleY,A.scaleX=i+(Math.abs(v)*te.signum(i)-i)*x,A.scaleY=m+(Math.abs(E)*te.signum(m)-m)*x;break;case G.add:A.scaleX+=(v-A.data.scaleX)*x,A.scaleY+=(E-A.data.scaleY)*x}else switch(y){case G.setup:i=Math.abs(A.data.scaleX)*te.signum(v),m=Math.abs(A.data.scaleY)*te.signum(E),A.scaleX=i+(v-i)*x,A.scaleY=m+(E-m)*x;break;case G.first:case G.replace:i=Math.abs(A.scaleX)*te.signum(v),m=Math.abs(A.scaleY)*te.signum(E),A.scaleX=i+(v-i)*x,A.scaleY=m+(E-m)*x;break;case G.add:A.scaleX+=(v-A.data.scaleX)*x,A.scaleY+=(E-A.data.scaleY)*x}}}};let ScaleXTimeline=class ScaleXTimeline extends CurveTimeline1{constructor(i,m,p){super(i,m,`${eV.scaleX}|${p}`),this.boneIndex=0,this.boneIndex=p}apply(i,m,p,_,x,y,T){let v=i.bones[this.boneIndex];if(!v.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.scaleX=v.data.scaleX;break;case G.first:v.scaleX+=(v.data.scaleX-v.scaleX)*x}return}let A=this.getCurveValue(p)*v.data.scaleX;if(1==x)y==G.add?v.scaleX+=A-v.data.scaleX:v.scaleX=A;else{let i=0;if(T==W.mixOut)switch(y){case G.setup:i=v.data.scaleX,v.scaleX=i+(Math.abs(A)*te.signum(i)-i)*x;break;case G.first:case G.replace:i=v.scaleX,v.scaleX=i+(Math.abs(A)*te.signum(i)-i)*x;break;case G.add:v.scaleX+=(A-v.data.scaleX)*x}else switch(y){case G.setup:i=Math.abs(v.data.scaleX)*te.signum(A),v.scaleX=i+(A-i)*x;break;case G.first:case G.replace:i=Math.abs(v.scaleX)*te.signum(A),v.scaleX=i+(A-i)*x;break;case G.add:v.scaleX+=(A-v.data.scaleX)*x}}}};let ScaleYTimeline=class ScaleYTimeline extends CurveTimeline1{constructor(i,m,p){super(i,m,`${eV.scaleY}|${p}`),this.boneIndex=0,this.boneIndex=p}apply(i,m,p,_,x,y,T){let v=i.bones[this.boneIndex];if(!v.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.scaleY=v.data.scaleY;break;case G.first:v.scaleY+=(v.data.scaleY-v.scaleY)*x}return}let A=this.getCurveValue(p)*v.data.scaleY;if(1==x)y==G.add?v.scaleY+=A-v.data.scaleY:v.scaleY=A;else{let i=0;if(T==W.mixOut)switch(y){case G.setup:i=v.data.scaleY,v.scaleY=i+(Math.abs(A)*te.signum(i)-i)*x;break;case G.first:case G.replace:i=v.scaleY,v.scaleY=i+(Math.abs(A)*te.signum(i)-i)*x;break;case G.add:v.scaleY+=(A-v.data.scaleY)*x}else switch(y){case G.setup:i=Math.abs(v.data.scaleY)*te.signum(A),v.scaleY=i+(A-i)*x;break;case G.first:case G.replace:i=Math.abs(v.scaleY)*te.signum(A),v.scaleY=i+(A-i)*x;break;case G.add:v.scaleY+=(A-v.data.scaleY)*x}}}};let core_Animation_ShearTimeline=class core_Animation_ShearTimeline extends CurveTimeline2{constructor(i,m,p){super(i,m,`${eV.shearX}|${p}`,`${eV.shearY}|${p}`),this.boneIndex=0,this.boneIndex=p}apply(i,m,p,_,x,y,T){let v=i.bones[this.boneIndex];if(!v.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.shearX=v.data.shearX,v.shearY=v.data.shearY;break;case G.first:v.shearX+=(v.data.shearX-v.shearX)*x,v.shearY+=(v.data.shearY-v.shearY)*x}return}let A=0,S=0,I=Timeline.search(E,p,3),R=this.curves[I/3];switch(R){case 0:let C=E[I];A=E[I+1],S=E[I+2];let P=(p-C)/(E[I+3]-C);A+=(E[I+3+1]-A)*P,S+=(E[I+3+2]-S)*P;break;case 1:A=E[I+1],S=E[I+2];break;default:A=this.getBezierValue(p,I,1,R-2),S=this.getBezierValue(p,I,2,R+18-2)}switch(y){case G.setup:v.shearX=v.data.shearX+A*x,v.shearY=v.data.shearY+S*x;break;case G.first:case G.replace:v.shearX+=(v.data.shearX+A-v.shearX)*x,v.shearY+=(v.data.shearY+S-v.shearY)*x;break;case G.add:v.shearX+=A*x,v.shearY+=S*x}}};let ShearXTimeline=class ShearXTimeline extends CurveTimeline1{constructor(i,m,p){super(i,m,`${eV.shearX}|${p}`),this.boneIndex=0,this.boneIndex=p}apply(i,m,p,_,x,y,T){let v=i.bones[this.boneIndex];if(!v.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.shearX=v.data.shearX;break;case G.first:v.shearX+=(v.data.shearX-v.shearX)*x}return}let A=this.getCurveValue(p);switch(y){case G.setup:v.shearX=v.data.shearX+A*x;break;case G.first:case G.replace:v.shearX+=(v.data.shearX+A-v.shearX)*x;break;case G.add:v.shearX+=A*x}}};let ShearYTimeline=class ShearYTimeline extends CurveTimeline1{constructor(i,m,p){super(i,m,`${eV.shearY}|${p}`),this.boneIndex=0,this.boneIndex=p}apply(i,m,p,_,x,y,T){let v=i.bones[this.boneIndex];if(!v.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.shearY=v.data.shearY;break;case G.first:v.shearY+=(v.data.shearY-v.shearY)*x}return}let A=this.getCurveValue(p);switch(y){case G.setup:v.shearY=v.data.shearY+A*x;break;case G.first:case G.replace:v.shearY+=(v.data.shearY+A-v.shearY)*x;break;case G.add:v.shearY+=A*x}}};let RGBATimeline=class RGBATimeline extends lib_core_Animation_CurveTimeline{constructor(i,m,p){super(i,m,[`${eV.rgb}|${p}`,`${eV.alpha}|${p}`]),this.slotIndex=0,this.slotIndex=p}getFrameEntries(){return 5}setFrame(i,m,p,_,x,y){i*=5,this.frames[i]=m,this.frames[i+1]=p,this.frames[i+2]=_,this.frames[i+3]=x,this.frames[i+4]=y}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(!v.bone.active)return;let E=this.frames,A=v.color;if(p<E[0]){let i=v.data.color;switch(y){case G.setup:A.setFromColor(i);break;case G.first:A.add((i.r-A.r)*x,(i.g-A.g)*x,(i.b-A.b)*x,(i.a-A.a)*x)}return}let S=0,I=0,R=0,C=0,P=Timeline.search(E,p,5),k=this.curves[P/5];switch(k){case 0:let B=E[P];S=E[P+1],I=E[P+2],R=E[P+3],C=E[P+4];let D=(p-B)/(E[P+5]-B);S+=(E[P+5+1]-S)*D,I+=(E[P+5+2]-I)*D,R+=(E[P+5+3]-R)*D,C+=(E[P+5+4]-C)*D;break;case 1:S=E[P+1],I=E[P+2],R=E[P+3],C=E[P+4];break;default:S=this.getBezierValue(p,P,1,k-2),I=this.getBezierValue(p,P,2,k+18-2),R=this.getBezierValue(p,P,3,k+36-2),C=this.getBezierValue(p,P,4,k+54-2)}1==x?A.set(S,I,R,C):(y==G.setup&&A.setFromColor(v.data.color),A.add((S-A.r)*x,(I-A.g)*x,(R-A.b)*x,(C-A.a)*x))}};let RGBTimeline=class RGBTimeline extends lib_core_Animation_CurveTimeline{constructor(i,m,p){super(i,m,[`${eV.rgb}|${p}`]),this.slotIndex=0,this.slotIndex=p}getFrameEntries(){return 4}setFrame(i,m,p,_,x){i<<=2,this.frames[i]=m,this.frames[i+1]=p,this.frames[i+2]=_,this.frames[i+3]=x}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(!v.bone.active)return;let E=this.frames,A=v.color;if(p<E[0]){let i=v.data.color;switch(y){case G.setup:A.r=i.r,A.g=i.g,A.b=i.b;break;case G.first:A.r+=(i.r-A.r)*x,A.g+=(i.g-A.g)*x,A.b+=(i.b-A.b)*x}return}let S=0,I=0,R=0,C=Timeline.search(E,p,4),P=this.curves[C>>2];switch(P){case 0:let k=E[C];S=E[C+1],I=E[C+2],R=E[C+3];let B=(p-k)/(E[C+4]-k);S+=(E[C+4+1]-S)*B,I+=(E[C+4+2]-I)*B,R+=(E[C+4+3]-R)*B;break;case 1:S=E[C+1],I=E[C+2],R=E[C+3];break;default:S=this.getBezierValue(p,C,1,P-2),I=this.getBezierValue(p,C,2,P+18-2),R=this.getBezierValue(p,C,3,P+36-2)}if(1==x)A.r=S,A.g=I,A.b=R;else{if(y==G.setup){let i=v.data.color;A.r=i.r,A.g=i.g,A.b=i.b}A.r+=(S-A.r)*x,A.g+=(I-A.g)*x,A.b+=(R-A.b)*x}}};let AlphaTimeline=class AlphaTimeline extends CurveTimeline1{constructor(i,m,p){super(i,m,`${eV.alpha}|${p}`),this.slotIndex=0,this.slotIndex=p}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(!v.bone.active)return;let E=v.color;if(p<this.frames[0]){let i=v.data.color;switch(y){case G.setup:E.a=i.a;break;case G.first:E.a+=(i.a-E.a)*x}return}let A=this.getCurveValue(p);1==x?E.a=A:(y==G.setup&&(E.a=v.data.color.a),E.a+=(A-E.a)*x)}};let RGBA2Timeline=class RGBA2Timeline extends lib_core_Animation_CurveTimeline{constructor(i,m,p){super(i,m,[`${eV.rgb}|${p}`,`${eV.alpha}|${p}`,`${eV.rgb2}|${p}`]),this.slotIndex=0,this.slotIndex=p}getFrameEntries(){return 8}setFrame(i,m,p,_,x,y,T,v,E){i<<=3,this.frames[i]=m,this.frames[i+1]=p,this.frames[i+2]=_,this.frames[i+3]=x,this.frames[i+4]=y,this.frames[i+5]=T,this.frames[i+6]=v,this.frames[i+7]=E}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(!v.bone.active)return;let E=this.frames,A=v.color,S=v.darkColor;if(p<E[0]){let i=v.data.color,m=v.data.darkColor;switch(y){case G.setup:A.setFromColor(i),S.r=m.r,S.g=m.g,S.b=m.b;break;case G.first:A.add((i.r-A.r)*x,(i.g-A.g)*x,(i.b-A.b)*x,(i.a-A.a)*x),S.r+=(m.r-S.r)*x,S.g+=(m.g-S.g)*x,S.b+=(m.b-S.b)*x}return}let I=0,R=0,C=0,P=0,k=0,B=0,D=0,F=Timeline.search(E,p,8),L=this.curves[F>>3];switch(L){case 0:let O=E[F];I=E[F+1],R=E[F+2],C=E[F+3],P=E[F+4],k=E[F+5],B=E[F+6],D=E[F+7];let V=(p-O)/(E[F+8]-O);I+=(E[F+8+1]-I)*V,R+=(E[F+8+2]-R)*V,C+=(E[F+8+3]-C)*V,P+=(E[F+8+4]-P)*V,k+=(E[F+8+5]-k)*V,B+=(E[F+8+6]-B)*V,D+=(E[F+8+7]-D)*V;break;case 1:I=E[F+1],R=E[F+2],C=E[F+3],P=E[F+4],k=E[F+5],B=E[F+6],D=E[F+7];break;default:I=this.getBezierValue(p,F,1,L-2),R=this.getBezierValue(p,F,2,L+18-2),C=this.getBezierValue(p,F,3,L+36-2),P=this.getBezierValue(p,F,4,L+54-2),k=this.getBezierValue(p,F,5,L+72-2),B=this.getBezierValue(p,F,6,L+90-2),D=this.getBezierValue(p,F,7,L+108-2)}if(1==x)A.set(I,R,C,P),S.r=k,S.g=B,S.b=D;else{if(y==G.setup){A.setFromColor(v.data.color);let i=v.data.darkColor;S.r=i.r,S.g=i.g,S.b=i.b}A.add((I-A.r)*x,(R-A.g)*x,(C-A.b)*x,(P-A.a)*x),S.r+=(k-S.r)*x,S.g+=(B-S.g)*x,S.b+=(D-S.b)*x}}};let RGB2Timeline=class RGB2Timeline extends lib_core_Animation_CurveTimeline{constructor(i,m,p){super(i,m,[`${eV.rgb}|${p}`,`${eV.rgb2}|${p}`]),this.slotIndex=0,this.slotIndex=p}getFrameEntries(){return 7}setFrame(i,m,p,_,x,y,T,v){i*=7,this.frames[i]=m,this.frames[i+1]=p,this.frames[i+2]=_,this.frames[i+3]=x,this.frames[i+4]=y,this.frames[i+5]=T,this.frames[i+6]=v}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(!v.bone.active)return;let E=this.frames,A=v.color,S=v.darkColor;if(p<E[0]){let i=v.data.color,m=v.data.darkColor;switch(y){case G.setup:A.r=i.r,A.g=i.g,A.b=i.b,S.r=m.r,S.g=m.g,S.b=m.b;break;case G.first:A.r+=(i.r-A.r)*x,A.g+=(i.g-A.g)*x,A.b+=(i.b-A.b)*x,S.r+=(m.r-S.r)*x,S.g+=(m.g-S.g)*x,S.b+=(m.b-S.b)*x}return}let I=0,R=0,C=0,P=0,k=0,B=0,D=Timeline.search(E,p,7),F=this.curves[D/7];switch(F){case 0:let L=E[D];I=E[D+1],R=E[D+2],C=E[D+3],P=E[D+4],k=E[D+5],B=E[D+6];let O=(p-L)/(E[D+7]-L);I+=(E[D+7+1]-I)*O,R+=(E[D+7+2]-R)*O,C+=(E[D+7+3]-C)*O,P+=(E[D+7+4]-P)*O,k+=(E[D+7+5]-k)*O,B+=(E[D+7+6]-B)*O;break;case 1:I=E[D+1],R=E[D+2],C=E[D+3],P=E[D+4],k=E[D+5],B=E[D+6];break;default:I=this.getBezierValue(p,D,1,F-2),R=this.getBezierValue(p,D,2,F+18-2),C=this.getBezierValue(p,D,3,F+36-2),P=this.getBezierValue(p,D,4,F+54-2),k=this.getBezierValue(p,D,5,F+72-2),B=this.getBezierValue(p,D,6,F+90-2)}if(1==x)A.r=I,A.g=R,A.b=C,S.r=P,S.g=k,S.b=B;else{if(y==G.setup){let i=v.data.color,m=v.data.darkColor;A.r=i.r,A.g=i.g,A.b=i.b,S.r=m.r,S.g=m.g,S.b=m.b}A.r+=(I-A.r)*x,A.g+=(R-A.g)*x,A.b+=(C-A.b)*x,S.r+=(P-S.r)*x,S.g+=(k-S.g)*x,S.b+=(B-S.b)*x}}};let core_Animation_AttachmentTimeline=class core_Animation_AttachmentTimeline extends Timeline{constructor(i,m){super(i,[`${eV.attachment}|${m}`]),this.slotIndex=0,this.slotIndex=m,this.attachmentNames=Array(i)}getFrameCount(){return this.frames.length}setFrame(i,m,p){this.frames[i]=m,this.attachmentNames[i]=p}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(v.bone.active){if(T==W.mixOut){y==G.setup&&this.setAttachment(i,v,v.data.attachmentName);return}if(p<this.frames[0]){(y==G.setup||y==G.first)&&this.setAttachment(i,v,v.data.attachmentName);return}this.setAttachment(i,v,this.attachmentNames[Timeline.search1(this.frames,p)])}}setAttachment(i,m,p){m.setAttachment(p?i.getAttachment(this.slotIndex,p):null)}};let core_Animation_DeformTimeline=class core_Animation_DeformTimeline extends lib_core_Animation_CurveTimeline{constructor(i,m,p,_){super(i,m,[`${eV.deform}|${p}|${_.id}`]),this.slotIndex=0,this.slotIndex=p,this.attachment=_,this.vertices=Array(i)}getFrameCount(){return this.frames.length}setFrame(i,m,p){this.frames[i]=m,this.vertices[i]=p}setBezier(i,m,p,_,x,y,T,v,E,A,S){let I=this.curves,R=this.getFrameCount()+18*i;0==p&&(I[m]=2+R);let C=(_-2*y+v)*.03,P=.03*E-.06*T,k=((y-v)*3-_+A)*.006,B=(T-E+.33333333)*.018,D=2*C+k,F=2*P+B,L=(y-_)*.3+C+.16666667*k,O=.3*T+P+.16666667*B,V=_+L,U=O;for(let i=R+18;R<i;R+=2)I[R]=V,I[R+1]=U,L+=D,O+=F,D+=k,F+=B,V+=L,U+=O}getCurvePercent(i,m){let p=this.curves,_=p[m];switch(_){case 0:let x=this.frames[m];return(i-x)/(this.frames[m+this.getFrameEntries()]-x);case 1:return 0}if(p[_-=2]>i){let x=this.frames[m];return p[_+1]*(i-x)/(p[_]-x)}let y=_+18;for(_+=2;_<y;_+=2)if(p[_]>=i){let m=p[_-2],x=p[_-1];return x+(i-m)/(p[_]-m)*(p[_+1]-x)}let T=p[y-2],v=p[y-1];return v+(1-v)*(i-T)/(this.frames[m+this.getFrameEntries()]-T)}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(!v.bone.active)return;let E=v.getAttachment();if(!E||!(E instanceof ek)||E.timelineAttachment!=this.attachment)return;let A=v.deform;0==A.length&&(y=G.setup);let S=this.vertices,I=S[0].length,R=this.frames;if(p<R[0]){switch(y){case G.setup:A.length=0;break;case G.first:if(1==x){A.length=0;break}if(A.length=I,E.bones){x=1-x;for(let i=0;i<I;i++)A[i]*=x}else{let i=E.vertices;for(let m=0;m<I;m++)A[m]+=(i[m]-A[m])*x}}return}if(A.length=I,p>=R[R.length-1]){let i=S[R.length-1];if(1==x){if(y==G.add){if(E.bones)for(let m=0;m<I;m++)A[m]+=i[m];else{let m=E.vertices;for(let p=0;p<I;p++)A[p]+=i[p]-m[p]}}else tr.arrayCopy(i,0,A,0,I)}else switch(y){case G.setup:if(E.bones)for(let m=0;m<I;m++)A[m]=i[m]*x;else{let m=E.vertices;for(let p=0;p<I;p++){let _=m[p];A[p]=_+(i[p]-_)*x}}break;case G.first:case G.replace:for(let m=0;m<I;m++)A[m]+=(i[m]-A[m])*x;break;case G.add:if(E.bones)for(let m=0;m<I;m++)A[m]+=i[m]*x;else{let m=E.vertices;for(let p=0;p<I;p++)A[p]+=(i[p]-m[p])*x}}return}let C=Timeline.search1(R,p),P=this.getCurvePercent(p,C),k=S[C],B=S[C+1];if(1==x){if(y==G.add){if(E.bones)for(let i=0;i<I;i++){let m=k[i];A[i]+=m+(B[i]-m)*P}else{let i=E.vertices;for(let m=0;m<I;m++){let p=k[m];A[m]+=p+(B[m]-p)*P-i[m]}}}else for(let i=0;i<I;i++){let m=k[i];A[i]=m+(B[i]-m)*P}}else switch(y){case G.setup:if(E.bones)for(let i=0;i<I;i++){let m=k[i];A[i]=(m+(B[i]-m)*P)*x}else{let i=E.vertices;for(let m=0;m<I;m++){let p=k[m],_=i[m];A[m]=_+(p+(B[m]-p)*P-_)*x}}break;case G.first:case G.replace:for(let i=0;i<I;i++){let m=k[i];A[i]+=(m+(B[i]-m)*P-A[i])*x}break;case G.add:if(E.bones)for(let i=0;i<I;i++){let m=k[i];A[i]+=(m+(B[i]-m)*P)*x}else{let i=E.vertices;for(let m=0;m<I;m++){let p=k[m];A[m]+=(p+(B[m]-p)*P-i[m])*x}}}}};let eU=class extends Timeline{constructor(i){super(i,eU.propertyIds),this.events=Array(i)}getFrameCount(){return this.frames.length}setFrame(i,m){this.frames[i]=m.time,this.events[i]=m}apply(i,m,p,_,x,y,T){if(!_)return;let v=this.frames,E=this.frames.length;if(m>p)this.apply(i,m,Number.MAX_VALUE,_,x,y,T),m=-1;else if(m>=v[E-1])return;if(p<v[0])return;let A=0;if(m<v[0])A=0;else{A=Timeline.search1(v,m)+1;let i=v[A];for(;A>0&&v[A-1]==i;)A--}for(;A<E&&p>=v[A];A++)_.push(this.events[A])}},eX=eU;eX.propertyIds=[`${eV.event}`];let eY=class extends Timeline{constructor(i){super(i,eY.propertyIds),this.drawOrders=Array(i)}getFrameCount(){return this.frames.length}setFrame(i,m,p){this.frames[i]=m,this.drawOrders[i]=p}apply(i,m,p,_,x,y,T){if(T==W.mixOut){y==G.setup&&tr.arrayCopy(i.slots,0,i.drawOrder,0,i.slots.length);return}if(p<this.frames[0]){(y==G.setup||y==G.first)&&tr.arrayCopy(i.slots,0,i.drawOrder,0,i.slots.length);return}let v=Timeline.search1(this.frames,p),E=this.drawOrders[v];if(E){let m=i.drawOrder,p=i.slots;for(let i=0,_=E.length;i<_;i++)m[i]=p[E[i]]}else tr.arrayCopy(i.slots,0,i.drawOrder,0,i.slots.length)}},eG=eY;eG.propertyIds=[`${eV.drawOrder}`];let lib_core_Animation_IkConstraintTimeline=class lib_core_Animation_IkConstraintTimeline extends lib_core_Animation_CurveTimeline{constructor(i,m,p){super(i,m,[`${eV.ikConstraint}|${p}`]),this.ikConstraintIndex=0,this.ikConstraintIndex=p}getFrameEntries(){return 6}setFrame(i,m,p,_,x,y,T){i*=6,this.frames[i]=m,this.frames[i+1]=p,this.frames[i+2]=_,this.frames[i+3]=x,this.frames[i+4]=y?1:0,this.frames[i+5]=T?1:0}apply(i,m,p,_,x,y,T){let v=i.ikConstraints[this.ikConstraintIndex];if(!v.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.mix=v.data.mix,v.softness=v.data.softness,v.bendDirection=v.data.bendDirection,v.compress=v.data.compress,v.stretch=v.data.stretch;break;case G.first:v.mix+=(v.data.mix-v.mix)*x,v.softness+=(v.data.softness-v.softness)*x,v.bendDirection=v.data.bendDirection,v.compress=v.data.compress,v.stretch=v.data.stretch}return}let A=0,S=0,I=Timeline.search(E,p,6),R=this.curves[I/6];switch(R){case 0:let C=E[I];A=E[I+1],S=E[I+2];let P=(p-C)/(E[I+6]-C);A+=(E[I+6+1]-A)*P,S+=(E[I+6+2]-S)*P;break;case 1:A=E[I+1],S=E[I+2];break;default:A=this.getBezierValue(p,I,1,R-2),S=this.getBezierValue(p,I,2,R+18-2)}y==G.setup?(v.mix=v.data.mix+(A-v.data.mix)*x,v.softness=v.data.softness+(S-v.data.softness)*x,T==W.mixOut?(v.bendDirection=v.data.bendDirection,v.compress=v.data.compress,v.stretch=v.data.stretch):(v.bendDirection=E[I+3],v.compress=0!=E[I+4],v.stretch=0!=E[I+5])):(v.mix+=(A-v.mix)*x,v.softness+=(S-v.softness)*x,T==W.mixIn&&(v.bendDirection=E[I+3],v.compress=0!=E[I+4],v.stretch=0!=E[I+5]))}};let lib_core_Animation_TransformConstraintTimeline=class lib_core_Animation_TransformConstraintTimeline extends lib_core_Animation_CurveTimeline{constructor(i,m,p){super(i,m,[`${eV.transformConstraint}|${p}`]),this.transformConstraintIndex=0,this.transformConstraintIndex=p}getFrameEntries(){return 7}setFrame(i,m,p,_,x,y,T,v){let E=this.frames;E[i*=7]=m,E[i+1]=p,E[i+2]=_,E[i+3]=x,E[i+4]=y,E[i+5]=T,E[i+6]=v}apply(i,m,p,_,x,y,T){let v,E,A,S,I,R;let C=i.transformConstraints[this.transformConstraintIndex];if(!C.active)return;let P=this.frames;if(p<P[0]){let i=C.data;switch(y){case G.setup:C.mixRotate=i.mixRotate,C.mixX=i.mixX,C.mixY=i.mixY,C.mixScaleX=i.mixScaleX,C.mixScaleY=i.mixScaleY,C.mixShearY=i.mixShearY;break;case G.first:C.mixRotate+=(i.mixRotate-C.mixRotate)*x,C.mixX+=(i.mixX-C.mixX)*x,C.mixY+=(i.mixY-C.mixY)*x,C.mixScaleX+=(i.mixScaleX-C.mixScaleX)*x,C.mixScaleY+=(i.mixScaleY-C.mixScaleY)*x,C.mixShearY+=(i.mixShearY-C.mixShearY)*x}return}let k=Timeline.search(P,p,7),B=this.curves[k/7];switch(B){case 0:let D=P[k];v=P[k+1],E=P[k+2],A=P[k+3],S=P[k+4],I=P[k+5],R=P[k+6];let F=(p-D)/(P[k+7]-D);v+=(P[k+7+1]-v)*F,E+=(P[k+7+2]-E)*F,A+=(P[k+7+3]-A)*F,S+=(P[k+7+4]-S)*F,I+=(P[k+7+5]-I)*F,R+=(P[k+7+6]-R)*F;break;case 1:v=P[k+1],E=P[k+2],A=P[k+3],S=P[k+4],I=P[k+5],R=P[k+6];break;default:v=this.getBezierValue(p,k,1,B-2),E=this.getBezierValue(p,k,2,B+18-2),A=this.getBezierValue(p,k,3,B+36-2),S=this.getBezierValue(p,k,4,B+54-2),I=this.getBezierValue(p,k,5,B+72-2),R=this.getBezierValue(p,k,6,B+90-2)}if(y==G.setup){let i=C.data;C.mixRotate=i.mixRotate+(v-i.mixRotate)*x,C.mixX=i.mixX+(E-i.mixX)*x,C.mixY=i.mixY+(A-i.mixY)*x,C.mixScaleX=i.mixScaleX+(S-i.mixScaleX)*x,C.mixScaleY=i.mixScaleY+(I-i.mixScaleY)*x,C.mixShearY=i.mixShearY+(R-i.mixShearY)*x}else C.mixRotate+=(v-C.mixRotate)*x,C.mixX+=(E-C.mixX)*x,C.mixY+=(A-C.mixY)*x,C.mixScaleX+=(S-C.mixScaleX)*x,C.mixScaleY+=(I-C.mixScaleY)*x,C.mixShearY+=(R-C.mixShearY)*x}};let lib_core_Animation_PathConstraintPositionTimeline=class lib_core_Animation_PathConstraintPositionTimeline extends CurveTimeline1{constructor(i,m,p){super(i,m,`${eV.pathConstraintPosition}|${p}`),this.pathConstraintIndex=0,this.pathConstraintIndex=p}apply(i,m,p,_,x,y,T){let v=i.pathConstraints[this.pathConstraintIndex];if(!v.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.position=v.data.position;break;case G.first:v.position+=(v.data.position-v.position)*x}return}let A=this.getCurveValue(p);y==G.setup?v.position=v.data.position+(A-v.data.position)*x:v.position+=(A-v.position)*x}};let core_Animation_PathConstraintSpacingTimeline=class core_Animation_PathConstraintSpacingTimeline extends CurveTimeline1{constructor(i,m,p){super(i,m,`${eV.pathConstraintSpacing}|${p}`),this.pathConstraintIndex=0,this.pathConstraintIndex=p}apply(i,m,p,_,x,y,T){let v=i.pathConstraints[this.pathConstraintIndex];if(!v.active)return;let E=this.frames;if(p<E[0]){switch(y){case G.setup:v.spacing=v.data.spacing;break;case G.first:v.spacing+=(v.data.spacing-v.spacing)*x}return}let A=this.getCurveValue(p);y==G.setup?v.spacing=v.data.spacing+(A-v.data.spacing)*x:v.spacing+=(A-v.spacing)*x}};let lib_core_Animation_PathConstraintMixTimeline=class lib_core_Animation_PathConstraintMixTimeline extends lib_core_Animation_CurveTimeline{constructor(i,m,p){super(i,m,[`${eV.pathConstraintMix}|${p}`]),this.pathConstraintIndex=0,this.pathConstraintIndex=p}getFrameEntries(){return 4}setFrame(i,m,p,_,x){let y=this.frames;y[i<<=2]=m,y[i+1]=p,y[i+2]=_,y[i+3]=x}apply(i,m,p,_,x,y,T){let v,E,A;let S=i.pathConstraints[this.pathConstraintIndex];if(!S.active)return;let I=this.frames;if(p<I[0]){switch(y){case G.setup:S.mixRotate=S.data.mixRotate,S.mixX=S.data.mixX,S.mixY=S.data.mixY;break;case G.first:S.mixRotate+=(S.data.mixRotate-S.mixRotate)*x,S.mixX+=(S.data.mixX-S.mixX)*x,S.mixY+=(S.data.mixY-S.mixY)*x}return}let R=Timeline.search(I,p,4),C=this.curves[R>>2];switch(C){case 0:let P=I[R];v=I[R+1],E=I[R+2],A=I[R+3];let k=(p-P)/(I[R+4]-P);v+=(I[R+4+1]-v)*k,E+=(I[R+4+2]-E)*k,A+=(I[R+4+3]-A)*k;break;case 1:v=I[R+1],E=I[R+2],A=I[R+3];break;default:v=this.getBezierValue(p,R,1,C-2),E=this.getBezierValue(p,R,2,C+18-2),A=this.getBezierValue(p,R,3,C+36-2)}if(y==G.setup){let i=S.data;S.mixRotate=i.mixRotate+(v-i.mixRotate)*x,S.mixX=i.mixX+(E-i.mixX)*x,S.mixY=i.mixY+(A-i.mixY)*x}else S.mixRotate+=(v-S.mixRotate)*x,S.mixX+=(E-S.mixX)*x,S.mixY+=(A-S.mixY)*x}};let eH=class extends Timeline{constructor(i,m,p){super(i,[`${eV.sequence}|${m}|${p.sequence.id}`]),this.slotIndex=m,this.attachment=p}getFrameEntries(){return eH.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(i,m,p,_,x){let y=this.frames;y[i*=eH.ENTRIES]=m,y[i+eH.MODE]=p|_<<4,y[i+eH.DELAY]=x}apply(i,m,p,_,x,y,T){let v=i.slots[this.slotIndex];if(!v.bone.active)return;let E=v.attachment,A=this.attachment;if(E!=A&&(!(E instanceof ek)||E.timelineAttachment!=A))return;let S=this.frames;if(p<S[0]){(y==G.setup||y==G.first)&&(v.sequenceIndex=-1);return}let I=Timeline.search(S,p,eH.ENTRIES),R=S[I],C=S[I+eH.MODE],P=S[I+eH.DELAY];if(!this.attachment.sequence)return;let k=C>>4,B=this.attachment.sequence.regions.length,D=eO[15&C];if(D!=eL.hold)switch(k+=(p-R)/P+1e-5|0,D){case eL.once:k=Math.min(B-1,k);break;case eL.loop:k%=B;break;case eL.pingpong:{let i=(B<<1)-2;(k=0==i?0:k%i)>=B&&(k=i-k);break}case eL.onceReverse:k=Math.max(B-1-k,0);break;case eL.loopReverse:k=B-1-k%B;break;case eL.pingpongReverse:{let i=(B<<1)-2;(k=0==i?0:(k+B-1)%i)>=B&&(k=i-k)}}v.sequenceIndex=k}},eW=eH;eW.ENTRIES=3,eW.MODE=1,eW.DELAY=2;let e$=class{constructor(i){this.tracks=[],this.timeScale=1,this.unkeyedState=0,this.events=[],this.listeners=[],this.queue=new lib_core_AnimationState_EventQueue(this),this.propertyIDs=new StringSet,this.animationsChanged=!1,this.trackEntryPool=new Pool(()=>new eq),this.data=i}static emptyAnimation(){return e$._emptyAnimation}update(i){i*=this.timeScale;let m=this.tracks;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(!_)continue;_.animationLast=_.nextAnimationLast,_.trackLast=_.nextTrackLast;let x=i*_.timeScale;if(_.delay>0){if(_.delay-=x,_.delay>0)continue;x=-_.delay,_.delay=0}let y=_.next;if(y){let m=_.trackLast-y.delay;if(m>=0){for(y.delay=0,y.trackTime+=0==_.timeScale?0:(m/_.timeScale+i)*y.timeScale,_.trackTime+=x,this.setCurrent(p,y,!0);y.mixingFrom;)y.mixTime+=i,y=y.mixingFrom;continue}}else if(_.trackLast>=_.trackEnd&&!_.mixingFrom){m[p]=null,this.queue.end(_),this.clearNext(_);continue}if(_.mixingFrom&&this.updateMixingFrom(_,i)){let i=_.mixingFrom;for(_.mixingFrom=null,i&&(i.mixingTo=null);i;)this.queue.end(i),i=i.mixingFrom}_.trackTime+=x}this.queue.drain()}updateMixingFrom(i,m){let p=i.mixingFrom;if(!p)return!0;let _=this.updateMixingFrom(p,m);return(p.animationLast=p.nextAnimationLast,p.trackLast=p.nextTrackLast,i.mixTime>0&&i.mixTime>=i.mixDuration)?((0==p.totalAlpha||0==i.mixDuration)&&(i.mixingFrom=p.mixingFrom,p.mixingFrom&&(p.mixingFrom.mixingTo=i),i.interruptAlpha=p.interruptAlpha,this.queue.end(p)),_):(p.trackTime+=m*p.timeScale,i.mixTime+=m,!1)}apply(i){if(!i)throw Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let m=this.events,p=this.tracks,_=!1;for(let x=0,y=p.length;x<y;x++){let y=p[x];if(!y||y.delay>0)continue;_=!0;let T=0==x?G.first:y.mixBlend,v=y.alpha;y.mixingFrom?v*=this.applyMixingFrom(y,i,T):y.trackTime>=y.trackEnd&&!y.next&&(v=0);let E=y.animationLast,A=y.getAnimationTime(),S=A,I=m;y.reverse&&(S=y.animation.duration-S,I=null);let R=y.animation.timelines,C=R.length;if(0==x&&1==v||T==G.add)for(let m=0;m<C;m++){tr.webkit602BugfixHelper(v,T);let p=R[m];p instanceof core_Animation_AttachmentTimeline?this.applyAttachmentTimeline(p,i,S,T,!0):p.apply(i,E,S,I,v,T,W.mixIn)}else{let m=y.timelineMode,p=y.shortestRotation,_=!p&&y.timelinesRotation.length!=C<<1;_&&(y.timelinesRotation.length=C<<1);for(let x=0;x<C;x++){let A=R[x],C=m[x]==eK?T:G.setup;!p&&A instanceof lib_core_Animation_RotateTimeline?this.applyRotateTimeline(A,i,S,v,C,y.timelinesRotation,x<<1,_):A instanceof core_Animation_AttachmentTimeline?this.applyAttachmentTimeline(A,i,S,T,!0):(tr.webkit602BugfixHelper(v,T),A.apply(i,E,S,I,v,C,W.mixIn))}}this.queueEvents(y,A),m.length=0,y.nextAnimationLast=A,y.nextTrackLast=y.trackTime}let x=this.unkeyedState+e2,y=i.slots;for(let m=0,p=i.slots.length;m<p;m++){let p=y[m];if(p.attachmentState==x){let m=p.data.attachmentName;p.setAttachment(m?i.getAttachment(p.data.index,m):null)}}return this.unkeyedState+=2,this.queue.drain(),_}applyMixingFrom(i,m,p){let _=i.mixingFrom;_.mixingFrom&&this.applyMixingFrom(_,m,p);let x=0;0==i.mixDuration?(x=1,p==G.first&&(p=G.setup)):((x=i.mixTime/i.mixDuration)>1&&(x=1),p!=G.first&&(p=_.mixBlend));let y=x<_.attachmentThreshold,T=x<_.drawOrderThreshold,v=_.animation.timelines,E=v.length,A=_.alpha*i.interruptAlpha,S=A*(1-x),I=_.animationLast,R=_.getAnimationTime(),C=R,P=null;if(_.reverse?C=_.animation.duration-C:x<_.eventThreshold&&(P=this.events),p==G.add)for(let i=0;i<E;i++)v[i].apply(m,I,C,P,S,p,W.mixOut);else{let i=_.timelineMode,x=_.timelineHoldMix,R=_.shortestRotation,k=!R&&_.timelinesRotation.length!=E<<1;k&&(_.timelinesRotation.length=E<<1),_.totalAlpha=0;for(let B=0;B<E;B++){let E;let D=v[B],F=W.mixOut,L=0;switch(i[B]){case eK:if(!T&&D instanceof eG)continue;E=p,L=S;break;case eJ:E=G.setup,L=S;break;case eQ:E=p,L=A;break;case e0:E=G.setup,L=A;break;default:E=G.setup;let O=x[B];L=A*Math.max(0,1-O.mixTime/O.mixDuration)}_.totalAlpha+=L,!R&&D instanceof lib_core_Animation_RotateTimeline?this.applyRotateTimeline(D,m,C,L,E,_.timelinesRotation,B<<1,k):D instanceof core_Animation_AttachmentTimeline?this.applyAttachmentTimeline(D,m,C,E,y):(tr.webkit602BugfixHelper(L,p),T&&D instanceof eG&&E==G.setup&&(F=W.mixIn),D.apply(m,I,C,P,L,E,F))}}return i.mixDuration>0&&this.queueEvents(_,R),this.events.length=0,_.nextAnimationLast=R,_.nextTrackLast=_.trackTime,x}applyAttachmentTimeline(i,m,p,_,x){let y=m.slots[i.slotIndex];y.bone.active&&(p<i.frames[0]?(_==G.setup||_==G.first)&&this.setAttachment(m,y,y.data.attachmentName,x):this.setAttachment(m,y,i.attachmentNames[Timeline.search1(i.frames,p)],x),y.attachmentState<=this.unkeyedState&&(y.attachmentState=this.unkeyedState+e2))}setAttachment(i,m,p,_){m.setAttachment(p?i.getAttachment(m.data.index,p):null),_&&(m.attachmentState=this.unkeyedState+e3)}applyRotateTimeline(i,m,p,_,x,y,T,v){if(v&&(y[T]=0),1==_){i.apply(m,0,p,null,1,x,W.mixIn);return}let E=m.bones[i.boneIndex];if(!E.active)return;let A=i.frames,S=0,I=0;if(p<A[0])switch(x){case G.setup:E.rotation=E.data.rotation;default:return;case G.first:S=E.rotation,I=E.data.rotation}else S=x==G.setup?E.data.rotation:E.rotation,I=E.data.rotation+i.getCurveValue(p);let R=0,C=I-S;if(0==(C-=(16384-(16384.499999999996-C/360|0))*360))R=y[T];else{let i=0,m=0;v?(i=0,m=C):(i=y[T],m=y[T+1]);let p=C>0,_=i>=0;te.signum(m)!=te.signum(C)&&90>=Math.abs(m)&&(Math.abs(i)>180&&(i+=360*te.signum(i)),_=p),R=C+i-i%360,_!=p&&(R+=360*te.signum(i)),y[T]=R}y[T+1]=C,E.rotation=S+R*_}queueEvents(i,m){let p=i.animationStart,_=i.animationEnd,x=_-p,y=i.trackLast%x,T=this.events,v=0,E=T.length;for(;v<E;v++){let m=T[v];if(m.time<y)break;m.time>_||this.queue.event(i,m)}for((i.loop?0==x||y>i.trackTime%x:m>=_&&i.animationLast<_)&&this.queue.complete(i);v<E;v++){let m=T[v];m.time<p||this.queue.event(i,m)}}clearTracks(){let i=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let i=0,m=this.tracks.length;i<m;i++)this.clearTrack(i);this.tracks.length=0,this.queue.drainDisabled=i,this.queue.drain()}clearTrack(i){if(i>=this.tracks.length)return;let m=this.tracks[i];if(!m)return;this.queue.end(m),this.clearNext(m);let p=m;for(;;){let i=p.mixingFrom;if(!i)break;this.queue.end(i),p.mixingFrom=null,p.mixingTo=null,p=i}this.tracks[m.trackIndex]=null,this.queue.drain()}setCurrent(i,m,p){let _=this.expandToIndex(i);this.tracks[i]=m,m.previous=null,_&&(p&&this.queue.interrupt(_),m.mixingFrom=_,_.mixingTo=m,m.mixTime=0,_.mixingFrom&&_.mixDuration>0&&(m.interruptAlpha*=Math.min(1,_.mixTime/_.mixDuration)),_.timelinesRotation.length=0),this.queue.start(m)}setAnimation(i,m,p=!1){let _=this.data.skeletonData.findAnimation(m);if(!_)throw Error(`Animation not found: ${m}`);return this.setAnimationWith(i,_,p)}setAnimationWith(i,m,p=!1){if(!m)throw Error("animation cannot be null.");let _=!0,x=this.expandToIndex(i);x&&(-1==x.nextTrackLast?(this.tracks[i]=x.mixingFrom,this.queue.interrupt(x),this.queue.end(x),this.clearNext(x),x=x.mixingFrom,_=!1):this.clearNext(x));let y=this.trackEntry(i,m,p,x);return this.setCurrent(i,y,_),this.queue.drain(),y}addAnimation(i,m,p=!1,_=0){let x=this.data.skeletonData.findAnimation(m);if(!x)throw Error(`Animation not found: ${m}`);return this.addAnimationWith(i,x,p,_)}addAnimationWith(i,m,p=!1,_=0){if(!m)throw Error("animation cannot be null.");let x=this.expandToIndex(i);if(x)for(;x.next;)x=x.next;let y=this.trackEntry(i,m,p,x);return x?(x.next=y,y.previous=x,_<=0&&(_+=x.getTrackComplete()-y.mixDuration)):(this.setCurrent(i,y,!0),this.queue.drain()),y.delay=_,y}setEmptyAnimation(i,m=0){let p=this.setAnimationWith(i,e$.emptyAnimation(),!1);return p.mixDuration=m,p.trackEnd=m,p}addEmptyAnimation(i,m=0,p=0){let _=this.addAnimationWith(i,e$.emptyAnimation(),!1,p);return p<=0&&(_.delay+=_.mixDuration-m),_.mixDuration=m,_.trackEnd=m,_}setEmptyAnimations(i=0){let m=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let m=0,p=this.tracks.length;m<p;m++){let p=this.tracks[m];p&&this.setEmptyAnimation(p.trackIndex,i)}this.queue.drainDisabled=m,this.queue.drain()}expandToIndex(i){return i<this.tracks.length?this.tracks[i]:(tr.ensureArrayCapacity(this.tracks,i+1,null),this.tracks.length=i+1,null)}trackEntry(i,m,p,_){let x=this.trackEntryPool.obtain();return x.reset(),x.trackIndex=i,x.animation=m,x.loop=p,x.holdPrevious=!1,x.reverse=!1,x.shortestRotation=!1,x.eventThreshold=0,x.attachmentThreshold=0,x.drawOrderThreshold=0,x.animationStart=0,x.animationEnd=m.duration,x.animationLast=-1,x.nextAnimationLast=-1,x.delay=0,x.trackTime=0,x.trackLast=-1,x.nextTrackLast=-1,x.trackEnd=Number.MAX_VALUE,x.timeScale=1,x.alpha=1,x.mixTime=0,x.mixDuration=_?this.data.getMix(_.animation,m):0,x.interruptAlpha=1,x.totalAlpha=0,x.mixBlend=G.replace,x}clearNext(i){let m=i.next;for(;m;)this.queue.dispose(m),m=m.next;i.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let i=this.tracks;for(let m=0,p=i.length;m<p;m++){let p=i[m];if(p){for(;p.mixingFrom;)p=p.mixingFrom;do p.mixingTo&&p.mixBlend==G.add||this.computeHold(p),p=p.mixingTo;while(p)}}}computeHold(i){let m=i.mixingTo,p=i.animation.timelines,_=i.animation.timelines.length,x=i.timelineMode;x.length=_;let y=i.timelineHoldMix;y.length=0;let T=this.propertyIDs;if(m&&m.holdPrevious){for(let i=0;i<_;i++)x[i]=T.addAll(p[i].getPropertyIds())?e0:eQ;return}t:for(let v=0;v<_;v++){let _=p[v],E=_.getPropertyIds();if(T.addAll(E)){if(!m||_ instanceof core_Animation_AttachmentTimeline||_ instanceof eG||_ instanceof eX||!m.animation.hasTimeline(E))x[v]=eJ;else{for(let p=m.mixingTo;p;p=p.mixingTo)if(!p.animation.hasTimeline(E)){if(i.mixDuration>0){x[v]=e1,y[v]=p;continue t}break}x[v]=e0}}else x[v]=eK}}getCurrent(i){return i>=this.tracks.length?null:this.tracks[i]}addListener(i){if(!i)throw Error("listener cannot be null.");this.listeners.push(i)}removeListener(i){let m=this.listeners.indexOf(i);m>=0&&this.listeners.splice(m,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(i,m,p){e$.deprecatedWarning1||(e$.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(i,m,p)}addAnimationByName(i,m,p,_){e$.deprecatedWarning2||(e$.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(i,m,p,_)}hasAnimation(i){let m=this.data.skeletonData.findAnimation(i);return null!==m}hasAnimationByName(i){return e$.deprecatedWarning3||(e$.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(i)}},ez=e$;ez._emptyAnimation=new core_Animation_Animation("<empty>",[],0),ez.deprecatedWarning1=!1,ez.deprecatedWarning2=!1,ez.deprecatedWarning3=!1;let ej=class{constructor(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=G.replace,this.timelineMode=[],this.timelineHoldMix=[],this.timelinesRotation=[]}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let i=this.animationEnd-this.animationStart;return 0==i?this.animationStart:this.trackTime%i+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(i){this.animationLast=i,this.nextAnimationLast=i}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let i=this.animationEnd-this.animationStart;if(0!=i){if(this.loop)return i*(1+(this.trackTime/i|0));if(this.trackTime<i)return i}return this.trackTime}get time(){return ej.deprecatedWarning1||(ej.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(i){ej.deprecatedWarning1||(ej.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=i}get endTime(){return ej.deprecatedWarning2||(ej.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(i){ej.deprecatedWarning2||(ej.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=i}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}},eq=ej;eq.deprecatedWarning1=!1,eq.deprecatedWarning2=!1;let lib_core_AnimationState_EventQueue=class lib_core_AnimationState_EventQueue{constructor(i){this.objects=[],this.drainDisabled=!1,this.animState=i}start(i){this.objects.push(eZ.start),this.objects.push(i),this.animState.animationsChanged=!0}interrupt(i){this.objects.push(eZ.interrupt),this.objects.push(i)}end(i){this.objects.push(eZ.end),this.objects.push(i),this.animState.animationsChanged=!0}dispose(i){this.objects.push(eZ.dispose),this.objects.push(i)}complete(i){this.objects.push(eZ.complete),this.objects.push(i)}event(i,m){this.objects.push(eZ.event),this.objects.push(i),this.objects.push(m)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let i=this.objects,m=this.animState.listeners;for(let p=0;p<i.length;p+=2){let _=i[p],x=i[p+1];switch(_){case eZ.start:x.listener&&x.listener.start&&x.listener.start(x);for(let i=0;i<m.length;i++){let p=m[i];p.start&&p.start(x)}break;case eZ.interrupt:x.listener&&x.listener.interrupt&&x.listener.interrupt(x);for(let i=0;i<m.length;i++){let p=m[i];p.interrupt&&p.interrupt(x)}break;case eZ.end:x.listener&&x.listener.end&&x.listener.end(x);for(let i=0;i<m.length;i++){let p=m[i];p.end&&p.end(x)}case eZ.dispose:x.listener&&x.listener.dispose&&x.listener.dispose(x);for(let i=0;i<m.length;i++){let p=m[i];p.dispose&&p.dispose(x)}this.animState.trackEntryPool.free(x);break;case eZ.complete:x.listener&&x.listener.complete&&x.listener.complete(x);for(let i=0;i<m.length;i++){let p=m[i];p.complete&&p.complete(x)}break;case eZ.event:let y=i[p+++2];x.listener&&x.listener.event&&x.listener.event(x,y);for(let i=0;i<m.length;i++){let p=m[i];p.event&&p.event(x,y)}}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}};var eZ=((F=eZ||{})[F.start=0]="start",F[F.interrupt=1]="interrupt",F[F.end=2]="end",F[F.dispose=3]="dispose",F[F.complete=4]="complete",F[F.event=5]="event",F);let AnimationState_AnimationStateAdapter=class AnimationState_AnimationStateAdapter{start(i){}interrupt(i){}end(i){}dispose(i){}complete(i){}event(i,m){}};let eK=0,eJ=1,eQ=2,e0=3,e1=4,e2=1,e3=2;let lib_core_AnimationStateData_AnimationStateData=class lib_core_AnimationStateData_AnimationStateData{constructor(i){if(this.animationToMixTime={},this.defaultMix=0,!i)throw Error("skeletonData cannot be null.");this.skeletonData=i}setMix(i,m,p){let _=this.skeletonData.findAnimation(i);if(!_)throw Error(`Animation not found: ${i}`);let x=this.skeletonData.findAnimation(m);if(!x)throw Error(`Animation not found: ${m}`);this.setMixWith(_,x,p)}setMixWith(i,m,p){if(!i)throw Error("from cannot be null.");if(!m)throw Error("to cannot be null.");let _=`${i.name}.${m.name}`;this.animationToMixTime[_]=p}getMix(i,m){let p=`${i.name}.${m.name}`,_=this.animationToMixTime[p];return void 0===_?this.defaultMix:_}};let core_AtlasAttachmentLoader_AtlasAttachmentLoader=class core_AtlasAttachmentLoader_AtlasAttachmentLoader{constructor(i){this.atlas=i}loadSequence(i,m,p){let _=p.regions;for(let x=0,y=_.length;x<y;x++){let y=p.getPath(m,x),T=this.atlas.findRegion(y);if(null==T)throw Error(`Region not found in atlas: ${y} (sequence: ${i})`);_[x]=T,_[x].renderObject=_[x]}}newRegionAttachment(i,m,p,_){let x=new eD(m,p);if(null!=_)this.loadSequence(m,p,_);else{let i=this.atlas.findRegion(p);if(!i)throw Error(`Region not found in atlas: ${p} (region attachment: ${m})`);i.renderObject=i,x.region=i}return x}newMeshAttachment(i,m,p,_){let x=new attachments_MeshAttachment_MeshAttachment(m,p);if(null!=_)this.loadSequence(m,p,_);else{let i=this.atlas.findRegion(p);if(!i)throw Error(`Region not found in atlas: ${p} (mesh attachment: ${m})`);i.renderObject=i,x.region=i}return x}newBoundingBoxAttachment(i,m){return new attachments_BoundingBoxAttachment_BoundingBoxAttachment(m)}newPathAttachment(i,m){return new attachments_PathAttachment_PathAttachment(m)}newPointAttachment(i,m){return new attachments_PointAttachment_PointAttachment(m)}newClippingAttachment(i,m){return new attachments_ClippingAttachment_ClippingAttachment(m)}};let core_Bone_Bone=class core_Bone_Bone{constructor(i,m,p){if(this.matrix=new K.y3,this.parent=null,this.children=[],this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.sorted=!1,this.active=!1,!i)throw Error("data cannot be null.");if(!m)throw Error("skeleton cannot be null.");this.data=i,this.skeleton=m,this.parent=p,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(i,m,p,_,x,y,T){this.ax=i,this.ay=m,this.arotation=p,this.ascaleX=_,this.ascaleY=x,this.ashearX=y,this.ashearY=T;let v=this.parent,E=this.matrix,A=this.skeleton.scaleX,S=ti.yDown?-this.skeleton.scaleY:this.skeleton.scaleY;if(!v){let v=this.skeleton,I=p+90+T;E.a=te.cosDeg(p+y)*_*A,E.c=te.cosDeg(I)*x*A,E.b=te.sinDeg(p+y)*_*S,E.d=te.sinDeg(I)*x*S,E.tx=i*A+v.x,E.ty=m*S+v.y;return}let I=v.matrix.a,R=v.matrix.c,C=v.matrix.b,P=v.matrix.d;switch(E.tx=I*i+R*m+v.matrix.tx,E.ty=C*i+P*m+v.matrix.ty,this.data.transformMode){case Z.Normal:{let i=p+90+T,m=te.cosDeg(p+y)*_,v=te.cosDeg(i)*x,A=te.sinDeg(p+y)*_,S=te.sinDeg(i)*x;E.a=I*m+R*A,E.c=I*v+R*S,E.b=C*m+P*A,E.d=C*v+P*S;return}case Z.OnlyTranslation:{let i=p+90+T;E.a=te.cosDeg(p+y)*_,E.c=te.cosDeg(i)*x,E.b=te.sinDeg(p+y)*_,E.d=te.sinDeg(i)*x;break}case Z.NoRotationOrReflection:{let i=I*I+C*C,m=0;i>1e-4?(i=Math.abs(I*P-R*C)/i,I/=A,C/=S,R=C*i,P=I*i,m=Math.atan2(C,I)*te.radDeg):(I=0,C=0,m=90-Math.atan2(P,R)*te.radDeg);let v=p+y-m,k=p+T-m+90,B=te.cosDeg(v)*_,D=te.cosDeg(k)*x,F=te.sinDeg(v)*_,L=te.sinDeg(k)*x;E.a=I*B-R*F,E.c=I*D-R*L,E.b=C*B+P*F,E.d=C*D+P*L;break}case Z.NoScale:case Z.NoScaleOrReflection:{let i=te.cosDeg(p),m=te.sinDeg(p),v=(I*i+R*m)/A,k=(C*i+P*m)/S,B=Math.sqrt(v*v+k*k);B>1e-5&&(B=1/B),v*=B,k*=B,B=Math.sqrt(v*v+k*k),this.data.transformMode==Z.NoScale&&I*P-R*C<0!=(A<0!=S<0)&&(B=-B);let D=Math.PI/2+Math.atan2(k,v),F=Math.cos(D)*B,L=Math.sin(D)*B,O=te.cosDeg(y)*_,V=te.cosDeg(90+T)*x,U=te.sinDeg(y)*_,X=te.sinDeg(90+T)*x;E.a=v*O+F*U,E.c=v*V+F*X,E.b=k*O+L*U,E.d=k*V+L*X}}E.a*=A,E.c*=A,E.b*=S,E.d*=S}setToSetupPose(){let i=this.data;this.x=i.x,this.y=i.y,this.rotation=i.rotation,this.scaleX=i.scaleX,this.scaleY=i.scaleY,this.shearX=i.shearX,this.shearY=i.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*te.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*te.radDeg}getWorldScaleX(){let i=this.matrix;return Math.sqrt(i.a*i.a+i.b*i.b)}getWorldScaleY(){let i=this.matrix;return Math.sqrt(i.c*i.c+i.d*i.d)}updateAppliedTransform(){let i=this.parent,m=this.matrix;if(!i){this.ax=m.tx-this.skeleton.x,this.ay=m.ty-this.skeleton.y,this.arotation=Math.atan2(m.b,m.a)*te.radDeg,this.ascaleX=Math.sqrt(m.a*m.a+m.b*m.b),this.ascaleY=Math.sqrt(m.c*m.c+m.d*m.d),this.ashearX=0,this.ashearY=Math.atan2(m.a*m.c+m.b*m.d,m.a*m.d-m.b*m.c)*te.radDeg;return}let p=i.matrix,_=1/(p.a*p.d-p.b*p.c),x=m.tx-p.tx,y=m.ty-p.ty;this.ax=x*p.d*_-y*p.c*_,this.ay=y*p.a*_-x*p.b*_;let T=_*p.d,v=_*p.a,E=_*p.c,A=_*p.b,S=T*m.a-E*m.b,I=T*m.c-E*m.d,R=v*m.b-A*m.a,C=v*m.d-A*m.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(S*S+R*R),this.ascaleX>1e-4){let i=S*C-I*R;this.ascaleY=i/this.ascaleX,this.ashearY=Math.atan2(S*I+R*C,i)*te.radDeg,this.arotation=Math.atan2(R,S)*te.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(I*I+C*C),this.ashearY=0,this.arotation=90-Math.atan2(C,I)*te.radDeg}worldToLocal(i){let m=this.matrix,p=m.a,_=m.c,x=m.b,y=m.d,T=1/(p*y-_*x),v=i.x-m.tx,E=i.y-m.ty;return i.x=v*y*T-E*_*T,i.y=E*p*T-v*x*T,i}localToWorld(i){let m=this.matrix,p=i.x,_=i.y;return i.x=p*m.a+_*m.c+m.tx,i.y=p*m.b+_*m.d+m.ty,i}worldToLocalRotation(i){let m=te.sinDeg(i),p=te.cosDeg(i),_=this.matrix;return Math.atan2(_.a*m-_.b*p,_.d*p-_.c*m)*te.radDeg}localToWorldRotation(i){i-=this.rotation-this.shearX;let m=te.sinDeg(i),p=te.cosDeg(i),_=this.matrix;return Math.atan2(p*_.b+m*_.d,p*_.a+m*_.c)*te.radDeg}rotateWorld(i){let m=this.matrix,p=m.a,_=m.c,x=m.b,y=m.d,T=te.cosDeg(i),v=te.sinDeg(i);m.a=T*p-v*x,m.c=T*_-v*y,m.b=v*p+T*x,m.d=v*_+T*y}};let core_BoneData_BoneData=class core_BoneData_BoneData{constructor(i,m,p){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Z.Normal,this.skinRequired=!1,this.color=new tt,i<0)throw Error("index must be >= 0.");if(!m)throw Error("name cannot be null.");this.index=i,this.name=m,this.parent=p}};let ConstraintData_ConstraintData=class ConstraintData_ConstraintData{constructor(i,m,p){this.name=i,this.order=m,this.skinRequired=p}};let core_Event_Event=class core_Event_Event{constructor(i,m){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!m)throw Error("data cannot be null.");this.time=i,this.data=m}};let core_EventData_EventData=class core_EventData_EventData{constructor(i){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=i}};let core_IkConstraint_IkConstraint=class core_IkConstraint_IkConstraint{constructor(i,m){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!i)throw Error("data cannot be null.");if(!m)throw Error("skeleton cannot be null.");this.data=i,this.mix=i.mix,this.softness=i.softness,this.bendDirection=i.bendDirection,this.compress=i.compress,this.stretch=i.stretch,this.bones=[];for(let p=0;p<i.bones.length;p++){let _=m.findBone(i.bones[p].name);if(!_)throw Error(`Couldn't find bone ${i.bones[p].name}`);this.bones.push(_)}let p=m.findBone(i.target.name);if(!p)throw Error(`Couldn't find bone ${i.target.name}`);this.target=p}isActive(){return this.active}update(){if(0==this.mix)return;let i=this.target,m=this.bones;switch(m.length){case 1:this.apply1(m[0],i.worldX,i.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(m[0],m[1],i.worldX,i.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}apply1(i,m,p,_,x,y,T){let v=i.parent.matrix;if(!v)throw Error("IK bone must have parent.");let E=v.a,A=v.c,S=v.b,I=v.d,R=-i.ashearX-i.arotation,C=0,P=0,k=i.skeleton.scaleX,B=ti.yDown?-i.skeleton.scaleY:i.skeleton.scaleY;switch(i.data.transformMode){case Z.OnlyTranslation:C=m-i.worldX,P=p-i.worldY,ti.yDown&&(P=-P);break;case Z.NoRotationOrReflection:let D=Math.abs(E*I-A*S)/(E*E+S*S),F=E/k,L=S/B;A=-L*D*k,I=F*D*B,R+=Math.atan2(L,F)*te.radDeg;default:let O=m-v.tx,V=p-v.ty,U=E*I-A*S;C=(O*I-V*A)/U-i.ax,P=(V*E-O*S)/U-i.ay}R+=Math.atan2(P,C)*te.radDeg,i.ascaleX<0&&(R+=180),R>180?R-=360:R<-180&&(R+=360);let X=i.ascaleX,Y=i.ascaleY;if(_||x){switch(i.data.transformMode){case Z.NoScale:case Z.NoScaleOrReflection:C=m-i.worldX,P=p-i.worldY}let v=i.data.length*X,E=Math.sqrt(C*C+P*P);if(_&&E<v||x&&E>v&&v>1e-4){let i=(E/v-1)*T+1;X*=i,y&&(Y*=i)}}i.updateWorldTransformWith(i.ax,i.ay,i.arotation+R*T,X,Y,i.ashearX,i.ashearY)}apply2(i,m,p,_,x,y,T,v,E){let A,S;let I=i.ax,R=i.ay,C=i.ascaleX,P=i.ascaleY,k=C,B=P,D=m.ascaleX,F=i.matrix,L=0,O=0,V=0;C<0?(C=-C,L=180,V=-1):(L=0,V=1),P<0&&(P=-P,V=-V),D<0?(D=-D,O=180):O=0;let U=m.ax,X=0,Y=0,G=0,W=F.a,z=F.c,j=F.b,Z=F.d,K=1e-4>=Math.abs(C-P);!K||y?(X=0,Y=W*U+F.tx,G=j*U+F.ty):(Y=W*U+z*(X=m.ay)+F.tx,G=j*U+Z*X+F.ty);let J=i.parent.matrix;if(!J)throw Error("IK parent must itself have a parent.");W=J.a,z=J.c,j=J.b,Z=J.d;let Q=1/(W*Z-z*j),tt=Y-J.tx,tr=G-J.ty,ti=(tt*Z-tr*z)*Q-I,ts=(tr*W-tt*j)*Q-R,tn=Math.sqrt(ti*ti+ts*ts),ta=m.data.length*D;if(tn<1e-4){this.apply1(i,p,_,!1,y,!1,E),m.updateWorldTransformWith(U,X,0,m.ascaleX,m.ascaleY,m.ashearX,m.ashearY);return}let to=((tt=p-J.tx)*Z-(tr=_-J.ty)*z)*Q-I,tl=(tr*W-tt*j)*Q-R,th=to*to+tl*tl;if(0!=v){v*=C*(D+1)*.5;let i=Math.sqrt(th),m=i-tn-ta*C+v;if(m>0){let p=Math.min(1,m/(2*v))-1;p=(m-v*(1-p*p))/i,to-=p*to,tl-=p*tl,th=to*to+tl*tl}}t:if(K){let i=(th-tn*tn-(ta*=C)*ta)/(2*tn*ta);i<-1?(i=-1,S=Math.PI*x):i>1?(i=1,S=0,y&&(k*=W=(Math.sqrt(th)/(tn+ta)-1)*E+1,T&&(B*=W))):S=Math.acos(i)*x,A=Math.atan2(tl*(W=tn+ta*i)-to*(z=ta*Math.sin(S)),to*W+tl*z)}else{W=C*ta,z=P*ta;let i=W*W,m=z*z,p=Math.atan2(tl,to);j=m*tn*tn+i*th-i*m;let _=-2*m*tn,y=m-i;if((Z=_*_-4*y*j)>=0){let i=Math.sqrt(Z);_<0&&(i=-i),i=-(.5*(_+i));let m=i/y,T=j/i,v=Math.abs(m)<Math.abs(T)?m:T;if(v*v<=th){A=p-Math.atan2(tr=Math.sqrt(th-v*v)*x,v),S=Math.atan2(tr/P,(v-tn)/C);break t}}let T=te.PI,v=tn-W,E=v*v,I=0,R=0,k=tn+W,B=k*k,D=0;(j=-W*tn/(i-m))>=-1&&j<=1&&((Z=(tt=W*Math.cos(j=Math.acos(j))+tn)*tt+(tr=z*Math.sin(j))*tr)<E&&(T=j,E=Z,v=tt,I=tr),Z>B&&(R=j,B=Z,k=tt,D=tr)),th<=(E+B)*.5?(A=p-Math.atan2(I*x,v),S=T*x):(A=p-Math.atan2(D*x,k),S=R*x)}let tu=Math.atan2(X,U)*V,td=i.arotation;(A=(A-tu)*te.radDeg+L-td)>180?A-=360:A<-180&&(A+=360),i.updateWorldTransformWith(I,R,td+A*E,k,B,0,0),td=m.arotation,(S=((S+tu)*te.radDeg-m.ashearX)*V+O-td)>180?S-=360:S<-180&&(S+=360),m.updateWorldTransformWith(U,X,td+S*E,m.ascaleX,m.ascaleY,m.ashearX,m.ashearY)}};let core_IkConstraintData_IkConstraintData=class core_IkConstraintData_IkConstraintData extends ConstraintData_ConstraintData{constructor(i){super(i,0,!1),this.bones=[],this._target=null,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}set target(i){this._target=i}get target(){if(this._target)return this._target;throw Error("BoneData not set.")}};let core_PathConstraintData_PathConstraintData=class core_PathConstraintData_PathConstraintData extends ConstraintData_ConstraintData{constructor(i){super(i,0,!1),this.bones=[],this._target=null,this.positionMode=z.Fixed,this.spacingMode=e4.Fixed,this.rotateMode=j.Chain,this.offsetRotation=0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0}set target(i){this._target=i}get target(){if(this._target)return this._target;throw Error("SlotData not set.")}};var e4=((L=e4||{})[L.Length=0]="Length",L[L.Fixed=1]="Fixed",L[L.Percent=2]="Percent",L[L.Proportional=3]="Proportional",L);let e6=class{constructor(i,m){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=[],this.positions=[],this.world=[],this.curves=[],this.lengths=[],this.segments=[],this.active=!1,!i)throw Error("data cannot be null.");if(!m)throw Error("skeleton cannot be null.");this.data=i,this.bones=[];for(let p=0,_=i.bones.length;p<_;p++){let _=m.findBone(i.bones[p].name);if(!_)throw Error(`Couldn't find bone ${i.bones[p].name}.`);this.bones.push(_)}let p=m.findSlot(i.target.name);if(!p)throw Error(`Couldn't find target bone ${i.target.name}`);this.target=p,this.position=i.position,this.spacing=i.spacing,this.mixRotate=i.mixRotate,this.mixX=i.mixX,this.mixY=i.mixY}isActive(){return this.active}update(){let i=this.target.getAttachment();if(!(i instanceof attachments_PathAttachment_PathAttachment))return;let m=this.mixRotate,p=this.mixX,_=this.mixY;if(0==m&&0==p&&0==_)return;let x=this.data,y=x.rotateMode==j.Tangent,T=x.rotateMode==j.ChainScale,v=this.bones,E=v.length,A=y?E:E+1,S=tr.setArraySize(this.spaces,A),I=T?this.lengths=tr.setArraySize(this.lengths,E):[],R=this.spacing;switch(x.spacingMode){case e4.Percent:if(T)for(let i=0,m=A-1;i<m;i++){let m=v[i],p=m.data.length;if(p<e6.epsilon)I[i]=0;else{let _=p*m.matrix.a,x=p*m.matrix.b;I[i]=Math.sqrt(_*_+x*x)}}tr.arrayFill(S,1,A,R);break;case e4.Proportional:let C=0;for(let i=0,m=A-1;i<m;){let m=v[i],p=m.data.length;if(p<e6.epsilon)T&&(I[i]=0),S[++i]=R;else{let _=p*m.matrix.a,x=p*m.matrix.b,y=Math.sqrt(_*_+x*x);T&&(I[i]=y),S[++i]=y,C+=y}}if(C>0){C=A/C*R;for(let i=1;i<A;i++)S[i]*=C}break;default:let P=x.spacingMode==e4.Length;for(let i=0,m=A-1;i<m;){let m=v[i],p=m.data.length;if(p<e6.epsilon)T&&(I[i]=0),S[++i]=R;else{let _=p*m.matrix.a,x=p*m.matrix.b,y=Math.sqrt(_*_+x*x);T&&(I[i]=y),S[++i]=(P?p+R:R)*y/p}}}let k=this.computeWorldPositions(i,A,y),B=k[0],D=k[1],F=x.offsetRotation,L=!1;if(0==F)L=x.rotateMode==j.Chain;else{L=!1;let i=this.target.bone.matrix;F*=i.a*i.d-i.b*i.c>0?te.degRad:-te.degRad}for(let i=0,x=3;i<E;i++,x+=3){let E=v[i],A=E.matrix;A.tx+=(B-A.tx)*p,A.ty+=(D-A.ty)*_;let R=k[x],C=k[x+1],P=R-B,O=C-D;if(T){let p=I[i];if(0!=p){let i=(Math.sqrt(P*P+O*O)/p-1)*m+1;A.a*=i,A.b*=i}}if(B=R,D=C,m>0){let p=A.a,_=A.c,T=A.b,v=A.d,I=0,R=0,C=0;if(I=(y?k[x-1]:0==S[i+1]?k[x+2]:Math.atan2(O,P))-Math.atan2(T,p),L){R=Math.cos(I),C=Math.sin(I);let i=E.data.length;B+=(i*(R*p-C*T)-P)*m,D+=(i*(C*p+R*T)-O)*m}else I+=F;I>te.PI?I-=te.PI2:I<-te.PI&&(I+=te.PI2),I*=m,R=Math.cos(I),C=Math.sin(I),A.a=R*p-C*T,A.c=R*_-C*v,A.b=C*p+R*T,A.d=C*_+R*v}E.updateAppliedTransform()}}computeWorldPositions(i,m,p){let _;let x=this.target,y=this.position,T=this.spaces,v=tr.setArraySize(this.positions,3*m+2),E=this.world,A=i.closed,S=i.worldVerticesLength,I=S/6,R=e6.NONE;if(!i.constantSpeed){let _;let C=i.lengths;I-=A?1:2;let P=C[I];switch(this.data.positionMode==z.Percent&&(y*=P),this.data.spacingMode){case e4.Percent:_=P;break;case e4.Proportional:_=P/m;break;default:_=1}E=tr.setArraySize(this.world,8);for(let k=0,B=0,D=0;k<m;k++,B+=3){let m=T[k]*_,F=y+=m;if(A)(F%=P)<0&&(F+=P),D=0;else if(F<0){R!=e6.BEFORE&&(R=e6.BEFORE,i.computeWorldVertices(x,2,4,E,0,2)),this.addBeforePosition(F,E,0,v,B);continue}else if(F>P){R!=e6.AFTER&&(R=e6.AFTER,i.computeWorldVertices(x,S-6,4,E,0,2)),this.addAfterPosition(F-P,E,0,v,B);continue}for(;;D++){let i=C[D];if(!(F>i)){if(0==D)F/=i;else{let m=C[D-1];F=(F-m)/(i-m)}break}}D!=R&&(R=D,A&&D==I?(i.computeWorldVertices(x,S-4,4,E,0,2),i.computeWorldVertices(x,0,4,E,4,2)):i.computeWorldVertices(x,6*D+2,8,E,0,2)),this.addCurvePosition(F,E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],v,B,p||k>0&&0==m)}return v}A?(S+=2,E=tr.setArraySize(this.world,S),i.computeWorldVertices(x,2,S-4,E,0,2),i.computeWorldVertices(x,0,2,E,S-4,2),E[S-2]=E[0],E[S-1]=E[1]):(I--,S-=4,E=tr.setArraySize(this.world,S),i.computeWorldVertices(x,2,S,E,0,2));let C=tr.setArraySize(this.curves,I),P=0,k=E[0],B=E[1],D=0,F=0,L=0,O=0,V=0,U=0,X=0,Y=0,G=0,W=0,j=0,Z=0,K=0,J=0;for(let i=0,m=2;i<I;i++,m+=6)D=E[m],F=E[m+1],L=E[m+2],O=E[m+3],V=E[m+4],U=E[m+5],X=(k-2*D+L)*.1875,Y=(B-2*F+O)*.1875,G=((D-L)*3-k+V)*.09375,W=((F-O)*3-B+U)*.09375,j=2*X+G,Z=2*Y+W,P+=Math.sqrt((K=(D-k)*.75+X+.16666667*G)*K+(J=(F-B)*.75+Y+.16666667*W)*J),K+=j,J+=Z,j+=G,Z+=W,P+=Math.sqrt(K*K+J*J),K+=j,J+=Z,P+=Math.sqrt(K*K+J*J),K+=j+G,J+=Z+W,P+=Math.sqrt(K*K+J*J),C[i]=P,k=V,B=U;switch(this.data.positionMode==z.Percent&&(y*=P),this.data.spacingMode){case e4.Percent:_=P;break;case e4.Proportional:_=P/m;break;default:_=1}let Q=this.segments,tt=0;for(let i=0,x=0,I=0,z=0;i<m;i++,x+=3){let m=T[i]*_,te=y+=m;if(A)(te%=P)<0&&(te+=P),I=0;else if(te<0){this.addBeforePosition(te,E,0,v,x);continue}else if(te>P){this.addAfterPosition(te-P,E,S-4,v,x);continue}for(;;I++){let i=C[I];if(!(te>i)){if(0==I)te/=i;else{let m=C[I-1];te=(te-m)/(i-m)}break}}if(I!=R){R=I;let i=6*I;for(k=E[i],B=E[i+1],D=E[i+2],F=E[i+3],L=E[i+4],O=E[i+5],V=E[i+6],U=E[i+7],X=(k-2*D+L)*.03,Y=(B-2*F+O)*.03,G=((D-L)*3-k+V)*.006,W=((F-O)*3-B+U)*.006,j=2*X+G,Z=2*Y+W,tt=Math.sqrt((K=(D-k)*.3+X+.16666667*G)*K+(J=(F-B)*.3+Y+.16666667*W)*J),Q[0]=tt,i=1;i<8;i++)K+=j,J+=Z,j+=G,Z+=W,tt+=Math.sqrt(K*K+J*J),Q[i]=tt;K+=j,J+=Z,tt+=Math.sqrt(K*K+J*J),Q[8]=tt,K+=j+G,J+=Z+W,tt+=Math.sqrt(K*K+J*J),Q[9]=tt,z=0}for(te*=tt;;z++){let i=Q[z];if(!(te>i)){if(0==z)te/=i;else{let m=Q[z-1];te=z+(te-m)/(i-m)}break}}this.addCurvePosition(.1*te,k,B,D,F,L,O,V,U,v,x,p||i>0&&0==m)}return v}addBeforePosition(i,m,p,_,x){let y=m[p],T=m[p+1],v=m[p+2]-y,E=m[p+3]-T,A=Math.atan2(E,v);_[x]=y+i*Math.cos(A),_[x+1]=T+i*Math.sin(A),_[x+2]=A}addAfterPosition(i,m,p,_,x){let y=m[p+2],T=m[p+3],v=y-m[p],E=T-m[p+1],A=Math.atan2(E,v);_[x]=y+i*Math.cos(A),_[x+1]=T+i*Math.sin(A),_[x+2]=A}addCurvePosition(i,m,p,_,x,y,T,v,E,A,S,I){if(0==i||isNaN(i)){A[S]=m,A[S+1]=p,A[S+2]=Math.atan2(x-p,_-m);return}let R=i*i,C=R*i,P=1-i,k=P*P,B=k*P,D=P*i,F=3*D,L=P*F,O=F*i,V=m*B+_*L+y*O+v*C,U=p*B+x*L+T*O+E*C;A[S]=V,A[S+1]=U,I&&(i<.001?A[S+2]=Math.atan2(x-p,_-m):A[S+2]=Math.atan2(U-(p*k+x*D*2+T*R),V-(m*k+_*D*2+y*R)))}},e5=e6;e5.NONE=-1,e5.BEFORE=-2,e5.AFTER=-3,e5.epsilon=1e-5;let core_Slot_Slot=class core_Slot_Slot{constructor(i,m){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=[],!i)throw Error("data cannot be null.");if(!m)throw Error("bone cannot be null.");this.data=i,this.bone=m,this.color=new tt,this.darkColor=i.darkColor?new tt:null,this.setToSetupPose(),this.blendMode=this.data.blendMode}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(i){this.attachment!=i&&(i instanceof ek&&this.attachment instanceof ek&&i.timelineAttachment==this.attachment.timelineAttachment||(this.deform.length=0),this.attachment=i,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}};let core_TransformConstraint_TransformConstraint=class core_TransformConstraint_TransformConstraint{constructor(i,m){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new Vector2,this.active=!1,!i)throw Error("data cannot be null.");if(!m)throw Error("skeleton cannot be null.");this.data=i,this.mixRotate=i.mixRotate,this.mixX=i.mixX,this.mixY=i.mixY,this.mixScaleX=i.mixScaleX,this.mixScaleY=i.mixScaleY,this.mixShearY=i.mixShearY,this.bones=[];for(let p=0;p<i.bones.length;p++){let _=m.findBone(i.bones[p].name);if(!_)throw Error(`Couldn't find bone ${i.bones[p].name}.`);this.bones.push(_)}let p=m.findBone(i.target.name);if(!p)throw Error(`Couldn't find target bone ${i.target.name}.`);this.target=p}isActive(){return this.active}update(){(0!=this.mixRotate||0!=this.mixX||0!=this.mixY||0!=this.mixScaleX||0!=this.mixScaleX||0!=this.mixShearY)&&(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let i=this.mixRotate,m=this.mixX,p=this.mixY,_=this.mixScaleX,x=this.mixScaleY,y=this.mixShearY,T=0!=m||0!=p,v=this.target,E=v.matrix,A=E.a,S=E.c,I=E.b,R=E.d,C=A*R-S*I>0?te.degRad:-te.degRad,P=this.data.offsetRotation*C,k=this.data.offsetShearY*C,B=this.bones;for(let E=0,C=B.length;E<C;E++){let C=B[E],D=C.matrix;if(0!=i){let m=D.a,p=D.c,_=D.b,x=D.d,y=Math.atan2(I,A)-Math.atan2(_,m)+P;y>te.PI?y-=te.PI2:y<-te.PI&&(y+=te.PI2),y*=i;let T=Math.cos(y),v=Math.sin(y);D.a=T*m-v*_,D.c=T*p-v*x,D.b=v*m+T*_,D.d=v*p+T*x}if(T){let i=this.temp;v.localToWorld(i.set(this.data.offsetX,this.data.offsetY)),D.tx+=(i.x-D.tx)*m,D.ty+=(i.y-D.ty)*p}if(0!=_){let i=Math.sqrt(D.a*D.a+D.b*D.b);0!=i&&(i=(i+(Math.sqrt(A*A+I*I)-i+this.data.offsetScaleX)*_)/i),D.a*=i,D.b*=i}if(0!=x){let i=Math.sqrt(D.c*D.c+D.d*D.d);0!=i&&(i=(i+(Math.sqrt(S*S+R*R)-i+this.data.offsetScaleY)*x)/i),D.c*=i,D.d*=i}if(y>0){let i=D.c,m=D.d,p=Math.atan2(m,i),_=Math.atan2(R,S)-Math.atan2(I,A)-(p-Math.atan2(D.b,D.a));_>te.PI?_-=te.PI2:_<-te.PI&&(_+=te.PI2),_=p+(_+k)*y;let x=Math.sqrt(i*i+m*m);D.c=Math.cos(_)*x,D.d=Math.sin(_)*x}C.updateAppliedTransform()}}applyRelativeWorld(){let i=this.mixRotate,m=this.mixX,p=this.mixY,_=this.mixScaleX,x=this.mixScaleY,y=this.mixShearY,T=0!=m||0!=p,v=this.target,E=v.matrix,A=E.a,S=E.c,I=E.b,R=E.d,C=A*R-S*I>0?te.degRad:-te.degRad,P=this.data.offsetRotation*C,k=this.data.offsetShearY*C,B=this.bones;for(let E=0,C=B.length;E<C;E++){let C=B[E],D=C.matrix;if(0!=i){let m=D.a,p=D.c,_=D.b,x=D.d,y=Math.atan2(I,A)+P;y>te.PI?y-=te.PI2:y<-te.PI&&(y+=te.PI2),y*=i;let T=Math.cos(y),v=Math.sin(y);D.a=T*m-v*_,D.c=T*p-v*x,D.b=v*m+T*_,D.d=v*p+T*x}if(T){let i=this.temp;v.localToWorld(i.set(this.data.offsetX,this.data.offsetY)),D.tx+=i.x*m,D.ty+=i.y*p}if(0!=_){let i=(Math.sqrt(A*A+I*I)-1+this.data.offsetScaleX)*_+1;D.a*=i,D.b*=i}if(0!=x){let i=(Math.sqrt(S*S+R*R)-1+this.data.offsetScaleY)*x+1;D.c*=i,D.d*=i}if(y>0){let i=Math.atan2(R,S)-Math.atan2(I,A);i>te.PI?i-=te.PI2:i<-te.PI&&(i+=te.PI2);let m=D.c,p=D.d;i=Math.atan2(p,m)+(i-te.PI/2+k)*y;let _=Math.sqrt(m*m+p*p);D.c=Math.cos(i)*_,D.d=Math.sin(i)*_}C.updateAppliedTransform()}}applyAbsoluteLocal(){let i=this.mixRotate,m=this.mixX,p=this.mixY,_=this.mixScaleX,x=this.mixScaleY,y=this.mixShearY,T=this.target,v=this.bones;for(let E=0,A=v.length;E<A;E++){let A=v[E],S=A.arotation;if(0!=i){let m=T.arotation-S+this.data.offsetRotation;m-=(16384-(16384.499999999996-m/360|0))*360,S+=m*i}let I=A.ax,R=A.ay;I+=(T.ax-I+this.data.offsetX)*m,R+=(T.ay-R+this.data.offsetY)*p;let C=A.ascaleX,P=A.ascaleY;0!=_&&0!=C&&(C=(C+(T.ascaleX-C+this.data.offsetScaleX)*_)/C),0!=x&&0!=P&&(P=(P+(T.ascaleY-P+this.data.offsetScaleY)*x)/P);let k=A.ashearY;if(0!=y){let i=T.ashearY-k+this.data.offsetShearY;i-=(16384-(16384.499999999996-i/360|0))*360,k+=i*y}A.updateWorldTransformWith(I,R,S,C,P,A.ashearX,k)}}applyRelativeLocal(){let i=this.mixRotate,m=this.mixX,p=this.mixY,_=this.mixScaleX,x=this.mixScaleY,y=this.mixShearY,T=this.target,v=this.bones;for(let E=0,A=v.length;E<A;E++){let A=v[E],S=A.arotation+(T.arotation+this.data.offsetRotation)*i,I=A.ax+(T.ax+this.data.offsetX)*m,R=A.ay+(T.ay+this.data.offsetY)*p,C=A.ascaleX*((T.ascaleX-1+this.data.offsetScaleX)*_+1),P=A.ascaleY*((T.ascaleY-1+this.data.offsetScaleY)*x+1),k=A.ashearY+(T.ashearY+this.data.offsetShearY)*y;A.updateWorldTransformWith(I,R,S,C,P,A.ashearX,k)}}};let e8=class{constructor(i){if(this._updateCache=[],this.skin=null,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!i)throw Error("data cannot be null.");this.data=i,this.bones=[];for(let m=0;m<i.bones.length;m++){let p;let _=i.bones[m];if(_.parent){let i=this.bones[_.parent.index];p=new core_Bone_Bone(_,this,i),i.children.push(p)}else p=new core_Bone_Bone(_,this,null);this.bones.push(p)}this.slots=[],this.drawOrder=[];for(let m=0;m<i.slots.length;m++){let p=i.slots[m],_=this.bones[p.boneData.index],x=new core_Slot_Slot(p,_);this.slots.push(x),this.drawOrder.push(x)}this.ikConstraints=[];for(let m=0;m<i.ikConstraints.length;m++){let p=i.ikConstraints[m];this.ikConstraints.push(new core_IkConstraint_IkConstraint(p,this))}this.transformConstraints=[];for(let m=0;m<i.transformConstraints.length;m++){let p=i.transformConstraints[m];this.transformConstraints.push(new core_TransformConstraint_TransformConstraint(p,this))}this.pathConstraints=[];for(let m=0;m<i.pathConstraints.length;m++){let p=i.pathConstraints[m];this.pathConstraints.push(new e5(p,this))}this.color=new tt(1,1,1,1),this.updateCache()}updateCache(){let i=this._updateCache;i.length=0;let m=this.bones;for(let i=0,p=m.length;i<p;i++){let p=m[i];p.sorted=p.data.skinRequired,p.active=!p.sorted}if(this.skin){let i=this.skin.bones;for(let m=0,p=this.skin.bones.length;m<p;m++){let p=this.bones[i[m].index];do p.sorted=!1,p.active=!0,p=p.parent;while(p)}}let p=this.ikConstraints,_=this.transformConstraints,x=this.pathConstraints,y=p.length,T=_.length,v=x.length,E=y+T+v;t:for(let i=0;i<E;i++){for(let m=0;m<y;m++){let _=p[m];if(_.data.order==i){this.sortIkConstraint(_);continue t}}for(let m=0;m<T;m++){let p=_[m];if(p.data.order==i){this.sortTransformConstraint(p);continue t}}for(let m=0;m<v;m++){let p=x[m];if(p.data.order==i){this.sortPathConstraint(p);continue t}}}for(let i=0,p=m.length;i<p;i++)this.sortBone(m[i])}sortIkConstraint(i){if(i.active=i.target.isActive()&&(!i.data.skinRequired||this.skin&&tr.contains(this.skin.constraints,i.data,!0)),!i.active)return;let m=i.target;this.sortBone(m);let p=i.bones,_=p[0];if(this.sortBone(_),1==p.length)this._updateCache.push(i),this.sortReset(_.children);else{let m=p[p.length-1];this.sortBone(m),this._updateCache.push(i),this.sortReset(_.children),m.sorted=!0}}sortPathConstraint(i){if(i.active=i.target.bone.isActive()&&(!i.data.skinRequired||this.skin&&tr.contains(this.skin.constraints,i.data,!0)),!i.active)return;let m=i.target,p=m.data.index,_=m.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,p,_),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,p,_);for(let i=0,m=this.data.skins.length;i<m;i++)this.sortPathConstraintAttachment(this.data.skins[i],p,_);let x=m.getAttachment();x instanceof attachments_PathAttachment_PathAttachment&&this.sortPathConstraintAttachmentWith(x,_);let y=i.bones,T=y.length;for(let i=0;i<T;i++)this.sortBone(y[i]);this._updateCache.push(i);for(let i=0;i<T;i++)this.sortReset(y[i].children);for(let i=0;i<T;i++)y[i].sorted=!0}sortTransformConstraint(i){if(i.active=i.target.isActive()&&(!i.data.skinRequired||this.skin&&tr.contains(this.skin.constraints,i.data,!0)),!i.active)return;this.sortBone(i.target);let m=i.bones,p=m.length;if(i.data.local)for(let i=0;i<p;i++){let p=m[i];this.sortBone(p.parent),this.sortBone(p)}else for(let i=0;i<p;i++)this.sortBone(m[i]);this._updateCache.push(i);for(let i=0;i<p;i++)this.sortReset(m[i].children);for(let i=0;i<p;i++)m[i].sorted=!0}sortPathConstraintAttachment(i,m,p){let _=i.attachments[m];if(_)for(let i in _)this.sortPathConstraintAttachmentWith(_[i],p)}sortPathConstraintAttachmentWith(i,m){if(!(i instanceof attachments_PathAttachment_PathAttachment))return;let p=i.bones;if(p){let i=this.bones;for(let m=0,_=p.length;m<_;){let _=p[m++];for(_+=m;m<_;)this.sortBone(i[p[m++]])}}else this.sortBone(m)}sortBone(i){if(!i||i.sorted)return;let m=i.parent;m&&this.sortBone(m),i.sorted=!0,this._updateCache.push(i)}sortReset(i){for(let m=0,p=i.length;m<p;m++){let p=i[m];p.active&&(p.sorted&&this.sortReset(p.children),p.sorted=!1)}}updateWorldTransform(){let i=this.bones;for(let m=0,p=i.length;m<p;m++){let p=i[m];p.ax=p.x,p.ay=p.y,p.arotation=p.rotation,p.ascaleX=p.scaleX,p.ascaleY=p.scaleY,p.ashearX=p.shearX,p.ashearY=p.shearY}let m=this._updateCache;for(let i=0,p=m.length;i<p;i++)m[i].update()}updateWorldTransformWith(i){let m=this.getRootBone(),p=i.matrix.a,_=i.matrix.c,x=i.matrix.b,y=i.matrix.d;m.matrix.tx=p*this.x+_*this.y+i.worldX,m.matrix.ty=x*this.x+y*this.y+i.worldY;let T=m.rotation+90+m.shearY,v=te.cosDeg(m.rotation+m.shearX)*m.scaleX,E=te.cosDeg(T)*m.scaleY,A=te.sinDeg(m.rotation+m.shearX)*m.scaleX,S=te.sinDeg(T)*m.scaleY,I=this.scaleX,R=ti.yDown?-this.scaleY:this.scaleY;m.matrix.a=(p*v+_*A)*I,m.matrix.c=(p*E+_*S)*I,m.matrix.b=(x*v+y*A)*R,m.matrix.d=(x*E+y*S)*R;let C=this._updateCache;for(let i=0,p=C.length;i<p;i++){let p=C[i];p!=m&&p.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){let i=this.bones;for(let m=0,p=i.length;m<p;m++)i[m].setToSetupPose();let m=this.ikConstraints;for(let i=0,p=m.length;i<p;i++){let p=m[i];p.mix=p.data.mix,p.softness=p.data.softness,p.bendDirection=p.data.bendDirection,p.compress=p.data.compress,p.stretch=p.data.stretch}let p=this.transformConstraints;for(let i=0,m=p.length;i<m;i++){let m=p[i],_=m.data;m.mixRotate=_.mixRotate,m.mixX=_.mixX,m.mixY=_.mixY,m.mixScaleX=_.mixScaleX,m.mixScaleY=_.mixScaleY,m.mixShearY=_.mixShearY}let _=this.pathConstraints;for(let i=0,m=_.length;i<m;i++){let m=_[i],p=m.data;m.position=p.position,m.spacing=p.spacing,m.mixRotate=p.mixRotate,m.mixX=p.mixX,m.mixY=p.mixY}}setSlotsToSetupPose(){let i=this.slots;tr.arrayCopy(i,0,this.drawOrder,0,i.length);for(let m=0,p=i.length;m<p;m++)i[m].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(i){if(!i)throw Error("boneName cannot be null.");let m=this.bones;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}findBoneIndex(i){if(!i)throw Error("boneName cannot be null.");let m=this.bones;for(let p=0,_=m.length;p<_;p++)if(m[p].data.name==i)return p;return -1}findSlot(i){if(!i)throw Error("slotName cannot be null.");let m=this.slots;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}findSlotIndex(i){if(!i)throw Error("slotName cannot be null.");let m=this.slots;for(let p=0,_=m.length;p<_;p++)if(m[p].data.name==i)return p;return -1}setSkinByName(i){let m=this.data.findSkin(i);if(!m)throw Error(`Skin not found: ${i}`);this.setSkin(m)}setSkin(i){if(i!=this.skin){if(i){if(this.skin)i.attachAll(this,this.skin);else{let m=this.slots;for(let p=0,_=m.length;p<_;p++){let _=m[p],x=_.data.attachmentName;if(x){let m=i.getAttachment(p,x);m&&_.setAttachment(m)}}}}this.skin=i,this.updateCache()}}getAttachmentByName(i,m){let p=this.data.findSlot(i);if(!p)throw Error(`Can't find slot with name ${i}`);return this.getAttachment(p.index,m)}getAttachment(i,m){if(!m)throw Error("attachmentName cannot be null.");if(this.skin){let p=this.skin.getAttachment(i,m);if(p)return p}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(i,m):null}setAttachment(i,m){if(!i)throw Error("slotName cannot be null.");let p=this.slots;for(let _=0,x=p.length;_<x;_++){let x=p[_];if(x.data.name==i){let p=null;if(m&&!(p=this.getAttachment(_,m)))throw Error(`Attachment not found: ${m}, for slot: ${i}`);x.setAttachment(p);return}}throw Error(`Slot not found: ${i}`)}findIkConstraint(i){if(!i)throw Error("constraintName cannot be null.");let m=this.ikConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}findTransformConstraint(i){if(!i)throw Error("constraintName cannot be null.");let m=this.transformConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}findPathConstraint(i){if(!i)throw Error("constraintName cannot be null.");let m=this.pathConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.data.name==i)return _}return null}getBoundsRect(){let i=new Vector2,m=new Vector2;return this.getBounds(i,m),{x:i.x,y:i.y,width:m.x,height:m.y}}getBounds(i,m,p=[,,]){if(!i)throw Error("offset cannot be null.");if(!m)throw Error("size cannot be null.");let _=this.drawOrder,x=Number.POSITIVE_INFINITY,y=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY,v=Number.NEGATIVE_INFINITY;for(let i=0,m=_.length;i<m;i++){let m=_[i];if(!m.bone.active)continue;let E=0,A=null,S=m.getAttachment();if(S instanceof eD?(E=8,A=tr.setArraySize(p,E,0),S.computeWorldVertices(m,A,0,2)):S instanceof attachments_MeshAttachment_MeshAttachment&&(E=S.worldVerticesLength,A=tr.setArraySize(p,E,0),S.computeWorldVertices(m,0,E,A,0,2)),A)for(let i=0,m=A.length;i<m;i+=2){let m=A[i],p=A[i+1];x=Math.min(x,m),y=Math.min(y,p),T=Math.max(T,m),v=Math.max(v,p)}}i.set(x,y),m.set(T-x,v-y)}get flipX(){return -1==this.scaleX}set flipX(i){e8.deprecatedWarning1||(e8.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=i?1:-1}get flipY(){return -1==this.scaleY}set flipY(i){e8.deprecatedWarning1||(e8.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=i?1:-1}},e9=e8;e9.deprecatedWarning1=!1;let core_SkeletonData_SkeletonData=class core_SkeletonData_SkeletonData{constructor(){this.name=null,this.bones=[],this.slots=[],this.skins=[],this.defaultSkin=null,this.events=[],this.animations=[],this.ikConstraints=[],this.transformConstraints=[],this.pathConstraints=[],this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}findBone(i){if(!i)throw Error("boneName cannot be null.");let m=this.bones;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findBoneIndex(i){if(!i)throw Error("boneName cannot be null.");let m=this.bones;for(let p=0,_=m.length;p<_;p++)if(m[p].name==i)return p;return -1}findSlot(i){if(!i)throw Error("slotName cannot be null.");let m=this.slots;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findSlotIndex(i){if(!i)throw Error("slotName cannot be null.");let m=this.slots;for(let p=0,_=m.length;p<_;p++)if(m[p].name==i)return p;return -1}findSkin(i){if(!i)throw Error("skinName cannot be null.");let m=this.skins;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findEvent(i){if(!i)throw Error("eventDataName cannot be null.");let m=this.events;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findAnimation(i){if(!i)throw Error("animationName cannot be null.");let m=this.animations;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findIkConstraint(i){if(!i)throw Error("constraintName cannot be null.");let m=this.ikConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findTransformConstraint(i){if(!i)throw Error("constraintName cannot be null.");let m=this.transformConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findPathConstraint(i){if(!i)throw Error("constraintName cannot be null.");let m=this.pathConstraints;for(let p=0,_=m.length;p<_;p++){let _=m[p];if(_.name==i)return _}return null}findPathConstraintIndex(i){if(null==i)throw Error("pathConstraintName cannot be null.");let m=this.pathConstraints;for(let p=0,_=m.length;p<_;p++)if(m[p].name==i)return p;return -1}};let core_SlotData_SlotData=class core_SlotData_SlotData{constructor(i,m,p){if(this.index=0,this.color=new tt(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=K.T$.NORMAL,i<0)throw Error("index must be >= 0.");if(!m)throw Error("name cannot be null.");if(!p)throw Error("boneData cannot be null.");this.index=i,this.name=m,this.boneData=p}};let core_TransformConstraintData_TransformConstraintData=class core_TransformConstraintData_TransformConstraintData extends ConstraintData_ConstraintData{constructor(i){super(i,0,!1),this.bones=[],this._target=null,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}set target(i){this._target=i}get target(){if(this._target)return this._target;throw Error("BoneData not set.")}};let Skin_SkinEntry=class Skin_SkinEntry{constructor(i,m,p){this.slotIndex=i,this.name=m,this.attachment=p}};let core_Skin_Skin=class core_Skin_Skin{constructor(i){if(this.attachments=[],this.bones=[],this.constraints=[],!i)throw Error("name cannot be null.");this.name=i}setAttachment(i,m,p){if(!p)throw Error("attachment cannot be null.");let _=this.attachments;i>=_.length&&(_.length=i+1),_[i]||(_[i]={}),_[i][m]=p}addSkin(i){for(let m=0;m<i.bones.length;m++){let p=i.bones[m],_=!1;for(let i=0;i<this.bones.length;i++)if(this.bones[i]==p){_=!0;break}_||this.bones.push(p)}for(let m=0;m<i.constraints.length;m++){let p=i.constraints[m],_=!1;for(let i=0;i<this.constraints.length;i++)if(this.constraints[i]==p){_=!0;break}_||this.constraints.push(p)}let m=i.getAttachments();for(let i=0;i<m.length;i++){let p=m[i];this.setAttachment(p.slotIndex,p.name,p.attachment)}}copySkin(i){for(let m=0;m<i.bones.length;m++){let p=i.bones[m],_=!1;for(let i=0;i<this.bones.length;i++)if(this.bones[i]==p){_=!0;break}_||this.bones.push(p)}for(let m=0;m<i.constraints.length;m++){let p=i.constraints[m],_=!1;for(let i=0;i<this.constraints.length;i++)if(this.constraints[i]==p){_=!0;break}_||this.constraints.push(p)}let m=i.getAttachments();for(let i=0;i<m.length;i++){let p=m[i];p.attachment&&(p.attachment instanceof attachments_MeshAttachment_MeshAttachment?p.attachment=p.attachment.newLinkedMesh():p.attachment=p.attachment.copy(),this.setAttachment(p.slotIndex,p.name,p.attachment))}}getAttachment(i,m){let p=this.attachments[i];return p?p[m]:null}removeAttachment(i,m){let p=this.attachments[i];p&&delete p[m]}getAttachments(){let i=[];for(let m=0;m<this.attachments.length;m++){let p=this.attachments[m];if(p)for(let _ in p){let x=p[_];x&&i.push(new Skin_SkinEntry(m,_,x))}}return i}getAttachmentsForSlot(i,m){let p=this.attachments[i];if(p)for(let _ in p){let x=p[_];x&&m.push(new Skin_SkinEntry(i,_,x))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(i,m){let p=0;for(let _=0;_<i.slots.length;_++){let x=i.slots[_],y=x.getAttachment();if(y&&p<m.attachments.length){let i=m.attachments[p];for(let m in i){let _=i[m];if(y==_){let i=this.getAttachment(p,m);i&&x.setAttachment(i);break}}}p++}}};let SkeletonBinary_SkeletonBinary=class SkeletonBinary_SkeletonBinary{constructor(i){this.ver40=!1,this.scale=1,this.linkedMeshes=[],this.attachmentLoader=i}readSkeletonData(i){let m=this.scale,p=new core_SkeletonData_SkeletonData;p.name="";let _=new BinaryInput(i),x=_.readInt32(),y=_.readInt32();p.hash=0==y&&0==x?null:y.toString(16)+x.toString(16),p.version=_.readString();let T=p.version.substr(0,3);if("4.0"!==T&&"4.1"!==T){let i=`Spine 4.1 loader cant load version ${p.version}. Please configure your pixi-spine bundle`;console.error(i)}this.ver40="4.0"===T,p.x=_.readFloat(),p.y=_.readFloat(),p.width=_.readFloat(),p.height=_.readFloat();let v=_.readBoolean();v&&(p.fps=_.readFloat(),p.imagesPath=_.readString(),p.audioPath=_.readString());let E=0;E=_.readInt(!0);for(let i=0;i<E;i++){let i=_.readString();if(!i)throw Error("String in string table must not be null.");_.strings.push(i)}E=_.readInt(!0);for(let i=0;i<E;i++){let x=_.readString();if(!x)throw Error("Bone name must not be null.");let y=0==i?null:p.bones[_.readInt(!0)],T=new core_BoneData_BoneData(i,x,y);T.rotation=_.readFloat(),T.x=_.readFloat()*m,T.y=_.readFloat()*m,T.scaleX=_.readFloat(),T.scaleY=_.readFloat(),T.shearX=_.readFloat(),T.shearY=_.readFloat(),T.length=_.readFloat()*m,T.transformMode=_.readInt(!0),T.skinRequired=_.readBoolean(),v&&tt.rgba8888ToColor(T.color,_.readInt32()),p.bones.push(T)}E=_.readInt(!0);for(let i=0;i<E;i++){let m=_.readString();if(!m)throw Error("Slot name must not be null.");let x=p.bones[_.readInt(!0)],y=new core_SlotData_SlotData(i,m,x);tt.rgba8888ToColor(y.color,_.readInt32());let T=_.readInt32();-1!=T&&tt.rgb888ToColor(y.darkColor=new tt,T),y.attachmentName=_.readStringRef(),y.blendMode=_.readInt(!0),p.slots.push(y)}E=_.readInt(!0);for(let i=0,x;i<E;i++){let i=_.readString();if(!i)throw Error("IK constraint data name must not be null.");let y=new core_IkConstraintData_IkConstraintData(i);y.order=_.readInt(!0),y.skinRequired=_.readBoolean(),x=_.readInt(!0);for(let i=0;i<x;i++)y.bones.push(p.bones[_.readInt(!0)]);y.target=p.bones[_.readInt(!0)],y.mix=_.readFloat(),y.softness=_.readFloat()*m,y.bendDirection=_.readByte(),y.compress=_.readBoolean(),y.stretch=_.readBoolean(),y.uniform=_.readBoolean(),p.ikConstraints.push(y)}E=_.readInt(!0);for(let i=0,x;i<E;i++){let i=_.readString();if(!i)throw Error("Transform constraint data name must not be null.");let y=new core_TransformConstraintData_TransformConstraintData(i);y.order=_.readInt(!0),y.skinRequired=_.readBoolean(),x=_.readInt(!0);for(let i=0;i<x;i++)y.bones.push(p.bones[_.readInt(!0)]);y.target=p.bones[_.readInt(!0)],y.local=_.readBoolean(),y.relative=_.readBoolean(),y.offsetRotation=_.readFloat(),y.offsetX=_.readFloat()*m,y.offsetY=_.readFloat()*m,y.offsetScaleX=_.readFloat(),y.offsetScaleY=_.readFloat(),y.offsetShearY=_.readFloat(),y.mixRotate=_.readFloat(),y.mixX=_.readFloat(),y.mixY=_.readFloat(),y.mixScaleX=_.readFloat(),y.mixScaleY=_.readFloat(),y.mixShearY=_.readFloat(),p.transformConstraints.push(y)}E=_.readInt(!0);for(let i=0,x;i<E;i++){let i=_.readString();if(!i)throw Error("Path constraint data name must not be null.");let y=new core_PathConstraintData_PathConstraintData(i);y.order=_.readInt(!0),y.skinRequired=_.readBoolean(),x=_.readInt(!0);for(let i=0;i<x;i++)y.bones.push(p.bones[_.readInt(!0)]);y.target=p.slots[_.readInt(!0)],y.positionMode=_.readInt(!0),y.spacingMode=_.readInt(!0),y.rotateMode=_.readInt(!0),y.offsetRotation=_.readFloat(),y.position=_.readFloat(),y.positionMode==z.Fixed&&(y.position*=m),y.spacing=_.readFloat(),(y.spacingMode==e4.Length||y.spacingMode==e4.Fixed)&&(y.spacing*=m),y.mixRotate=_.readFloat(),y.mixX=_.readFloat(),y.mixY=_.readFloat(),p.pathConstraints.push(y)}let A=this.readSkin(_,p,!0,v);A&&(p.defaultSkin=A,p.skins.push(A));{let i=p.skins.length;for(tr.setArraySize(p.skins,E=i+_.readInt(!0));i<E;i++){let m=this.readSkin(_,p,!1,v);if(!m)throw Error("readSkin() should not have returned null.");p.skins[i]=m}}E=this.linkedMeshes.length;for(let i=0;i<E;i++){let m=this.linkedMeshes[i],_=m.skin?p.findSkin(m.skin):p.defaultSkin;if(!_)throw Error("Not skin found for linked mesh.");if(!m.parent)throw Error("Linked mesh parent must not be null");let x=_.getAttachment(m.slotIndex,m.parent);if(!x)throw Error(`Parent mesh not found: ${m.parent}`);m.mesh.timelineAttachment=m.inheritTimeline?x:m.mesh,m.mesh.setParentMesh(x)}this.linkedMeshes.length=0,E=_.readInt(!0);for(let i=0;i<E;i++){let i=_.readStringRef();if(!i)throw Error();let m=new core_EventData_EventData(i);m.intValue=_.readInt(!1),m.floatValue=_.readFloat(),m.stringValue=_.readString(),m.audioPath=_.readString(),m.audioPath&&(m.volume=_.readFloat(),m.balance=_.readFloat()),p.events.push(m)}E=_.readInt(!0);for(let i=0;i<E;i++){let i=_.readString();if(!i)throw Error("Animatio name must not be null.");p.animations.push(this.readAnimation(_,i,p))}return p}readSkin(i,m,p,_){let x=null,y=0;if(p){if(0==(y=i.readInt(!0)))return null;x=new core_Skin_Skin("default")}else{let p=i.readStringRef();if(!p)throw Error("Skin name must not be null.");(x=new core_Skin_Skin(p)).bones.length=i.readInt(!0);for(let p=0,_=x.bones.length;p<_;p++)x.bones[p]=m.bones[i.readInt(!0)];for(let p=0,_=i.readInt(!0);p<_;p++)x.constraints.push(m.ikConstraints[i.readInt(!0)]);for(let p=0,_=i.readInt(!0);p<_;p++)x.constraints.push(m.transformConstraints[i.readInt(!0)]);for(let p=0,_=i.readInt(!0);p<_;p++)x.constraints.push(m.pathConstraints[i.readInt(!0)]);y=i.readInt(!0)}for(let p=0;p<y;p++){let p=i.readInt(!0);for(let y=0,T=i.readInt(!0);y<T;y++){let y=i.readStringRef();if(!y)throw Error("Attachment name must not be null");let T=this.readAttachment(i,m,x,p,y,_);T&&x.setAttachment(p,y,T)}}return x}readAttachment(i,m,p,_,x,y){let T=this.scale,v=i.readStringRef();switch(v||(v=x),i.readByte()){case Y.Region:{let m=i.readStringRef(),_=i.readFloat(),x=i.readFloat(),y=i.readFloat(),E=i.readFloat(),A=i.readFloat(),S=i.readFloat(),I=i.readFloat(),R=i.readInt32(),C=this.readSequence(i);m||(m=v);let P=this.attachmentLoader.newRegionAttachment(p,v,m,C);if(!P)return null;return P.path=m,P.x=x*T,P.y=y*T,P.scaleX=E,P.scaleY=A,P.rotation=_,P.width=S*T,P.height=I*T,tt.rgba8888ToColor(P.color,R),P.sequence=C,null==C&&P.updateRegion(),P}case Y.BoundingBox:{let m=i.readInt(!0),_=this.readVertices(i,m),x=y?i.readInt32():0,T=this.attachmentLoader.newBoundingBoxAttachment(p,v);if(!T)return null;return T.worldVerticesLength=m<<1,T.vertices=_.vertices,T.bones=_.bones,y&&tt.rgba8888ToColor(T.color,x),T}case Y.Mesh:{let m=i.readStringRef(),_=i.readInt32(),x=i.readInt(!0),E=this.readFloatArray(i,x<<1,1),A=this.readShortArray(i),S=this.readVertices(i,x),I=i.readInt(!0),R=this.readSequence(i),C=[],P=0,k=0;y&&(C=this.readShortArray(i),P=i.readFloat(),k=i.readFloat()),m||(m=v);let B=this.attachmentLoader.newMeshAttachment(p,v,m,R);if(!B)return null;return B.path=m,tt.rgba8888ToColor(B.color,_),B.bones=S.bones,B.vertices=S.vertices,B.worldVerticesLength=x<<1,B.triangles=A,B.regionUVs=new Float32Array(E),B.hullLength=I<<1,B.sequence=R,y&&(B.edges=C,B.width=P*T,B.height=k*T),B}case Y.LinkedMesh:{let m=i.readStringRef(),x=i.readInt32(),E=i.readStringRef(),A=i.readStringRef(),S=i.readBoolean(),I=this.readSequence(i),R=0,C=0;y&&(R=i.readFloat(),C=i.readFloat()),m||(m=v);let P=this.attachmentLoader.newMeshAttachment(p,v,m,I);if(!P)return null;return P.path=m,tt.rgba8888ToColor(P.color,x),P.sequence=I,y&&(P.width=R*T,P.height=C*T),this.linkedMeshes.push(new SkeletonBinary_LinkedMesh(P,E,_,A,S)),P}case Y.Path:{let m=i.readBoolean(),_=i.readBoolean(),x=i.readInt(!0),E=this.readVertices(i,x),A=tr.newArray(x/3,0);for(let m=0,p=A.length;m<p;m++)A[m]=i.readFloat()*T;let S=y?i.readInt32():0,I=this.attachmentLoader.newPathAttachment(p,v);if(!I)return null;return I.closed=m,I.constantSpeed=_,I.worldVerticesLength=x<<1,I.vertices=E.vertices,I.bones=E.bones,I.lengths=A,y&&tt.rgba8888ToColor(I.color,S),I}case Y.Point:{let m=i.readFloat(),_=i.readFloat(),x=i.readFloat(),E=y?i.readInt32():0,A=this.attachmentLoader.newPointAttachment(p,v);if(!A)return null;return A.x=_*T,A.y=x*T,A.rotation=m,y&&tt.rgba8888ToColor(A.color,E),A}case Y.Clipping:{let _=i.readInt(!0),x=i.readInt(!0),T=this.readVertices(i,x),E=y?i.readInt32():0,A=this.attachmentLoader.newClippingAttachment(p,v);if(!A)return null;return A.endSlot=m.slots[_],A.worldVerticesLength=x<<1,A.vertices=T.vertices,A.bones=T.bones,y&&tt.rgba8888ToColor(A.color,E),A}}return null}readSequence(i){if(this.ver40||!i.readBoolean())return null;let m=new eN(i.readInt(!0));return m.start=i.readInt(!0),m.digits=i.readInt(!0),m.setupIndex=i.readInt(!0),m}readDeformTimelineType(i){return this.ver40?rp:i.readByte()}readVertices(i,m){let p=this.scale,_=new SkeletonBinary_Vertices;if(!i.readBoolean())return _.vertices=this.readFloatArray(i,m<<1,p),_;let x=[],y=[];for(let _=0;_<m;_++){let m=i.readInt(!0);y.push(m);for(let _=0;_<m;_++)y.push(i.readInt(!0)),x.push(i.readFloat()*p),x.push(i.readFloat()*p),x.push(i.readFloat())}return _.vertices=tr.toFloatArray(x),_.bones=y,_}readFloatArray(i,m,p){let _=Array(m);if(1==p)for(let p=0;p<m;p++)_[p]=i.readFloat();else for(let x=0;x<m;x++)_[x]=i.readFloat()*p;return _}readShortArray(i){let m=i.readInt(!0),p=Array(m);for(let _=0;_<m;_++)p[_]=i.readShort();return p}readAnimation(i,m,p){i.readInt(!0);let _=[],x=this.scale;for(let m=0,p=i.readInt(!0);m<p;m++){let m=i.readInt(!0);for(let p=0,x=i.readInt(!0);p<x;p++){let p=i.readByte(),x=i.readInt(!0),y=x-1;switch(p){case rh:{let p=new core_Animation_AttachmentTimeline(x,m);for(let m=0;m<x;m++)p.setFrame(m,i.readFloat(),i.readStringRef());_.push(p);break}case ru:{let p=i.readInt(!0),T=new RGBATimeline(x,p,m),v=i.readFloat(),E=i.readUnsignedByte()/255,A=i.readUnsignedByte()/255,S=i.readUnsignedByte()/255,I=i.readUnsignedByte()/255;for(let m=0,p=0;T.setFrame(m,v,E,A,S,I),m!=y;m++){let _=i.readFloat(),x=i.readUnsignedByte()/255,y=i.readUnsignedByte()/255,R=i.readUnsignedByte()/255,C=i.readUnsignedByte()/255;switch(i.readByte()){case rb:T.setStepped(m);break;case rT:setBezier(i,T,p++,m,0,v,_,E,x,1),setBezier(i,T,p++,m,1,v,_,A,y,1),setBezier(i,T,p++,m,2,v,_,S,R,1),setBezier(i,T,p++,m,3,v,_,I,C,1)}v=_,E=x,A=y,S=R,I=C}_.push(T);break}case rd:{let p=i.readInt(!0),T=new RGBTimeline(x,p,m),v=i.readFloat(),E=i.readUnsignedByte()/255,A=i.readUnsignedByte()/255,S=i.readUnsignedByte()/255;for(let m=0,p=0;T.setFrame(m,v,E,A,S),m!=y;m++){let _=i.readFloat(),x=i.readUnsignedByte()/255,y=i.readUnsignedByte()/255,I=i.readUnsignedByte()/255;switch(i.readByte()){case rb:T.setStepped(m);break;case rT:setBezier(i,T,p++,m,0,v,_,E,x,1),setBezier(i,T,p++,m,1,v,_,A,y,1),setBezier(i,T,p++,m,2,v,_,S,I,1)}v=_,E=x,A=y,S=I}_.push(T);break}case rc:{let p=i.readInt(!0),T=new RGBA2Timeline(x,p,m),v=i.readFloat(),E=i.readUnsignedByte()/255,A=i.readUnsignedByte()/255,S=i.readUnsignedByte()/255,I=i.readUnsignedByte()/255,R=i.readUnsignedByte()/255,C=i.readUnsignedByte()/255,P=i.readUnsignedByte()/255;for(let m=0,p=0;T.setFrame(m,v,E,A,S,I,R,C,P),m!=y;m++){let _=i.readFloat(),x=i.readUnsignedByte()/255,y=i.readUnsignedByte()/255,k=i.readUnsignedByte()/255,B=i.readUnsignedByte()/255,D=i.readUnsignedByte()/255,F=i.readUnsignedByte()/255,L=i.readUnsignedByte()/255;switch(i.readByte()){case rb:T.setStepped(m);break;case rT:setBezier(i,T,p++,m,0,v,_,E,x,1),setBezier(i,T,p++,m,1,v,_,A,y,1),setBezier(i,T,p++,m,2,v,_,S,k,1),setBezier(i,T,p++,m,3,v,_,I,B,1),setBezier(i,T,p++,m,4,v,_,R,D,1),setBezier(i,T,p++,m,5,v,_,C,F,1),setBezier(i,T,p++,m,6,v,_,P,L,1)}v=_,E=x,A=y,S=k,I=B,R=D,C=F,P=L}_.push(T);break}case rm:{let p=i.readInt(!0),T=new RGB2Timeline(x,p,m),v=i.readFloat(),E=i.readUnsignedByte()/255,A=i.readUnsignedByte()/255,S=i.readUnsignedByte()/255,I=i.readUnsignedByte()/255,R=i.readUnsignedByte()/255,C=i.readUnsignedByte()/255;for(let m=0,p=0;T.setFrame(m,v,E,A,S,I,R,C),m!=y;m++){let _=i.readFloat(),x=i.readUnsignedByte()/255,y=i.readUnsignedByte()/255,P=i.readUnsignedByte()/255,k=i.readUnsignedByte()/255,B=i.readUnsignedByte()/255,D=i.readUnsignedByte()/255;switch(i.readByte()){case rb:T.setStepped(m);break;case rT:setBezier(i,T,p++,m,0,v,_,E,x,1),setBezier(i,T,p++,m,1,v,_,A,y,1),setBezier(i,T,p++,m,2,v,_,S,P,1),setBezier(i,T,p++,m,3,v,_,I,k,1),setBezier(i,T,p++,m,4,v,_,R,B,1),setBezier(i,T,p++,m,5,v,_,C,D,1)}v=_,E=x,A=y,S=P,I=k,R=B,C=D}_.push(T);break}case rf:{let p=new AlphaTimeline(x,i.readInt(!0),m),T=i.readFloat(),v=i.readUnsignedByte()/255;for(let m=0,_=0;p.setFrame(m,T,v),m!=y;m++){let x=i.readFloat(),y=i.readUnsignedByte()/255;switch(i.readByte()){case rb:p.setStepped(m);break;case rT:setBezier(i,p,_++,m,0,T,x,v,y,1)}T=x,v=y}_.push(p)}}}}for(let m=0,p=i.readInt(!0);m<p;m++){let m=i.readInt(!0);for(let p=0,y=i.readInt(!0);p<y;p++){let p=i.readByte(),y=i.readInt(!0),T=i.readInt(!0);switch(p){case e7:_.push(readTimeline1(i,new lib_core_Animation_RotateTimeline(y,T,m),1));break;case rt:_.push(readTimeline2(i,new lib_core_Animation_TranslateTimeline(y,T,m),x));break;case re:_.push(readTimeline1(i,new TranslateXTimeline(y,T,m),x));break;case rr:_.push(readTimeline1(i,new TranslateYTimeline(y,T,m),x));break;case ri:_.push(readTimeline2(i,new core_Animation_ScaleTimeline(y,T,m),1));break;case rs:_.push(readTimeline1(i,new ScaleXTimeline(y,T,m),1));break;case rn:_.push(readTimeline1(i,new ScaleYTimeline(y,T,m),1));break;case ra:_.push(readTimeline2(i,new core_Animation_ShearTimeline(y,T,m),1));break;case ro:_.push(readTimeline1(i,new ShearXTimeline(y,T,m),1));break;case rl:_.push(readTimeline1(i,new ShearYTimeline(y,T,m),1))}}}for(let m=0,p=i.readInt(!0);m<p;m++){let m=i.readInt(!0),p=i.readInt(!0),y=p-1,T=new lib_core_Animation_IkConstraintTimeline(p,i.readInt(!0),m),v=i.readFloat(),E=i.readFloat(),A=i.readFloat()*x;for(let m=0,p=0;T.setFrame(m,v,E,A,i.readByte(),i.readBoolean(),i.readBoolean()),m!=y;m++){let _=i.readFloat(),y=i.readFloat(),S=i.readFloat()*x;switch(i.readByte()){case rb:T.setStepped(m);break;case rT:setBezier(i,T,p++,m,0,v,_,E,y,1),setBezier(i,T,p++,m,1,v,_,A,S,x)}v=_,E=y,A=S}_.push(T)}for(let m=0,p=i.readInt(!0);m<p;m++){let m=i.readInt(!0),p=i.readInt(!0),x=p-1,y=new lib_core_Animation_TransformConstraintTimeline(p,i.readInt(!0),m),T=i.readFloat(),v=i.readFloat(),E=i.readFloat(),A=i.readFloat(),S=i.readFloat(),I=i.readFloat(),R=i.readFloat();for(let m=0,p=0;y.setFrame(m,T,v,E,A,S,I,R),m!=x;m++){let _=i.readFloat(),x=i.readFloat(),C=i.readFloat(),P=i.readFloat(),k=i.readFloat(),B=i.readFloat(),D=i.readFloat();switch(i.readByte()){case rb:y.setStepped(m);break;case rT:setBezier(i,y,p++,m,0,T,_,v,x,1),setBezier(i,y,p++,m,1,T,_,E,C,1),setBezier(i,y,p++,m,2,T,_,A,P,1),setBezier(i,y,p++,m,3,T,_,S,k,1),setBezier(i,y,p++,m,4,T,_,I,B,1),setBezier(i,y,p++,m,5,T,_,R,D,1)}T=_,v=x,E=C,A=P,S=k,I=B,R=D}_.push(y)}for(let m=0,y=i.readInt(!0);m<y;m++){let m=i.readInt(!0),y=p.pathConstraints[m];for(let p=0,T=i.readInt(!0);p<T;p++)switch(i.readByte()){case r_:_.push(readTimeline1(i,new lib_core_Animation_PathConstraintPositionTimeline(i.readInt(!0),i.readInt(!0),m),y.positionMode==z.Fixed?x:1));break;case rx:_.push(readTimeline1(i,new core_Animation_PathConstraintSpacingTimeline(i.readInt(!0),i.readInt(!0),m),y.spacingMode==e4.Length||y.spacingMode==e4.Fixed?x:1));break;case ry:let p=new lib_core_Animation_PathConstraintMixTimeline(i.readInt(!0),i.readInt(!0),m),T=i.readFloat(),v=i.readFloat(),E=i.readFloat(),A=i.readFloat();for(let m=0,_=0,x=p.getFrameCount()-1;p.setFrame(m,T,v,E,A),m!=x;m++){let x=i.readFloat(),y=i.readFloat(),S=i.readFloat(),I=i.readFloat();switch(i.readByte()){case rb:p.setStepped(m);break;case rT:setBezier(i,p,_++,m,0,T,x,v,y,1),setBezier(i,p,_++,m,1,T,x,E,S,1),setBezier(i,p,_++,m,2,T,x,A,I,1)}T=x,v=y,E=S,A=I}_.push(p)}}for(let m=0,y=i.readInt(!0);m<y;m++){let m=p.skins[i.readInt(!0)];for(let p=0,y=i.readInt(!0);p<y;p++){let p=i.readInt(!0);for(let y=0,T=i.readInt(!0);y<T;y++){let y=i.readStringRef();if(!y)throw Error("attachmentName must not be null.");let T=m.getAttachment(p,y),v=this.readDeformTimelineType(i),E=i.readInt(!0),A=E-1;switch(v){case rp:{let m=T.bones,y=T.vertices,v=m?y.length/3*2:y.length,S=i.readInt(!0),I=new core_Animation_DeformTimeline(E,S,p,T),R=i.readFloat();for(let p=0,_=0;;p++){let T;let E=i.readInt(!0);if(0==E)T=m?tr.newFloatArray(v):y;else{T=tr.newFloatArray(v);let p=i.readInt(!0);if(E+=p,1==x)for(let m=p;m<E;m++)T[m]=i.readFloat();else for(let m=p;m<E;m++)T[m]=i.readFloat()*x;if(!m)for(let i=0,m=T.length;i<m;i++)T[i]+=y[i]}if(I.setFrame(p,R,T),p==A)break;let S=i.readFloat();switch(i.readByte()){case rb:I.setStepped(p);break;case rT:setBezier(i,I,_++,p,0,R,S,0,1,1)}R=S}_.push(I);break}case rg:{let m=new eW(E,p,T);for(let p=0;p<E;p++){let _=i.readFloat(),x=i.readInt32();m.setFrame(p,_,eO[15&x],x>>4,i.readFloat())}_.push(m)}}}}}let y=i.readInt(!0);if(y>0){let m=new eG(y),x=p.slots.length;for(let p=0;p<y;p++){let _=i.readFloat(),y=i.readInt(!0),T=tr.newArray(x,0);for(let i=x-1;i>=0;i--)T[i]=-1;let v=tr.newArray(x-y,0),E=0,A=0;for(let m=0;m<y;m++){let m=i.readInt(!0);for(;E!=m;)v[A++]=E++;T[E+i.readInt(!0)]=E++}for(;E<x;)v[A++]=E++;for(let i=x-1;i>=0;i--)-1==T[i]&&(T[i]=v[--A]);m.setFrame(p,_,T)}_.push(m)}let T=i.readInt(!0);if(T>0){let m=new eX(T);for(let _=0;_<T;_++){let x=i.readFloat(),y=p.events[i.readInt(!0)],T=new core_Event_Event(x,y);T.intValue=i.readInt(!1),T.floatValue=i.readFloat(),T.stringValue=i.readBoolean()?i.readString():y.stringValue,T.data.audioPath&&(T.volume=i.readFloat(),T.balance=i.readFloat()),m.setFrame(_,T)}_.push(m)}let v=0;for(let i=0,m=_.length;i<m;i++)v=Math.max(v,_[i].getDuration());return new core_Animation_Animation(m,_,v)}};SkeletonBinary_SkeletonBinary.BlendModeValues=[K.T$.NORMAL,K.T$.ADD,K.T$.MULTIPLY,K.T$.SCREEN];let SkeletonBinary_LinkedMesh=class SkeletonBinary_LinkedMesh{constructor(i,m,p,_,x){this.mesh=i,this.skin=m,this.slotIndex=p,this.parent=_,this.inheritTimeline=x}};let SkeletonBinary_Vertices=class SkeletonBinary_Vertices{constructor(i=null,m=null){this.bones=i,this.vertices=m}};function readTimeline1(i,m,p){let _=i.readFloat(),x=i.readFloat()*p;for(let y=0,T=0,v=m.getFrameCount()-1;m.setFrame(y,_,x),y!=v;y++){let v=i.readFloat(),E=i.readFloat()*p;switch(i.readByte()){case rb:m.setStepped(y);break;case rT:setBezier(i,m,T++,y,0,_,v,x,E,p)}_=v,x=E}return m}function readTimeline2(i,m,p){let _=i.readFloat(),x=i.readFloat()*p,y=i.readFloat()*p;for(let T=0,v=0,E=m.getFrameCount()-1;m.setFrame(T,_,x,y),T!=E;T++){let E=i.readFloat(),A=i.readFloat()*p,S=i.readFloat()*p;switch(i.readByte()){case rb:m.setStepped(T);break;case rT:setBezier(i,m,v++,T,0,_,E,x,A,p),setBezier(i,m,v++,T,1,_,E,y,S,p)}_=E,x=A,y=S}return m}function setBezier(i,m,p,_,x,y,T,v,E,A){m.setBezier(p,_,x,y,v,i.readFloat(),i.readFloat()*A,i.readFloat(),i.readFloat()*A,T,E)}let e7=0,rt=1,re=2,rr=3,ri=4,rs=5,rn=6,ra=7,ro=8,rl=9,rh=0,ru=1,rd=2,rc=3,rm=4,rf=5,rp=0,rg=1,r_=0,rx=1,ry=2,rb=1,rT=2;let core_SkeletonBounds_SkeletonBounds=class core_SkeletonBounds_SkeletonBounds extends SkeletonBoundsBase_SkeletonBoundsBase{};let core_SkeletonJson_SkeletonJson=class core_SkeletonJson_SkeletonJson{constructor(i){this.scale=1,this.linkedMeshes=[],this.attachmentLoader=i}readSkeletonData(i){let m=this.scale,p=new core_SkeletonData_SkeletonData,_="string"==typeof i?JSON.parse(i):i,x=_.skeleton;if(x){p.hash=x.hash,p.version=x.spine;let i=p.version.substr(0,3);if("4.0"!==i&&"4.1"!==i){let i=`Spine 4.1 loader cant load version ${x.spine}. Please configure your pixi-spine bundle`;console.error(i)}p.x=x.x,p.y=x.y,p.width=x.width,p.height=x.height,p.fps=x.fps,p.imagesPath=x.images}if(_.bones)for(let i=0;i<_.bones.length;i++){let x=_.bones[i],y=null,T=getValue(x,"parent",null);if(null!=T&&null==(y=p.findBone(T)))throw Error(`Parent bone not found: ${T}`);let v=new core_BoneData_BoneData(p.bones.length,x.name,y);v.length=getValue(x,"length",0)*m,v.x=getValue(x,"x",0)*m,v.y=getValue(x,"y",0)*m,v.rotation=getValue(x,"rotation",0),v.scaleX=getValue(x,"scaleX",1),v.scaleY=getValue(x,"scaleY",1),v.shearX=getValue(x,"shearX",0),v.shearY=getValue(x,"shearY",0),v.transformMode=tr.enumValue(Z,getValue(x,"transform","Normal")),v.skinRequired=getValue(x,"skin",!1);let E=getValue(x,"color",null);E&&v.color.setFromString(E),p.bones.push(v)}if(_.slots)for(let i=0;i<_.slots.length;i++){let m=_.slots[i],x=p.findBone(m.bone);if(!x)throw Error(`Couldn't find bone ${m.bone} for slot ${m.name}`);let y=new core_SlotData_SlotData(p.slots.length,m.name,x),T=getValue(m,"color",null);T&&y.color.setFromString(T);let v=getValue(m,"dark",null);v&&(y.darkColor=tt.fromString(v)),y.attachmentName=getValue(m,"attachment",null),y.blendMode=core_SkeletonJson_SkeletonJson.blendModeFromString(getValue(m,"blend","normal")),p.slots.push(y)}if(_.ik)for(let i=0;i<_.ik.length;i++){let x=_.ik[i],y=new core_IkConstraintData_IkConstraintData(x.name);y.order=getValue(x,"order",0),y.skinRequired=getValue(x,"skin",!1);for(let i=0;i<x.bones.length;i++){let m=x.bones[i],_=p.findBone(m);if(null==_)throw Error(`IK bone not found: ${m}`);y.bones.push(_)}y.target=p.findBone(x.target),y.mix=getValue(x,"mix",1),y.softness=getValue(x,"softness",0)*m,y.bendDirection=getValue(x,"bendPositive",!0)?1:-1,y.compress=getValue(x,"compress",!1),y.stretch=getValue(x,"stretch",!1),y.uniform=getValue(x,"uniform",!1),p.ikConstraints.push(y)}if(_.transform)for(let i=0;i<_.transform.length;i++){let x=_.transform[i],y=new core_TransformConstraintData_TransformConstraintData(x.name);y.order=getValue(x,"order",0),y.skinRequired=getValue(x,"skin",!1);for(let i=0;i<x.bones.length;i++){let m=x.bones[i],_=p.findBone(m);if(!_)throw Error(`Couldn't find bone ${m} for transform constraint ${x.name}.`);y.bones.push(_)}let T=x.target,v=p.findBone(T);if(!v)throw Error(`Couldn't find target bone ${T} for transform constraint ${x.name}.`);y.target=v,y.local=getValue(x,"local",!1),y.relative=getValue(x,"relative",!1),y.offsetRotation=getValue(x,"rotation",0),y.offsetX=getValue(x,"x",0)*m,y.offsetY=getValue(x,"y",0)*m,y.offsetScaleX=getValue(x,"scaleX",0),y.offsetScaleY=getValue(x,"scaleY",0),y.offsetShearY=getValue(x,"shearY",0),y.mixRotate=getValue(x,"mixRotate",1),y.mixX=getValue(x,"mixX",1),y.mixY=getValue(x,"mixY",y.mixX),y.mixScaleX=getValue(x,"mixScaleX",1),y.mixScaleY=getValue(x,"mixScaleY",y.mixScaleX),y.mixShearY=getValue(x,"mixShearY",1),p.transformConstraints.push(y)}if(_.path)for(let i=0;i<_.path.length;i++){let x=_.path[i],y=new core_PathConstraintData_PathConstraintData(x.name);y.order=getValue(x,"order",0),y.skinRequired=getValue(x,"skin",!1);for(let i=0;i<x.bones.length;i++){let m=x.bones[i],_=p.findBone(m);if(!_)throw Error(`Couldn't find bone ${m} for path constraint ${x.name}.`);y.bones.push(_)}let T=x.target,v=p.findSlot(T);if(!v)throw Error(`Couldn't find target slot ${T} for path constraint ${x.name}.`);y.target=v,y.positionMode=tr.enumValue(z,getValue(x,"positionMode","Percent")),y.spacingMode=tr.enumValue(e4,getValue(x,"spacingMode","Length")),y.rotateMode=tr.enumValue(j,getValue(x,"rotateMode","Tangent")),y.offsetRotation=getValue(x,"rotation",0),y.position=getValue(x,"position",0),y.positionMode==z.Fixed&&(y.position*=m),y.spacing=getValue(x,"spacing",0),(y.spacingMode==e4.Length||y.spacingMode==e4.Fixed)&&(y.spacing*=m),y.mixRotate=getValue(x,"mixRotate",1),y.mixX=getValue(x,"mixX",1),y.mixY=getValue(x,"mixY",y.mixX),p.pathConstraints.push(y)}if(_.skins)for(let i=0;i<_.skins.length;i++){let m=_.skins[i],x=new core_Skin_Skin(m.name);if(m.bones)for(let i=0;i<m.bones.length;i++){let _=m.bones[i],y=p.findBone(_);if(!y)throw Error(`Couldn't find bone ${_} for skin ${m.name}.`);x.bones.push(y)}if(m.ik)for(let i=0;i<m.ik.length;i++){let _=m.ik[i],y=p.findIkConstraint(_);if(!y)throw Error(`Couldn't find IK constraint ${_} for skin ${m.name}.`);x.constraints.push(y)}if(m.transform)for(let i=0;i<m.transform.length;i++){let _=m.transform[i],y=p.findTransformConstraint(_);if(!y)throw Error(`Couldn't find transform constraint ${_} for skin ${m.name}.`);x.constraints.push(y)}if(m.path)for(let i=0;i<m.path.length;i++){let _=m.path[i],y=p.findPathConstraint(_);if(!y)throw Error(`Couldn't find path constraint ${_} for skin ${m.name}.`);x.constraints.push(y)}for(let i in m.attachments){let _=p.findSlot(i);if(!_)throw Error(`Couldn't find slot ${i} for skin ${m.name}.`);let y=m.attachments[i];for(let i in y){let m=this.readAttachment(y[i],x,_.index,i,p);m&&x.setAttachment(_.index,i,m)}}p.skins.push(x),"default"==x.name&&(p.defaultSkin=x)}for(let i=0,m=this.linkedMeshes.length;i<m;i++){let m=this.linkedMeshes[i],_=m.skin?p.findSkin(m.skin):p.defaultSkin;if(!_)throw Error(`Skin not found: ${m.skin}`);let x=_.getAttachment(m.slotIndex,m.parent);if(!x)throw Error(`Parent mesh not found: ${m.parent}`);m.mesh.timelineAttachment=m.inheritTimeline?x:m.mesh,m.mesh.setParentMesh(x)}if(this.linkedMeshes.length=0,_.events)for(let i in _.events){let m=_.events[i],x=new core_EventData_EventData(i);x.intValue=getValue(m,"int",0),x.floatValue=getValue(m,"float",0),x.stringValue=getValue(m,"string",""),x.audioPath=getValue(m,"audio",null),x.audioPath&&(x.volume=getValue(m,"volume",1),x.balance=getValue(m,"balance",0)),p.events.push(x)}if(_.animations)for(let i in _.animations){let m=_.animations[i];this.readAnimation(m,i,p)}return p}readAttachment(i,m,p,_,x){let y=this.scale;switch(_=getValue(i,"name",_),getValue(i,"type","region")){case"region":{let p=getValue(i,"path",_),x=this.readSequence(getValue(i,"sequence",null)),T=this.attachmentLoader.newRegionAttachment(m,_,p,x);if(!T)return null;T.path=p,T.x=getValue(i,"x",0)*y,T.y=getValue(i,"y",0)*y,T.scaleX=getValue(i,"scaleX",1),T.scaleY=getValue(i,"scaleY",1),T.rotation=getValue(i,"rotation",0),T.width=i.width*y,T.height=i.height*y,T.sequence=x;let v=getValue(i,"color",null);return v&&T.color.setFromString(v),T}case"boundingbox":{let p=this.attachmentLoader.newBoundingBoxAttachment(m,_);if(!p)return null;this.readVertices(i,p,i.vertexCount<<1);let x=getValue(i,"color",null);return x&&p.color.setFromString(x),p}case"mesh":case"linkedmesh":{let x=getValue(i,"path",_),T=this.readSequence(getValue(i,"sequence",null)),v=this.attachmentLoader.newMeshAttachment(m,_,x,T);if(!v)return null;v.path=x;let E=getValue(i,"color",null);E&&v.color.setFromString(E),v.width=getValue(i,"width",0)*y,v.height=getValue(i,"height",0)*y,v.sequence=T;let A=getValue(i,"parent",null);if(A)return this.linkedMeshes.push(new lib_core_SkeletonJson_LinkedMesh(v,getValue(i,"skin",null),p,A,getValue(i,"timelines",!0))),v;let S=i.uvs;return this.readVertices(i,v,S.length),v.triangles=i.triangles,v.regionUVs=new Float32Array(S),v.edges=getValue(i,"edges",null),v.hullLength=2*getValue(i,"hull",0),v}case"path":{let p=this.attachmentLoader.newPathAttachment(m,_);if(!p)return null;p.closed=getValue(i,"closed",!1),p.constantSpeed=getValue(i,"constantSpeed",!0);let x=i.vertexCount;this.readVertices(i,p,x<<1);let T=tr.newArray(x/3,0);for(let m=0;m<i.lengths.length;m++)T[m]=i.lengths[m]*y;p.lengths=T;let v=getValue(i,"color",null);return v&&p.color.setFromString(v),p}case"point":{let p=this.attachmentLoader.newPointAttachment(m,_);if(!p)return null;p.x=getValue(i,"x",0)*y,p.y=getValue(i,"y",0)*y,p.rotation=getValue(i,"rotation",0);let x=getValue(i,"color",null);return x&&p.color.setFromString(x),p}case"clipping":{let p=this.attachmentLoader.newClippingAttachment(m,_);if(!p)return null;let y=getValue(i,"end",null);if(null!=y){let i=x.findSlot(y);if(null==i)throw Error(`Clipping end slot not found: ${y}`);p.endSlot=i}let T=i.vertexCount;this.readVertices(i,p,T<<1);let v=getValue(i,"color",null);return v&&p.color.setFromString(v),p}}return null}readSequence(i){if(null==i)return null;let m=new eN(getValue(i,"count",0));return m.start=getValue(i,"start",1),m.digits=getValue(i,"digits",0),m.setupIndex=getValue(i,"setup",0),m}readVertices(i,m,p){let _=this.scale;m.worldVerticesLength=p;let x=i.vertices;if(p==x.length){let i=tr.toFloatArray(x);if(1!=_)for(let m=0,p=x.length;m<p;m++)i[m]*=_;m.vertices=i;return}let y=[],T=[];for(let i=0,m=x.length;i<m;){let m=x[i++];T.push(m);for(let p=i+4*m;i<p;i+=4)T.push(x[i]),y.push(x[i+1]*_),y.push(x[i+2]*_),y.push(x[i+3])}m.bones=T,m.vertices=tr.toFloatArray(y)}readAnimation(i,m,p){let _=this.scale,x=[];if(i.slots)for(let m in i.slots){let _=i.slots[m],y=p.findSlot(m);if(!y)throw Error(`Slot not found: ${m}`);let T=y.index;for(let i in _){let m=_[i];if(!m)continue;let p=m.length;if("attachment"==i){let i=new core_Animation_AttachmentTimeline(p,T);for(let _=0;_<p;_++){let p=m[_];i.setFrame(_,getValue(p,"time",0),getValue(p,"name",null))}x.push(i)}else if("rgba"==i){let i=new RGBATimeline(p,p<<2,T),_=m[0],y=getValue(_,"time",0),v=tt.fromString(_.color);for(let p=0,x=0;;p++){i.setFrame(p,y,v.r,v.g,v.b,v.a);let T=m[p+1];if(!T){i.shrink(x);break}let E=getValue(T,"time",0),A=tt.fromString(T.color),S=_.curve;S&&(x=readCurve(S,i,x,p,0,y,E,v.r,A.r,1),x=readCurve(S,i,x,p,1,y,E,v.g,A.g,1),x=readCurve(S,i,x,p,2,y,E,v.b,A.b,1),x=readCurve(S,i,x,p,3,y,E,v.a,A.a,1)),y=E,v=A,_=T}x.push(i)}else if("rgb"==i){let i=new RGBTimeline(p,3*p,T),_=m[0],y=getValue(_,"time",0),v=tt.fromString(_.color);for(let p=0,x=0;;p++){i.setFrame(p,y,v.r,v.g,v.b);let T=m[p+1];if(!T){i.shrink(x);break}let E=getValue(T,"time",0),A=tt.fromString(T.color),S=_.curve;S&&(x=readCurve(S,i,x,p,0,y,E,v.r,A.r,1),x=readCurve(S,i,x,p,1,y,E,v.g,A.g,1),x=readCurve(S,i,x,p,2,y,E,v.b,A.b,1)),y=E,v=A,_=T}x.push(i)}else if("alpha"==i)x.push(SkeletonJson_readTimeline1(m,new AlphaTimeline(p,p,T),0,1));else if("rgba2"==i){let i=new RGBA2Timeline(p,7*p,T),_=m[0],y=getValue(_,"time",0),v=tt.fromString(_.light),E=tt.fromString(_.dark);for(let p=0,x=0;;p++){i.setFrame(p,y,v.r,v.g,v.b,v.a,E.r,E.g,E.b);let T=m[p+1];if(!T){i.shrink(x);break}let A=getValue(T,"time",0),S=tt.fromString(T.light),I=tt.fromString(T.dark),R=_.curve;R&&(x=readCurve(R,i,x,p,0,y,A,v.r,S.r,1),x=readCurve(R,i,x,p,1,y,A,v.g,S.g,1),x=readCurve(R,i,x,p,2,y,A,v.b,S.b,1),x=readCurve(R,i,x,p,3,y,A,v.a,S.a,1),x=readCurve(R,i,x,p,4,y,A,E.r,I.r,1),x=readCurve(R,i,x,p,5,y,A,E.g,I.g,1),x=readCurve(R,i,x,p,6,y,A,E.b,I.b,1)),y=A,v=S,E=I,_=T}x.push(i)}else if("rgb2"==i){let i=new RGB2Timeline(p,6*p,T),_=m[0],y=getValue(_,"time",0),v=tt.fromString(_.light),E=tt.fromString(_.dark);for(let p=0,x=0;;p++){i.setFrame(p,y,v.r,v.g,v.b,E.r,E.g,E.b);let T=m[p+1];if(!T){i.shrink(x);break}let A=getValue(T,"time",0),S=tt.fromString(T.light),I=tt.fromString(T.dark),R=_.curve;R&&(x=readCurve(R,i,x,p,0,y,A,v.r,S.r,1),x=readCurve(R,i,x,p,1,y,A,v.g,S.g,1),x=readCurve(R,i,x,p,2,y,A,v.b,S.b,1),x=readCurve(R,i,x,p,3,y,A,E.r,I.r,1),x=readCurve(R,i,x,p,4,y,A,E.g,I.g,1),x=readCurve(R,i,x,p,5,y,A,E.b,I.b,1)),y=A,v=S,E=I,_=T}x.push(i)}}}if(i.bones)for(let m in i.bones){let y=i.bones[m],T=p.findBone(m);if(!T)throw Error(`Bone not found: ${m}`);let v=T.index;for(let i in y){let m=y[i],p=m.length;if(0!=p){if("rotate"===i)x.push(SkeletonJson_readTimeline1(m,new lib_core_Animation_RotateTimeline(p,p,v),0,1));else if("translate"===i){let i=new lib_core_Animation_TranslateTimeline(p,p<<1,v);x.push(SkeletonJson_readTimeline2(m,i,"x","y",0,_))}else if("translatex"===i){let i=new TranslateXTimeline(p,p,v);x.push(SkeletonJson_readTimeline1(m,i,0,_))}else if("translatey"===i){let i=new TranslateYTimeline(p,p,v);x.push(SkeletonJson_readTimeline1(m,i,0,_))}else if("scale"===i){let i=new core_Animation_ScaleTimeline(p,p<<1,v);x.push(SkeletonJson_readTimeline2(m,i,"x","y",1,1))}else if("scalex"===i){let i=new ScaleXTimeline(p,p,v);x.push(SkeletonJson_readTimeline1(m,i,1,1))}else if("scaley"===i){let i=new ScaleYTimeline(p,p,v);x.push(SkeletonJson_readTimeline1(m,i,1,1))}else if("shear"===i){let i=new core_Animation_ShearTimeline(p,p<<1,v);x.push(SkeletonJson_readTimeline2(m,i,"x","y",0,1))}else if("shearx"===i){let i=new ShearXTimeline(p,p,v);x.push(SkeletonJson_readTimeline1(m,i,0,1))}else if("sheary"===i){let i=new ShearYTimeline(p,p,v);x.push(SkeletonJson_readTimeline1(m,i,0,1))}}}}if(i.ik)for(let m in i.ik){let y=i.ik[m],T=y[0];if(!T)continue;let v=p.findIkConstraint(m);if(!v)throw Error(`IK Constraint not found: ${m}`);let E=p.ikConstraints.indexOf(v),A=new lib_core_Animation_IkConstraintTimeline(y.length,y.length<<1,E),S=getValue(T,"time",0),I=getValue(T,"mix",1),R=getValue(T,"softness",0)*_;for(let i=0,m=0;;i++){A.setFrame(i,S,I,R,getValue(T,"bendPositive",!0)?1:-1,getValue(T,"compress",!1),getValue(T,"stretch",!1));let p=y[i+1];if(!p){A.shrink(m);break}let x=getValue(p,"time",0),v=getValue(p,"mix",1),E=getValue(p,"softness",0)*_,C=T.curve;C&&(m=readCurve(C,A,m,i,0,S,x,I,v,1),m=readCurve(C,A,m,i,1,S,x,R,E,_)),S=x,I=v,R=E,T=p}x.push(A)}if(i.transform)for(let m in i.transform){let _=i.transform[m],y=_[0];if(!y)continue;let T=p.findTransformConstraint(m);if(!T)throw Error(`Transform constraint not found: ${m}`);let v=p.transformConstraints.indexOf(T),E=new lib_core_Animation_TransformConstraintTimeline(_.length,6*_.length,v),A=getValue(y,"time",0),S=getValue(y,"mixRotate",1),I=getValue(y,"mixX",1),R=getValue(y,"mixY",I),C=getValue(y,"mixScaleX",1),P=getValue(y,"mixScaleY",C),k=getValue(y,"mixShearY",1);for(let i=0,m=0;;i++){E.setFrame(i,A,S,I,R,C,P,k);let p=_[i+1];if(!p){E.shrink(m);break}let x=getValue(p,"time",0),T=getValue(p,"mixRotate",1),v=getValue(p,"mixX",1),B=getValue(p,"mixY",v),D=getValue(p,"mixScaleX",1),F=getValue(p,"mixScaleY",D),L=getValue(p,"mixShearY",1),O=y.curve;O&&(m=readCurve(O,E,m,i,0,A,x,S,T,1),m=readCurve(O,E,m,i,1,A,x,I,v,1),m=readCurve(O,E,m,i,2,A,x,R,B,1),m=readCurve(O,E,m,i,3,A,x,C,D,1),m=readCurve(O,E,m,i,4,A,x,P,F,1),m=readCurve(O,E,m,i,5,A,x,k,L,1)),A=x,S=T,I=v,R=B,C=D,P=F,C=D,y=p}x.push(E)}if(i.path)for(let m in i.path){let y=i.path[m],T=p.findPathConstraint(m);if(!T)throw Error(`Path constraint not found: ${m}`);let v=p.pathConstraints.indexOf(T);for(let i in y){let m=y[i],p=m[0];if(!p)continue;let E=m.length;if("position"===i){let i=new lib_core_Animation_PathConstraintPositionTimeline(E,E,v);x.push(SkeletonJson_readTimeline1(m,i,0,T.positionMode==z.Fixed?_:1))}else if("spacing"===i){let i=new core_Animation_PathConstraintSpacingTimeline(E,E,v);x.push(SkeletonJson_readTimeline1(m,i,0,T.spacingMode==e4.Length||T.spacingMode==e4.Fixed?_:1))}else if("mix"===i){let i=new lib_core_Animation_PathConstraintMixTimeline(E,3*E,v),_=getValue(p,"time",0),y=getValue(p,"mixRotate",1),T=getValue(p,"mixX",1),A=getValue(p,"mixY",T);for(let x=0,v=0;;x++){i.setFrame(x,_,y,T,A);let E=m[x+1];if(!E){i.shrink(v);break}let S=getValue(E,"time",0),I=getValue(E,"mixRotate",1),R=getValue(E,"mixX",1),C=getValue(E,"mixY",R),P=p.curve;P&&(v=readCurve(P,i,v,x,0,_,S,y,I,1),v=readCurve(P,i,v,x,1,_,S,T,R,1),v=readCurve(P,i,v,x,2,_,S,A,C,1)),_=S,y=I,T=R,A=C,p=E}x.push(i)}}}if(i.deform)for(let m in i.attachments={},i.deform){let p=i.deform[m],_=i.attachments[m]={};for(let i in p){let m=p[i],x=_[i]={};for(let i in m)x[i]={deform:m[i]}}}if(i.attachments)for(let m in i.attachments){let y=i.attachments[m],T=p.findSkin(m);if(null==T){if(!ti.FAIL_ON_NON_EXISTING_SKIN)continue;throw Error(`Skin not found: ${m}`)}for(let i in y){let m=y[i],v=p.findSlot(i);if(!v)throw Error(`Slot not found: ${i}`);let E=v.index;for(let i in m){let p=m[i],y=T.getAttachment(E,i);for(let i in p){let m=p[i],T=m[0];if(T){if("deform"==i){let i=y.bones,p=y.vertices,v=i?p.length/3*2:p.length,A=new core_Animation_DeformTimeline(m.length,m.length,E,y),S=getValue(T,"time",0);for(let x=0,y=0;;x++){let E;let I=getValue(T,"vertices",null);if(I){E=tr.newFloatArray(v);let m=getValue(T,"offset",0);if(tr.arrayCopy(I,0,E,m,I.length),1!=_)for(let i=m,p=i+I.length;i<p;i++)E[i]*=_;if(!i)for(let i=0;i<v;i++)E[i]+=p[i]}else E=i?tr.newFloatArray(v):p;A.setFrame(x,S,E);let R=m[x+1];if(!R){A.shrink(y);break}let C=getValue(R,"time",0),P=T.curve;P&&(y=readCurve(P,A,y,x,0,S,C,0,1,1)),S=C,T=R}x.push(A)}else if("sequence"==i){let i=new eW(m.length,E,y),p=0;for(let _=0;_<m.length;_++){let x=getValue(T,"delay",p),y=getValue(T,"time",0),v=eL[getValue(T,"mode","hold")],E=getValue(T,"index",0);i.setFrame(_,y,v,E,x),p=x,T=m[_+1]}x.push(i)}}}}}}if(i.drawOrder){let m=new eG(i.drawOrder.length),_=p.slots.length,y=0;for(let x=0;x<i.drawOrder.length;x++,y++){let T=i.drawOrder[x],v=null,E=getValue(T,"offsets",null);if(E){v=tr.newArray(_,-1);let i=tr.newArray(_-E.length,0),m=0,x=0;for(let _=0;_<E.length;_++){let y=E[_],T=p.findSlot(y.slot);if(!T)throw Error(`Slot not found: ${T}`);let A=T.index;for(;m!=A;)i[x++]=m++;v[m+y.offset]=m++}for(;m<_;)i[x++]=m++;for(let m=_-1;m>=0;m--)-1==v[m]&&(v[m]=i[--x])}m.setFrame(y,getValue(T,"time",0),v)}x.push(m)}if(i.events){let m=new eX(i.events.length),_=0;for(let x=0;x<i.events.length;x++,_++){let y=i.events[x],T=p.findEvent(y.name);if(!T)throw Error(`Event not found: ${y.name}`);let v=new core_Event_Event(tr.toSinglePrecision(getValue(y,"time",0)),T);v.intValue=getValue(y,"int",T.intValue),v.floatValue=getValue(y,"float",T.floatValue),v.stringValue=getValue(y,"string",T.stringValue),v.data.audioPath&&(v.volume=getValue(y,"volume",1),v.balance=getValue(y,"balance",0)),m.setFrame(_,v)}x.push(m)}let y=0;for(let i=0,m=x.length;i<m;i++)y=Math.max(y,x[i].getDuration());if(isNaN(y))throw Error("Error while parsing animation, duration is NaN");p.animations.push(new core_Animation_Animation(m,x,y))}static blendModeFromString(i){if("normal"==(i=i.toLowerCase()))return K.T$.NORMAL;if("additive"==i)return K.T$.ADD;if("multiply"==i)return K.T$.MULTIPLY;if("screen"==i)return K.T$.SCREEN;throw Error(`Unknown blend mode: ${i}`)}};let lib_core_SkeletonJson_LinkedMesh=class lib_core_SkeletonJson_LinkedMesh{constructor(i,m,p,_,x){this.mesh=i,this.skin=m,this.slotIndex=p,this.parent=_,this.inheritTimeline=x}};function SkeletonJson_readTimeline1(i,m,p,_){let x=i[0],y=getValue(x,"time",0),T=getValue(x,"value",p)*_,v=0;for(let E=0;;E++){m.setFrame(E,y,T);let A=i[E+1];if(!A)return m.shrink(v),m;let S=getValue(A,"time",0),I=getValue(A,"value",p)*_;x.curve&&(v=readCurve(x.curve,m,v,E,0,y,S,T,I,_)),y=S,T=I,x=A}}function SkeletonJson_readTimeline2(i,m,p,_,x,y){let T=i[0],v=getValue(T,"time",0),E=getValue(T,p,x)*y,A=getValue(T,_,x)*y,S=0;for(let I=0;;I++){m.setFrame(I,v,E,A);let R=i[I+1];if(!R)return m.shrink(S),m;let C=getValue(R,"time",0),P=getValue(R,p,x)*y,k=getValue(R,_,x)*y,B=T.curve;B&&(S=readCurve(B,m,S,I,0,v,C,E,P,y),S=readCurve(B,m,S,I,1,v,C,A,k,y)),v=C,E=P,A=k,T=R}}function readCurve(i,m,p,_,x,y,T,v,E,A){if("stepped"==i)return m.setStepped(_),p;let S=x<<2,I=i[S],R=i[S+1]*A,C=i[S+2],P=i[S+3]*A;return m.setBezier(p,_,x,y,v,I,R,C,P,T,E),p+1}function getValue(i,m,p){return void 0!==i[m]?i[m]:p}let lib_Spine_Spine=class lib_Spine_Spine extends tu{createSkeleton(i){this.skeleton=new e9(i),this.skeleton.updateWorldTransform(),this.stateData=new lib_core_AnimationStateData_AnimationStateData(i),this.state=new ez(this.stateData)}};var rv=((O=rv||{})[O.UNKNOWN=0]="UNKNOWN",O[O.VER37=37]="VER37",O[O.VER38=38]="VER38",O[O.VER40=40]="VER40",O[O.VER41=41]="VER41",O);function detectSpineVersion(i){let m=i.substr(0,3),p=Math.floor(10*Number(m)+.001);return"3.7"===m?37:"3.8"===m?38:"4.0"===m?40:"4.1"===m?41:p<37?37:0}let UniBinaryParser=class UniBinaryParser{constructor(){this.scale=1}readSkeletonData(i,m){let p=null,_=this.readVersionOldFormat(m),x=detectSpineVersion(_);if(x===rv.VER38&&(p=new t0(new AtlasAttachmentLoader(i))),((x=detectSpineVersion(_=this.readVersionNewFormat(m)))===rv.VER40||x===rv.VER41)&&(p=new SkeletonBinary_SkeletonBinary(new core_AtlasAttachmentLoader_AtlasAttachmentLoader(i))),!p){let i=`Unsupported version of spine model ${_}, please update pixi-spine`;console.error(i)}return p.scale=this.scale,p.readSkeletonData(m)}readVersionOldFormat(i){let m;let p=new BinaryInput(i);try{p.readString(),m=p.readString()}catch(i){m=""}return m||""}readVersionNewFormat(i){let m;let p=new BinaryInput(i);p.readInt32(),p.readInt32();try{m=p.readString()}catch(i){m=""}return m||""}};let UniJsonParser=class UniJsonParser{constructor(){this.scale=1}readSkeletonData(i,m){let p=m.skeleton.spine,_=detectSpineVersion(p),x=null;if(_===rv.VER37&&(x=new SkeletonJson_SkeletonJson(new AtlasAttachmentLoader_AtlasAttachmentLoader(i))),_===rv.VER38&&(x=new SkeletonJson(new AtlasAttachmentLoader(i))),(_===rv.VER40||_===rv.VER41)&&(x=new core_SkeletonJson_SkeletonJson(new core_AtlasAttachmentLoader_AtlasAttachmentLoader(i))),!x){let i=`Unsupported version of spine model ${p}, please update pixi-spine`;console.error(i)}return x.scale=this.scale,x.readSkeletonData(m)}};let SpineLoader=class SpineLoader extends SpineLoaderAbstract{createBinaryParser(){return new UniBinaryParser}createJsonParser(){return new UniJsonParser}parseData(i,m,p){return{spineData:i.readSkeletonData(m,p),spineAtlas:m}}};let loader_uni_lib_Spine_Spine=class loader_uni_lib_Spine_Spine extends tu{createSkeleton(i){let m=detectSpineVersion(i.version),p=null;if(m===rv.VER37&&(p=U),m===rv.VER38&&(p=V),(m===rv.VER40||m===rv.VER41)&&(p=X),!p){let m=`Cant detect version of spine model ${i.version}`;console.error(m)}this.skeleton=new p.Skeleton(i),this.skeleton.updateWorldTransform(),this.stateData=new p.AnimationStateData(i),this.state=new p.AnimationState(this.stateData)}};new SpineLoader().installLoader()},6720:function(i,m,p){"use strict";let _,x;p.d(m,{MxU:function(){return j},deM:function(){return Z.de},W20:function(){return E.W2}});var y,T,v=p(6392),E=p(607),A=p(9521);let S=new v.y3;E.s$.prototype._cacheAsBitmap=!1,E.s$.prototype._cacheData=null,E.s$.prototype._cacheAsBitmapResolution=null,E.s$.prototype._cacheAsBitmapMultisample=null;let CacheData=class CacheData{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}};Object.defineProperties(E.s$.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(i){i!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(i){i!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(i){let m;this._cacheAsBitmap!==i&&(this._cacheAsBitmap=i,i?(this._cacheData||(this._cacheData=new CacheData),(m=this._cacheData).originalRender=this.render,m.originalRenderCanvas=this.renderCanvas,m.originalUpdateTransform=this.updateTransform,m.originalCalculateBounds=this.calculateBounds,m.originalGetLocalBounds=this.getLocalBounds,m.originalDestroy=this.destroy,m.originalContainsPoint=this.containsPoint,m.originalMask=this._mask,m.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((m=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=m.originalRender,this.renderCanvas=m.originalRenderCanvas,this.calculateBounds=m.originalCalculateBounds,this.getLocalBounds=m.originalGetLocalBounds,this.destroy=m.originalDestroy,this.updateTransform=m.originalUpdateTransform,this.containsPoint=m.originalContainsPoint,this._mask=m.originalMask,this.filterArea=m.originalFilterArea))}}}),E.s$.prototype._renderCached=function(i){this.visible&&!(this.worldAlpha<=0)&&this.renderable&&(this._initCachedDisplayObject(i),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(i))},E.s$.prototype._initCachedDisplayObject=function(i){if(this._cacheData?.sprite)return;let m=this.alpha;this.alpha=1,i.batch.flush();let p=this.getLocalBounds(new v.Ae,!0);if(this.filters?.length){let i=this.filters[0].padding;p.pad(i)}let _=this.cacheAsBitmapResolution||i.resolution;p.ceil(_),p.width=Math.max(p.width,1/_),p.height=Math.max(p.height,1/_);let x=i.renderTexture.current,y=i.renderTexture.sourceFrame.clone(),T=i.renderTexture.destinationFrame.clone(),E=i.projection.transform,I=v.TI.create({width:p.width,height:p.height,resolution:_,multisample:this.cacheAsBitmapMultisample??i.multisample}),R=`cacheAsBitmap_${v.P6.uid()}`;this._cacheData.textureCacheId=R,v.VL.addToCache(I.baseTexture,R),v.xE.addToCache(I,R);let C=this.transform.localTransform.copyTo(S).invert().translate(-p.x,-p.y);this.render=this._cacheData.originalRender,i.render(this,{renderTexture:I,clear:!0,transform:C,skipUpdateTransform:!1}),i.framebuffer.blit(),i.projection.transform=E,i.renderTexture.bind(x,y,T),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=m;let P=new A.j(I);P.transform.worldTransform=this.transform.worldTransform,P.anchor.x=-(p.x/p.width),P.anchor.y=-(p.y/p.height),P.alpha=m,P._bounds=this._bounds,this._cacheData.sprite=P,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=P.containsPoint.bind(P)},E.s$.prototype._renderCachedCanvas=function(i){this.visible&&!(this.worldAlpha<=0)&&this.renderable&&(this._initCachedDisplayObjectCanvas(i),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(i))},E.s$.prototype._initCachedDisplayObjectCanvas=function(i){if(this._cacheData?.sprite)return;let m=this.getLocalBounds(new v.Ae,!0),p=this.alpha;this.alpha=1;let _=i.canvasContext.activeContext,x=i._projTransform,y=this.cacheAsBitmapResolution||i.resolution;m.ceil(y),m.width=Math.max(m.width,1/y),m.height=Math.max(m.height,1/y);let T=v.TI.create({width:m.width,height:m.height,resolution:y}),E=`cacheAsBitmap_${v.P6.uid()}`;this._cacheData.textureCacheId=E,v.VL.addToCache(T.baseTexture,E),v.xE.addToCache(T,E),this.transform.localTransform.copyTo(S),S.invert(),S.tx-=m.x,S.ty-=m.y,this.renderCanvas=this._cacheData.originalRenderCanvas,i.render(this,{renderTexture:T,clear:!0,transform:S,skipUpdateTransform:!1}),i.canvasContext.activeContext=_,i._projTransform=x,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=p;let I=new A.j(T);I.transform.worldTransform=this.transform.worldTransform,I.anchor.x=-(m.x/m.width),I.anchor.y=-(m.y/m.height),I.alpha=p,I._bounds=this._bounds,this._cacheData.sprite=I,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=i._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=I.containsPoint.bind(I)},E.s$.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},E.s$.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},E.s$.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,v.VL.removeFromCache(this._cacheData.textureCacheId),v.xE.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},E.s$.prototype._cacheAsBitmapDestroy=function(i){this.cacheAsBitmap=!1,this.destroy(i)},E.s$.prototype.name=null,E.W2.prototype.getChildByName=function(i,m){for(let m=0,p=this.children.length;m<p;m++)if(this.children[m].name===i)return this.children[m];if(m)for(let m=0,p=this.children.length;m<p;m++){let p=this.children[m];if(!p.getChildByName)continue;let _=p.getChildByName(i,!0);if(_)return _}return null},E.s$.prototype.getGlobalPosition=function(i=new v.E9,m=!1){return this.parent?this.parent.toGlobal(this.position,i,m):(i.x=this.position.x,i.y=this.position.y),i};var I=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;let AlphaFilter=class AlphaFilter extends v.wn{constructor(i=1){super(v.kP,I,{uAlpha:1}),this.alpha=i}get alpha(){return this.uniforms.uAlpha}set alpha(i){this.uniforms.uAlpha=i}};let R={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},C=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function generateBlurFragSource(i){let m;let p=R[i],_=p.length,x=C,y="";for(let x=0;x<i;x++){let T="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",x.toString());m=x,x>=_&&(m=i-x-1),y+=(T=T.replace("%value%",p[m].toString()))+`
`}return(x=x.replace("%blur%",y)).replace("%size%",i.toString())}let P=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function generateBlurVertSource(i,m){let p=Math.ceil(i/2),_=P,x="",y;y=m?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let m=0;m<i;m++){let i=y.replace("%index%",m.toString());x+=(i=i.replace("%sampleIndex%",`${m-(p-1)}.0`))+`
`}return(_=_.replace("%blur%",x)).replace("%size%",i.toString())}let BlurFilterPass=class BlurFilterPass extends v.wn{constructor(i,m=8,p=4,_=v.wn.defaultResolution,x=5){let y=generateBlurVertSource(x,i),T=generateBlurFragSource(x);super(y,T),this.horizontal=i,this.resolution=_,this._quality=0,this.quality=p,this.blur=m}apply(i,m,p,_){if(p?this.horizontal?this.uniforms.strength=1/p.width*(p.width/m.width):this.uniforms.strength=1/p.height*(p.height/m.height):this.horizontal?this.uniforms.strength=1/i.renderer.width*(i.renderer.width/m.width):this.uniforms.strength=1/i.renderer.height*(i.renderer.height/m.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)i.applyFilter(this,m,p,_);else{let x=i.getFilterTexture(),y=i.renderer,T=m,E=x;this.state.blend=!1,i.applyFilter(this,T,E,v.yl.CLEAR);for(let m=1;m<this.passes-1;m++){i.bindAndClear(T,v.yl.BLIT),this.uniforms.uSampler=E;let m=E;E=T,T=m,y.shader.bind(this),y.geometry.draw(5)}this.state.blend=!0,i.applyFilter(this,E,p,_),i.returnFilterTexture(x)}}get blur(){return this.strength}set blur(i){this.padding=1+2*Math.abs(i),this.strength=i}get quality(){return this._quality}set quality(i){this._quality=i,this.passes=i}};let BlurFilter=class BlurFilter extends v.wn{constructor(i=8,m=4,p=v.wn.defaultResolution,_=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new BlurFilterPass(!0,i,m,p,_),this.blurYFilter=new BlurFilterPass(!1,i,m,p,_),this.resolution=p,this.quality=m,this.blur=i,this.repeatEdgePixels=!1}apply(i,m,p,_){let x=Math.abs(this.blurXFilter.strength),y=Math.abs(this.blurYFilter.strength);if(x&&y){let x=i.getFilterTexture();this.blurXFilter.apply(i,m,x,v.yl.CLEAR),this.blurYFilter.apply(i,x,p,_),i.returnFilterTexture(x)}else y?this.blurYFilter.apply(i,m,p,_):this.blurXFilter.apply(i,m,p,_)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(i){this.blurXFilter.blur=this.blurYFilter.blur=i,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(i){this.blurXFilter.quality=this.blurYFilter.quality=i}get blurX(){return this.blurXFilter.blur}set blurX(i){this.blurXFilter.blur=i,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(i){this.blurYFilter.blur=i,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(i){this.blurYFilter.blendMode=i}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(i){this._repeatEdgePixels=i,this.updatePadding()}};var k=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;let ColorMatrixFilter=class ColorMatrixFilter extends v.wn{constructor(){let i={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(v.Y9,k,i),this.alpha=1}_loadMatrix(i,m=!1){let p=i;m&&(this._multiply(p,this.uniforms.m,i),p=this._colorMatrix(p)),this.uniforms.m=p}_multiply(i,m,p){return i[0]=m[0]*p[0]+m[1]*p[5]+m[2]*p[10]+m[3]*p[15],i[1]=m[0]*p[1]+m[1]*p[6]+m[2]*p[11]+m[3]*p[16],i[2]=m[0]*p[2]+m[1]*p[7]+m[2]*p[12]+m[3]*p[17],i[3]=m[0]*p[3]+m[1]*p[8]+m[2]*p[13]+m[3]*p[18],i[4]=m[0]*p[4]+m[1]*p[9]+m[2]*p[14]+m[3]*p[19]+m[4],i[5]=m[5]*p[0]+m[6]*p[5]+m[7]*p[10]+m[8]*p[15],i[6]=m[5]*p[1]+m[6]*p[6]+m[7]*p[11]+m[8]*p[16],i[7]=m[5]*p[2]+m[6]*p[7]+m[7]*p[12]+m[8]*p[17],i[8]=m[5]*p[3]+m[6]*p[8]+m[7]*p[13]+m[8]*p[18],i[9]=m[5]*p[4]+m[6]*p[9]+m[7]*p[14]+m[8]*p[19]+m[9],i[10]=m[10]*p[0]+m[11]*p[5]+m[12]*p[10]+m[13]*p[15],i[11]=m[10]*p[1]+m[11]*p[6]+m[12]*p[11]+m[13]*p[16],i[12]=m[10]*p[2]+m[11]*p[7]+m[12]*p[12]+m[13]*p[17],i[13]=m[10]*p[3]+m[11]*p[8]+m[12]*p[13]+m[13]*p[18],i[14]=m[10]*p[4]+m[11]*p[9]+m[12]*p[14]+m[13]*p[19]+m[14],i[15]=m[15]*p[0]+m[16]*p[5]+m[17]*p[10]+m[18]*p[15],i[16]=m[15]*p[1]+m[16]*p[6]+m[17]*p[11]+m[18]*p[16],i[17]=m[15]*p[2]+m[16]*p[7]+m[17]*p[12]+m[18]*p[17],i[18]=m[15]*p[3]+m[16]*p[8]+m[17]*p[13]+m[18]*p[18],i[19]=m[15]*p[4]+m[16]*p[9]+m[17]*p[14]+m[18]*p[19]+m[19],i}_colorMatrix(i){let m=new Float32Array(i);return m[4]/=255,m[9]/=255,m[14]/=255,m[19]/=255,m}brightness(i,m){let p=[i,0,0,0,0,0,i,0,0,0,0,0,i,0,0,0,0,0,1,0];this._loadMatrix(p,m)}tint(i,m){let[p,_,x]=v.Il.shared.setValue(i).toArray(),y=[p,0,0,0,0,0,_,0,0,0,0,0,x,0,0,0,0,0,1,0];this._loadMatrix(y,m)}greyscale(i,m){let p=[i,i,i,0,0,i,i,i,0,0,i,i,i,0,0,0,0,0,1,0];this._loadMatrix(p,m)}blackAndWhite(i){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],i)}hue(i,m){i=(i||0)/180*Math.PI;let p=Math.cos(i),_=Math.sin(i),x=1/3,y=(0,Math.sqrt)(x),T=p+(1-p)*x,v=x*(1-p)-y*_,E=x*(1-p)+y*_,A=x*(1-p)+y*_,S=p+x*(1-p),I=x*(1-p)-y*_,R=x*(1-p)-y*_,C=x*(1-p)+y*_,P=p+x*(1-p),k=[T,v,E,0,0,A,S,I,0,0,R,C,P,0,0,0,0,0,1,0];this._loadMatrix(k,m)}contrast(i,m){let p=(i||0)+1,_=-.5*(p-1),x=[p,0,0,0,_,0,p,0,0,_,0,0,p,0,_,0,0,0,1,0];this._loadMatrix(x,m)}saturate(i=0,m){let p=2*i/3+1,_=-((p-1)*.5),x=[p,_,_,0,0,_,p,_,0,0,_,_,p,0,0,0,0,0,1,0];this._loadMatrix(x,m)}desaturate(){this.saturate(-1)}negative(i){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],i)}sepia(i){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],i)}technicolor(i){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],i)}polaroid(i){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],i)}toBGR(i){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],i)}kodachrome(i){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],i)}browni(i){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],i)}vintage(i){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],i)}colorTone(i,m,p,_,x){i=i||.2,m=m||.15,p=p||16770432,_=_||3375104;let y=v.Il.shared,[T,E,A]=y.setValue(p).toArray(),[S,I,R]=y.setValue(_).toArray(),C=[.3,.59,.11,0,0,T,E,A,i,0,S,I,R,m,0,T-S,E-I,A-R,0,0];this._loadMatrix(C,x)}night(i,m){i=i||.1;let p=[-2*i,-i,0,0,0,-i,0,i,0,0,0,i,2*i,0,0,0,0,0,1,0];this._loadMatrix(p,m)}predator(i,m){this._loadMatrix([11.224130630493164*i,-4.794486999511719*i,-2.8746118545532227*i,0*i,.40342438220977783*i,-3.6330697536468506*i,9.193157196044922*i,-2.951810836791992*i,0*i,-1.316135048866272*i,-3.2184197902679443*i,-4.2375030517578125*i,7.476448059082031*i,0*i,.8044459223747253*i,0,0,0,1,0],m)}lsd(i){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],i)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(i){this.uniforms.m=i}get alpha(){return this.uniforms.uAlpha}set alpha(i){this.uniforms.uAlpha=i}};ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale;var B=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,D=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;let DisplacementFilter=class DisplacementFilter extends v.wn{constructor(i,m){let p=new v.y3;i.renderable=!1,super(D,B,{mapSampler:i._texture,filterMatrix:p,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=i,this.maskMatrix=p,null==m&&(m=20),this.scale=new v.E9(m,m)}apply(i,m,p,_){this.uniforms.filterMatrix=i.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;let x=this.maskSprite.worldTransform,y=Math.sqrt(x.a*x.a+x.b*x.b),T=Math.sqrt(x.c*x.c+x.d*x.d);0!==y&&0!==T&&(this.uniforms.rotation[0]=x.a/y,this.uniforms.rotation[1]=x.b/y,this.uniforms.rotation[2]=x.c/T,this.uniforms.rotation[3]=x.d/T),i.applyFilter(this,m,p,_)}get map(){return this.uniforms.mapSampler}set map(i){this.uniforms.mapSampler=i}};var F=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,L=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;let FXAAFilter=class FXAAFilter extends v.wn{constructor(){super(L,F)}};var O=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;let NoiseFilter=class NoiseFilter extends v.wn{constructor(i=.5,m=Math.random()){super(v.Y9,O,{uNoise:0,uSeed:0}),this.noise=i,this.seed=m}get noise(){return this.uniforms.uNoise}set noise(i){this.uniforms.uNoise=i}get seed(){return this.uniforms.uSeed}set seed(i){this.uniforms.uSeed=i}};let V={AlphaFilter:AlphaFilter,BlurFilter:BlurFilter,BlurFilterPass:BlurFilterPass,ColorMatrixFilter:ColorMatrixFilter,DisplacementFilter:DisplacementFilter,FXAAFilter:FXAAFilter,NoiseFilter:NoiseFilter};Object.entries(V).forEach(([i,m])=>{Object.defineProperty(V,i,{get:()=>(v.P6.deprecation("7.1.0",`filters.${i} has moved to ${i}`),m)})});let EventsTickerClass=class EventsTickerClass{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(i){this.removeTickerListener(),this.events=i,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(i){this._pauseUpdate=i}addTickerListener(){this.tickerAdded||!this.domElement||(v.vB.system.add(this.tickerUpdate,this,v.uF.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(v.vB.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}let i=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===i.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:i.clientX,clientY:i.clientY}))}tickerUpdate(i){this._deltaTime+=i,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())}};let U=new EventsTickerClass;let FederatedEvent=class FederatedEvent{constructor(i){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=FederatedEvent.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new v.E9,this.page=new v.E9,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=i}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(i,m,p){throw Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(i,m,p,_,x){throw Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}};let FederatedMouseEvent=class FederatedMouseEvent extends FederatedEvent{constructor(){super(...arguments),this.client=new v.E9,this.movement=new v.E9,this.offset=new v.E9,this.global=new v.E9,this.screen=new v.E9}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(i,m,p){return i.worldTransform.applyInverse(p||this.global,m)}getModifierState(i){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(i)}initMouseEvent(i,m,p,_,x,y,T,v,E,A,S,I,R,C,P){throw Error("Method not implemented.")}};let FederatedPointerEvent=class FederatedPointerEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw Error("getPredictedEvents is not supported!")}};let FederatedWheelEvent=class FederatedWheelEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}};FederatedWheelEvent.DOM_DELTA_PIXEL=0,FederatedWheelEvent.DOM_DELTA_LINE=1,FederatedWheelEvent.DOM_DELTA_PAGE=2;let X=new v.E9,Y=new v.E9;let EventBoundary=class EventBoundary{constructor(i){this.dispatch=new v.P6.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=i,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(i,m){this.mappingTable[i]||(this.mappingTable[i]=[]),this.mappingTable[i].push({fn:m,priority:0}),this.mappingTable[i].sort((i,m)=>i.priority-m.priority)}dispatchEvent(i,m){i.propagationStopped=!1,i.propagationImmediatelyStopped=!1,this.propagate(i,m),this.dispatch.emit(m||i.type,i)}mapEvent(i){if(!this.rootTarget)return;let m=this.mappingTable[i.type];if(m)for(let p=0,_=m.length;p<_;p++)m[p].fn(i);else console.warn(`[EventBoundary]: Event mapping not defined for ${i.type}`)}hitTest(i,m){U.pauseUpdate=!0;let p=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",_=this[p](this.rootTarget,this.rootTarget.eventMode,X.set(i,m),this.hitTestFn,this.hitPruneFn);return _&&_[0]}propagate(i,m){if(!i.target)return;let p=i.composedPath();i.eventPhase=i.CAPTURING_PHASE;for(let _=0,x=p.length-1;_<x;_++)if(i.currentTarget=p[_],this.notifyTarget(i,m),i.propagationStopped||i.propagationImmediatelyStopped)return;if(i.eventPhase=i.AT_TARGET,i.currentTarget=i.target,this.notifyTarget(i,m),!(i.propagationStopped||i.propagationImmediatelyStopped)){i.eventPhase=i.BUBBLING_PHASE;for(let _=p.length-2;_>=0;_--)if(i.currentTarget=p[_],this.notifyTarget(i,m),i.propagationStopped||i.propagationImmediatelyStopped)return}}all(i,m,p=this._allInteractiveElements){if(0===p.length)return;i.eventPhase=i.BUBBLING_PHASE;let _=Array.isArray(m)?m:[m];for(let m=p.length-1;m>=0;m--)_.forEach(_=>{i.currentTarget=p[m],this.notifyTarget(i,_)})}propagationPath(i){let m=[i];for(let p=0;p<2048&&i!==this.rootTarget;p++){if(!i.parent)throw Error("Cannot find propagation path to disconnected target");m.push(i.parent),i=i.parent}return m.reverse(),m}hitTestMoveRecursive(i,m,p,_,x,y=!1){let T=!1;if(this._interactivePrune(i))return null;if(("dynamic"===i.eventMode||"dynamic"===m)&&(U.pauseUpdate=!1),i.interactiveChildren&&i.children){let v=i.children;for(let E=v.length-1;E>=0;E--){let A=v[E],S=this.hitTestMoveRecursive(A,this._isInteractive(m)?m:A.eventMode,p,_,x,y||x(i,p));if(S){if(S.length>0&&!S[S.length-1].parent)continue;let m=i.isInteractive();(S.length>0||m)&&(m&&this._allInteractiveElements.push(i),S.push(i)),0===this._hitElements.length&&(this._hitElements=S),T=!0}}}let v=this._isInteractive(m),E=i.isInteractive();return v&&E&&this._allInteractiveElements.push(i),y||this._hitElements.length>0?null:T?this._hitElements:v&&!x(i,p)&&_(i,p)?E?[i]:[]:null}hitTestRecursive(i,m,p,_,x){if(this._interactivePrune(i)||x(i,p))return null;if(("dynamic"===i.eventMode||"dynamic"===m)&&(U.pauseUpdate=!1),i.interactiveChildren&&i.children){let y=i.children;for(let T=y.length-1;T>=0;T--){let v=y[T],E=this.hitTestRecursive(v,this._isInteractive(m)?m:v.eventMode,p,_,x);if(E){if(E.length>0&&!E[E.length-1].parent)continue;let m=i.isInteractive();return(E.length>0||m)&&E.push(i),E}}}let y=this._isInteractive(m),T=i.isInteractive();return y&&_(i,p)?T?[i]:[]:null}_isInteractive(i){return"static"===i||"dynamic"===i}_interactivePrune(i){return!!(!i||i.isMask||!i.visible||!i.renderable||"none"===i.eventMode||"passive"===i.eventMode&&!i.interactiveChildren||i.isMask)}hitPruneFn(i,m){if(i.hitArea&&(i.worldTransform.applyInverse(m,Y),!i.hitArea.contains(Y.x,Y.y)))return!0;if(i._mask){let p=i._mask.isMaskData?i._mask.maskObject:i._mask;if(p&&!p.containsPoint?.(m))return!0}return!1}hitTestFn(i,m){return"passive"!==i.eventMode&&(!!i.hitArea||!!i.containsPoint&&i.containsPoint(m))}notifyTarget(i,m){m=m??i.type;let p=`on${m}`;i.currentTarget[p]?.(i);let _=i.eventPhase===i.CAPTURING_PHASE||i.eventPhase===i.AT_TARGET?`${m}capture`:m;this.notifyListeners(i,_),i.eventPhase===i.AT_TARGET&&this.notifyListeners(i,m)}mapPointerDown(i){if(!(i instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let m=this.createPointerEvent(i);if(this.dispatchEvent(m,"pointerdown"),"touch"===m.pointerType)this.dispatchEvent(m,"touchstart");else if("mouse"===m.pointerType||"pen"===m.pointerType){let i=2===m.button;this.dispatchEvent(m,i?"rightdown":"mousedown")}let p=this.trackingData(i.pointerId);p.pressTargetsByButton[i.button]=m.composedPath(),this.freeEvent(m)}mapPointerMove(i){if(!(i instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;let m=this.createPointerEvent(i);this._isPointerMoveEvent=!1;let p="mouse"===m.pointerType||"pen"===m.pointerType,_=this.trackingData(i.pointerId),x=this.findMountedTarget(_.overTargets);if(_.overTargets?.length>0&&x!==m.target){let _="mousemove"===i.type?"mouseout":"pointerout",y=this.createPointerEvent(i,_,x);if(this.dispatchEvent(y,"pointerout"),p&&this.dispatchEvent(y,"mouseout"),!m.composedPath().includes(x)){let _=this.createPointerEvent(i,"pointerleave",x);for(_.eventPhase=_.AT_TARGET;_.target&&!m.composedPath().includes(_.target);)_.currentTarget=_.target,this.notifyTarget(_),p&&this.notifyTarget(_,"mouseleave"),_.target=_.target.parent;this.freeEvent(_)}this.freeEvent(y)}if(x!==m.target){let _="mousemove"===i.type?"mouseover":"pointerover",y=this.clonePointerEvent(m,_);this.dispatchEvent(y,"pointerover"),p&&this.dispatchEvent(y,"mouseover");let T=x?.parent;for(;T&&T!==this.rootTarget.parent&&T!==m.target;)T=T.parent;if(!T||T===this.rootTarget.parent){let i=this.clonePointerEvent(m,"pointerenter");for(i.eventPhase=i.AT_TARGET;i.target&&i.target!==x&&i.target!==this.rootTarget.parent;)i.currentTarget=i.target,this.notifyTarget(i),p&&this.notifyTarget(i,"mouseenter"),i.target=i.target.parent;this.freeEvent(i)}this.freeEvent(y)}let y=[],T=this.enableGlobalMoveEvents??!0;this.moveOnAll?y.push("pointermove"):this.dispatchEvent(m,"pointermove"),T&&y.push("globalpointermove"),"touch"===m.pointerType&&(this.moveOnAll?y.splice(1,0,"touchmove"):this.dispatchEvent(m,"touchmove"),T&&y.push("globaltouchmove")),p&&(this.moveOnAll?y.splice(1,0,"mousemove"):this.dispatchEvent(m,"mousemove"),T&&y.push("globalmousemove"),this.cursor=m.target?.cursor),y.length>0&&this.all(m,y),this._allInteractiveElements.length=0,this._hitElements.length=0,_.overTargets=m.composedPath(),this.freeEvent(m)}mapPointerOver(i){if(!(i instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let m=this.trackingData(i.pointerId),p=this.createPointerEvent(i),_="mouse"===p.pointerType||"pen"===p.pointerType;this.dispatchEvent(p,"pointerover"),_&&this.dispatchEvent(p,"mouseover"),"mouse"===p.pointerType&&(this.cursor=p.target?.cursor);let x=this.clonePointerEvent(p,"pointerenter");for(x.eventPhase=x.AT_TARGET;x.target&&x.target!==this.rootTarget.parent;)x.currentTarget=x.target,this.notifyTarget(x),_&&this.notifyTarget(x,"mouseenter"),x.target=x.target.parent;m.overTargets=p.composedPath(),this.freeEvent(p),this.freeEvent(x)}mapPointerOut(i){if(!(i instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let m=this.trackingData(i.pointerId);if(m.overTargets){let p="mouse"===i.pointerType||"pen"===i.pointerType,_=this.findMountedTarget(m.overTargets),x=this.createPointerEvent(i,"pointerout",_);this.dispatchEvent(x),p&&this.dispatchEvent(x,"mouseout");let y=this.createPointerEvent(i,"pointerleave",_);for(y.eventPhase=y.AT_TARGET;y.target&&y.target!==this.rootTarget.parent;)y.currentTarget=y.target,this.notifyTarget(y),p&&this.notifyTarget(y,"mouseleave"),y.target=y.target.parent;m.overTargets=null,this.freeEvent(x),this.freeEvent(y)}this.cursor=null}mapPointerUp(i){if(!(i instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let m=performance.now(),p=this.createPointerEvent(i);if(this.dispatchEvent(p,"pointerup"),"touch"===p.pointerType)this.dispatchEvent(p,"touchend");else if("mouse"===p.pointerType||"pen"===p.pointerType){let i=2===p.button;this.dispatchEvent(p,i?"rightup":"mouseup")}let _=this.trackingData(i.pointerId),x=this.findMountedTarget(_.pressTargetsByButton[i.button]),y=x;if(x&&!p.composedPath().includes(x)){let m=x;for(;m&&!p.composedPath().includes(m);){if(p.currentTarget=m,this.notifyTarget(p,"pointerupoutside"),"touch"===p.pointerType)this.notifyTarget(p,"touchendoutside");else if("mouse"===p.pointerType||"pen"===p.pointerType){let i=2===p.button;this.notifyTarget(p,i?"rightupoutside":"mouseupoutside")}m=m.parent}delete _.pressTargetsByButton[i.button],y=m}if(y){let x=this.clonePointerEvent(p,"click");x.target=y,x.path=null,_.clicksByButton[i.button]||(_.clicksByButton[i.button]={clickCount:0,target:x.target,timeStamp:m});let T=_.clicksByButton[i.button];if(T.target===x.target&&m-T.timeStamp<200?++T.clickCount:T.clickCount=1,T.target=x.target,T.timeStamp=m,x.detail=T.clickCount,"mouse"===x.pointerType){let i=2===x.button;this.dispatchEvent(x,i?"rightclick":"click")}else"touch"===x.pointerType&&this.dispatchEvent(x,"tap");this.dispatchEvent(x,"pointertap"),this.freeEvent(x)}this.freeEvent(p)}mapPointerUpOutside(i){if(!(i instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let m=this.trackingData(i.pointerId),p=this.findMountedTarget(m.pressTargetsByButton[i.button]),_=this.createPointerEvent(i);if(p){let x=p;for(;x;)_.currentTarget=x,this.notifyTarget(_,"pointerupoutside"),"touch"===_.pointerType?this.notifyTarget(_,"touchendoutside"):("mouse"===_.pointerType||"pen"===_.pointerType)&&this.notifyTarget(_,2===_.button?"rightupoutside":"mouseupoutside"),x=x.parent;delete m.pressTargetsByButton[i.button]}this.freeEvent(_)}mapWheel(i){if(!(i instanceof FederatedWheelEvent)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}let m=this.createWheelEvent(i);this.dispatchEvent(m),this.freeEvent(m)}findMountedTarget(i){if(!i)return null;let m=i[0];for(let p=1;p<i.length&&i[p].parent===m;p++)m=i[p];return m}createPointerEvent(i,m,p){let _=this.allocateEvent(FederatedPointerEvent);return this.copyPointerData(i,_),this.copyMouseData(i,_),this.copyData(i,_),_.nativeEvent=i.nativeEvent,_.originalEvent=i,_.target=p??this.hitTest(_.global.x,_.global.y)??this._hitElements[0],"string"==typeof m&&(_.type=m),_}createWheelEvent(i){let m=this.allocateEvent(FederatedWheelEvent);return this.copyWheelData(i,m),this.copyMouseData(i,m),this.copyData(i,m),m.nativeEvent=i.nativeEvent,m.originalEvent=i,m.target=this.hitTest(m.global.x,m.global.y),m}clonePointerEvent(i,m){let p=this.allocateEvent(FederatedPointerEvent);return p.nativeEvent=i.nativeEvent,p.originalEvent=i.originalEvent,this.copyPointerData(i,p),this.copyMouseData(i,p),this.copyData(i,p),p.target=i.target,p.path=i.composedPath().slice(),p.type=m??p.type,p}copyWheelData(i,m){m.deltaMode=i.deltaMode,m.deltaX=i.deltaX,m.deltaY=i.deltaY,m.deltaZ=i.deltaZ}copyPointerData(i,m){i instanceof FederatedPointerEvent&&m instanceof FederatedPointerEvent&&(m.pointerId=i.pointerId,m.width=i.width,m.height=i.height,m.isPrimary=i.isPrimary,m.pointerType=i.pointerType,m.pressure=i.pressure,m.tangentialPressure=i.tangentialPressure,m.tiltX=i.tiltX,m.tiltY=i.tiltY,m.twist=i.twist)}copyMouseData(i,m){i instanceof FederatedMouseEvent&&m instanceof FederatedMouseEvent&&(m.altKey=i.altKey,m.button=i.button,m.buttons=i.buttons,m.client.copyFrom(i.client),m.ctrlKey=i.ctrlKey,m.metaKey=i.metaKey,m.movement.copyFrom(i.movement),m.screen.copyFrom(i.screen),m.shiftKey=i.shiftKey,m.global.copyFrom(i.global))}copyData(i,m){m.isTrusted=i.isTrusted,m.srcElement=i.srcElement,m.timeStamp=performance.now(),m.type=i.type,m.detail=i.detail,m.view=i.view,m.which=i.which,m.layer.copyFrom(i.layer),m.page.copyFrom(i.page)}trackingData(i){return this.mappingState.trackingData[i]||(this.mappingState.trackingData[i]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[i]}allocateEvent(i){this.eventPool.has(i)||this.eventPool.set(i,[]);let m=this.eventPool.get(i).pop()||new i(this);return m.eventPhase=m.NONE,m.currentTarget=null,m.path=null,m.target=null,m}freeEvent(i){if(i.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");let m=i.constructor;this.eventPool.has(m)||this.eventPool.set(m,[]),this.eventPool.get(m).push(i)}notifyListeners(i,m){let p=i.currentTarget._events[m];if(p&&i.currentTarget.isInteractive()){if("fn"in p)p.once&&i.currentTarget.removeListener(m,p.fn,void 0,!0),p.fn.call(p.context,i);else for(let _=0,x=p.length;_<x&&!i.propagationImmediatelyStopped;_++)p[_].once&&i.currentTarget.removeListener(m,p[_].fn,void 0,!0),p[_].fn.call(p[_].context,i)}}};let G={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},W=class _EventSystem2{constructor(i){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=i,this.rootBoundary=new EventBoundary(null),U.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new FederatedPointerEvent(null),this.rootWheelEvent=new FederatedWheelEvent(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({..._EventSystem2.defaultEventFeatures},{set:(i,m,p)=>("globalMove"===m&&(this.rootBoundary.enableGlobalMoveEvents=p),i[m]=p,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(i){let{view:m,resolution:p}=this.renderer;this.setTargetElement(m),this.resolution=p,_EventSystem2._defaultEventMode=i.eventMode??"auto",Object.assign(this.features,i.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(i){this.resolution=i}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(i){i=i||"default";let m=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(m=!1),this.currentCursor===i)return;this.currentCursor=i;let p=this.cursorStyles[i];if(p)switch(typeof p){case"string":m&&(this.domElement.style.cursor=p);break;case"function":p(i);break;case"object":m&&Object.assign(this.domElement.style,p)}else m&&"string"==typeof i&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,i)&&(this.domElement.style.cursor=i)}get pointer(){return this.rootPointerEvent}onPointerDown(i){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let m=this.normalizeToPointerData(i);this.autoPreventDefault&&m[0].isNormalized&&(i.cancelable||!("cancelable"in i))&&i.preventDefault();for(let i=0,p=m.length;i<p;i++){let p=m[i],_=this.bootstrapEvent(this.rootPointerEvent,p);this.rootBoundary.mapEvent(_)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(i){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,U.pointerMoved();let m=this.normalizeToPointerData(i);for(let i=0,p=m.length;i<p;i++){let p=this.bootstrapEvent(this.rootPointerEvent,m[i]);this.rootBoundary.mapEvent(p)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(i){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let m=i.target;i.composedPath&&i.composedPath().length>0&&(m=i.composedPath()[0]);let p=m!==this.domElement?"outside":"",_=this.normalizeToPointerData(i);for(let i=0,m=_.length;i<m;i++){let m=this.bootstrapEvent(this.rootPointerEvent,_[i]);m.type+=p,this.rootBoundary.mapEvent(m)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(i){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let m=this.normalizeToPointerData(i);for(let i=0,p=m.length;i<p;i++){let p=this.bootstrapEvent(this.rootPointerEvent,m[i]);this.rootBoundary.mapEvent(p)}this.setCursor(this.rootBoundary.cursor)}onWheel(i){if(!this.features.wheel)return;let m=this.normalizeWheelEvent(i);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(m)}setTargetElement(i){this.removeEvents(),this.domElement=i,U.domElement=i,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;U.addTickerListener();let i=this.domElement.style;i&&(globalThis.navigator.msPointerEnabled?(i.msContentZooming="none",i.msTouchAction="none"):this.supportsPointerEvents&&(i.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;U.removeTickerListener();let i=this.domElement.style;globalThis.navigator.msPointerEnabled?(i.msContentZooming="",i.msTouchAction=""):this.supportsPointerEvents&&(i.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(i,m,p){let _=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},x=1/this.resolution;i.x=(m-_.left)*(this.domElement.width/_.width)*x,i.y=(p-_.top)*(this.domElement.height/_.height)*x}normalizeToPointerData(i){let m=[];if(this.supportsTouchEvents&&i instanceof TouchEvent)for(let p=0,_=i.changedTouches.length;p<_;p++){let _=i.changedTouches[p];typeof _.button>"u"&&(_.button=0),typeof _.buttons>"u"&&(_.buttons=1),typeof _.isPrimary>"u"&&(_.isPrimary=1===i.touches.length&&"touchstart"===i.type),typeof _.width>"u"&&(_.width=_.radiusX||1),typeof _.height>"u"&&(_.height=_.radiusY||1),typeof _.tiltX>"u"&&(_.tiltX=0),typeof _.tiltY>"u"&&(_.tiltY=0),typeof _.pointerType>"u"&&(_.pointerType="touch"),typeof _.pointerId>"u"&&(_.pointerId=_.identifier||0),typeof _.pressure>"u"&&(_.pressure=_.force||.5),typeof _.twist>"u"&&(_.twist=0),typeof _.tangentialPressure>"u"&&(_.tangentialPressure=0),typeof _.layerX>"u"&&(_.layerX=_.offsetX=_.clientX),typeof _.layerY>"u"&&(_.layerY=_.offsetY=_.clientY),_.isNormalized=!0,_.type=i.type,m.push(_)}else(!globalThis.MouseEvent||i instanceof MouseEvent&&(!this.supportsPointerEvents||!(i instanceof globalThis.PointerEvent)))&&(typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=1),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0),m.push(i);return m}normalizeWheelEvent(i){let m=this.rootWheelEvent;return this.transferMouseData(m,i),m.deltaX=i.deltaX,m.deltaY=i.deltaY,m.deltaZ=i.deltaZ,m.deltaMode=i.deltaMode,this.mapPositionToPoint(m.screen,i.clientX,i.clientY),m.global.copyFrom(m.screen),m.offset.copyFrom(m.screen),m.nativeEvent=i,m.type=i.type,m}bootstrapEvent(i,m){return i.originalEvent=null,i.nativeEvent=m,i.pointerId=m.pointerId,i.width=m.width,i.height=m.height,i.isPrimary=m.isPrimary,i.pointerType=m.pointerType,i.pressure=m.pressure,i.tangentialPressure=m.tangentialPressure,i.tiltX=m.tiltX,i.tiltY=m.tiltY,i.twist=m.twist,this.transferMouseData(i,m),this.mapPositionToPoint(i.screen,m.clientX,m.clientY),i.global.copyFrom(i.screen),i.offset.copyFrom(i.screen),i.isTrusted=m.isTrusted,"pointerleave"===i.type&&(i.type="pointerout"),i.type.startsWith("mouse")&&(i.type=i.type.replace("mouse","pointer")),i.type.startsWith("touch")&&(i.type=G[i.type]||i.type),i}transferMouseData(i,m){i.isTrusted=m.isTrusted,i.srcElement=m.srcElement,i.timeStamp=performance.now(),i.type=m.type,i.altKey=m.altKey,i.button=m.button,i.buttons=m.buttons,i.client.x=m.clientX,i.client.y=m.clientY,i.ctrlKey=m.ctrlKey,i.metaKey=m.metaKey,i.movement.x=m.movementX,i.movement.y=m.movementY,i.page.x=m.pageX,i.page.y=m.pageY,i.relatedTarget=null,i.shiftKey=m.shiftKey}};function convertEventModeToInteractiveMode(i){return"dynamic"===i||"static"===i}W.extension={name:"events",type:[v.nw.RendererSystem,v.nw.CanvasRendererSystem]},W.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0},v.Rw.add(W),E.s$.mixin({onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??convertEventModeToInteractiveMode(W.defaultEventMode)},set interactive(value){v.P6.deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=value,this.eventMode=value?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??W.defaultEventMode},set eventMode(value){this._internalInteractive=convertEventModeToInteractiveMode(value),this._internalEventMode=value},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(i,m,p){let _="boolean"==typeof p&&p||"object"==typeof p&&p.capture,x="function"==typeof m?void 0:m;i=_?`${i}capture`:i,m="function"==typeof m?m:m.handleEvent,this.on(i,m,x)},removeEventListener(i,m,p){let _="boolean"==typeof p&&p||"object"==typeof p&&p.capture,x="function"==typeof m?void 0:m;i=_?`${i}capture`:i,m="function"==typeof m?m:m.handleEvent,this.off(i,m,x)},dispatchEvent(i){if(!(i instanceof FederatedEvent))throw Error("DisplayObject cannot propagate events outside of the Federated Events API");return i.defaultPrevented=!1,i.path=null,i.target=this,i.manager.dispatchEvent(i),!i.defaultPrevented}}),E.s$.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});let AccessibilityManager=class AccessibilityManager{constructor(i){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(v.P6.isMobile.tablet||v.P6.isMobile.phone)&&this.createTouchHook();let m=document.createElement("div");m.style.width="100px",m.style.height="100px",m.style.position="absolute",m.style.top="0px",m.style.left="0px",m.style.zIndex="2",this.div=m,this.renderer=i,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){let i=document.createElement("button");i.style.width="1px",i.style.height="1px",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.style.zIndex="2",i.style.backgroundColor="#FF0000",i.title="select to enable accessibility for this content",i.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(i),this._hookDiv=i}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(i){if(!i.visible||!i.accessibleChildren)return;i.accessible&&i.isInteractive()&&(i._accessibleActive||this.addChild(i),i.renderId=this.renderId);let m=i.children;if(m)for(let i=0;i<m.length;i++)this.updateAccessibleObjects(m[i])}update(){let i=performance.now();if(v.P6.isMobile.android.device&&i<this.androidUpdateCount||(this.androidUpdateCount=i+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);let{x:m,y:p,width:_,height:x}=this.renderer.view.getBoundingClientRect(),{width:y,height:T,resolution:E}=this.renderer,A=_/y*E,S=x/T*E,I=this.div;I.style.left=`${m}px`,I.style.top=`${p}px`,I.style.width=`${y}px`,I.style.height=`${T}px`;for(let i=0;i<this.children.length;i++){let m=this.children[i];if(m.renderId!==this.renderId)m._accessibleActive=!1,v.P6.removeItems(this.children,i,1),this.div.removeChild(m._accessibleDiv),this.pool.push(m._accessibleDiv),m._accessibleDiv=null,i--;else{I=m._accessibleDiv;let i=m.hitArea,p=m.worldTransform;m.hitArea?(I.style.left=`${(p.tx+i.x*p.a)*A}px`,I.style.top=`${(p.ty+i.y*p.d)*S}px`,I.style.width=`${i.width*p.a*A}px`,I.style.height=`${i.height*p.d*S}px`):(i=m.getBounds(),this.capHitArea(i),I.style.left=`${i.x*A}px`,I.style.top=`${i.y*S}px`,I.style.width=`${i.width*A}px`,I.style.height=`${i.height*S}px`,I.title!==m.accessibleTitle&&null!==m.accessibleTitle&&(I.title=m.accessibleTitle),I.getAttribute("aria-label")!==m.accessibleHint&&null!==m.accessibleHint&&I.setAttribute("aria-label",m.accessibleHint)),(m.accessibleTitle!==I.title||m.tabIndex!==I.tabIndex)&&(I.title=m.accessibleTitle,I.tabIndex=m.tabIndex,this.debug&&this.updateDebugHTML(I))}}this.renderId++}updateDebugHTML(i){i.innerHTML=`type: ${i.type}</br> title : ${i.title}</br> tabIndex: ${i.tabIndex}`}capHitArea(i){i.x<0&&(i.width+=i.x,i.x=0),i.y<0&&(i.height+=i.y,i.y=0);let{width:m,height:p}=this.renderer;i.x+i.width>m&&(i.width=m-i.x),i.y+i.height>p&&(i.height=p-i.y)}addChild(i){let m=this.pool.pop();m||((m=document.createElement("button")).style.width="100px",m.style.height="100px",m.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",m.style.position="absolute",m.style.zIndex="2",m.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?m.setAttribute("aria-live","off"):m.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?m.setAttribute("aria-relevant","additions"):m.setAttribute("aria-relevant","text"),m.addEventListener("click",this._onClick.bind(this)),m.addEventListener("focus",this._onFocus.bind(this)),m.addEventListener("focusout",this._onFocusOut.bind(this))),m.style.pointerEvents=i.accessiblePointerEvents,m.type=i.accessibleType,i.accessibleTitle&&null!==i.accessibleTitle?m.title=i.accessibleTitle:i.accessibleHint&&null!==i.accessibleHint||(m.title=`displayObject ${i.tabIndex}`),i.accessibleHint&&null!==i.accessibleHint&&m.setAttribute("aria-label",i.accessibleHint),this.debug&&this.updateDebugHTML(m),i._accessibleActive=!0,i._accessibleDiv=m,m.displayObject=i,this.children.push(i),this.div.appendChild(i._accessibleDiv),i._accessibleDiv.tabIndex=i.tabIndex}_dispatchEvent(i,m){let{displayObject:p}=i.target,_=this.renderer.events.rootBoundary,x=Object.assign(new FederatedEvent(_),{target:p});_.rootTarget=this.renderer.lastObjectRendered,m.forEach(i=>_.dispatchEvent(x,i))}_onClick(i){this._dispatchEvent(i,["click","pointertap","tap"])}_onFocus(i){i.target.getAttribute("aria-live")||i.target.setAttribute("aria-live","assertive"),this._dispatchEvent(i,["mouseover"])}_onFocusOut(i){i.target.getAttribute("aria-live")||i.target.setAttribute("aria-live","polite"),this._dispatchEvent(i,["mouseout"])}_onKeyDown(i){9===i.keyCode&&this.activate()}_onMouseMove(i){0===i.movementX&&0===i.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}};AccessibilityManager.extension={name:"accessibility",type:[v.nw.RendererPlugin,v.nw.CanvasRendererPlugin]},v.Rw.add(AccessibilityManager);let z=class _Application2{constructor(i){this.stage=new E.W2,i=Object.assign({forceCanvas:!1},i),this.renderer=(0,v.e6)(i),_Application2._plugins.forEach(m=>{m.init.call(this,i)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer?.view}get screen(){return this.renderer?.screen}destroy(i,m){let p=_Application2._plugins.slice(0);p.reverse(),p.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(m),this.stage=null,this.renderer.destroy(i),this.renderer=null}};z._plugins=[];let j=z;v.Rw.handleByList(v.nw.Application,j._plugins);let ResizePlugin=class ResizePlugin{static init(i){Object.defineProperty(this,"resizeTo",{set(i){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=i,i&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{let i,m;if(this._resizeTo){if(this.cancelResize(),this._resizeTo===globalThis.window)i=globalThis.innerWidth,m=globalThis.innerHeight;else{let{clientWidth:p,clientHeight:_}=this._resizeTo;i=p,m=_}this.renderer.resize(i,m),this.render()}},this._resizeId=null,this._resizeTo=null,this.resizeTo=i.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}};ResizePlugin.extension=v.nw.Application,v.Rw.add(ResizePlugin);var Z=p(2857),K=((y=K||{})[y.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",y[y.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",y[y.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",y[y.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",y[y.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",y[y.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",y[y.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",y[y.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",y[y.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",y[y.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",y[y.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",y[y.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",y[y.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",y[y.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",y[y.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",y[y.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",y[y.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",y[y.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",y[y.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",y[y.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",y[y.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",y[y.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",y[y.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",y[y.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",y[y.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",y[y.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",y[y.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",y);let J={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};function getCompressedTextureExtensions(){x={s3tc:_.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:_.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:_.getExtension("WEBGL_compressed_texture_etc"),etc1:_.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:_.getExtension("WEBGL_compressed_texture_pvrtc")||_.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:_.getExtension("WEBGL_compressed_texture_atc"),astc:_.getExtension("WEBGL_compressed_texture_astc")}}let Q={extension:{type:v.nw.DetectionParser,priority:2},test:async()=>{let i=v.Xd.ADAPTER.createCanvas().getContext("webgl");return i?(_=i,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async i=>{x||getCompressedTextureExtensions();let m=[];for(let i in x)x[i]&&m.push(i);return[...m,...i]},remove:async i=>(x||getCompressedTextureExtensions(),i.filter(i=>!(i in x)))};v.Rw.add(Q);let BlobResource=class BlobResource extends v.qm{constructor(i,m={width:1,height:1,autoLoad:!0}){let p,_;"string"==typeof i?(p=i,_=new Uint8Array):(p=null,_=i),super(_,m),this.origin=p,this.buffer=_?new v.Rv(_):null,this._load=null,this.loaded=!1,null!==this.origin&&!1!==m.autoLoad&&this.load(),null===this.origin&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(i){}load(){return this._load||(this._load=fetch(this.origin).then(i=>i.blob()).then(i=>i.arrayBuffer()).then(i=>(this.data=new Uint32Array(i),this.buffer=new v.Rv(i),this.loaded=!0,this.onBlobLoaded(i),this.update(),this))),this._load}};let CompressedTextureResource=class CompressedTextureResource extends BlobResource{constructor(i,m){super(i,m),this.format=m.format,this.levels=m.levels||1,this._width=m.width,this._height=m.height,this._extension=CompressedTextureResource._formatToExtension(this.format),(m.levelBuffers||this.buffer)&&(this._levelBuffers=m.levelBuffers||CompressedTextureResource._createLevelBuffers(i instanceof Uint8Array?i:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(i,m,p){let _=i.gl;if(!i.context.extensions[this._extension])throw Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;_.pixelStorei(_.UNPACK_ALIGNMENT,4);for(let i=0,m=this.levels;i<m;i++){let{levelID:m,levelWidth:p,levelHeight:x,levelBuffer:y}=this._levelBuffers[i];_.compressedTexImage2D(_.TEXTURE_2D,m,this.format,p,x,0,y)}return!0}onBlobLoaded(){this._levelBuffers=CompressedTextureResource._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(i){if(i>=33776&&i<=33779)return"s3tc";if(i>=37488&&i<=37497)return"etc";if(i>=35840&&i<=35843)return"pvrtc";if(i>=36196)return"etc1";if(i>=35986&&i<=34798)return"atc";throw Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(i,m,p,_,x,y,T){let v=Array(p),E=i.byteOffset,A=y,S=T,I=A+_-1&~(_-1),R=S+x-1&~(x-1),C=I*R*J[m];for(let y=0;y<p;y++)v[y]={levelID:y,levelWidth:p>1?A:I,levelHeight:p>1?S:R,levelBuffer:new Uint8Array(i.buffer,E,C)},E+=C,S=S>>1||1,C=(I=(A=A>>1||1)+_-1&~(_-1))*(R=S+x-1&~(x-1))*J[m];return v}};let tt={FOURCC:2},te={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},tr={827611204:K.COMPRESSED_RGBA_S3TC_DXT1_EXT,861165636:K.COMPRESSED_RGBA_S3TC_DXT3_EXT,894720068:K.COMPRESSED_RGBA_S3TC_DXT5_EXT},ti={70:K.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:K.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:K.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:K.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:K.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:K.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:K.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:K.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:K.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function parseDDS(i){let m=new Uint32Array(i);if(542327876!==m[0])throw Error("Invalid DDS file magic word");let p=new Uint32Array(i,0,124/Uint32Array.BYTES_PER_ELEMENT),_=p[3],x=p[4],y=p[7],T=new Uint32Array(i,19*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),v=T[1];if(4&v){let p=T[tt.FOURCC];if(808540228!==p){let m=tr[p],T=new Uint8Array(i,128);return[new CompressedTextureResource(T,{format:m,width:x,height:_,levels:y})]}let v=new Uint32Array(m.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),E=v[te.DXGI_FORMAT],A=v[te.RESOURCE_DIMENSION],S=v[te.MISC_FLAG],I=v[te.ARRAY_SIZE],R=ti[E];if(void 0===R)throw Error(`DDSParser cannot parse texture data with DXGI format ${E}`);if(4===S)throw Error("DDSParser does not support cubemap textures");if(6===A)throw Error("DDSParser does not supported 3D texture data");let C=[];if(1===I)C.push(new Uint8Array(i,148));else{let m=J[R],p=0,T=x,v=_;for(let i=0;i<y;i++){let i=Math.max(1,T+3&-4),_=Math.max(1,v+3&-4),x=i*_*m;p+=x,T>>>=1,v>>>=1}let E=148;for(let m=0;m<I;m++)C.push(new Uint8Array(i,E,p)),E+=p}return C.map(i=>new CompressedTextureResource(i,{format:R,width:x,height:_,levels:y}))}throw 64&v?Error("DDSParser does not support uncompressed texture data."):512&v?Error("DDSParser does not supported YUV uncompressed texture data."):131072&v?Error("DDSParser does not support single-channel (lumninance) texture data!"):2&v?Error("DDSParser does not support single-channel (alpha) texture data!"):Error("DDSParser failed to load a texture file due to an unknown reason!")}let ts=[171,75,84,88,32,49,49,187,13,10,26,10],tn={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},ta={[v.vK.UNSIGNED_BYTE]:1,[v.vK.UNSIGNED_SHORT]:2,[v.vK.INT]:4,[v.vK.UNSIGNED_INT]:4,[v.vK.FLOAT]:4,[v.vK.HALF_FLOAT]:8},to={[v.I2.RGBA]:4,[v.I2.RGB]:3,[v.I2.RG]:2,[v.I2.RED]:1,[v.I2.LUMINANCE]:1,[v.I2.LUMINANCE_ALPHA]:2,[v.I2.ALPHA]:1},tl={[v.vK.UNSIGNED_SHORT_4_4_4_4]:2,[v.vK.UNSIGNED_SHORT_5_5_5_1]:2,[v.vK.UNSIGNED_SHORT_5_6_5]:2};function parseKTX(i,m,p=!1){let _;let x=new DataView(m);if(!validate(i,x))return null;let y=67305985===x.getUint32(tn.ENDIANNESS,!0),T=x.getUint32(tn.GL_TYPE,y),E=x.getUint32(tn.GL_FORMAT,y),A=x.getUint32(tn.GL_INTERNAL_FORMAT,y),S=x.getUint32(tn.PIXEL_WIDTH,y),I=x.getUint32(tn.PIXEL_HEIGHT,y)||1,R=x.getUint32(tn.PIXEL_DEPTH,y)||1,C=x.getUint32(tn.NUMBER_OF_ARRAY_ELEMENTS,y)||1,P=x.getUint32(tn.NUMBER_OF_FACES,y),k=x.getUint32(tn.NUMBER_OF_MIPMAP_LEVELS,y),B=x.getUint32(tn.BYTES_OF_KEY_VALUE_DATA,y);if(0===I||1!==R)throw Error("Only 2D textures are supported");if(1!==P)throw Error("CubeTextures are not supported by KTXLoader yet!");if(1!==C)throw Error("WebGL does not support array textures");let D=S+3&-4,F=I+3&-4,L=Array(C),O=S*I;if(0===T&&(O=D*F),void 0===(_=0!==T?ta[T]?ta[T]*to[E]:tl[T]:J[A]))throw Error("Unable to resolve the pixel format stored in the *.ktx file!");let V=p?parseKvData(x,B,y):null,U=O*_,X=S,Y=I,G=D,W=F,z=64+B;for(let i=0;i<k;i++){let p=x.getUint32(z,y),v=z+4;for(let p=0;p<C;p++){let _=L[p];_||(_=L[p]=Array(k)),_[i]={levelID:i,levelWidth:k>1||0!==T?X:G,levelHeight:k>1||0!==T?Y:W,levelBuffer:new Uint8Array(m,v,U)},v+=U}z+=p+4,z=z%4!=0?z+4-z%4:z,Y=Y>>1||1,U=(G=(X=X>>1||1)+4-1&-4)*(W=Y+4-1&-4)*_}return 0!==T?{uncompressed:L.map(i=>{let m=i[0].levelBuffer,p=!1;return T===v.vK.FLOAT?m=new Float32Array(i[0].levelBuffer.buffer,i[0].levelBuffer.byteOffset,i[0].levelBuffer.byteLength/4):T===v.vK.UNSIGNED_INT?(p=!0,m=new Uint32Array(i[0].levelBuffer.buffer,i[0].levelBuffer.byteOffset,i[0].levelBuffer.byteLength/4)):T===v.vK.INT&&(p=!0,m=new Int32Array(i[0].levelBuffer.buffer,i[0].levelBuffer.byteOffset,i[0].levelBuffer.byteLength/4)),{resource:new v.qm(m,{width:i[0].levelWidth,height:i[0].levelHeight}),type:T,format:p?convertFormatToInteger(E):E}}),kvData:V}:{compressed:L.map(i=>new CompressedTextureResource(null,{format:A,width:S,height:I,levels:k,levelBuffers:i})),kvData:V}}function validate(i,m){for(let p=0;p<ts.length;p++)if(m.getUint8(p)!==ts[p])return console.error(`${i} is not a valid *.ktx file!`),!1;return!0}function convertFormatToInteger(i){switch(i){case v.I2.RGBA:return v.I2.RGBA_INTEGER;case v.I2.RGB:return v.I2.RGB_INTEGER;case v.I2.RG:return v.I2.RG_INTEGER;case v.I2.RED:return v.I2.RED_INTEGER;default:return i}}function parseKvData(i,m,p){let _=new Map,x=0;for(;x<m;){let y=i.getUint32(64+x,p),T=64+x+4,v=3-(y+3)%4;if(0===y||y>m-x){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let E=0;for(;E<y&&0!==i.getUint8(T+E);E++);if(-1===E){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}let A=new TextDecoder().decode(new Uint8Array(i.buffer,T,E)),S=new DataView(i.buffer,T+E+1,y-E-1);_.set(A,S),x+=4+y+v}return _}let th={extension:{type:v.nw.LoadParser,priority:Z.Q2.High},name:"loadDDS",test:i=>(0,Z.gN)(i,".dds"),async load(i,m,p){let _=await (await v.Xd.ADAPTER.fetch(i)).arrayBuffer(),x=parseDDS(_).map(_=>{let x=new v.VL(_,{mipmap:v.KI.OFF,alphaMode:v.iw.NO_PREMULTIPLIED_ALPHA,resolution:v.P6.getResolutionOfUrl(i),...m.data});return(0,Z.cU)(x,p,i)});return 1===x.length?x[0]:x},unload(i){Array.isArray(i)?i.forEach(i=>i.destroy(!0)):i.destroy(!0)}};v.Rw.add(th);let tu={extension:{type:v.nw.LoadParser,priority:Z.Q2.High},name:"loadKTX",test:i=>(0,Z.gN)(i,".ktx"),async load(i,m,p){let _=await (await v.Xd.ADAPTER.fetch(i)).arrayBuffer(),{compressed:x,uncompressed:y,kvData:T}=parseKTX(i,_),E=x??y,A={mipmap:v.KI.OFF,alphaMode:v.iw.NO_PREMULTIPLIED_ALPHA,resolution:v.P6.getResolutionOfUrl(i),...m.data},S=E.map(m=>{E===y&&Object.assign(A,{type:m.type,format:m.format});let _=m.resource??m,x=new v.VL(_,A);return x.ktxKeyValueData=T,(0,Z.cU)(x,p,i)});return 1===S.length?S[0]:S},unload(i){Array.isArray(i)?i.forEach(i=>i.destroy(!0)):i.destroy(!0)}};v.Rw.add(tu);let td={extension:v.nw.ResolveParser,test:i=>{let m=v.P6.path.extname(i).slice(1);return["basis","ktx","dds"].includes(m)},parse:i=>{let m=v.P6.path.extname(i).slice(1);if("ktx"===m){let m=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(m.some(m=>i.endsWith(m)))return{resolution:parseFloat(v.Xd.RETINA_PREFIX.exec(i)?.[1]??"1"),format:m.find(m=>i.endsWith(m)),src:i}}return{resolution:parseFloat(v.Xd.RETINA_PREFIX.exec(i)?.[1]??"1"),format:m,src:i}}};v.Rw.add(td);let tc=new v.Ae,tm=class _Extract2{constructor(i){this.renderer=i,this._rendererPremultipliedAlpha=!1}contextChange(){let i=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(i&&i.alpha&&i.premultipliedAlpha)}async image(i,m,p,_){let x=new Image;return x.src=await this.base64(i,m,p,_),x}async base64(i,m,p,_){let x=this.canvas(i,_);if(void 0!==x.toBlob)return new Promise((i,_)=>{x.toBlob(m=>{if(!m){_(Error("ICanvas.toBlob failed!"));return}let p=new FileReader;p.onload=()=>i(p.result),p.onerror=_,p.readAsDataURL(m)},m,p)});if(void 0!==x.toDataURL)return x.toDataURL(m,p);if(void 0!==x.convertToBlob){let i=await x.convertToBlob({type:m,quality:p});return new Promise((m,p)=>{let _=new FileReader;_.onload=()=>m(_.result),_.onerror=p,_.readAsDataURL(i)})}throw Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(i,m){let{pixels:p,width:_,height:x,flipY:y,premultipliedAlpha:T}=this._rawPixels(i,m);y&&_Extract2._flipY(p,_,x),T&&_Extract2._unpremultiplyAlpha(p);let E=new v.P6.CanvasRenderTarget(_,x,1),A=new ImageData(new Uint8ClampedArray(p.buffer),_,x);return E.context.putImageData(A,0,0),E.canvas}pixels(i,m){let{pixels:p,width:_,height:x,flipY:y,premultipliedAlpha:T}=this._rawPixels(i,m);return y&&_Extract2._flipY(p,_,x),T&&_Extract2._unpremultiplyAlpha(p),p}_rawPixels(i,m){let p=this.renderer;if(!p)throw Error("The Extract has already been destroyed");let _,x=!1,y=!1,T,E=!1;i&&(i instanceof v.TI?T=i:(T=p.generateTexture(i,{region:m,resolution:p.resolution,multisample:p.multisample}),E=!0,m&&(tc.width=m.width,tc.height=m.height,m=tc)));let A=p.gl;if(T){if(_=T.baseTexture.resolution,m=m??T.frame,x=!1,y=T.baseTexture.alphaMode>0&&T.baseTexture.format===v.I2.RGBA,!E){p.renderTexture.bind(T);let i=T.framebuffer.glFramebuffers[p.CONTEXT_UID];i.blitFramebuffer&&p.framebuffer.bind(i.blitFramebuffer)}}else _=p.resolution,m||((m=tc).width=p.width/_,m.height=p.height/_),x=!0,y=this._rendererPremultipliedAlpha,p.renderTexture.bind();let S=Math.max(Math.round(m.width*_),1),I=Math.max(Math.round(m.height*_),1),R=new Uint8Array(4*S*I);return A.readPixels(Math.round(m.x*_),Math.round(m.y*_),S,I,A.RGBA,A.UNSIGNED_BYTE,R),E&&T?.destroy(!0),{pixels:R,width:S,height:I,flipY:x,premultipliedAlpha:y}}destroy(){this.renderer=null}static _flipY(i,m,p){let _=m<<2,x=p>>1,y=new Uint8Array(_);for(let m=0;m<x;m++){let x=m*_,T=(p-m-1)*_;y.set(i.subarray(x,x+_)),i.copyWithin(x,T,T+_),i.set(y,T)}}static _unpremultiplyAlpha(i){i instanceof Uint8ClampedArray&&(i=new Uint8Array(i.buffer));let m=i.length;for(let p=0;p<m;p+=4){let m=i[p+3];if(0!==m){let _=255.001/m;i[p]=i[p]*_+.5,i[p+1]=i[p+1]*_+.5,i[p+2]=i[p+2]*_+.5}}}};tm.extension={name:"extract",type:v.nw.RendererSystem},v.Rw.add(tm);var tf=p(7731),tp=p(2904);p(88);let ParticleBuffer=class ParticleBuffer{constructor(i,m,p){this.geometry=new v.wG,this.indexBuffer=null,this.size=p,this.dynamicProperties=[],this.staticProperties=[];for(let p=0;p<i.length;++p){let _=i[p];_={attributeName:_.attributeName,size:_.size,uploadFunction:_.uploadFunction,type:_.type||v.vK.FLOAT,offset:_.offset},m[p]?this.dynamicProperties.push(_):this.staticProperties.push(_)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){let i=this.geometry,m=0;this.indexBuffer=new v.lW(v.P6.createIndicesForQuads(this.size),!0,!0),i.addIndex(this.indexBuffer),this.dynamicStride=0;for(let i=0;i<this.dynamicProperties.length;++i){let p=this.dynamicProperties[i];p.offset=m,m+=p.size,this.dynamicStride+=p.size}let p=new ArrayBuffer(this.size*this.dynamicStride*16);this.dynamicData=new Float32Array(p),this.dynamicDataUint32=new Uint32Array(p),this.dynamicBuffer=new v.lW(this.dynamicData,!1,!1);let _=0;this.staticStride=0;for(let i=0;i<this.staticProperties.length;++i){let m=this.staticProperties[i];m.offset=_,_+=m.size,this.staticStride+=m.size}let x=new ArrayBuffer(this.size*this.staticStride*16);this.staticData=new Float32Array(x),this.staticDataUint32=new Uint32Array(x),this.staticBuffer=new v.lW(this.staticData,!0,!1);for(let m=0;m<this.dynamicProperties.length;++m){let p=this.dynamicProperties[m];i.addAttribute(p.attributeName,this.dynamicBuffer,0,p.type===v.vK.UNSIGNED_BYTE,p.type,4*this.dynamicStride,4*p.offset)}for(let m=0;m<this.staticProperties.length;++m){let p=this.staticProperties[m];i.addAttribute(p.attributeName,this.staticBuffer,0,p.type===v.vK.UNSIGNED_BYTE,p.type,4*this.staticStride,4*p.offset)}}uploadDynamic(i,m,p){for(let _=0;_<this.dynamicProperties.length;_++){let x=this.dynamicProperties[_];x.uploadFunction(i,m,p,x.type===v.vK.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,x.offset)}this.dynamicBuffer._updateID++}uploadStatic(i,m,p){for(let _=0;_<this.staticProperties.length;_++){let x=this.staticProperties[_];x.uploadFunction(i,m,p,x.type===v.vK.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,x.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}};var tg=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,t_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;let ParticleRenderer=class ParticleRenderer extends v.bO{constructor(i){super(i),this.shader=null,this.properties=null,this.tempMatrix=new v.y3,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:v.vK.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=v.ex.from(t_,tg,{}),this.state=v.ZM.for2d()}render(i){let m=i.children,p=i._maxSize,_=i._batchSize,x=this.renderer,y=m.length;if(0===y)return;y>p&&!i.autoResize&&(y=p);let T=i._buffers;T||(T=i._buffers=this.generateBuffers(i));let E=m[0]._texture.baseTexture,A=E.alphaMode>0;this.state.blendMode=v.P6.correctBlendMode(i.blendMode,A),x.state.set(this.state);let S=x.gl,I=i.worldTransform.copyTo(this.tempMatrix);I.prepend(x.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=I.toArray(!0),this.shader.uniforms.uColor=v.Il.shared.setValue(i.tintRgb).premultiply(i.worldAlpha,A).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=E,this.renderer.shader.bind(this.shader);let R=!1;for(let p=0,v=0;p<y;p+=_,v+=1){let E=y-p;E>_&&(E=_),v>=T.length&&T.push(this._generateOneMoreBuffer(i));let A=T[v];A.uploadDynamic(m,p,E);let I=i._bufferUpdateIDs[v]||0;(R=R||A._updateID<I)&&(A._updateID=i._updateID,A.uploadStatic(m,p,E)),x.geometry.bind(A.geometry),S.drawElements(S.TRIANGLES,6*E,S.UNSIGNED_SHORT,0)}}generateBuffers(i){let m=[],p=i._maxSize,_=i._batchSize,x=i._properties;for(let i=0;i<p;i+=_)m.push(new ParticleBuffer(this.properties,x,_));return m}_generateOneMoreBuffer(i){let m=i._batchSize,p=i._properties;return new ParticleBuffer(this.properties,p,m)}uploadVertices(i,m,p,_,x,y){let T=0,v=0,E=0,A=0;for(let S=0;S<p;++S){let p=i[m+S],I=p._texture,R=p.scale.x,C=p.scale.y,P=I.trim,k=I.orig;P?(T=(v=P.x-p.anchor.x*k.width)+P.width,E=(A=P.y-p.anchor.y*k.height)+P.height):(T=k.width*(1-p.anchor.x),v=-(k.width*p.anchor.x),E=k.height*(1-p.anchor.y),A=-(k.height*p.anchor.y)),_[y]=v*R,_[y+1]=A*C,_[y+x]=T*R,_[y+x+1]=A*C,_[y+2*x]=T*R,_[y+2*x+1]=E*C,_[y+3*x]=v*R,_[y+3*x+1]=E*C,y+=4*x}}uploadPosition(i,m,p,_,x,y){for(let T=0;T<p;T++){let p=i[m+T].position;_[y]=p.x,_[y+1]=p.y,_[y+x]=p.x,_[y+x+1]=p.y,_[y+2*x]=p.x,_[y+2*x+1]=p.y,_[y+3*x]=p.x,_[y+3*x+1]=p.y,y+=4*x}}uploadRotation(i,m,p,_,x,y){for(let T=0;T<p;T++){let p=i[m+T].rotation;_[y]=p,_[y+x]=p,_[y+2*x]=p,_[y+3*x]=p,y+=4*x}}uploadUvs(i,m,p,_,x,y){for(let T=0;T<p;++T){let p=i[m+T]._texture._uvs;p?(_[y]=p.x0,_[y+1]=p.y0,_[y+x]=p.x1,_[y+x+1]=p.y1,_[y+2*x]=p.x2,_[y+2*x+1]=p.y2,_[y+3*x]=p.x3,_[y+3*x+1]=p.y3):(_[y]=0,_[y+1]=0,_[y+x]=0,_[y+x+1]=0,_[y+2*x]=0,_[y+2*x+1]=0,_[y+3*x]=0,_[y+3*x+1]=0),y+=4*x}}uploadTint(i,m,p,_,x,y){for(let T=0;T<p;++T){let p=i[m+T],E=v.Il.shared.setValue(p._tintRGB).toPremultiplied(p.alpha,p.texture.baseTexture.alphaMode>0);_[y]=E,_[y+x]=E,_[y+2*x]=E,_[y+3*x]=E,y+=4*x}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}};ParticleRenderer.extension={name:"particle",type:v.nw.RendererPlugin},v.Rw.add(ParticleRenderer);var tx=((T=tx||{})[T.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",T[T.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",T);let ty={willReadFrequently:!0},tb=class _TextMetrics2{static get experimentalLetterSpacingSupported(){let i=_TextMetrics2._experimentalLetterSpacingSupported;if(void 0!==i){let m=v.Xd.ADAPTER.getCanvasRenderingContext2D().prototype;i=_TextMetrics2._experimentalLetterSpacingSupported="letterSpacing"in m||"textLetterSpacing"in m}return i}constructor(i,m,p,_,x,y,T,v,E){this.text=i,this.style=m,this.width=p,this.height=_,this.lines=x,this.lineWidths=y,this.lineHeight=T,this.maxLineWidth=v,this.fontProperties=E}static measureText(i,m,p,_=_TextMetrics2._canvas){p=p??m.wordWrap;let x=m.toFontString(),y=_TextMetrics2.measureFont(x);0===y.fontSize&&(y.fontSize=m.fontSize,y.ascent=m.fontSize);let T=_.getContext("2d",ty);T.font=x;let v=(p?_TextMetrics2.wordWrap(i,m,_):i).split(/(?:\r\n|\r|\n)/),E=Array(v.length),A=0;for(let i=0;i<v.length;i++){let p=_TextMetrics2._measureText(v[i],m.letterSpacing,T);E[i]=p,A=Math.max(A,p)}let S=A+m.strokeThickness;m.dropShadow&&(S+=m.dropShadowDistance);let I=m.lineHeight||y.fontSize+m.strokeThickness,R=Math.max(I,y.fontSize+2*m.strokeThickness)+m.leading+(v.length-1)*(I+m.leading);return m.dropShadow&&(R+=m.dropShadowDistance),new _TextMetrics2(i,m,S,R,v,E,I+m.leading,A,y)}static _measureText(i,m,p){let _=!1;_TextMetrics2.experimentalLetterSpacingSupported&&(_TextMetrics2.experimentalLetterSpacing?(p.letterSpacing=`${m}px`,p.textLetterSpacing=`${m}px`,_=!0):(p.letterSpacing="0px",p.textLetterSpacing="0px"));let x=p.measureText(i).width;return x>0&&(_?x-=m:x+=(_TextMetrics2.graphemeSegmenter(i).length-1)*m),x}static wordWrap(i,m,p=_TextMetrics2._canvas){let _=p.getContext("2d",ty),x=0,y="",T="",v=Object.create(null),{letterSpacing:E,whiteSpace:A}=m,S=_TextMetrics2.collapseSpaces(A),I=_TextMetrics2.collapseNewlines(A),R=!S,C=m.wordWrapWidth+E,P=_TextMetrics2.tokenize(i);for(let i=0;i<P.length;i++){let p=P[i];if(_TextMetrics2.isNewline(p)){if(!I){T+=_TextMetrics2.addLine(y),R=!S,y="",x=0;continue}p=" "}if(S){let i=_TextMetrics2.isBreakingSpace(p),m=_TextMetrics2.isBreakingSpace(y[y.length-1]);if(i&&m)continue}let A=_TextMetrics2.getFromCache(p,E,v,_);if(A>C){if(""!==y&&(T+=_TextMetrics2.addLine(y),y="",x=0),_TextMetrics2.canBreakWords(p,m.breakWords)){let i=_TextMetrics2.wordWrapSplit(p);for(let A=0;A<i.length;A++){let S=i[A],I=S,P=1;for(;i[A+P];){let _=i[A+P];if(_TextMetrics2.canBreakChars(I,_,p,A,m.breakWords))break;S+=_,I=_,P++}A+=P-1;let k=_TextMetrics2.getFromCache(S,E,v,_);k+x>C&&(T+=_TextMetrics2.addLine(y),R=!1,y="",x=0),y+=S,x+=k}}else{y.length>0&&(T+=_TextMetrics2.addLine(y),y="",x=0);let m=i===P.length-1;T+=_TextMetrics2.addLine(p,!m),R=!1,y="",x=0}}else A+x>C&&(R=!1,T+=_TextMetrics2.addLine(y),y="",x=0),(y.length>0||!_TextMetrics2.isBreakingSpace(p)||R)&&(y+=p,x+=A)}return T+_TextMetrics2.addLine(y,!1)}static addLine(i,m=!0){return i=_TextMetrics2.trimRight(i),i=m?`${i}
`:i}static getFromCache(i,m,p,_){let x=p[i];return"number"!=typeof x&&(x=_TextMetrics2._measureText(i,m,_)+m,p[i]=x),x}static collapseSpaces(i){return"normal"===i||"pre-line"===i}static collapseNewlines(i){return"normal"===i}static trimRight(i){if("string"!=typeof i)return"";for(let m=i.length-1;m>=0;m--){let p=i[m];if(!_TextMetrics2.isBreakingSpace(p))break;i=i.slice(0,-1)}return i}static isNewline(i){return"string"==typeof i&&_TextMetrics2._newlines.includes(i.charCodeAt(0))}static isBreakingSpace(i,m){return"string"==typeof i&&_TextMetrics2._breakingSpaces.includes(i.charCodeAt(0))}static tokenize(i){let m=[],p="";if("string"!=typeof i)return m;for(let _=0;_<i.length;_++){let x=i[_],y=i[_+1];if(_TextMetrics2.isBreakingSpace(x,y)||_TextMetrics2.isNewline(x)){""!==p&&(m.push(p),p=""),m.push(x);continue}p+=x}return""!==p&&m.push(p),m}static canBreakWords(i,m){return m}static canBreakChars(i,m,p,_,x){return!0}static wordWrapSplit(i){return _TextMetrics2.graphemeSegmenter(i)}static measureFont(i){if(_TextMetrics2._fonts[i])return _TextMetrics2._fonts[i];let m={ascent:0,descent:0,fontSize:0},p=_TextMetrics2._canvas,_=_TextMetrics2._context;_.font=i;let x=_TextMetrics2.METRICS_STRING+_TextMetrics2.BASELINE_SYMBOL,y=Math.ceil(_.measureText(x).width),T=Math.ceil(_.measureText(_TextMetrics2.BASELINE_SYMBOL).width),v=Math.ceil(_TextMetrics2.HEIGHT_MULTIPLIER*T);if(T=T*_TextMetrics2.BASELINE_MULTIPLIER|0,0===y||0===v)return _TextMetrics2._fonts[i]=m,m;p.width=y,p.height=v,_.fillStyle="#f00",_.fillRect(0,0,y,v),_.font=i,_.textBaseline="alphabetic",_.fillStyle="#000",_.fillText(x,0,T);let E=_.getImageData(0,0,y,v).data,A=E.length,S=4*y,I=0,R=0,C=!1;for(I=0;I<T;++I){for(let i=0;i<S;i+=4)if(255!==E[R+i]){C=!0;break}if(C)break;R+=S}for(m.ascent=T-I,R=A-S,C=!1,I=v;I>T;--I){for(let i=0;i<S;i+=4)if(255!==E[R+i]){C=!0;break}if(C)break;R-=S}return m.descent=I-T,m.fontSize=m.ascent+m.descent,_TextMetrics2._fonts[i]=m,m}static clearMetrics(i=""){i?delete _TextMetrics2._fonts[i]:_TextMetrics2._fonts={}}static get _canvas(){if(!_TextMetrics2.__canvas){let i;try{let m=new OffscreenCanvas(0,0);if(m.getContext("2d",ty)?.measureText)return _TextMetrics2.__canvas=m,m;i=v.Xd.ADAPTER.createCanvas()}catch{i=v.Xd.ADAPTER.createCanvas()}i.width=i.height=10,_TextMetrics2.__canvas=i}return _TextMetrics2.__canvas}static get _context(){return _TextMetrics2.__context||(_TextMetrics2.__context=_TextMetrics2._canvas.getContext("2d",ty)),_TextMetrics2.__context}};tb.METRICS_STRING="|\xc9q\xc5",tb.BASELINE_SYMBOL="M",tb.BASELINE_MULTIPLIER=1.4,tb.HEIGHT_MULTIPLIER=2,tb.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){let i=new Intl.Segmenter;return m=>[...i.segment(m)].map(i=>i.segment)}return i=>[...i]})(),tb.experimentalLetterSpacing=!1,tb._fonts={},tb._newlines=[10,13],tb._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let tT=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],tv=class _TextStyle2{constructor(i){this.styleID=0,this.reset(),deepCopyProperties(this,i,i)}clone(){let i={};return deepCopyProperties(i,this,_TextStyle2.defaultStyle),new _TextStyle2(i)}reset(){deepCopyProperties(this,_TextStyle2.defaultStyle,_TextStyle2.defaultStyle)}get align(){return this._align}set align(i){this._align!==i&&(this._align=i,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(i){this._breakWords!==i&&(this._breakWords=i,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(i){this._dropShadow!==i&&(this._dropShadow=i,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(i){this._dropShadowAlpha!==i&&(this._dropShadowAlpha=i,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(i){this._dropShadowAngle!==i&&(this._dropShadowAngle=i,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(i){this._dropShadowBlur!==i&&(this._dropShadowBlur=i,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(i){let m=getColor(i);this._dropShadowColor!==m&&(this._dropShadowColor=m,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(i){this._dropShadowDistance!==i&&(this._dropShadowDistance=i,this.styleID++)}get fill(){return this._fill}set fill(i){let m=getColor(i);this._fill!==m&&(this._fill=m,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(i){this._fillGradientType!==i&&(this._fillGradientType=i,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(i){areArraysEqual(this._fillGradientStops,i)||(this._fillGradientStops=i,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(i){this.fontFamily!==i&&(this._fontFamily=i,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(i){this._fontSize!==i&&(this._fontSize=i,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(i){this._fontStyle!==i&&(this._fontStyle=i,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(i){this._fontVariant!==i&&(this._fontVariant=i,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(i){this._fontWeight!==i&&(this._fontWeight=i,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(i){this._letterSpacing!==i&&(this._letterSpacing=i,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(i){this._lineHeight!==i&&(this._lineHeight=i,this.styleID++)}get leading(){return this._leading}set leading(i){this._leading!==i&&(this._leading=i,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(i){this._lineJoin!==i&&(this._lineJoin=i,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(i){this._miterLimit!==i&&(this._miterLimit=i,this.styleID++)}get padding(){return this._padding}set padding(i){this._padding!==i&&(this._padding=i,this.styleID++)}get stroke(){return this._stroke}set stroke(i){let m=getColor(i);this._stroke!==m&&(this._stroke=m,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(i){this._strokeThickness!==i&&(this._strokeThickness=i,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(i){this._textBaseline!==i&&(this._textBaseline=i,this.styleID++)}get trim(){return this._trim}set trim(i){this._trim!==i&&(this._trim=i,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(i){this._whiteSpace!==i&&(this._whiteSpace=i,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(i){this._wordWrap!==i&&(this._wordWrap=i,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(i){this._wordWrapWidth!==i&&(this._wordWrapWidth=i,this.styleID++)}toFontString(){let i="number"==typeof this.fontSize?`${this.fontSize}px`:this.fontSize,m=this.fontFamily;Array.isArray(this.fontFamily)||(m=this.fontFamily.split(","));for(let i=m.length-1;i>=0;i--){let p=m[i].trim();/([\"\'])[^\'\"]+\1/.test(p)||tT.includes(p)||(p=`"${p}"`),m[i]=p}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${i} ${m.join(",")}`}};tv.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:tx.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let tE=tv;function getColor(i){let m=v.Il.shared,format=i=>{let p=m.setValue(i);return 1===p.alpha?p.toHex():p.toRgbaString()};return Array.isArray(i)?i.map(format):format(i)}function areArraysEqual(i,m){if(!Array.isArray(i)||!Array.isArray(m)||i.length!==m.length)return!1;for(let p=0;p<i.length;++p)if(i[p]!==m[p])return!1;return!0}function deepCopyProperties(i,m,p){for(let _ in p)Array.isArray(m[_])?i[_]=m[_].slice():i[_]=m[_]}let tA={texture:!0,children:!1,baseTexture:!0},tS=class _Text2 extends A.j{constructor(i,m,p){let _=!1;p||(p=v.Xd.ADAPTER.createCanvas(),_=!0),p.width=3,p.height=3;let x=v.xE.from(p);x.orig=new v.Ae,x.trim=new v.Ae,super(x),this._ownCanvas=_,this.canvas=p,this.context=p.getContext("2d",{willReadFrequently:!0}),this._resolution=_Text2.defaultResolution??v.Xd.RESOLUTION,this._autoResolution=_Text2.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=i,this.style=m,this.localStyleID=-1}static get experimentalLetterSpacing(){return tb.experimentalLetterSpacing}static set experimentalLetterSpacing(i){v.P6.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),tb.experimentalLetterSpacing=i}updateText(i){let m,p;let _=this._style;if(this.localStyleID!==_.styleID&&(this.dirty=!0,this.localStyleID=_.styleID),!this.dirty&&i)return;this._font=this._style.toFontString();let x=this.context,y=tb.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),T=y.width,E=y.height,A=y.lines,S=y.lineHeight,I=y.lineWidths,R=y.maxLineWidth,C=y.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,T)+2*_.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,E)+2*_.padding)*this._resolution),x.scale(this._resolution,this._resolution),x.clearRect(0,0,this.canvas.width,this.canvas.height),x.font=this._font,x.lineWidth=_.strokeThickness,x.textBaseline=_.textBaseline,x.lineJoin=_.lineJoin,x.miterLimit=_.miterLimit;let P=_.dropShadow?2:1;for(let i=0;i<P;++i){let T=_.dropShadow&&0===i,P=T?Math.ceil(Math.max(1,E)+2*_.padding):0,k=P*this._resolution;if(T){x.fillStyle="black",x.strokeStyle="black";let i=_.dropShadowColor,m=_.dropShadowBlur*this._resolution,p=_.dropShadowDistance*this._resolution;x.shadowColor=v.Il.shared.setValue(i).setAlpha(_.dropShadowAlpha).toRgbaString(),x.shadowBlur=m,x.shadowOffsetX=Math.cos(_.dropShadowAngle)*p,x.shadowOffsetY=Math.sin(_.dropShadowAngle)*p+k}else x.fillStyle=this._generateFillStyle(_,A,y),x.strokeStyle=_.stroke,x.shadowColor="black",x.shadowBlur=0,x.shadowOffsetX=0,x.shadowOffsetY=0;let B=(S-C.fontSize)/2;S-C.fontSize<0&&(B=0);for(let i=0;i<A.length;i++)m=_.strokeThickness/2,p=_.strokeThickness/2+i*S+C.ascent+B,"right"===_.align?m+=R-I[i]:"center"===_.align&&(m+=(R-I[i])/2),_.stroke&&_.strokeThickness&&this.drawLetterSpacing(A[i],m+_.padding,p+_.padding-P,!0),_.fill&&this.drawLetterSpacing(A[i],m+_.padding,p+_.padding-P)}this.updateTexture()}drawLetterSpacing(i,m,p,_=!1){let x=this._style.letterSpacing,y=!1;if(tb.experimentalLetterSpacingSupported&&(tb.experimentalLetterSpacing?(this.context.letterSpacing=`${x}px`,this.context.textLetterSpacing=`${x}px`,y=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===x||y){_?this.context.strokeText(i,m,p):this.context.fillText(i,m,p);return}let T=m,v=tb.graphemeSegmenter(i),E=this.context.measureText(i).width,A=0;for(let i=0;i<v.length;++i){let m=v[i];_?this.context.strokeText(m,T,p):this.context.fillText(m,T,p);let y="";for(let m=i+1;m<v.length;++m)y+=v[m];T+=E-(A=this.context.measureText(y).width)+x,E=A}}updateTexture(){let i=this.canvas;if(this._style.trim){let m=v.P6.trimCanvas(i);m.data&&(i.width=m.width,i.height=m.height,this.context.putImageData(m.data,0,0))}let m=this._texture,p=this._style,_=p.trim?0:p.padding,x=m.baseTexture;m.trim.width=m._frame.width=i.width/this._resolution,m.trim.height=m._frame.height=i.height/this._resolution,m.trim.x=-_,m.trim.y=-_,m.orig.width=m._frame.width-2*_,m.orig.height=m._frame.height-2*_,this._onTextureUpdate(),x.setRealSize(i.width,i.height,this._resolution),m.updateUvs(),this.dirty=!1}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),super._render(i)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(i,m){return this.updateText(!0),-1===this._textureID&&(i=!1),super.getBounds(i,m)}getLocalBounds(i){return this.updateText(!0),super.getLocalBounds.call(this,i)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(i,m,p){let _;let x=i.fill;if(!Array.isArray(x))return x;if(1===x.length)return x[0];let y=i.dropShadow?i.dropShadowDistance:0,T=i.padding||0,v=this.canvas.width/this._resolution-y-2*T,E=this.canvas.height/this._resolution-y-2*T,A=x.slice(),S=i.fillGradientStops.slice();if(!S.length){let i=A.length+1;for(let m=1;m<i;++m)S.push(m/i)}if(A.unshift(x[0]),S.unshift(0),A.push(x[x.length-1]),S.push(1),i.fillGradientType===tx.LINEAR_VERTICAL){_=this.context.createLinearGradient(v/2,T,v/2,E+T);let x=p.fontProperties.fontSize+i.strokeThickness;for(let i=0;i<m.length;i++){let y=p.lineHeight*(i-1)+x,T=p.lineHeight*i,v=T;i>0&&y>T&&(v=(T+y)/2);let I=T+x,R=p.lineHeight*(i+1),C=I;i+1<m.length&&R<I&&(C=(I+R)/2);let P=(C-v)/E;for(let i=0;i<A.length;i++){let m=Math.min(1,Math.max(0,v/E+("number"==typeof S[i]?S[i]:i/A.length)*P));m=Number(m.toFixed(5)),_.addColorStop(m,A[i])}}}else{_=this.context.createLinearGradient(T,E/2,v+T,E/2);let i=A.length+1,m=1;for(let p=0;p<A.length;p++){let x;x="number"==typeof S[p]?S[p]:m/i,_.addColorStop(x,A[p]),m++}}return _}destroy(i){"boolean"==typeof i&&(i={children:i}),i=Object.assign({},tA,i),super.destroy(i),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(i){this.updateText(!0);let m=v.P6.sign(this.scale.x)||1;this.scale.x=m*i/this._texture.orig.width,this._width=i}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(i){this.updateText(!0);let m=v.P6.sign(this.scale.y)||1;this.scale.y=m*i/this._texture.orig.height,this._height=i}get style(){return this._style}set style(i){(i=i||{})instanceof tE?this._style=i:this._style=new tE(i),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(i){i=String(i??""),this._text!==i&&(this._text=i,this.dirty=!0)}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}};tS.defaultAutoResolution=!0;let CountLimiter=class CountLimiter{constructor(i){this.maxItemsPerFrame=i,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}};function findMultipleBaseTextures(i,m){let p=!1;if(i?._textures?.length){for(let _=0;_<i._textures.length;_++)if(i._textures[_]instanceof v.xE){let x=i._textures[_].baseTexture;m.includes(x)||(m.push(x),p=!0)}}return p}function findBaseTexture(i,m){if(i.baseTexture instanceof v.VL){let p=i.baseTexture;return m.includes(p)||m.push(p),!0}return!1}function findTexture(i,m){if(i._texture&&i._texture instanceof v.xE){let p=i._texture.baseTexture;return m.includes(p)||m.push(p),!0}return!1}function drawText(i,m){return m instanceof tS&&(m.updateText(!0),!0)}function calculateTextStyle(i,m){if(m instanceof tE){let i=m.toFontString();return tb.measureFont(i),!0}return!1}function findText(i,m){if(i instanceof tS){m.includes(i.style)||m.push(i.style),m.includes(i)||m.push(i);let p=i._texture.baseTexture;return m.includes(p)||m.push(p),!0}return!1}function findTextStyle(i,m){return i instanceof tE&&(m.includes(i)||m.push(i),!0)}let tw=class _BasePrepare2{constructor(i){this.limiter=new CountLimiter(_BasePrepare2.uploadsPerFrame),this.renderer=i,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(findText),this.registerFindHook(findTextStyle),this.registerFindHook(findMultipleBaseTextures),this.registerFindHook(findBaseTexture),this.registerFindHook(findTexture),this.registerUploadHook(drawText),this.registerUploadHook(calculateTextStyle)}upload(i){return new Promise(m=>{i&&this.add(i),this.queue.length?(this.completes.push(m),this.ticking||(this.ticking=!0,v.vB.system.addOnce(this.tick,this,v.uF.UTILITY))):m()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){let i=this.queue[0],m=!1;if(i&&!i._destroyed){for(let p=0,_=this.uploadHooks.length;p<_;p++)if(this.uploadHooks[p](this.uploadHookHelper,i)){this.queue.shift(),m=!0;break}}m||this.queue.shift()}if(this.queue.length)v.vB.system.addOnce(this.tick,this,v.uF.UTILITY);else{this.ticking=!1;let i=this.completes.slice(0);this.completes.length=0;for(let m=0,p=i.length;m<p;m++)i[m]()}}registerFindHook(i){return i&&this.addHooks.push(i),this}registerUploadHook(i){return i&&this.uploadHooks.push(i),this}add(i){for(let m=0,p=this.addHooks.length;m<p&&!this.addHooks[m](i,this.queue);m++);if(i instanceof E.W2)for(let m=i.children.length-1;m>=0;m--)this.add(i.children[m]);return this}destroy(){this.ticking&&v.vB.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};tw.uploadsPerFrame=4;let tI=tw;function uploadBaseTextures(i,m){return m instanceof v.VL&&(m._glTextures[i.CONTEXT_UID]||i.texture.bind(m),!0)}function uploadGraphics(i,m){if(!(m instanceof tf.TC))return!1;let{geometry:p}=m;m.finishPoly(),p.updateBatches();let{batches:_}=p;for(let m=0;m<_.length;m++){let{texture:p}=_[m].style;p&&uploadBaseTextures(i,p.baseTexture)}return p.batchable||i.geometry.bind(p,m._resolveDirectShader(i)),!0}function findGraphics(i,m){return i instanceof tf.TC&&(m.push(i),!0)}Object.defineProperties(v.Xd,{UPLOADS_PER_FRAME:{get:()=>tI.uploadsPerFrame,set(i){v.P6.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),tI.uploadsPerFrame=i}}});let Prepare=class Prepare extends tI{constructor(i){super(i),this.uploadHookHelper=this.renderer,this.registerFindHook(findGraphics),this.registerUploadHook(uploadBaseTextures),this.registerUploadHook(uploadGraphics)}};Prepare.extension={name:"prepare",type:v.nw.RendererSystem},v.Rw.add(Prepare),new v.E9;var tR=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,tM=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,tC=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,tP=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,tk=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;let tB=new v.y3;let TilingSpriteRenderer=class TilingSpriteRenderer extends v.bO{constructor(i){super(i),i.runners.contextChange.add(this),this.quad=new v.ud,this.state=v.ZM.for2d()}contextChange(){let i=this.renderer,m={globals:i.globalUniforms};this.simpleShader=v.ex.from(tP,tk,m),this.shader=i.context.webGLVersion>1?v.ex.from(tM,tR,m):v.ex.from(tP,tC,m)}render(i){let m=this.renderer,p=this.quad,_=p.vertices;_[0]=_[6]=-(i._width*i.anchor.x),_[1]=_[3]=-(i._height*i.anchor.y),_[2]=_[4]=i._width*(1-i.anchor.x),_[5]=_[7]=i._height*(1-i.anchor.y);let x=i.uvRespectAnchor?i.anchor.x:0,y=i.uvRespectAnchor?i.anchor.y:0;(_=p.uvs)[0]=_[6]=-x,_[1]=_[3]=-y,_[2]=_[4]=1-x,_[5]=_[7]=1-y,p.invalidate();let T=i._texture,E=T.baseTexture,A=E.alphaMode>0,S=i.tileTransform.localTransform,I=i.uvMatrix,R=E.isPowerOfTwo&&T.frame.width===E.width&&T.frame.height===E.height;R&&(E._glTextures[m.CONTEXT_UID]?R=E.wrapMode!==v.Nt.CLAMP:E.wrapMode===v.Nt.CLAMP&&(E.wrapMode=v.Nt.REPEAT));let C=R?this.simpleShader:this.shader,P=T.width,k=T.height,B=i._width,D=i._height;tB.set(S.a*P/B,S.b*P/D,S.c*k/B,S.d*k/D,S.tx/B,S.ty/D),tB.invert(),R?tB.prepend(I.mapCoord):(C.uniforms.uMapCoord=I.mapCoord.toArray(!0),C.uniforms.uClampFrame=I.uClampFrame,C.uniforms.uClampOffset=I.uClampOffset),C.uniforms.uTransform=tB.toArray(!0),C.uniforms.uColor=v.Il.shared.setValue(i.tint).premultiply(i.worldAlpha,A).toArray(C.uniforms.uColor),C.uniforms.translationMatrix=i.transform.worldTransform.toArray(!0),C.uniforms.uSampler=T,m.shader.bind(C),m.geometry.bind(p),this.state.blendMode=v.P6.correctBlendMode(i.blendMode,A),m.state.set(this.state),m.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}};TilingSpriteRenderer.extension={name:"tilingSprite",type:v.nw.RendererPlugin},v.Rw.add(TilingSpriteRenderer);let tD=class _Spritesheet2{constructor(i,m,p=null){this.linkedSheets=[],this._texture=i instanceof v.xE?i:null,this.baseTexture=i instanceof v.VL?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=m;let _=this.baseTexture.resource;this.resolution=this._updateResolution(p||(_?_.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(i=null){let{scale:m}=this.data.meta,p=v.P6.getResolutionOfUrl(i,null);return null===p&&(p=parseFloat(m??"1")),1!==p&&this.baseTexture.setResolution(p),p}parse(){return new Promise(i=>{this._callback=i,this._batchIndex=0,this._frameKeys.length<=_Spritesheet2.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(i){let m=i,p=_Spritesheet2.BATCH_SIZE;for(;m-i<p&&m<this._frameKeys.length;){let i=this._frameKeys[m],p=this._frames[i],_=p.frame;if(_){let m=null,x=null,y=!1!==p.trimmed&&p.sourceSize?p.sourceSize:p.frame,T=new v.Ae(0,0,Math.floor(y.w)/this.resolution,Math.floor(y.h)/this.resolution);m=p.rotated?new v.Ae(Math.floor(_.x)/this.resolution,Math.floor(_.y)/this.resolution,Math.floor(_.h)/this.resolution,Math.floor(_.w)/this.resolution):new v.Ae(Math.floor(_.x)/this.resolution,Math.floor(_.y)/this.resolution,Math.floor(_.w)/this.resolution,Math.floor(_.h)/this.resolution),!1!==p.trimmed&&p.spriteSourceSize&&(x=new v.Ae(Math.floor(p.spriteSourceSize.x)/this.resolution,Math.floor(p.spriteSourceSize.y)/this.resolution,Math.floor(_.w)/this.resolution,Math.floor(_.h)/this.resolution)),this.textures[i]=new v.xE(this.baseTexture,m,T,x,p.rotated?2:0,p.anchor,p.borders),v.xE.addToCache(this.textures[i],i.toString())}m++}}_processAnimations(){let i=this.data.animations||{};for(let m in i){this.animations[m]=[];for(let p=0;p<i[m].length;p++){let _=i[m][p];this.animations[m].push(this.textures[_])}}}_parseComplete(){let i=this._callback;this._callback=null,this._batchIndex=0,i.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*_Spritesheet2.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*_Spritesheet2.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(i=!1){for(let i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,i&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};tD.BATCH_SIZE=1e3;let tF=["jpg","png","jpeg","avif","webp"];function getCacheableAssets(i,m,p){let _={};if(i.forEach(i=>{_[i]=m}),Object.keys(m.textures).forEach(i=>{_[i]=m.textures[i]}),!p){let p=v.P6.path.dirname(i[0]);m.linkedSheets.forEach((i,x)=>{let y=getCacheableAssets([`${p}/${m.data.meta.related_multi_packs[x]}`],i,!0);Object.assign(_,y)})}return _}let tN={extension:v.nw.Asset,cache:{test:i=>i instanceof tD,getCacheableAssets:(i,m)=>getCacheableAssets(i,m,!1)},resolver:{test:i=>{let m=i.split("?")[0].split("."),p=m.pop(),_=m.pop();return"json"===p&&tF.includes(_)},parse:i=>{let m=i.split(".");return{resolution:parseFloat(v.Xd.RETINA_PREFIX.exec(i)?.[1]??"1"),format:m[m.length-2],src:i}}},loader:{name:"spritesheetLoader",extension:{type:v.nw.LoadParser,priority:Z.Q2.Normal},testParse:async(i,m)=>".json"===v.P6.path.extname(m.src).toLowerCase()&&!!i.frames,async parse(i,m,p){let _=v.P6.path.dirname(m.src);_&&_.lastIndexOf("/")!==_.length-1&&(_+="/");let x=_+i.meta.image;x=(0,Z.uz)(x,m.src);let y=(await p.load([x]))[x],T=new tD(y.baseTexture,i,m.src);await T.parse();let E=i?.meta?.related_multi_packs;if(Array.isArray(E)){let i=[];for(let x of E){if("string"!=typeof x)continue;let y=_+x;m.data?.ignoreMultiPack||(y=(0,Z.uz)(y,m.src),i.push(p.load({src:y,data:{ignoreMultiPack:!0}})))}let x=await Promise.all(i);T.linkedSheets=x,x.forEach(i=>{i.linkedSheets=[T].concat(T.linkedSheets.filter(m=>m!==i))})}return T},unload(i){i.destroy(!0)}}};v.Rw.add(tN);let BitmapFontData=class BitmapFontData{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}};let TextFormat=class TextFormat{static test(i){return"string"==typeof i&&i.startsWith("info face=")}static parse(i){let m=i.match(/^[a-z]+\s+.+$/gm),p={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let i in m){let _=m[i].match(/^[a-z]+/gm)[0],x=m[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),y={};for(let i in x){let m=x[i].split("="),p=m[0],_=m[1].replace(/"/gm,""),T=parseFloat(_),v=isNaN(T)?_:T;y[p]=v}p[_].push(y)}let _=new BitmapFontData;return p.info.forEach(i=>_.info.push({face:i.face,size:parseInt(i.size,10)})),p.common.forEach(i=>_.common.push({lineHeight:parseInt(i.lineHeight,10)})),p.page.forEach(i=>_.page.push({id:parseInt(i.id,10),file:i.file})),p.char.forEach(i=>_.char.push({id:parseInt(i.id,10),page:parseInt(i.page,10),x:parseInt(i.x,10),y:parseInt(i.y,10),width:parseInt(i.width,10),height:parseInt(i.height,10),xoffset:parseInt(i.xoffset,10),yoffset:parseInt(i.yoffset,10),xadvance:parseInt(i.xadvance,10)})),p.kerning.forEach(i=>_.kerning.push({first:parseInt(i.first,10),second:parseInt(i.second,10),amount:parseInt(i.amount,10)})),p.distanceField.forEach(i=>_.distanceField.push({distanceRange:parseInt(i.distanceRange,10),fieldType:i.fieldType})),_}};let XMLFormat=class XMLFormat{static test(i){return"string"!=typeof i&&"getElementsByTagName"in i&&i.getElementsByTagName("page").length&&null!==i.getElementsByTagName("info")[0].getAttribute("face")}static parse(i){let m=new BitmapFontData,p=i.getElementsByTagName("info"),_=i.getElementsByTagName("common"),x=i.getElementsByTagName("page"),y=i.getElementsByTagName("char"),T=i.getElementsByTagName("kerning"),v=i.getElementsByTagName("distanceField");for(let i=0;i<p.length;i++)m.info.push({face:p[i].getAttribute("face"),size:parseInt(p[i].getAttribute("size"),10)});for(let i=0;i<_.length;i++)m.common.push({lineHeight:parseInt(_[i].getAttribute("lineHeight"),10)});for(let i=0;i<x.length;i++)m.page.push({id:parseInt(x[i].getAttribute("id"),10)||0,file:x[i].getAttribute("file")});for(let i=0;i<y.length;i++){let p=y[i];m.char.push({id:parseInt(p.getAttribute("id"),10),page:parseInt(p.getAttribute("page"),10)||0,x:parseInt(p.getAttribute("x"),10),y:parseInt(p.getAttribute("y"),10),width:parseInt(p.getAttribute("width"),10),height:parseInt(p.getAttribute("height"),10),xoffset:parseInt(p.getAttribute("xoffset"),10),yoffset:parseInt(p.getAttribute("yoffset"),10),xadvance:parseInt(p.getAttribute("xadvance"),10)})}for(let i=0;i<T.length;i++)m.kerning.push({first:parseInt(T[i].getAttribute("first"),10),second:parseInt(T[i].getAttribute("second"),10),amount:parseInt(T[i].getAttribute("amount"),10)});for(let i=0;i<v.length;i++)m.distanceField.push({fieldType:v[i].getAttribute("fieldType"),distanceRange:parseInt(v[i].getAttribute("distanceRange"),10)});return m}};let XMLStringFormat=class XMLStringFormat{static test(i){return!!("string"==typeof i&&i.includes("<font>"))&&XMLFormat.test(v.Xd.ADAPTER.parseXML(i))}static parse(i){return XMLFormat.parse(v.Xd.ADAPTER.parseXML(i))}};let tL=[TextFormat,XMLFormat,XMLStringFormat];function autoDetectFormat(i){for(let m=0;m<tL.length;m++)if(tL[m].test(i))return tL[m];return null}function generateFillStyle(i,m,p,_,x,y){let T;let v=p.fill;if(!Array.isArray(v))return v;if(1===v.length)return v[0];let E=p.dropShadow?p.dropShadowDistance:0,A=p.padding||0,S=i.width/_-E-2*A,I=i.height/_-E-2*A,R=v.slice(),C=p.fillGradientStops.slice();if(!C.length){let i=R.length+1;for(let m=1;m<i;++m)C.push(m/i)}if(R.unshift(v[0]),C.unshift(0),R.push(v[v.length-1]),C.push(1),p.fillGradientType===tx.LINEAR_VERTICAL){T=m.createLinearGradient(S/2,A,S/2,I+A);let i=0,_=(y.fontProperties.fontSize+p.strokeThickness)/I;for(let m=0;m<x.length;m++){let p=y.lineHeight*m;for(let m=0;m<R.length;m++){let x=0;x="number"==typeof C[m]?C[m]:m/R.length;let y=p/I+x*_,v=Math.max(i,y);v=Math.min(v,1),T.addColorStop(v,R[m]),i=v}}}else{T=m.createLinearGradient(A,I/2,S+A,I/2);let i=R.length+1,p=1;for(let m=0;m<R.length;m++){let _;_="number"==typeof C[m]?C[m]:p/i,T.addColorStop(_,R[m]),p++}}return T}function drawGlyph(i,m,p,_,x,y,T){let E=p.text,A=p.fontProperties;m.translate(_,x),m.scale(y,y);let S=T.strokeThickness/2,I=-(T.strokeThickness/2);if(m.font=T.toFontString(),m.lineWidth=T.strokeThickness,m.textBaseline=T.textBaseline,m.lineJoin=T.lineJoin,m.miterLimit=T.miterLimit,m.fillStyle=generateFillStyle(i,m,T,y,[E],p),m.strokeStyle=T.stroke,T.dropShadow){let i=T.dropShadowColor,p=T.dropShadowBlur*y,_=T.dropShadowDistance*y;m.shadowColor=v.Il.shared.setValue(i).setAlpha(T.dropShadowAlpha).toRgbaString(),m.shadowBlur=p,m.shadowOffsetX=Math.cos(T.dropShadowAngle)*_,m.shadowOffsetY=Math.sin(T.dropShadowAngle)*_}else m.shadowColor="black",m.shadowBlur=0,m.shadowOffsetX=0,m.shadowOffsetY=0;T.stroke&&T.strokeThickness&&m.strokeText(E,S,I+p.lineHeight-A.descent),T.fill&&m.fillText(E,S,I+p.lineHeight-A.descent),m.setTransform(1,0,0,1,0,0),m.fillStyle="rgba(0, 0, 0, 0)"}function splitTextToCharacters(i){return Array.from?Array.from(i):i.split("")}function resolveCharacters(i){"string"==typeof i&&(i=[i]);let m=[];for(let p=0,_=i.length;p<_;p++){let _=i[p];if(Array.isArray(_)){if(2!==_.length)throw Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${_.length}.`);let i=_[0].charCodeAt(0),p=_[1].charCodeAt(0);if(p<i)throw Error("[BitmapFont]: Invalid character range.");for(let _=i;_<=p;_++)m.push(String.fromCharCode(_))}else m.push(...splitTextToCharacters(_))}if(0===m.length)throw Error("[BitmapFont]: Empty set when resolving characters.");return m}function extractCharCode(i){return i.codePointAt?i.codePointAt(0):i.charCodeAt(0)}let tO=class _BitmapFont2{constructor(i,m,p){let[_]=i.info,[x]=i.common,[y]=i.page,[T]=i.distanceField,E=v.P6.getResolutionOfUrl(y.file),A={};this._ownsTextures=p,this.font=_.face,this.size=_.size,this.lineHeight=x.lineHeight/E,this.chars={},this.pageTextures=A;for(let p=0;p<i.page.length;p++){let{id:_,file:x}=i.page[p];A[_]=m instanceof Array?m[p]:m[x],T?.fieldType&&"none"!==T.fieldType&&(A[_].baseTexture.alphaMode=v.iw.NO_PREMULTIPLIED_ALPHA,A[_].baseTexture.mipmap=v.KI.OFF)}for(let m=0;m<i.char.length;m++){let{id:p,page:_}=i.char[m],{x,y,width:T,height:S,xoffset:I,yoffset:R,xadvance:C}=i.char[m];x/=E,y/=E,T/=E,S/=E,I/=E,R/=E,C/=E;let P=new v.Ae(x+A[_].frame.x/E,y+A[_].frame.y/E,T,S);this.chars[p]={xOffset:I,yOffset:R,xAdvance:C,kerning:{},texture:new v.xE(A[_].baseTexture,P),page:_}}for(let m=0;m<i.kerning.length;m++){let{first:p,second:_,amount:x}=i.kerning[m];p/=E,_/=E,x/=E,this.chars[_]&&(this.chars[_].kerning[p]=x)}this.distanceFieldRange=T?.distanceRange,this.distanceFieldType=T?.fieldType?.toLowerCase()??"none"}destroy(){for(let i in this.chars)this.chars[i].texture.destroy(),this.chars[i].texture=null;for(let i in this.pageTextures)this._ownsTextures&&this.pageTextures[i].destroy(!0),this.pageTextures[i]=null;this.chars=null,this.pageTextures=null}static install(i,m,p){let _;if(i instanceof BitmapFontData)_=i;else{let m=autoDetectFormat(i);if(!m)throw Error("Unrecognized data format for font.");_=m.parse(i)}m instanceof v.xE&&(m=[m]);let x=new _BitmapFont2(_,m,p);return _BitmapFont2.available[x.font]=x,x}static uninstall(i){let m=_BitmapFont2.available[i];if(!m)throw Error(`No font found named '${i}'`);m.destroy(),delete _BitmapFont2.available[i]}static from(i,m,p){if(!i)throw Error("[BitmapFont] Property `name` is required.");let{chars:_,padding:x,resolution:y,textureWidth:T,textureHeight:E,...A}=Object.assign({},_BitmapFont2.defaultOptions,p),S=resolveCharacters(_),I=m instanceof tE?m:new tE(m),R=new BitmapFontData;R.info[0]={face:I.fontFamily,size:I.fontSize},R.common[0]={lineHeight:I.fontSize};let C=0,P=0,k,B,D,F=0,L=[],O=[];for(let i=0;i<S.length;i++){k||((k=v.Xd.ADAPTER.createCanvas()).width=T,k.height=E,B=k.getContext("2d"),D=new v.VL(k,{resolution:y,...A}),L.push(D),O.push(new v.xE(D)),R.page.push({id:O.length-1,file:""}));let m=S[i],p=tb.measureText(m,I,!1,k),_=p.width,V=Math.ceil(p.height),U=Math.ceil(("italic"===I.fontStyle?2:1)*_);if(P>=E-V*y){if(0===P)throw Error(`[BitmapFont] textureHeight ${E}px is too small (fontFamily: '${I.fontFamily}', fontSize: ${I.fontSize}px, char: '${m}')`);--i,k=null,B=null,D=null,P=0,C=0,F=0;continue}if(F=Math.max(V+p.fontProperties.descent,F),U*y+C>=T){if(0===C)throw Error(`[BitmapFont] textureWidth ${T}px is too small (fontFamily: '${I.fontFamily}', fontSize: ${I.fontSize}px, char: '${m}')`);--i,P+=F*y,P=Math.ceil(P),C=0,F=0;continue}drawGlyph(k,B,p,C,P,y,I);let X=extractCharCode(p.text);R.char.push({id:X,page:O.length-1,x:C/y,y:P/y,width:U,height:V,xoffset:0,yoffset:0,xadvance:_-(I.dropShadow?I.dropShadowDistance:0)-(I.stroke?I.strokeThickness:0)}),C+=(U+2*x)*y,C=Math.ceil(C)}if(!p?.skipKerning)for(let i=0,m=S.length;i<m;i++){let p=S[i];for(let i=0;i<m;i++){let m=S[i],_=B.measureText(p).width,x=B.measureText(m).width,y=B.measureText(p+m).width-(_+x);y&&R.kerning.push({first:extractCharCode(p),second:extractCharCode(m),amount:y})}}let V=new _BitmapFont2(R,O,!0);return void 0!==_BitmapFont2.available[i]&&_BitmapFont2.uninstall(i),_BitmapFont2.available[i]=V,V}};tO.ALPHA=[["a","z"],["A","Z"]," "],tO.NUMERIC=[["0","9"]],tO.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],tO.ASCII=[[" ","~"]],tO.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:tO.ALPHANUMERIC},tO.available={};var tV=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,tU=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;let tX=[],tY=[],tG=[],tH=class _BitmapText2 extends E.W2{constructor(i,m={}){super();let{align:p,tint:_,maxWidth:x,letterSpacing:y,fontName:T,fontSize:E}=Object.assign({},_BitmapText2.styleDefaults,m);if(!tO.available[T])throw Error(`Missing BitmapFont "${T}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=p,this._tintColor=new v.Il(_),this._font=void 0,this._fontName=T,this._fontSize=E,this.text=i,this._maxWidth=x,this._maxLineHeight=0,this._letterSpacing=y,this._anchor=new v.AB(()=>{this.dirty=!0},this,0,0),this._roundPixels=v.Xd.ROUND_PIXELS,this.dirty=!0,this._resolution=v.Xd.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){let i=tO.available[this._fontName],m=this.fontSize,p=m/i.size,_=new v.E9,x=[],y=[],T=[],E=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",A=splitTextToCharacters(E),S=this._maxWidth*i.size/m,I="none"===i.distanceFieldType?tX:tY,R=null,C=0,P=0,k=0,B=-1,D=0,F=0,L=0,O=0;for(let m=0;m<A.length;m++){let p=A[m],E=extractCharCode(p);if(/(?:\s)/.test(p)&&(B=m,D=C,O++),"\r"===p||p===`
`){y.push(C),T.push(-1),P=Math.max(P,C),++k,++F,_.x=0,_.y+=i.lineHeight,R=null,O=0;continue}let I=i.chars[E];if(!I)continue;R&&I.kerning[R]&&(_.x+=I.kerning[R]);let V=tG.pop()||{texture:v.xE.EMPTY,line:0,charCode:0,prevSpaces:0,position:new v.E9};V.texture=I.texture,V.line=k,V.charCode=E,V.position.x=Math.round(_.x+I.xOffset+this._letterSpacing/2),V.position.y=Math.round(_.y+I.yOffset),V.prevSpaces=O,x.push(V),C=V.position.x+Math.max(I.xAdvance-I.xOffset,I.texture.orig.width),_.x+=I.xAdvance+this._letterSpacing,L=Math.max(L,I.yOffset+I.texture.height),R=E,-1!==B&&S>0&&_.x>S&&(++F,v.P6.removeItems(x,1+B-F,1+m-B),m=B,B=-1,y.push(D),T.push(x.length>0?x[x.length-1].prevSpaces:0),P=Math.max(P,D),k++,_.x=0,_.y+=i.lineHeight,R=null,O=0)}let V=A[A.length-1];"\r"!==V&&V!==`
`&&(/(?:\s)/.test(V)&&(C=D),y.push(C),P=Math.max(P,C),T.push(-1));let U=[];for(let i=0;i<=k;i++){let m=0;"right"===this._align?m=P-y[i]:"center"===this._align?m=(P-y[i])/2:"justify"===this._align&&(m=T[i]<0?0:(P-y[i])/T[i]),U.push(m)}let X=x.length,Y={},G=[],W=this._activePagesMeshData;I.push(...W);for(let m=0;m<X;m++){let p=x[m].texture,_=p.baseTexture.uid;if(!Y[_]){let m=I.pop();if(!m){let p,_;let x=new tp.xc;"none"===i.distanceFieldType?(p=new tp.rY(v.xE.EMPTY),_=v.T$.NORMAL):(p=new tp.rY(v.xE.EMPTY,{program:v.$r.from(tU,tV),uniforms:{uFWidth:0}}),_=v.T$.NORMAL_NPM);let y=new tp.Kj(x,p);y.blendMode=_,m={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:y,vertices:null,uvs:null,indices:null}}m.index=0,m.indexCount=0,m.vertexCount=0,m.uvsCount=0,m.total=0;let{_textureCache:x}=this;x[_]=x[_]||new v.xE(p.baseTexture),m.mesh.texture=x[_],m.mesh.tint=this._tintColor.value,G.push(m),Y[_]=m}Y[_].total++}for(let i=0;i<W.length;i++)G.includes(W[i])||this.removeChild(W[i].mesh);for(let i=0;i<G.length;i++)G[i].mesh.parent!==this&&this.addChild(G[i].mesh);for(let i in this._activePagesMeshData=G,Y){let m=Y[i],p=m.total;if(!(m.indices?.length>6*p)||m.vertices.length<2*tp.Kj.BATCHABLE_SIZE)m.vertices=new Float32Array(8*p),m.uvs=new Float32Array(8*p),m.indices=new Uint16Array(6*p);else{let i=m.total,p=m.vertices;for(let m=8*i;m<p.length;m++)p[m]=0}m.mesh.size=6*p}for(let i=0;i<X;i++){let m=x[i],_=m.position.x+U[m.line]*("justify"===this._align?m.prevSpaces:1);this._roundPixels&&(_=Math.round(_));let y=_*p,T=m.position.y*p,v=m.texture,E=Y[v.baseTexture.uid],A=v.frame,S=v._uvs,I=E.index++;E.indices[6*I+0]=0+4*I,E.indices[6*I+1]=1+4*I,E.indices[6*I+2]=2+4*I,E.indices[6*I+3]=0+4*I,E.indices[6*I+4]=2+4*I,E.indices[6*I+5]=3+4*I,E.vertices[8*I+0]=y,E.vertices[8*I+1]=T,E.vertices[8*I+2]=y+A.width*p,E.vertices[8*I+3]=T,E.vertices[8*I+4]=y+A.width*p,E.vertices[8*I+5]=T+A.height*p,E.vertices[8*I+6]=y,E.vertices[8*I+7]=T+A.height*p,E.uvs[8*I+0]=S.x0,E.uvs[8*I+1]=S.y0,E.uvs[8*I+2]=S.x1,E.uvs[8*I+3]=S.y1,E.uvs[8*I+4]=S.x2,E.uvs[8*I+5]=S.y2,E.uvs[8*I+6]=S.x3,E.uvs[8*I+7]=S.y3}for(let m in this._textWidth=P*p,this._textHeight=(_.y+i.lineHeight)*p,Y){let i=Y[m];if(0!==this.anchor.x||0!==this.anchor.y){let m=0,p=this._textWidth*this.anchor.x,_=this._textHeight*this.anchor.y;for(let x=0;x<i.total;x++)i.vertices[m++]-=p,i.vertices[m++]-=_,i.vertices[m++]-=p,i.vertices[m++]-=_,i.vertices[m++]-=p,i.vertices[m++]-=_,i.vertices[m++]-=p,i.vertices[m++]-=_}this._maxLineHeight=L*p;let _=i.mesh.geometry.getBuffer("aVertexPosition"),x=i.mesh.geometry.getBuffer("aTextureCoord"),y=i.mesh.geometry.getIndex();_.data=i.vertices,x.data=i.uvs,y.data=i.indices,_.update(),x.update(),y.update()}for(let i=0;i<x.length;i++)tG.push(x[i]);this._font=i,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0);let{distanceFieldRange:m,distanceFieldType:p,size:_}=tO.available[this._fontName];if("none"!==p){let{a:p,b:x,c:y,d:T}=this.worldTransform,v=(Math.abs(Math.sqrt(p*p+x*x))+Math.abs(Math.sqrt(y*y+T*T)))/2,E=this.fontSize/_,A=i._view.resolution;for(let i of this._activePagesMeshData)i.mesh.shader.uniforms.uFWidth=v*m*E*A}super._render(i)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){let i=tO.available[this._fontName];if(!i)throw Error(`Missing BitmapFont "${this._fontName}"`);this._font!==i&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(i){if(this.tint!==i){this._tintColor.setValue(i);for(let m=0;m<this._activePagesMeshData.length;m++)this._activePagesMeshData[m].mesh.tint=i}}get align(){return this._align}set align(i){this._align!==i&&(this._align=i,this.dirty=!0)}get fontName(){return this._fontName}set fontName(i){if(!tO.available[i])throw Error(`Missing BitmapFont "${i}"`);this._fontName!==i&&(this._fontName=i,this.dirty=!0)}get fontSize(){return this._fontSize??tO.available[this._fontName].size}set fontSize(i){this._fontSize!==i&&(this._fontSize=i,this.dirty=!0)}get anchor(){return this._anchor}set anchor(i){"number"==typeof i?this._anchor.set(i):this._anchor.copyFrom(i)}get text(){return this._text}set text(i){i=String(i??""),this._text!==i&&(this._text=i,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(i){this._maxWidth!==i&&(this._maxWidth=i,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(i){this._letterSpacing!==i&&(this._letterSpacing=i,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(i){i!==this._roundPixels&&(this._roundPixels=i,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}destroy(i){let{_textureCache:m}=this,p="none"===tO.available[this._fontName].distanceFieldType?tX:tY;for(let i of(p.push(...this._activePagesMeshData),this._activePagesMeshData))this.removeChild(i.mesh);for(let i in this._activePagesMeshData=[],p.filter(i=>m[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=v.xE.EMPTY}),m)m[i].destroy(),delete m[i];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(i)}};tH.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};let tW=[".xml",".fnt"],t$={extension:{type:v.nw.LoadParser,priority:Z.Q2.Normal},name:"loadBitmapFont",test:i=>tW.includes(v.P6.path.extname(i).toLowerCase()),testParse:async i=>TextFormat.test(i)||XMLStringFormat.test(i),async parse(i,m,p){let _=TextFormat.test(i)?TextFormat.parse(i):XMLStringFormat.parse(i),{src:x}=m,{page:y}=_,T=[];for(let i=0;i<y.length;++i){let m=y[i].file,p=v.P6.path.join(v.P6.path.dirname(x),m);p=(0,Z.uz)(p,x),T.push(p)}let E=await p.load(T),A=T.map(i=>E[i]);return tO.install(_,A,!0)},load:async(i,m)=>(await v.Xd.ADAPTER.fetch(i)).text(),unload(i){i.destroy()}};v.Rw.add(t$);let tz=class _HTMLTextStyle2 extends tE{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(i){return new _HTMLTextStyle2(Object.keys(_HTMLTextStyle2.defaultOptions).reduce((m,p)=>({...m,[p]:i[p]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(i=>{URL.revokeObjectURL(i.src),i.refs--,0===i.refs&&(i.fontFace&&document.fonts.delete(i.fontFace),delete _HTMLTextStyle2.availableFonts[i.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(i,m={}){let{availableFonts:p}=_HTMLTextStyle2;if(p[i]){let m=p[i];return this._fonts.push(m),m.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return v.Xd.ADAPTER.fetch(i).then(i=>i.blob()).then(async i=>new Promise((m,p)=>{let _=URL.createObjectURL(i),x=new FileReader;x.onload=()=>m([_,x.result]),x.onerror=p,x.readAsDataURL(i)})).then(async([_,x])=>{let y=Object.assign({family:v.P6.path.basename(i,v.P6.path.extname(i)),weight:"normal",style:"normal",display:"auto",src:_,dataSrc:x,refs:1,originalUrl:i,fontFace:null},m);p[i]=y,this._fonts.push(y),this.styleID++;let T=new FontFace(y.family,`url(${y.src})`,{weight:y.weight,style:y.style,display:y.display});y.fontFace=T,await T.load(),document.fonts.add(T),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...i){let m=i.filter(i=>!this._overrides.includes(i));m.length>0&&(this._overrides.push(...m),this.styleID++)}removeOverride(...i){let m=i.filter(i=>this._overrides.includes(i));m.length>0&&(this._overrides=this._overrides.filter(i=>!m.includes(i)),this.styleID++)}toCSS(i){return[`transform: scale(${i})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((i,m)=>`${i}
            @font-face {
                font-family: "${m.family}";
                src: url('${m.dataSrc}');
                font-weight: ${m.weight};
                font-style: ${m.style};
                font-display: ${m.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(i){this._stylesheet!==i&&(this._stylesheet=i,this.styleID++)}normalizeColor(i){return Array.isArray(i)&&(i=v.P6.rgb2hex(i)),"number"==typeof i?v.P6.hex2string(i):i}dropShadowToCSS(){let i=this.normalizeColor(this.dropShadowColor),m=this.dropShadowAlpha,p=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),_=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);i.startsWith("#")&&m<1&&(i+=(255*m|0).toString(16).padStart(2,"0"));let x=`${p}px ${_}px`;return this.dropShadowBlur>0?`text-shadow: ${x} ${this.dropShadowBlur}px ${i}`:`text-shadow: ${x} ${i}`}reset(){Object.assign(this,_HTMLTextStyle2.defaultOptions)}onBeforeDraw(){let{fontsDirty:i}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&i?new Promise(i=>setTimeout(i,100)):Promise.resolve()}get isSafari(){let{userAgent:i}=v.Xd.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(i)}set fillGradientStops(i){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(i){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(i){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(i){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(i){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(i){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(i){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};tz.availableFonts={},tz.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let tj=class _HTMLText2 extends A.j{constructor(i="",m={}){super(v.xE.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;let p=new Image,_=v.xE.from(p,{scaleMode:v.Xd.SCALE_MODE,resourceOptions:{autoLoad:!1}});_.orig=new v.Ae,_.trim=new v.Ae,this.texture=_;let x="http://www.w3.org/2000/svg",y="http://www.w3.org/1999/xhtml",T=document.createElementNS(x,"svg"),E=document.createElementNS(x,"foreignObject"),A=document.createElementNS(y,"div"),S=document.createElementNS(y,"style");E.setAttribute("width","10000"),E.setAttribute("height","10000"),E.style.overflow="hidden",T.appendChild(E),this.maxWidth=_HTMLText2.defaultMaxWidth,this.maxHeight=_HTMLText2.defaultMaxHeight,this._domElement=A,this._styleElement=S,this._svgRoot=T,this._foreignObject=E,this._foreignObject.appendChild(S),this._foreignObject.appendChild(A),this._image=p,this._loadImage=new Image,this._autoResolution=_HTMLText2.defaultAutoResolution,this._resolution=_HTMLText2.defaultResolution??v.Xd.RESOLUTION,this.text=i,this.style=m}measureText(i){let{text:m,style:p,resolution:_}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},i);Object.assign(this._domElement,{innerHTML:m,style:p.toCSS(_)}),this._styleElement.textContent=p.toGlobalCSS(),document.body.appendChild(this._svgRoot);let x=this._domElement.getBoundingClientRect();this._svgRoot.remove();let{width:y,height:T}=x;(y>this.maxWidth||T>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");let v=Math.min(this.maxWidth,Math.ceil(y)),E=Math.min(this.maxHeight,Math.ceil(T));return this._svgRoot.setAttribute("width",v.toString()),this._svgRoot.setAttribute("height",E.toString()),m!==this._text&&(this._domElement.innerHTML=this._text),p!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(_)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:v+2*p.padding,height:E+2*p.padding}}async updateText(i=!0){let{style:m,_image:p,_loadImage:_}=this;if(this.localStyleID!==m.styleID&&(this.dirty=!0,this.localStyleID=m.styleID),!this.dirty&&i)return;let{width:x,height:y}=this.measureText();p.width=_.width=Math.ceil(Math.max(1,x)),p.height=_.height=Math.ceil(Math.max(1,y)),this._updateID++;let T=this._updateID;await new Promise(i=>{_.onload=async()=>{if(T<this._updateID){i();return}await m.onBeforeDraw(),p.src=_.src,_.onload=null,_.src="",this.updateTexture(),i()};let x=new XMLSerializer().serializeToString(this._svgRoot);_.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(x)}`})}get source(){return this._image}updateTexture(){let{style:i,texture:m,_image:p,resolution:_}=this,{padding:x}=i,{baseTexture:y}=m;m.trim.width=m._frame.width=p.width/_,m.trim.height=m._frame.height=p.height/_,m.trim.x=-x,m.trim.y=-x,m.orig.width=m._frame.width-2*x,m.orig.height=m._frame.height-2*x,this._onTextureUpdate(),y.setRealSize(p.width,p.height,_),this.dirty=!1}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),super._render(i)}_renderCanvas(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(i)}getLocalBounds(i){return this.updateText(!0),super.getLocalBounds(i)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(i){"boolean"==typeof i&&(i={children:i}),i=Object.assign({},_HTMLText2.defaultDestroyOptions,i),super.destroy(i),this.ownsStyle&&this._style?.cleanFonts(),this._style=null,this._svgRoot?.remove(),this._svgRoot=null,this._domElement?.remove(),this._domElement=null,this._foreignObject?.remove(),this._foreignObject=null,this._styleElement?.remove(),this._styleElement=null,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=null,this._image.src="",this._image=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(i){this.updateText(!0);let m=v.P6.sign(this.scale.x)||1;this.scale.x=m*i/this._image.width/this.resolution,this._width=i}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(i){this.updateText(!0);let m=v.P6.sign(this.scale.y)||1;this.scale.y=m*i/this._image.height/this.resolution,this._height=i}get style(){return this._style}set style(i){this._style!==i&&((i=i||{})instanceof tz?(this.ownsStyle=!1,this._style=i):i instanceof tE?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=tz.from(i)):(this.ownsStyle=!0,this._style=new tz(i)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(i){i=String(""===i||null==i?" ":i),i=this.sanitiseText(i),this._text!==i&&(this._text=i,this.dirty=!0)}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}sanitiseText(i){return i.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};tj.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},tj.defaultMaxWidth=2024,tj.defaultMaxHeight=2024,tj.defaultAutoResolution=!0}}]);